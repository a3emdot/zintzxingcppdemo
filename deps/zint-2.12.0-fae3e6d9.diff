diff -urN zint-2.12.0/backend/2of5.c zint/backend/2of5.c
--- zint-2.12.0/backend/2of5.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/2of5.c	2023-05-08 14:39:44.834319188 +0200
@@ -1,7 +1,7 @@
 /* 2of5.c - Handles Code 2 of 5 barcodes */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -89,6 +89,7 @@
         /* Add standard GS1 check digit */
         temp[length] = gs1_check_digit(source, length);
         temp[++length] = '\0';
+        if (symbol->debug & ZINT_DEBUG_PRINT) printf("Check digit: %c\n", temp[length - 1]);
     }
 
     /* Start character */
diff -urN zint-2.12.0/backend/bmp.c zint/backend/bmp.c
--- zint-2.12.0/backend/bmp.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/bmp.c	2023-05-08 14:39:44.838319211 +0200
@@ -1,7 +1,7 @@
 /* bmp.c - Handles output to Windows Bitmap file */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -41,7 +41,7 @@
 #include "output.h"
 #include "bmp.h"        /* Bitmap header structure */
 
-INTERNAL int bmp_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf) {
+INTERNAL int bmp_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
     int i, row, column;
     int row_size;
     int bits_per_pixel;
@@ -57,18 +57,19 @@
     color_ref_t fg_color_ref;
     color_ref_t ultra_color_ref[8];
     int ultra_fg_index = 9;
+    unsigned char map[128];
     const int output_to_stdout = symbol->output_options & BARCODE_STDOUT; /* Suppress gcc -fanalyzer warning */
 
-    fg_color_ref.red = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fg_color_ref.green = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fg_color_ref.blue = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
+    (void) out_colour_get_rgb(symbol->fgcolour, &fg_color_ref.red, &fg_color_ref.green, &fg_color_ref.blue,
+                NULL /*alpha*/);
     fg_color_ref.reserved = 0x00;
-    bg_color_ref.red = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bg_color_ref.green = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bg_color_ref.blue = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
+
+    (void) out_colour_get_rgb(symbol->bgcolour, &bg_color_ref.red, &bg_color_ref.green, &bg_color_ref.blue,
+                NULL /*alpha*/);
     bg_color_ref.reserved = 0x00;
 
     if (symbol->symbology == BARCODE_ULTRA) {
+        static const int ultra_chars[8] = { 'C', 'B', 'M', 'R', 'Y', 'G', 'K', 'W' };
         for (i = 0; i < 8; i++) {
             ultra_color_ref[i].red = colour_to_red(i + 1);
             ultra_color_ref[i].green = colour_to_green(i + 1);
@@ -77,12 +78,17 @@
             if (memcmp(&ultra_color_ref[i], &fg_color_ref, sizeof(fg_color_ref)) == 0) {
                 ultra_fg_index = i + 1;
             }
+            map[ultra_chars[i]] = i + 1;
         }
         bits_per_pixel = 4;
         colour_count = ultra_fg_index == 9 ? 10 : 9;
+        map['0'] = 0;
+        map['1'] = ultra_fg_index;
     } else {
         bits_per_pixel = 1;
         colour_count = 2;
+        map['0'] = 0;
+        map['1'] = 0x80;
     }
     row_size = 4 * ((bits_per_pixel * symbol->bitmap_width + 31) / 32);
     data_size = symbol->bitmap_height * row_size;
@@ -102,46 +108,16 @@
     /* Pixel Plotting */
     if (symbol->symbology == BARCODE_ULTRA) {
         for (row = 0; row < symbol->bitmap_height; row++) {
+            const unsigned char *pb = pixelbuf + (symbol->bitmap_width * (symbol->bitmap_height - row - 1));
             for (column = 0; column < symbol->bitmap_width; column++) {
-                i = (column / 2) + (row * row_size);
-                switch (*(pixelbuf + (symbol->bitmap_width * (symbol->bitmap_height - row - 1)) + column)) {
-                    case 'C': /* Cyan */
-                        bitmap[i] += 1 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'B': /* Blue */
-                        bitmap[i] += 2 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'M': /* Magenta */
-                        bitmap[i] += 3 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'R': /* Red */
-                        bitmap[i] += 4 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'Y': /* Yellow */
-                        bitmap[i] += 5 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'G': /* Green */
-                        bitmap[i] += 6 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'K': /* Black */
-                        bitmap[i] += 7 << (4 * (1 - (column % 2)));
-                        break;
-                    case 'W': /* White */
-                        bitmap[i] += 8 << (4 * (1 - (column % 2)));
-                        break;
-                    case '1': /* Foreground */
-                        bitmap[i] += ultra_fg_index << (4 * (1 - (column % 2)));
-                        break;
-                }
+                bitmap[(column >> 1) + (row * row_size)] |= map[pb[column]] << (!(column & 1) << 2);
             }
         }
     } else {
         for (row = 0; row < symbol->bitmap_height; row++) {
+            const unsigned char *pb = pixelbuf + (symbol->bitmap_width * (symbol->bitmap_height - row - 1));
             for (column = 0; column < symbol->bitmap_width; column++) {
-                i = (column / 8) + (row * row_size);
-                if ((*(pixelbuf + (symbol->bitmap_width * (symbol->bitmap_height - row - 1)) + column)) == '1') {
-                    bitmap[i] += (0x01 << (7 - (column % 8)));
-                }
+                bitmap[(column >> 3) + (row * row_size)] |= map[pb[column]] >> (column & 7);
             }
         }
     }
@@ -199,18 +175,35 @@
         bmp_file = stdout;
     } else {
         if (!(bmp_file = out_fopen(symbol->outfile, "wb"))) {
-            free(bitmap_file_start);
             sprintf(symbol->errtxt, "601: Could not open output file (%d: %.30s)", errno, strerror(errno));
+            free(bitmap_file_start);
             return ZINT_ERROR_FILE_ACCESS;
         }
     }
 
     fwrite(bitmap_file_start, file_header.file_size, 1, bmp_file);
 
+    if (ferror(bmp_file)) {
+        sprintf(symbol->errtxt, "603: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        free(bitmap_file_start);
+        if (!output_to_stdout) {
+            (void) fclose(bmp_file);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(bmp_file);
+        if (fflush(bmp_file) != 0) {
+            sprintf(symbol->errtxt, "604: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            free(bitmap_file_start);
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(bmp_file);
+        if (fclose(bmp_file) != 0) {
+            sprintf(symbol->errtxt, "605: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            free(bitmap_file_start);
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     free(bitmap_file_start);
diff -urN zint-2.12.0/backend/CMakeLists.txt zint/backend/CMakeLists.txt
--- zint-2.12.0/backend/CMakeLists.txt	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/CMakeLists.txt	2023-05-08 14:39:44.834319188 +0200
@@ -46,12 +46,12 @@
     endif()
 endfunction()
 
-function(zint_target_include_directories scope directory)
+function(zint_target_include_directories)
     if(ZINT_SHARED)
-        target_include_directories(zint ${scope} ${directory})
+        target_include_directories(zint ${ARGN})
     endif()
     if(ZINT_STATIC)
-        target_include_directories(zint-static ${scope} ${directory})
+        target_include_directories(zint-static ${ARGN})
     endif()
 endfunction()
 
@@ -80,7 +80,9 @@
 endif()
 
 if(MSVC)
-    target_compile_definitions(zint PRIVATE DLL_EXPORT)
+    if(ZINT_SHARED)
+        target_compile_definitions(zint PRIVATE DLL_EXPORT)
+    endif()
 endif()
 
 zint_target_include_directories(PUBLIC
diff -urN zint-2.12.0/backend/code128.c zint/backend/code128.c
--- zint-2.12.0/backend/code128.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/code128.c	2023-05-08 14:39:44.841319229 +0200
@@ -1,7 +1,7 @@
 /* code128.c - Handles Code 128 and derivatives */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
     Bugfixes thanks to Christian Sakowski and BogDan Vatra
 
     Redistribution and use in source and binary forms, with or without
@@ -97,14 +97,14 @@
 }
 
 /**
- * bring together same type blocks
+ * Bring together same type blocks
  */
-static void c128_grwp(int list[2][C128_MAX], int *indexliste) {
+static void c128_grwp(int list[2][C128_MAX], int *p_indexliste) {
 
     /* bring together same type blocks */
-    if (*(indexliste) > 1) {
+    if (*p_indexliste > 1) {
         int i = 1;
-        while (i < *(indexliste)) {
+        while (i < *p_indexliste) {
             if (list[1][i - 1] == list[1][i]) {
                 int j;
                 /* bring together */
@@ -112,12 +112,12 @@
                 j = i + 1;
 
                 /* decrease the list */
-                while (j < *(indexliste)) {
+                while (j < *p_indexliste) {
                     list[0][j - 1] = list[0][j];
                     list[1][j - 1] = list[1][j];
                     j++;
                 }
-                *(indexliste) = *(indexliste) - 1;
+                *p_indexliste = *p_indexliste - 1;
                 i--;
             }
             i++;
@@ -128,10 +128,11 @@
 /**
  * Implements rules from ISO 15417 Annex E
  */
-INTERNAL void c128_dxsmooth(int list[2][C128_MAX], int *indexliste) {
+INTERNAL void c128_dxsmooth(int list[2][C128_MAX], int *p_indexliste, const char *manual_set) {
     int i, last, next;
+    const int indexliste = *p_indexliste;
 
-    for (i = 0; i < *(indexliste); i++) {
+    for (i = 0; i < indexliste; i++) {
         int current = list[1][i]; /* Either C128_ABORC, C128_AORB, C128_SHIFTA or C128_SHIFTB */
         int length = list[0][i];
         if (i != 0) {
@@ -139,7 +140,7 @@
         } else {
             last = 0;
         }
-        if (i != *(indexliste) - 1) {
+        if (i != indexliste - 1) {
             next = list[1][i + 1];
         } else {
             next = 0;
@@ -147,7 +148,10 @@
 
         if (i == 0) { /* first block */
             if (current == C128_ABORC) {
-                if ((*(indexliste) == 1) && (length == 2)) {
+                if (manual_set && manual_set[i]) {
+                    list[1][i] = manual_set[i];
+                    current = manual_set[i];
+                } else if ((indexliste == 1) && (length == 2)) {
                     /* Rule 1a */
                     list[1][i] = C128_LATCHC;
                     current = C128_LATCHC;
@@ -160,7 +164,9 @@
                 }
             }
             if (current == C128_AORB) {
-                if (next == C128_SHIFTA) {
+                if (manual_set && (manual_set[i] == 'A' || manual_set[i] == 'B')) {
+                    list[1][i] = manual_set[i];
+                } else if (next == C128_SHIFTA) {
                     /* Rule 1c */
                     list[1][i] = C128_LATCHA;
                 } else {
@@ -170,14 +176,17 @@
             } else if (current == C128_SHIFTA) {
                 /* Rule 1c */
                 list[1][i] = C128_LATCHA;
-            } else if (current == C128_SHIFTB) { /* Unless C128_LATCHC set above, can only be C128_SHIFTB */
+            } else if (current == C128_SHIFTB) { /* Unless C128_LATCHX set above, can only be C128_SHIFTB */
                 /* Rule 1d */
                 list[1][i] = C128_LATCHB;
             }
         } else {
             if (current == C128_ABORC) {
-                if (length >= 4) {
-                    /* Rule 3 */
+                if (manual_set && manual_set[i]) {
+                    list[1][i] = manual_set[i];
+                    current = manual_set[i];
+                } else if (length >= 4) {
+                    /* Rule 3 - note Rule 3b (odd C blocks) dealt with later */
                     list[1][i] = C128_LATCHC;
                     current = C128_LATCHC;
                 } else {
@@ -185,7 +194,9 @@
                 }
             }
             if (current == C128_AORB) {
-                if (last == C128_LATCHA || last == C128_SHIFTB) { /* Maintain state */
+                if (manual_set && (manual_set[i] == 'A' || manual_set[i] == 'B')) {
+                    list[1][i] = manual_set[i];
+                } else if (last == C128_LATCHA || last == C128_SHIFTB) { /* Maintain state */
                     list[1][i] = C128_LATCHA;
                 } else if (last == C128_LATCHB || last == C128_SHIFTA) { /* Maintain state */
                     list[1][i] = C128_LATCHB;
@@ -195,7 +206,9 @@
                     list[1][i] = C128_LATCHB;
                 }
             } else if (current == C128_SHIFTA) {
-                if (length > 1) {
+                if (manual_set && manual_set[i] == 'A') {
+                    list[1][i] = C128_LATCHA;
+                } else if (length > 1) {
                     /* Rule 4 */
                     list[1][i] = C128_LATCHA;
                 } else if (last == C128_LATCHA || last == C128_SHIFTB) { /* Maintain state */
@@ -203,8 +216,10 @@
                 } else if (last == C128_LATCHC) {
                     list[1][i] = C128_LATCHA;
                 }
-            } else if (current == C128_SHIFTB) { /* Unless C128_LATCHC set above, can only be C128_SHIFTB */
-                if (length > 1) {
+            } else if (current == C128_SHIFTB) { /* Unless C128_LATCHX set above, can only be C128_SHIFTB */
+                if (manual_set && manual_set[i] == 'B') {
+                    list[1][i] = C128_LATCHB;
+                } else if (length > 1) {
                     /* Rule 5 */
                     list[1][i] = C128_LATCHB;
                 } else if (last == C128_LATCHB || last == C128_SHIFTA) { /* Maintain state */
@@ -216,7 +231,7 @@
         } /* Rule 2 is implemented elsewhere, Rule 6 is implied */
     }
 
-    c128_grwp(list, indexliste);
+    c128_grwp(list, p_indexliste);
 }
 
 /**
@@ -273,25 +288,13 @@
 
 /* Put set data into set[]. If source given (GS1_MODE) then resolves odd C blocks */
 INTERNAL void c128_put_in_set(int list[2][C128_MAX], const int indexliste, char set[C128_MAX],
-                unsigned char *source) {
+                const unsigned char *source) {
     int read = 0;
     int i, j;
 
     for (i = 0; i < indexliste; i++) {
         for (j = 0; j < list[0][i]; j++) {
-            switch (list[1][i]) {
-                case C128_SHIFTA: set[read] = 'a';
-                    break;
-                case C128_LATCHA: set[read] = 'A';
-                    break;
-                case C128_SHIFTB: set[read] = 'b';
-                    break;
-                case C128_LATCHB: set[read] = 'B';
-                    break;
-                case C128_LATCHC: set[read] = 'C';
-                    break;
-            }
-            read++;
+            set[read++] = list[1][i];
         }
     }
     if (source) {
@@ -380,6 +383,9 @@
 INTERNAL int code128(struct zint_symbol *symbol, unsigned char source[], int length) {
     int i, j, k, values[C128_MAX] = {0}, bar_characters = 0, read, total_sum;
     int error_number = 0, indexchaine, indexliste, f_state = 0;
+    unsigned char src_buf[C128_MAX + 1];
+    unsigned char *src = source;
+    char manual_set[C128_MAX] = {0};
     int list[2][C128_MAX] = {{0}};
     char set[C128_MAX] = {0}, fset[C128_MAX], mode, last_set, current_set = ' ';
     int glyph_count = 0; /* Codeword estimate times 2 */
@@ -396,9 +402,47 @@
         return ZINT_ERROR_TOO_LONG;
     }
 
+    /* Detect special Code Set escapes for Code 128 in extra escape mode only */
+    if ((symbol->input_mode & EXTRA_ESCAPE_MODE) && symbol->symbology == BARCODE_CODE128) {
+        char manual_ch = '\0';
+        j = 0;
+        for (i = 0; i < length; i++) {
+            if (source[i] == '\\' && i + 2 < length && source[i + 1] == '^'
+                    && ((source[i + 2] >= 'A' && source[i + 2] <= 'C') || source[i + 2] == '^')) {
+                if (source[i + 2] != '^') {
+                    i += 2;
+                    manual_ch = source[i];
+                } else { /* Escape sequence '\^^' */
+                    manual_set[j] = manual_ch;
+                    src_buf[j++] = source[i++];
+                    manual_set[j] = manual_ch;
+                    src_buf[j++] = source[i++];
+                    /* Drop second '^' */
+                }
+            } else {
+                manual_set[j] = manual_ch;
+                src_buf[j++] = source[i];
+            }
+        }
+        if (j != length) {
+            length = j;
+            if (length == 0) {
+                strcpy(symbol->errtxt, "842: No input data");
+                return ZINT_ERROR_INVALID_DATA;
+            }
+            src = src_buf;
+            src[length] = '\0';
+            if (symbol->debug & ZINT_DEBUG_PRINT) {
+                printf("MSet: ");
+                for (i = 0; i < length; i++) printf("%c", manual_set[i] ? manual_set[i] : '.');
+                printf("\n");
+            }
+        }
+    }
+
     /* Detect extended ASCII characters */
     for (i = 0; i < length; i++) {
-        fset[i] = source[i] >= 128 ? 'f' : ' ';
+        fset[i] = src[i] >= 128 ? 'f' : ' ';
     }
 
     /* Decide when to latch to extended mode - Annex E note 3 */
@@ -447,8 +491,10 @@
     indexliste = 0;
     indexchaine = 0;
 
-    mode = c128_parunmodd(source[indexchaine]);
-    if ((symbol->symbology == BARCODE_CODE128AB) && (mode == C128_ABORC)) {
+    mode = c128_parunmodd(src[indexchaine]);
+    if (mode == C128_ABORC
+            && (symbol->symbology == BARCODE_CODE128AB
+                || (manual_set[indexchaine] == 'A' || manual_set[indexchaine] == 'B'))) {
         mode = C128_AORB;
     }
 
@@ -460,15 +506,28 @@
             if (indexchaine == length) {
                 break;
             }
-            mode = c128_parunmodd(source[indexchaine]);
-            if ((symbol->symbology == BARCODE_CODE128AB) && (mode == C128_ABORC)) {
+            mode = c128_parunmodd(src[indexchaine]);
+            if (mode == C128_ABORC
+                    && (symbol->symbology == BARCODE_CODE128AB
+                        || (manual_set[indexchaine] == 'A' || manual_set[indexchaine] == 'B'))) {
                 mode = C128_AORB;
             }
+            if (manual_set[indexchaine] != manual_set[indexchaine - 1]) {
+                break;
+            }
         }
         indexliste++;
     } while (indexchaine < length);
 
-    c128_dxsmooth(list, &indexliste);
+    if (src == src_buf) {
+        /* Need to re-index `manual_set` to have sames indexes as `list` blocks for `c128_dxsmooth()` */
+        j = 0;
+        for (i = 1; i < indexliste; i++) {
+            j += list[0][i - 1];
+            manual_set[i] = manual_set[j];
+        }
+    }
+    c128_dxsmooth(list, &indexliste, src == src_buf ? manual_set : NULL);
 
     /* Resolve odd length C128_LATCHC blocks */
     if ((list[1][0] == C128_LATCHC) && (list[0][0] & 1)) {
@@ -495,7 +554,7 @@
     c128_put_in_set(list, indexliste, set, NULL /*source*/);
 
     if (symbol->debug & ZINT_DEBUG_PRINT) {
-        printf("Data: %.*s (%d)\n", length, source, length);
+        printf("Data: %.*s (%d)\n", length, src, length);
         printf(" Set: %.*s\n", length, set);
         printf("FSet: %.*s\n", length, fset);
     }
@@ -668,14 +727,14 @@
 
         switch (set[read]) { /* Encode data characters */
             case 'a':
-            case 'A': c128_set_a(source[read], values, &bar_characters);
+            case 'A': c128_set_a(src[read], values, &bar_characters);
                 read++;
                 break;
             case 'b':
-            case 'B': (void) c128_set_b(source[read], values, &bar_characters);
+            case 'B': (void) c128_set_b(src[read], values, &bar_characters);
                 read++;
                 break;
-            case 'C': c128_set_c(source[read], source[read + 1], values, &bar_characters);
+            case 'C': c128_set_c(src[read], src[read + 1], values, &bar_characters);
                 read += 2;
                 break;
         }
@@ -720,7 +779,7 @@
 
     /* ISO/IEC 15417:2007 leaves dimensions/height as application specification */
 
-    c128_hrt_cpy_iso8859_1(symbol, source, length);
+    c128_hrt_cpy_iso8859_1(symbol, src, length);
 
     return error_number;
 }
@@ -782,7 +841,7 @@
         indexliste++;
     } while (indexchaine < reduced_length);
 
-    c128_dxsmooth(list, &indexliste);
+    c128_dxsmooth(list, &indexliste, NULL /*manual_set*/);
 
     /* Put set data into set[], resolving odd C blocks */
     c128_put_in_set(list, indexliste, set, reduced);
diff -urN zint-2.12.0/backend/code128.h zint/backend/code128.h
--- zint-2.12.0/backend/code128.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/code128.h	2023-05-08 14:39:44.841319229 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -38,24 +38,23 @@
 
 #define C128_MAX 160
 
-#define C128_SHIFTA 90
-#define C128_LATCHA 91
-#define C128_SHIFTB 92
-#define C128_LATCHB 93
-#define C128_SHIFTC 94
-#define C128_LATCHC 95
-#define C128_AORB   96
-#define C128_ABORC  97
+#define C128_LATCHA 'A'
+#define C128_LATCHB 'B'
+#define C128_LATCHC 'C'
+#define C128_SHIFTA 'a'
+#define C128_SHIFTB 'b'
+#define C128_ABORC  '9'
+#define C128_AORB   'Z'
 
 INTERNAL int code128(struct zint_symbol *symbol, unsigned char source[], int length);
 
 INTERNAL int c128_parunmodd(const unsigned char llyth);
-INTERNAL void c128_dxsmooth(int list[2][C128_MAX], int *indexliste);
+INTERNAL void c128_dxsmooth(int list[2][C128_MAX], int *indexliste, const char *manual_set);
 INTERNAL void c128_set_a(const unsigned char source, int values[], int *bar_chars);
 INTERNAL int c128_set_b(const unsigned char source, int values[], int *bar_chars);
 INTERNAL void c128_set_c(const unsigned char source_a, const unsigned char source_b, int values[], int *bar_chars);
 INTERNAL void c128_put_in_set(int list[2][C128_MAX], const int indexliste, char set[C128_MAX],
-                unsigned char *source);
+                const unsigned char *source);
 
 INTERNAL_DATA_EXTERN const char C128Table[107][6];
 
diff -urN zint-2.12.0/backend/code16k.c zint/backend/code16k.c
--- zint-2.12.0/backend/code16k.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/code16k.c	2023-05-08 14:39:44.841319229 +0200
@@ -1,7 +1,7 @@
 /* code16k.c - Handles Code 16k stacked symbology */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -108,7 +108,7 @@
         indexliste++;
     } while (indexchaine < length);
 
-    c128_dxsmooth(list, &indexliste);
+    c128_dxsmooth(list, &indexliste, NULL /*manual_set*/);
 
     /* Put set data into set[], resolving odd C blocks */
     c128_put_in_set(list, indexliste, set, source);
diff -urN zint-2.12.0/backend/code.c zint/backend/code.c
--- zint-2.12.0/backend/code.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/code.c	2023-05-08 14:39:44.839319217 +0200
@@ -1,7 +1,7 @@
 /* code.c - Handles Code 11, 39, 39+, 93, PZN, Channel and VIN */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -296,6 +296,7 @@
 
         localstr[0] = check_digit;
         localstr[1] = '\0';
+        if (symbol->debug & ZINT_DEBUG_PRINT) printf("Check digit: %c\n", check_digit);
     }
 
     /* Stop character */
diff -urN zint-2.12.0/backend/emf.c zint/backend/emf.c
--- zint-2.12.0/backend/emf.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/emf.c	2023-05-08 14:39:44.847319264 +0200
@@ -1,7 +1,7 @@
 /*  emf.c - Support for Microsoft Enhanced Metafile Format */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2016-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2016-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -168,7 +168,7 @@
 INTERNAL int emf_plot(struct zint_symbol *symbol, int rotate_angle) {
     int i;
     FILE *emf_file;
-    int fgred, fggrn, fgblu, bgred, bggrn, bgblu;
+    unsigned char fgred, fggrn, fgblu, bgred, bggrn, bgblu, bgalpha;
     int error_number = 0;
     int rectangle_count, this_rectangle;
     int circle_count, this_circle;
@@ -248,17 +248,10 @@
         return ZINT_ERROR_INVALID_DATA;
     }
 
-    fgred = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fggrn = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fgblu = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    bgred = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bggrn = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bgblu = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
-
-    if (strlen(symbol->bgcolour) > 6) {
-        if ((ctoi(symbol->bgcolour[6]) == 0) && (ctoi(symbol->bgcolour[7]) == 0)) {
-            draw_background = 0;
-        }
+    (void) out_colour_get_rgb(symbol->fgcolour, &fgred, &fggrn, &fgblu, NULL /*alpha*/);
+    (void) out_colour_get_rgb(symbol->bgcolour, &bgred, &bggrn, &bgblu, &bgalpha);
+    if (bgalpha == 0) {
+        draw_background = 0;
     }
 
     rectangle_count = count_rectangles(symbol);
@@ -560,8 +553,7 @@
 
     /* Create font records, alignment records and text color */
     if (symbol->vector->strings) {
-        bold = (symbol->output_options & BOLD_TEXT) &&
-                (!is_extendable(symbol->symbology) || (symbol->output_options & SMALL_TEXT));
+        bold = (symbol->output_options & BOLD_TEXT) && !is_extendable(symbol->symbology);
         memset(&emr_extcreatefontindirectw, 0, sizeof(emr_extcreatefontindirectw));
         emr_extcreatefontindirectw.type = 0x00000052; /* EMR_EXTCREATEFONTINDIRECTW */
         emr_extcreatefontindirectw.size = 104;
@@ -832,10 +824,24 @@
 
     fwrite(&emr_eof, sizeof(emr_eof_t), 1, emf_file);
 
+    if (ferror(emf_file)) {
+        sprintf(symbol->errtxt, "644: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(emf_file);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(emf_file);
+        if (fflush(emf_file) != 0) {
+            sprintf(symbol->errtxt, "940: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(emf_file);
+        if (fclose(emf_file) != 0) {
+            sprintf(symbol->errtxt, "941: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
     return error_number;
 }
diff -urN zint-2.12.0/backend/gif.c zint/backend/gif.c
--- zint-2.12.0/backend/gif.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/gif.c	2023-05-08 14:39:44.852319294 +0200
@@ -1,7 +1,7 @@
 /* gif.c - Handles output to gif file */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -44,7 +44,7 @@
 
 typedef struct s_statestruct {
     unsigned char *pOut;
-    unsigned char *pIn;
+    const unsigned char *pIn;
     unsigned int InLen;
     unsigned int OutLength;
     unsigned int OutPosCur;
@@ -297,6 +297,10 @@
     unsigned char backgroundColourIndex;
     unsigned char RGBCur[3];
     unsigned char RGBUnused[3] = {0,0,0};
+    unsigned char RGBfg[3];
+    unsigned char RGBbg[3];
+    unsigned char fgalpha;
+    unsigned char bgalpha;
 
     int colourIndex;
 
@@ -311,6 +315,9 @@
         lzoutbufSize = GIF_LZW_PAGE_SIZE;
     }
 
+    (void) out_colour_get_rgb(symbol->fgcolour, &RGBfg[0], &RGBfg[1], &RGBfg[2], &fgalpha);
+    (void) out_colour_get_rgb(symbol->bgcolour, &RGBbg[0], &RGBbg[1], &RGBbg[2], &bgalpha);
+
     /*
      * Build a table of the used palette items.
      * Currently, there are the following 10 colour codes:
@@ -364,14 +371,10 @@
         /* Get RGB value */
         switch (pixelColour) {
             case '0': /* standard background */
-                RGBCur[0] = (unsigned char) (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-                RGBCur[1] = (unsigned char) (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-                RGBCur[2] = (unsigned char) (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
+                RGBCur[0] = RGBbg[0]; RGBCur[1] = RGBbg[1]; RGBCur[2] = RGBbg[2];
                 break;
             case '1': /* standard foreground */
-                RGBCur[0] = (unsigned char) (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-                RGBCur[1] = (unsigned char) (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-                RGBCur[2] = (unsigned char) (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
+                RGBCur[0] = RGBfg[0]; RGBCur[1] = RGBfg[1]; RGBCur[2] = RGBfg[2];
                 break;
             case 'W': /* white */
                 RGBCur[0] = 255; RGBCur[1] = 255; RGBCur[2] = 255;
@@ -436,17 +439,12 @@
     /* Note: does not allow both transparent foreground and background -
      * background takes priority */
     transparent_index = -1;
-    if (strlen(symbol->fgcolour) > 6) {
-        if ((symbol->fgcolour[6] == '0') && (symbol->fgcolour[7] == '0')) {
-            /* Transparent foreground */
-            transparent_index = fgindex;
-        }
-    }
-    if (strlen(symbol->bgcolour) > 6) {
-        if ((symbol->bgcolour[6] == '0') && (symbol->bgcolour[7] == '0')) {
-            /* Transparent background */
-            transparent_index = bgindex;
-        }
+    if (bgalpha == 0) {
+        /* Transparent background */
+        transparent_index = bgindex;
+    } else if (fgalpha == 0) {
+        /* Transparent foreground */
+        transparent_index = fgindex;
     }
 
     /* find palette bit size from palette size*/
@@ -584,7 +582,7 @@
     State.InLen = bitmapSize;
     if (!(State.pOut = (unsigned char *) malloc(lzoutbufSize))) {
         if (!output_to_stdout) {
-            fclose(gif_file);
+            (void) fclose(gif_file);
         }
         strcpy(symbol->errtxt, "614: Insufficient memory for LZW buffer");
         return ZINT_ERROR_MEMORY;
@@ -596,7 +594,7 @@
     if (byte_out <= 0) {
         free(State.pOut);
         if (!output_to_stdout) {
-            fclose(gif_file);
+            (void) fclose(gif_file);
         }
         strcpy(symbol->errtxt, "613: Insufficient memory for LZW buffer");
         return ZINT_ERROR_MEMORY;
@@ -606,10 +604,25 @@
 
     /* GIF terminator */
     fputc('\x3b', gif_file);
+
+    if (ferror(gif_file)) {
+        sprintf(symbol->errtxt, "615: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(gif_file);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(gif_file);
+        if (fflush(gif_file) != 0) {
+            sprintf(symbol->errtxt, "616: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(gif_file);
+        if (fclose(gif_file) != 0) {
+            sprintf(symbol->errtxt, "617: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     return 0;
diff -urN zint-2.12.0/backend/gs1.c zint/backend/gs1.c
--- zint-2.12.0/backend/gs1.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/gs1.c	2023-05-08 14:39:44.853319300 +0200
@@ -1,7 +1,7 @@
 /* gs1.c - Verifies GS1 data */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -846,7 +846,11 @@
     if ((vli < vli_min || vli > vli_max) && (vli != 9 || !vli_nine)) {
         *p_err_no = 3;
         *p_err_posn = d - data + 1;
-        sprintf(err_msg, vli < 0 ? "Non-numeric %s VLI '%c'" : "Invalid %s VLI '%c'", name, *d);
+        if (vli < 0) {
+            sprintf(err_msg, "Non-numeric %s VLI '%c'", name, *d);
+        } else {
+            sprintf(err_msg, "Invalid %s VLI '%c'", name, *d);
+        }
         return NULL;
     }
     d++;
@@ -1101,8 +1105,11 @@
 
                 *p_err_no = 3;
                 *p_err_posn = d - 1 - data + 1;
-                sprintf(err_msg, data_field < 0 ? "Non-numeric Data Field '%c'" : "Invalid Data Field '%c'",
-                    *(d - 1));
+                if (data_field < 0) {
+                    sprintf(err_msg, "Non-numeric Data Field '%c'", *(d - 1));
+                } else {
+                    sprintf(err_msg, "Invalid Data Field '%c'", *(d - 1));
+                }
                 return 0;
             }
         }
diff -urN zint-2.12.0/backend/library.c zint/backend/library.c
--- zint-2.12.0/backend/library.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/library.c	2023-05-08 14:39:44.858319329 +0200
@@ -1,7 +1,7 @@
 /*  library.c - external functions of libzint */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -216,9 +216,7 @@
 static int error_tag(struct zint_symbol *symbol, int error_number, const char *error_string) {
 
     if (error_number != 0) {
-        static const char error_fmt[] = "Error %.93s"; /* Truncate if too long */
-        static const char warn_fmt[] = "Warning %.91s"; /* Truncate if too long */
-        const char *fmt = error_number >= ZINT_ERROR ? error_fmt : warn_fmt;
+        const char *const error_arg = error_string ? error_string : symbol->errtxt;
         char error_buffer[100];
 
         if (error_number < ZINT_ERROR && symbol->warn_level == WARN_FAIL_ALL) {
@@ -230,9 +228,12 @@
             } else { /* ZINT_WARN_INVALID_OPTION */
                 error_number = ZINT_ERROR_INVALID_OPTION;
             }
-            fmt = error_fmt;
         }
-        sprintf(error_buffer, fmt, error_string ? error_string : symbol->errtxt);
+        if (error_number >= ZINT_ERROR) {
+            sprintf(error_buffer, "Error %.93s", error_arg); /* Truncate if too long */
+        } else {
+            sprintf(error_buffer, "Warning %.91s", error_arg); /* Truncate if too long */
+        }
         strcpy(symbol->errtxt, error_buffer);
     }
 
@@ -249,11 +250,11 @@
 static int dump_plot(struct zint_symbol *symbol) {
     FILE *f;
     int i, r;
-    char hex[] = {'0', '1', '2', '3', '4', '5', '6', '7', '8',
-        '9', 'A', 'B', 'C', 'D', 'E', 'F'};
+    static const char hex[] = {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};
     int space = 0;
+    const int output_to_stdout = symbol->output_options & BARCODE_STDOUT;
 
-    if (symbol->output_options & BARCODE_STDOUT) {
+    if (output_to_stdout) {
         f = stdout;
     } else {
         f = fopen(symbol->outfile, "w");
@@ -295,10 +296,24 @@
         space = 0;
     }
 
-    if (symbol->output_options & BARCODE_STDOUT) {
-        fflush(f);
+    if (ferror(f)) {
+        sprintf(symbol->errtxt, "795: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(f);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
+    if (output_to_stdout) {
+        if (fflush(f) != 0) {
+            sprintf(symbol->errtxt, "796: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(f);
+        if (fclose(f) != 0) {
+            sprintf(symbol->errtxt, "792: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     return 0;
@@ -478,6 +493,7 @@
         case BARCODE_FIM:
         case BARCODE_PHARMA:
         case BARCODE_PHARMA_TWO:
+        case BARCODE_CEPNET:
         case BARCODE_PDF417:
         case BARCODE_PDF417COMP:
         case BARCODE_AUSPOST:
@@ -695,6 +711,7 @@
     int i;
     unsigned long unicode;
     unsigned char *escaped_string = (unsigned char *) z_alloca(length + 1);
+    const int extra_escape_mode = (symbol->input_mode & EXTRA_ESCAPE_MODE) && symbol->symbology == BARCODE_CODE128;
 
     in_posn = 0;
     out_posn = 0;
@@ -711,6 +728,19 @@
                 case '0': escaped_string[out_posn] = 0x00; /* Null */
                     in_posn += 2;
                     break;
+                case '^': /* CODE128 specific */
+                    if (!extra_escape_mode) {
+                        strcpy(symbol->errtxt, "798: Escape '\\^' only valid for Code 128 in extra escape mode");
+                        return ZINT_ERROR_INVALID_DATA;
+                    }
+                    /* Pass thru unaltered */
+                    escaped_string[out_posn++] = '\\';
+                    escaped_string[out_posn] = '^';
+                    in_posn += 2;
+                    if (in_posn < length) { /* Note allowing '\\^' on its own at end */
+                        escaped_string[++out_posn] = input_string[in_posn++];
+                    }
+                    break;
                 case 'E': escaped_string[out_posn] = 0x04; /* End of Transmission */
                     in_posn += 2;
                     break;
@@ -745,7 +775,7 @@
                     in_posn += 2;
                     break;
                 case 'd':
-                case 'o': /* Undocumented (as not very useful for most people) */
+                case 'o':
                 case 'x':
                     if ((val = esc_base(symbol, input_string, length, in_posn + 2, ch)) == -1) {
                         return ZINT_ERROR_INVALID_DATA;
@@ -845,7 +875,6 @@
     unsigned char *local_source;
     struct zint_seg *local_segs;
     unsigned char *local_sources;
-    local_segs = (struct zint_seg *) z_alloca(sizeof(struct zint_seg) * (seg_count > 0 ? seg_count : 1));
 
     if (!symbol) return ZINT_ERROR_INVALID_DATA;
 
@@ -856,6 +885,7 @@
     if (seg_count > ZINT_MAX_SEG_COUNT) {
         return error_tag(symbol, ZINT_ERROR_INVALID_DATA, "771: Too many input segments (max 256)");
     }
+    local_segs = (struct zint_seg *) z_alloca(sizeof(struct zint_seg) * (seg_count > 0 ? seg_count : 1));
 
     if ((symbol->input_mode & 0x07) > 2) {
         symbol->input_mode = DATA_MODE; /* Reset completely TODO: in future, warn/error */
@@ -1067,6 +1097,9 @@
     if ((symbol->guard_descent < 0.0f) || (symbol->guard_descent > 50.0f)) {
         return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "769: Guard bar descent out of range (0 to 50)");
     }
+    if ((symbol->text_gap < 0.0f) || (symbol->text_gap > 5.0f)) {
+        return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "219: Text gap out of range (0 to 5)");
+    }
     if ((symbol->whitespace_width < 0) || (symbol->whitespace_width > 100)) {
         return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "766: Whitespace width out of range (0 to 100)");
     }
@@ -1080,6 +1113,9 @@
     if (symbol->rows >= 200) { /* Check for stacking too many symbols */
         return error_tag(symbol, ZINT_ERROR_TOO_LONG, "770: Too many stacked symbols");
     }
+    if (symbol->rows < 0) { /* Silently defend against out-of-bounds access */
+        symbol->rows = 0;
+    }
 
     if ((symbol->input_mode & 0x07) == GS1_MODE && !gs1_compliant(symbol->symbology)) {
         return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "220: Selected symbology does not support GS1 mode");
@@ -1153,7 +1189,7 @@
                 local_segs[0].length = (int) ustrlen(reduced);
             }
         } else {
-            return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "220: Selected symbology does not support GS1 mode");
+            return error_tag(symbol, ZINT_ERROR_INVALID_OPTION, "210: Selected symbology does not support GS1 mode");
         }
     }
 
@@ -1413,7 +1449,7 @@
         return error_tag(symbol, ZINT_ERROR_INVALID_DATA, "239: Filename NULL");
     }
 
-    if (!strcmp(filename, "-")) {
+    if (strcmp(filename, "-") == 0) {
         file = stdin;
         fileLen = ZINT_MAX_DATA_LEN;
     } else {
@@ -1425,26 +1461,36 @@
         file_opened = 1;
 
         /* Get file length */
-        fseek(file, 0, SEEK_END);
+        if (fseek(file, 0, SEEK_END) != 0) {
+            sprintf(symbol->errtxt, "797: Unable to seek input file (%d: %.30s)", errno, strerror(errno));
+            (void) fclose(file);
+            return error_tag(symbol, ZINT_ERROR_INVALID_DATA, NULL);
+        }
+
         fileLen = ftell(file);
-        fseek(file, 0, SEEK_SET);
 
         /* On many Linux distros ftell() returns LONG_MAX not -1 on error */
         if (fileLen <= 0 || fileLen == LONG_MAX) {
-            fclose(file);
+            (void) fclose(file);
             return error_tag(symbol, ZINT_ERROR_INVALID_DATA, "235: Input file empty or unseekable");
         }
         if (fileLen > ZINT_MAX_DATA_LEN) {
-            fclose(file);
+            (void) fclose(file);
             return error_tag(symbol, ZINT_ERROR_TOO_LONG, "230: Input file too long");
         }
+
+        if (fseek(file, 0, SEEK_SET) != 0) {
+            sprintf(symbol->errtxt, "793: Unable to seek input file (%d: %.30s)", errno, strerror(errno));
+            (void) fclose(file);
+            return error_tag(symbol, ZINT_ERROR_INVALID_DATA, NULL);
+        }
     }
 
     /* Allocate memory */
     buffer = (unsigned char *) malloc(fileLen);
     if (!buffer) {
         if (file_opened) {
-            fclose(file);
+            (void) fclose(file);
         }
         return error_tag(symbol, ZINT_ERROR_MEMORY, "231: Insufficient memory for file read buffer");
     }
@@ -1455,17 +1501,21 @@
         n = fread(buffer + nRead, 1, fileLen - nRead, file);
         if (ferror(file)) {
             sprintf(symbol->errtxt, "241: Input file read error (%d: %.30s)", errno, strerror(errno));
+            free(buffer);
             if (file_opened) {
-                fclose(file);
+                (void) fclose(file);
             }
-            free(buffer);
             return error_tag(symbol, ZINT_ERROR_INVALID_DATA, NULL);
         }
         nRead += n;
     } while (!feof(file) && (0 < n) && ((long) nRead < fileLen));
 
     if (file_opened) {
-        fclose(file);
+        if (fclose(file) != 0) {
+            sprintf(symbol->errtxt, "794: Failure on closing input file (%d: %.30s)", errno, strerror(errno));
+            free(buffer);
+            return error_tag(symbol, ZINT_ERROR_INVALID_DATA, NULL);
+        }
     }
     ret = ZBarcode_Encode(symbol, buffer, (int) nRead);
     free(buffer);
diff -urN zint-2.12.0/backend/libzint.rc zint/backend/libzint.rc
--- zint-2.12.0/backend/libzint.rc	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/libzint.rc	2023-05-08 14:39:44.858319329 +0200
@@ -2,8 +2,8 @@
 #include <windows.h>
 #include <winver.h>
 
-#define VER_FILEVERSION        2,12,0,0
-#define VER_FILEVERSION_STR    "2.12.0.0\0"
+#define VER_FILEVERSION        2,12,0,9
+#define VER_FILEVERSION_STR    "2.12.0.9\0"
 
 #ifdef GCC_WINDRES
 VS_VERSION_INFO		VERSIONINFO
@@ -30,7 +30,7 @@
       VALUE "FileDescription",	"libzint barcode library\0"
       VALUE "FileVersion",	VER_FILEVERSION_STR
       VALUE "InternalName",	"zint.dll\0"
-      VALUE "LegalCopyright",	"Copyright © 2022 Robin Stuart & BogDan Vatra\0"
+      VALUE "LegalCopyright",	"Copyright © 2023 Robin Stuart & BogDan Vatra\0"
       VALUE "OriginalFilename",	"zint.dll\0"
       VALUE "ProductName",	"libzint\0"
       VALUE "ProductVersion",	VER_FILEVERSION_STR
diff -urN zint-2.12.0/backend/mailmark.c zint/backend/mailmark.c
--- zint-2.12.0/backend/mailmark.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/mailmark.c	2023-05-08 14:39:44.859319335 +0200
@@ -597,7 +597,8 @@
     }
 
     if (!is_sane(RUBIDIUM_F, local_source, 45)) {
-        strcpy(symbol->errtxt, "866: Invalid character in data (alphanumerics and space only in first 45 characters)");
+        strcpy(symbol->errtxt,
+                "866: Invalid character in data (alphanumerics and space only in first 45 characters)");
         return ZINT_ERROR_INVALID_DATA;
     }
 
diff -urN zint-2.12.0/backend/Makefile.mingw zint/backend/Makefile.mingw
--- zint-2.12.0/backend/Makefile.mingw	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/Makefile.mingw	2023-05-08 14:39:44.834319188 +0200
@@ -6,7 +6,7 @@
 # make clean		cleans up a previous compilation and any object or editor files
 #
 
-ZINT_VERSION:=-DZINT_VERSION=\"2.12.0\"
+ZINT_VERSION:=-DZINT_VERSION=\"2.12.0.9\"
 
 
 CC:= gcc
diff -urN zint-2.12.0/backend/output.c zint/backend/output.c
--- zint-2.12.0/backend/output.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/output.c	2023-05-08 14:39:44.860319341 +0200
@@ -1,7 +1,7 @@
 /*  output.c - Common routines for raster/vector
 
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -41,40 +41,154 @@
 #endif
 #include "common.h"
 #include "output.h"
-#include "font.h"
 
-#define SSET_F  (IS_NUM_F | IS_UHX_F) /* SSET "0123456789ABCDEF" */
+#define OUT_SSET_F  (IS_NUM_F | IS_UHX_F | IS_LHX_F) /* SSET "0123456789ABCDEFabcdef" */
 
-/* Check colour options are good. Note: using raster.c error nos 651-654 */
-INTERNAL int out_check_colour_options(struct zint_symbol *symbol) {
-    int fg_len = (int) strlen(symbol->fgcolour);
-    int bg_len = (int) strlen(symbol->bgcolour);
+/* Helper to check an individual colour option is good */
+static int out_check_colour(struct zint_symbol *symbol, const char *colour, const char *name) {
+    const char *comma1, *comma2, *comma3;
+    int val;
+
+    if ((comma1 = strchr(colour, ',')) == NULL) {
+        const int len = (int) strlen(colour);
+        if ((len != 6) && (len != 8)) {
+            sprintf(symbol->errtxt, "880: Malformed %s RGB colour (6 or 8 characters only)", name);
+            return ZINT_ERROR_INVALID_OPTION;
+        }
+        if (!is_sane(OUT_SSET_F, (unsigned char *) colour, len)) {
+            sprintf(symbol->errtxt, "881: Malformed %s RGB colour '%s' (hexadecimal only)", name, colour);
+            return ZINT_ERROR_INVALID_OPTION;
+        }
+
+        return 0;
+    }
 
-    if ((fg_len != 6) && (fg_len != 8)) {
-        strcpy(symbol->errtxt, "651: Malformed foreground colour (6 or 8 characters only)");
+    /* CMYK comma-separated percentages */
+    if ((comma2 = strchr(comma1 + 1, ',')) == NULL || (comma3 = strchr(comma2 + 1, ',')) == NULL
+            || strchr(comma3 + 1, ',') != NULL) {
+        sprintf(symbol->errtxt, "882: Malformed %s CMYK colour (4 decimal numbers, comma-separated)", name);
         return ZINT_ERROR_INVALID_OPTION;
     }
-    if ((bg_len != 6) && (bg_len != 8)) {
-        strcpy(symbol->errtxt, "652: Malformed background colour (6 or 8 characters only)");
+    if (comma1 - colour > 3 || comma2 - (comma1 + 1) > 3 || comma3 - (comma2 + 1) > 3 || strlen(comma3 + 1) > 3) {
+        sprintf(symbol->errtxt, "883: Malformed %s CMYK colour (3 digit maximum per number)", name);
         return ZINT_ERROR_INVALID_OPTION;
     }
 
-    to_upper((unsigned char *) symbol->fgcolour, fg_len);
-    to_upper((unsigned char *) symbol->bgcolour, bg_len);
-
-    if (!is_sane(SSET_F, (unsigned char *) symbol->fgcolour, fg_len)) {
-        sprintf(symbol->errtxt, "653: Malformed foreground colour '%s' (hexadecimal only)", symbol->fgcolour);
+    if ((val = to_int((const unsigned char *) colour, (int) (comma1 - colour))) == -1 || val > 100) {
+        sprintf(symbol->errtxt, "884: Malformed %s CMYK colour C (decimal 0-100 only)", name);
+        return ZINT_ERROR_INVALID_OPTION;
+    }
+    if ((val = to_int((const unsigned char *) (comma1 + 1), (int) (comma2 - (comma1 + 1)))) == -1 || val > 100) {
+        sprintf(symbol->errtxt, "885: Malformed %s CMYK colour M (decimal 0-100 only)", name);
+        return ZINT_ERROR_INVALID_OPTION;
+    }
+    if ((val = to_int((const unsigned char *) (comma2 + 1), (int) (comma3 - (comma2 + 1)))) == -1 || val > 100) {
+        sprintf(symbol->errtxt, "886: Malformed %s CMYK colour Y (decimal 0-100 only)", name);
+        return ZINT_ERROR_INVALID_OPTION;
+    }
+    if ((val = to_int((const unsigned char *) (comma3 + 1), (int) strlen(comma3 + 1))) == -1 || val > 100) {
+        sprintf(symbol->errtxt, "887: Malformed %s CMYK colour K (decimal 0-100 only)", name);
         return ZINT_ERROR_INVALID_OPTION;
     }
 
-    if (!is_sane(SSET_F, (unsigned char *) symbol->bgcolour, bg_len)) {
-        sprintf(symbol->errtxt, "654: Malformed background colour '%s' (hexadecimal only)", symbol->bgcolour);
+    return 0;
+}
+
+/* Check colour options are good (`symbol->fgcolour`, `symbol->bgcolour`) */
+INTERNAL int out_check_colour_options(struct zint_symbol *symbol) {
+
+    if (out_check_colour(symbol, symbol->fgcolour, "foreground") != 0) {
+        return ZINT_ERROR_INVALID_OPTION;
+    }
+    if (out_check_colour(symbol, symbol->bgcolour, "background") != 0) {
         return ZINT_ERROR_INVALID_OPTION;
     }
 
     return 0;
 }
 
+/* Return RGB(A) from (well-formed) colour string. Returns 0 if RGB or converted CMYK, 1 if RGBA */
+INTERNAL int out_colour_get_rgb(const char *colour, unsigned char *red, unsigned char *green, unsigned char *blue,
+                unsigned char *alpha) {
+    const char *comma1, *comma2, *comma3;
+    int black, val;
+
+    if ((comma1 = strchr(colour, ',')) == NULL) {
+        *red = 16 * ctoi(colour[0]) + ctoi(colour[1]);
+        *green = 16 * ctoi(colour[2]) + ctoi(colour[3]);
+        *blue = 16 * ctoi(colour[4]) + ctoi(colour[5]);
+        if (alpha) {
+            *alpha = colour[6] ? 16 * ctoi(colour[6]) + ctoi(colour[7]) : 0xFF;
+            return colour[6] ? 1 : 0;
+        }
+        return 0;
+    }
+    comma2 = strchr(comma1 + 1, ',');
+    comma3 = strchr(comma2 + 1, ',');
+
+    black = 100 - to_int((const unsigned char *) (comma3 + 1), (int) strlen(comma3 + 1));
+
+    val = 100 - to_int((const unsigned char *) colour, (int) (comma1 - colour)); /* Cyan */
+    *red = (int) roundf((0xFF * val * black) / 10000.0f);
+
+    val = 100 - to_int((const unsigned char *) (comma1 + 1), (int) (comma2 - (comma1 + 1))); /* Magenta */
+    *green = (int) roundf((0xFF * val * black) / 10000.0f);
+
+    val = 100 - to_int((const unsigned char *) (comma2 + 1), (int) (comma3 - (comma2 + 1))); /* Yellow */
+    *blue = (int) roundf((0xFF * val * black) / 10000.0f);
+
+    if (alpha) {
+        *alpha = 0xFF;
+    }
+
+    return 0;
+}
+
+/* Return CMYK from (well-formed) colour string. Returns 0 if CMYK, 1 if converted RBG, 2 if converted RGBA */
+INTERNAL int out_colour_get_cmyk(const char *colour, int *cyan, int *magenta, int *yellow, int *black,
+                unsigned char *rgb_alpha) {
+    const char *comma1;
+    unsigned char red, green, blue, alpha;
+    int have_alpha, k;
+
+    if ((comma1 = strchr(colour, ',')) != NULL) {
+        const char *const comma2 = strchr(comma1 + 1, ',');
+        const char *const comma3 = strchr(comma2 + 1, ',');
+        *cyan = to_int((const unsigned char *) colour, (int) (comma1 - colour));
+        *magenta = to_int((const unsigned char *) (comma1 + 1), (int) (comma2 - (comma1 + 1)));
+        *yellow = to_int((const unsigned char *) (comma2 + 1), (int) (comma3 - (comma2 + 1)));
+        *black = to_int((const unsigned char *) (comma3 + 1), (int) strlen(comma3 + 1));
+        if (rgb_alpha) {
+            *rgb_alpha = 0xFF;
+        }
+        return 0;
+    }
+    have_alpha = out_colour_get_rgb(colour, &red, &green, &blue, &alpha);
+
+    k = red;
+    if (green > k) {
+        k = green;
+    }
+    if (blue > k) {
+        k = blue;
+    }
+    if (k == 0) {
+        *cyan = *magenta = *yellow = 0;
+        *black = 100;
+    } else {
+        *cyan = (int) roundf((k - red) * 100.0f / k);
+        *magenta = (int) roundf((k - green) * 100.0f / k);
+        *yellow = (int) roundf((k - blue) * 100.0f / k);
+        *black = (int) roundf(((0xFF - k) * 100.0f) / 0xFF);
+    }
+
+    if (rgb_alpha) {
+        *rgb_alpha = have_alpha ? alpha : 0xFF;
+    }
+
+    return 1 + have_alpha;
+}
+
 /* Return minimum quiet zones for each symbology */
 static int out_quiet_zones(const struct zint_symbol *symbol, const int hide_text,
                             float *left, float *right, float *top, float *bottom) {
@@ -626,7 +740,8 @@
 /* Calculate large bar height i.e. linear bars with zero row height that respond to the symbol height.
    If scaler `si` non-zero (raster), then large_bar_height if non-zero or else row heights will be rounded
    to nearest pixel and symbol height adjusted */
-INTERNAL float out_large_bar_height(struct zint_symbol *symbol, int si, int *row_heights_si, int *symbol_height_si) {
+INTERNAL float out_large_bar_height(struct zint_symbol *symbol, const int si, int *row_heights_si,
+                int *symbol_height_si) {
     float fixed_height = 0.0f;
     int zero_count = 0;
     int round_rows = 0;
@@ -697,72 +812,69 @@
 }
 
 /* Split UPC/EAN add-on text into various constituents */
-INTERNAL void out_upcean_split_text(int upceanflag, unsigned char text[],
-                unsigned char textpart1[5], unsigned char textpart2[7], unsigned char textpart3[7],
-                unsigned char textpart4[2]) {
+INTERNAL void out_upcean_split_text(const int upceanflag, const unsigned char text[], unsigned char textparts[4][7]) {
     int i;
 
     if (upceanflag == 6) { /* UPC-E */
-        textpart1[0] = text[0];
-        textpart1[1] = '\0';
+        textparts[0][0] = text[0];
+        textparts[0][1] = '\0';
 
         for (i = 0; i < 6; i++) {
-            textpart2[i] = text[i + 1];
+            textparts[1][i] = text[i + 1];
         }
-        textpart2[6] = '\0';
+        textparts[1][6] = '\0';
 
-        textpart3[0] = text[7];
-        textpart3[1] = '\0';
+        textparts[2][0] = text[7];
+        textparts[2][1] = '\0';
 
     } else if (upceanflag == 8) { /* EAN-8 */
         for (i = 0; i < 4; i++) {
-            textpart1[i] = text[i];
+            textparts[0][i] = text[i];
         }
-        textpart1[4] = '\0';
+        textparts[0][4] = '\0';
 
         for (i = 0; i < 4; i++) {
-            textpart2[i] = text[i + 4];
+            textparts[1][i] = text[i + 4];
         }
-        textpart2[4] = '\0';
+        textparts[1][4] = '\0';
 
     } else if (upceanflag == 12) { /* UPC-A */
-        textpart1[0] = text[0];
-        textpart1[1] = '\0';
+        textparts[0][0] = text[0];
+        textparts[0][1] = '\0';
 
         for (i = 0; i < 5; i++) {
-            textpart2[i] = text[i + 1];
+            textparts[1][i] = text[i + 1];
         }
-        textpart2[5] = '\0';
+        textparts[1][5] = '\0';
 
         for (i = 0; i < 5; i++) {
-            textpart3[i] = text[i + 6];
+            textparts[2][i] = text[i + 6];
         }
-        textpart3[5] = '\0';
+        textparts[2][5] = '\0';
 
-        textpart4[0] = text[11];
-        textpart4[1] = '\0';
+        textparts[3][0] = text[11];
+        textparts[3][1] = '\0';
 
     } else if (upceanflag == 13) { /* EAN-13 */
-        textpart1[0] = text[0];
-        textpart1[1] = '\0';
+        textparts[0][0] = text[0];
+        textparts[0][1] = '\0';
 
         for (i = 0; i < 6; i++) {
-            textpart2[i] = text[i + 1];
+            textparts[1][i] = text[i + 1];
         }
-        textpart2[6] = '\0';
+        textparts[1][6] = '\0';
 
         for (i = 0; i < 6; i++) {
-            textpart3[i] = text[i + 7];
+            textparts[2][i] = text[i + 7];
         }
-        textpart3[6] = '\0';
+        textparts[2][6] = '\0';
     }
 }
 
 /* Make a directory; already existing dir okay */
 /* Adapted from https://gist.github.com/JonathonReinhart/8c0d90191c38af2dcadb102c4e202950 and
    https://nachtimwald.com/2019/07/10/recursive-create-directory-in-c-revisited/ */
-static int out_maybe_mkdir(const char* path)
-{
+static int out_maybe_mkdir(const char* path) {
 #ifdef _WIN32
     DWORD dwAttrib;
 
diff -urN zint-2.12.0/backend/output.h zint/backend/output.h
--- zint-2.12.0/backend/output.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/output.h	2023-05-08 14:39:44.860319341 +0200
@@ -1,7 +1,7 @@
 /*  output.h - Common routines for raster/vector */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -39,16 +39,36 @@
 
 #include <stdio.h> /* For FILE */
 
+/* Check colour options are good (`symbol->fgcolour`, `symbol->bgcolour`) */
 INTERNAL int out_check_colour_options(struct zint_symbol *symbol);
+
+/* Return RGB(A) from (well-formed) colour string. Returns 0 if RGB or converted CMYK, 1 if RGBA */
+INTERNAL int out_colour_get_rgb(const char *colour, unsigned char *red, unsigned char *green, unsigned char *blue,
+                unsigned char *alpha);
+/* Return CMYK from (well-formed) colour string. Returns 0 if CMYK, 1 if converted RBG, 2 if converted RGBA */
+INTERNAL int out_colour_get_cmyk(const char *colour, int *cyan, int *magenta, int *yellow, int *black,
+                unsigned char *rgb_alpha);
+
+/* Set left (x), top (y), right and bottom offsets for whitespace */
 INTERNAL void out_set_whitespace_offsets(const struct zint_symbol *symbol, const int hide_text,
                 float *xoffset, float *yoffset, float *roffset, float *boffset, const float scaler,
                 int *xoffset_si, int *yoffset_si, int *roffset_si, int *boffset_si);
+
+/* Set composite offset and main width excluding addon (for start of addon calc) and addon text, returning
+   UPC/EAN type */
 INTERNAL int out_process_upcean(const struct zint_symbol *symbol, int *p_main_width, int *p_comp_xoffset,
                 unsigned char addon[6], int *p_addon_gap);
-INTERNAL float out_large_bar_height(struct zint_symbol *symbol, int si, int *row_heights_si, int *symbol_height_si);
-INTERNAL void out_upcean_split_text(int upceanflag, unsigned char text[],
-                unsigned char textpart1[5], unsigned char textpart2[7], unsigned char textpart3[7],
-                unsigned char textpart4[2]);
+
+/* Calculate large bar height i.e. linear bars with zero row height that respond to the symbol height.
+   If scaler `si` non-zero (raster), then large_bar_height if non-zero or else row heights will be rounded
+   to nearest pixel and symbol height adjusted */
+INTERNAL float out_large_bar_height(struct zint_symbol *symbol, const int si, int *row_heights_si,
+                int *symbol_height_si);
+
+/* Split UPC/EAN add-on text into various constituents */
+INTERNAL void out_upcean_split_text(const int upceanflag, const unsigned char text[], unsigned char textparts[4][7]);
+
+/* Create output file, creating sub-directories if necessary. Returns `fopen()` FILE pointer */
 INTERNAL FILE *out_fopen(const char filename[256], const char *mode);
 
 #ifdef __cplusplus
diff -urN zint-2.12.0/backend/pcx.c zint/backend/pcx.c
--- zint-2.12.0/backend/pcx.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/pcx.c	2023-05-08 14:39:44.860319341 +0200
@@ -1,7 +1,7 @@
 /* pcx.c - Handles output to ZSoft PCX file */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -42,8 +42,8 @@
 #include "pcx.h"        /* PCX header structure */
 
 /* ZSoft PCX File Format Technical Reference Manual http://bespin.org/~qz/pc-gpe/pcx.txt */
-INTERNAL int pcx_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf) {
-    int fgred, fggrn, fgblu, bgred, bggrn, bgblu;
+INTERNAL int pcx_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
+    unsigned char fgred, fggrn, fgblu, fgalpha, bgred, bggrn, bgblu, bgalpha;
     int row, column, i, colour;
     int run_count;
     FILE *pcx_file;
@@ -55,17 +55,13 @@
 
     rle_row[bytes_per_line - 1] = 0; /* Will remain zero if bitmap_width odd */
 
-    fgred = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fggrn = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fgblu = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    bgred = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bggrn = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bgblu = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
+    (void) out_colour_get_rgb(symbol->fgcolour, &fgred, &fggrn, &fgblu, &fgalpha);
+    (void) out_colour_get_rgb(symbol->bgcolour, &bgred, &bggrn, &bgblu, &bgalpha);
 
     header.manufacturer = 10; /* ZSoft */
     header.version = 5; /* Version 3.0 */
     header.encoding = 1; /* Run length encoding */
-    header.bits_per_pixel = 8;
+    header.bits_per_pixel = 8; /* TODO: 1-bit monochrome black/white */
     header.window_xmin = 0;
     header.window_ymin = 0;
     header.window_xmax = symbol->bitmap_width - 1;
@@ -78,7 +74,7 @@
     }
 
     header.reserved = 0;
-    header.number_of_planes = 3;
+    header.number_of_planes = 3 + (fgalpha != 0xFF || bgalpha != 0xFF); /* TODO: 1-bit monochrome black/white */
 
     header.bytes_per_line = bytes_per_line;
 
@@ -109,11 +105,13 @@
     fwrite(&header, sizeof(pcx_header_t), 1, pcx_file);
 
     for (row = 0; row < symbol->bitmap_height; row++) {
-        for (colour = 0; colour < 3; colour++) {
+        const unsigned char *const pb = pixelbuf + row * symbol->bitmap_width;
+        for (colour = 0; colour < header.number_of_planes; colour++) {
             for (column = 0; column < symbol->bitmap_width; column++) {
+                const unsigned char ch = pb[column];
                 switch (colour) {
                     case 0:
-                        switch (pixelbuf[(row * symbol->bitmap_width) + column]) {
+                        switch (ch) {
                             case 'W': /* White */
                             case 'M': /* Magenta */
                             case 'R': /* Red */
@@ -135,7 +133,7 @@
                         }
                         break;
                     case 1:
-                        switch (pixelbuf[(row * symbol->bitmap_width) + column]) {
+                        switch (ch) {
                             case 'W': /* White */
                             case 'C': /* Cyan */
                             case 'Y': /* Yellow */
@@ -157,7 +155,7 @@
                         }
                         break;
                     case 2:
-                        switch (pixelbuf[(row * symbol->bitmap_width) + column]) {
+                        switch (ch) {
                             case 'W': /* White */
                             case 'C': /* Cyan */
                             case 'B': /* Blue */
@@ -178,6 +176,9 @@
                                 break;
                         }
                         break;
+                    case 3:
+                        rle_row[column] = ch != '0' ? fgalpha : bgalpha;
+                        break;
                 }
             }
 
@@ -207,10 +208,24 @@
         }
     }
 
+    if (ferror(pcx_file)) {
+        sprintf(symbol->errtxt, "622: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(pcx_file);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(pcx_file);
+        if (fflush(pcx_file) != 0) {
+            sprintf(symbol->errtxt, "623: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(pcx_file);
+        if (fclose(pcx_file) != 0) {
+            sprintf(symbol->errtxt, "624: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     return 0;
diff -urN zint-2.12.0/backend/png.c zint/backend/png.c
--- zint-2.12.0/backend/png.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/png.c	2023-05-08 14:39:44.862319353 +0200
@@ -1,7 +1,7 @@
 /* png.c - Handles output to PNG file */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -73,7 +73,7 @@
 #endif
 
 /* Guestimate best compression strategy */
-static int guess_compression_strategy(struct zint_symbol *symbol, unsigned char *pixelbuf) {
+static int guess_compression_strategy(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
     (void)pixelbuf;
 
     /* TODO: Do properly */
@@ -92,7 +92,7 @@
     return Z_FILTERED;
 }
 
-INTERNAL int png_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf) {
+INTERNAL int png_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
     struct wpng_error_type wpng_error;
     FILE *outfile;
     png_structp png_ptr;
@@ -108,30 +108,14 @@
     int num_trans;
     int bit_depth;
     int compression_strategy;
-    unsigned char *pb;
+    const unsigned char *pb;
     const int output_to_stdout = symbol->output_options & BARCODE_STDOUT;
     unsigned char *outdata = (unsigned char *) z_alloca(symbol->bitmap_width);
 
     wpng_error.symbol = symbol;
 
-    fg.red = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fg.green = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fg.blue = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    bg.red = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bg.green = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bg.blue = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
-
-    if (strlen(symbol->fgcolour) > 6) {
-        fg_alpha = (16 * ctoi(symbol->fgcolour[6])) + ctoi(symbol->fgcolour[7]);
-    } else {
-        fg_alpha = 0xff;
-    }
-
-    if (strlen(symbol->bgcolour) > 6) {
-        bg_alpha = (16 * ctoi(symbol->bgcolour[6])) + ctoi(symbol->bgcolour[7]);
-    } else {
-        bg_alpha = 0xff;
-    }
+    (void) out_colour_get_rgb(symbol->fgcolour, &fg.red, &fg.green, &fg.blue, &fg_alpha);
+    (void) out_colour_get_rgb(symbol->bgcolour, &bg.red, &bg.green, &bg.blue, &bg_alpha);
 
     num_trans = 0;
     if (symbol->symbology == BARCODE_ULTRA) {
@@ -245,7 +229,7 @@
     if (!png_ptr) {
         strcpy(symbol->errtxt, "633: Insufficient memory for PNG write structure buffer");
         if (!output_to_stdout) {
-            fclose(outfile);
+            (void) fclose(outfile);
         }
         return ZINT_ERROR_MEMORY;
     }
@@ -255,7 +239,7 @@
         png_destroy_write_struct(&png_ptr, NULL);
         strcpy(symbol->errtxt, "634: Insufficient memory for PNG info structure buffer");
         if (!output_to_stdout) {
-            fclose(outfile);
+            (void) fclose(outfile);
         }
         return ZINT_ERROR_MEMORY;
     }
@@ -264,7 +248,7 @@
     if (setjmp(wpng_error.jmpbuf)) {
         png_destroy_write_struct(&png_ptr, &info_ptr);
         if (!output_to_stdout) {
-            fclose(outfile);
+            (void) fclose(outfile);
         }
         return ZINT_ERROR_MEMORY;
     }
@@ -343,10 +327,24 @@
     /* make sure we have disengaged */
     png_destroy_write_struct(&png_ptr, &info_ptr);
 
+    if (ferror(outfile)) {
+        sprintf(symbol->errtxt, "638: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(outfile);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(outfile);
+        if (fflush(outfile) != 0) {
+            sprintf(symbol->errtxt, "639: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(outfile);
+        if (fclose(outfile) != 0) {
+            sprintf(symbol->errtxt, "960: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     return 0;
diff -urN zint-2.12.0/backend/postal.c zint/backend/postal.c
--- zint-2.12.0/backend/postal.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/postal.c	2023-05-08 14:39:44.863319358 +0200
@@ -1,7 +1,7 @@
 /* postal.c - Handles POSTNET, PLANET, CEPNet, FIM. RM4SCC and Flattermarken */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
     Including bug fixes by Bryan Hatton
 
     Redistribution and use in source and binary forms, with or without
@@ -559,12 +559,12 @@
 
 /* Handles DAFT Code symbols */
 INTERNAL int daft(struct zint_symbol *symbol, unsigned char source[], int length) {
-    int posns[100];
+    int posns[250];
     int loopey;
     int writer;
 
-    if (length > 100) {
-        strcpy(symbol->errtxt, "492: Input too long (100 character maximum)");
+    if (length > 250) {
+        strcpy(symbol->errtxt, "492: Input too long (250 character maximum)");
         return ZINT_ERROR_TOO_LONG;
     }
     to_upper(source, length);
diff -urN zint-2.12.0/backend/ps.c zint/backend/ps.c
--- zint-2.12.0/backend/ps.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/ps.c	2023-05-08 14:39:44.863319358 +0200
@@ -1,7 +1,7 @@
 /* ps.c - Post Script output */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -137,10 +137,12 @@
 
 INTERNAL int ps_plot(struct zint_symbol *symbol) {
     FILE *feps;
-    int fgred, fggrn, fgblu, bgred, bggrn, bgblu;
-    float red_ink, green_ink, blue_ink, red_paper, green_paper, blue_paper;
-    float cyan_ink, magenta_ink, yellow_ink, black_ink;
-    float cyan_paper, magenta_paper, yellow_paper, black_paper;
+    unsigned char fgred, fggrn, fgblu, bgred, bggrn, bgblu, bgalpha;
+    int fgcyan, fgmagenta, fgyellow, fgblack, bgcyan, bgmagenta, bgyellow, bgblack;
+    float red_ink = 0.0f, green_ink = 0.0f, blue_ink = 0.0f; /* Suppress `-Wmaybe-uninitialized` */
+    float red_paper = 0.0f, green_paper = 0.0f, blue_paper = 0.0f;
+    float cyan_ink = 0.0f, magenta_ink = 0.0f, yellow_ink = 0.0f, black_ink = 0.0f;
+    float cyan_paper = 0.0f, magenta_paper = 0.0f, yellow_paper = 0.0f, black_paper = 0.0f;
     int error_number = 0;
     float ax, ay, bx, by, cx, cy, dx, dy, ex, ey, fx, fy;
     float previous_diameter;
@@ -166,12 +168,6 @@
         return ZINT_ERROR_INVALID_DATA;
     }
 
-    if (strlen(symbol->bgcolour) > 6) {
-        if ((ctoi(symbol->bgcolour[6]) == 0) && (ctoi(symbol->bgcolour[7]) == 0)) {
-            draw_background = 0;
-        }
-    }
-
     if (output_to_stdout) {
         feps = stdout;
     } else {
@@ -183,64 +179,31 @@
 
     locale = setlocale(LC_ALL, "C");
 
-    fgred = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fggrn = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fgblu = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    bgred = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bggrn = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bgblu = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
-    red_ink = (float) (fgred / 256.0);
-    green_ink = (float) (fggrn / 256.0);
-    blue_ink = (float) (fgblu / 256.0);
-    red_paper = (float) (bgred / 256.0);
-    green_paper = (float) (bggrn / 256.0);
-    blue_paper = (float) (bgblu / 256.0);
-
-    /* Convert RGB to CMYK */
-    if (red_ink > green_ink) {
-        if (blue_ink > red_ink) {
-            black_ink = 1.0f - blue_ink;
-        } else {
-            black_ink = 1.0f - red_ink;
-        }
-    } else {
-        if (blue_ink > red_ink) {
-            black_ink = 1.0f - blue_ink;
-        } else {
-            black_ink = 1.0f - green_ink;
-        }
-    }
-    if (black_ink < 1.0f) {
-        cyan_ink = (1.0f - red_ink - black_ink) / (1.0f - black_ink);
-        magenta_ink = (1.0f - green_ink - black_ink) / (1.0f - black_ink);
-        yellow_ink = (1.0f - blue_ink - black_ink) / (1.0f - black_ink);
-    } else {
-        cyan_ink = 0.0f;
-        magenta_ink = 0.0f;
-        yellow_ink = 0.0f;
-    }
-
-    if (red_paper > green_paper) {
-        if (blue_paper > red_paper) {
-            black_paper = 1.0f - blue_paper;
-        } else {
-            black_paper = 1.0f - red_paper;
-        }
+    if ((symbol->output_options & CMYK_COLOUR) == 0) {
+        (void) out_colour_get_rgb(symbol->fgcolour, &fgred, &fggrn, &fgblu, NULL /*alpha*/);
+        red_ink = fgred / 255.0f;
+        green_ink = fggrn / 255.0f;
+        blue_ink = fgblu / 255.0f;
+
+        (void) out_colour_get_rgb(symbol->bgcolour, &bgred, &bggrn, &bgblu, &bgalpha);
+        red_paper = bgred / 255.0f;
+        green_paper = bggrn / 255.0f;
+        blue_paper = bgblu / 255.0f;
     } else {
-        if (blue_paper > red_paper) {
-            black_paper = 1.0f - blue_paper;
-        } else {
-            black_paper = 1.0f - green_paper;
-        }
+        (void) out_colour_get_cmyk(symbol->fgcolour, &fgcyan, &fgmagenta, &fgyellow, &fgblack, NULL /*rgb_alpha*/);
+        cyan_ink = fgcyan / 100.0f;
+        magenta_ink = fgmagenta / 100.0f;
+        yellow_ink = fgyellow / 100.0f;
+        black_ink = fgblack / 100.0f;
+
+        (void) out_colour_get_cmyk(symbol->bgcolour, &bgcyan, &bgmagenta, &bgyellow, &bgblack, &bgalpha);
+        cyan_paper = bgcyan / 100.0f;
+        magenta_paper = bgmagenta / 100.0f;
+        yellow_paper = bgyellow / 100.0f;
+        black_paper = bgblack / 100.0f;
     }
-    if (black_paper < 1.0f) {
-        cyan_paper = (1.0f - red_paper - black_paper) / (1.0f - black_paper);
-        magenta_paper = (1.0f - green_paper - black_paper) / (1.0f - black_paper);
-        yellow_paper = (1.0f - blue_paper - black_paper) / (1.0f - black_paper);
-    } else {
-        cyan_paper = 0.0f;
-        magenta_paper = 0.0f;
-        yellow_paper = 0.0f;
+    if (bgalpha == 0) {
+        draw_background = 0;
     }
 
     for (i = 0, len = (int) ustrlen(symbol->text); i < len; i++) {
@@ -271,38 +234,38 @@
     }
 
     /* Start writing the header */
-    fprintf(feps, "%%!PS-Adobe-3.0 EPSF-3.0\n");
+    fputs("%!PS-Adobe-3.0 EPSF-3.0\n", feps);
     if (ZINT_VERSION_BUILD) {
         fprintf(feps, "%%%%Creator: Zint %d.%d.%d.%d\n",
                 ZINT_VERSION_MAJOR, ZINT_VERSION_MINOR, ZINT_VERSION_RELEASE, ZINT_VERSION_BUILD);
     } else {
         fprintf(feps, "%%%%Creator: Zint %d.%d.%d\n", ZINT_VERSION_MAJOR, ZINT_VERSION_MINOR, ZINT_VERSION_RELEASE);
     }
-    fprintf(feps, "%%%%Title: Zint Generated Symbol\n");
-    fprintf(feps, "%%%%Pages: 0\n");
+    fputs("%%Title: Zint Generated Symbol\n"
+          "%%Pages: 0\n", feps);
     fprintf(feps, "%%%%BoundingBox: 0 0 %d %d\n",
             (int) ceilf(symbol->vector->width), (int) ceilf(symbol->vector->height));
-    fprintf(feps, "%%%%EndComments\n");
+    fputs("%%EndComments\n", feps);
 
     /* Definitions */
     if (have_circles_without_width) {
         /* Disc: x y radius TD */
-        fprintf(feps, "/TD { newpath 0 360 arc fill } bind def\n");
+        fputs("/TD { newpath 0 360 arc fill } bind def\n", feps);
     }
     if (have_circles_with_width) {
         /* Circle (ring): x y radius width TC (adapted from BWIPP renmaxicode.ps) */
-        fprintf(feps, "/TC { newpath 4 1 roll 3 copy 0 360 arc closepath 4 -1 roll add 360 0 arcn closepath fill }"
-                        " bind def\n");
+        fputs("/TC { newpath 4 1 roll 3 copy 0 360 arc closepath 4 -1 roll add 360 0 arcn closepath fill }"
+                " bind def\n", feps);
     }
     if (symbol->vector->hexagons) {
-        fprintf(feps, "/TH { 0 setlinewidth moveto lineto lineto lineto lineto lineto closepath fill } bind def\n");
+        fputs("/TH { 0 setlinewidth moveto lineto lineto lineto lineto lineto closepath fill } bind def\n", feps);
     }
-    fprintf(feps, "/TB { 2 copy } bind def\n");
-    fprintf(feps, "/TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill }"
-                    " bind def\n");
-    fprintf(feps, "/TE { pop pop } bind def\n");
+    fputs("/TB { 2 copy } bind def\n"
+          "/TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill }"
+            " bind def\n"
+          "/TE { pop pop } bind def\n", feps);
 
-    fprintf(feps, "newpath\n");
+    fputs("newpath\n", feps);
 
     /* Now the actual representation */
 
@@ -315,7 +278,7 @@
         }
 
         fprintf(feps, "%.2f 0.00 TB 0.00 %.2f TR\n", symbol->vector->height, symbol->vector->width);
-        fprintf(feps, "TE\n");
+        fputs("TE\n", feps);
     }
 
     if (symbol->symbology != BARCODE_ULTRA) {
@@ -344,7 +307,7 @@
                 }
                 fprintf(feps, "%.2f %.2f TB %.2f %.2f TR\n",
                         rect->height, (symbol->vector->height - rect->y) - rect->height, rect->x, rect->width);
-                fprintf(feps, "TE\n");
+                fputs("TE\n", feps);
             }
             rect = rect->next;
         }
@@ -361,7 +324,7 @@
                     }
                     fprintf(feps, "%.2f %.2f TB %.2f %.2f TR\n",
                             rect->height, (symbol->vector->height - rect->y) - rect->height, rect->x, rect->width);
-                    fprintf(feps, "TE\n");
+                    fputs("TE\n", feps);
                 }
                 rect = rect->next;
             }
@@ -371,7 +334,7 @@
         while (rect) {
             fprintf(feps, "%.2f %.2f TB %.2f %.2f TR\n",
                     rect->height, (symbol->vector->height - rect->y) - rect->height, rect->x, rect->width);
-            fprintf(feps, "TE\n");
+            fputs("TE\n", feps);
             rect = rect->next;
         }
     }
@@ -426,7 +389,7 @@
             previous_diameter = circle->diameter - circle->width;
             radius = (float) (0.5 * previous_diameter);
         }
-        if (circle->colour) {
+        if (circle->colour) { /* Legacy - no longer used */
             /* A 'white' circle */
             if ((symbol->output_options & CMYK_COLOUR) == 0) {
                 fprintf(feps, "%.2f %.2f %.2f setrgbcolor\n", red_paper, green_paper, blue_paper);
@@ -464,8 +427,7 @@
     string = symbol->vector->strings;
 
     if (string) {
-        if ((symbol->output_options & BOLD_TEXT)
-                && (!is_extendable(symbol->symbology) || (symbol->output_options & SMALL_TEXT))) {
+        if ((symbol->output_options & BOLD_TEXT) && !is_extendable(symbol->symbology)) {
             font = "Helvetica-Bold";
         } else {
             font = "Helvetica";
@@ -473,17 +435,17 @@
         if (iso_latin1) {
             /* Change encoding to ISO 8859-1, see Postscript Language Reference Manual 2nd Edition Example 5.6 */
             fprintf(feps, "/%s findfont\n", font);
-            fprintf(feps, "dup length dict begin\n");
-            fprintf(feps, "{1 index /FID ne {def} {pop pop} ifelse} forall\n");
-            fprintf(feps, "/Encoding ISOLatin1Encoding def\n");
-            fprintf(feps, "currentdict\n");
-            fprintf(feps, "end\n");
-            fprintf(feps, "/Helvetica-ISOLatin1 exch definefont pop\n");
+            fputs("dup length dict begin\n"
+                  "{1 index /FID ne {def} {pop pop} ifelse} forall\n"
+                  "/Encoding ISOLatin1Encoding def\n"
+                  "currentdict\n"
+                  "end\n"
+                  "/Helvetica-ISOLatin1 exch definefont pop\n", feps);
             font = "Helvetica-ISOLatin1";
         }
         do {
             ps_convert(string->text, ps_string);
-            fprintf(feps, "matrix currentmatrix\n");
+            fputs("matrix currentmatrix\n", feps);
             fprintf(feps, "/%s findfont\n", font);
             fprintf(feps, "%.2f scalefont setfont\n", string->fsize);
             fprintf(feps, " 0 0 moveto %.2f %.2f translate 0.00 rotate 0 0 moveto\n",
@@ -492,31 +454,45 @@
                 fprintf(feps, " (%s) stringwidth\n", ps_string);
             }
             if (string->rotation != 0) {
-                fprintf(feps, "gsave\n");
+                fputs("gsave\n", feps);
                 fprintf(feps, "%d rotate\n", 360 - string->rotation);
             }
             if (string->halign == 0 || string->halign == 2) {
-                fprintf(feps, "pop\n");
+                fputs("pop\n", feps);
                 fprintf(feps, "%s 0 rmoveto\n", string->halign == 2 ? "neg" : "-2 div");
             }
             fprintf(feps, " (%s) show\n", ps_string);
             if (string->rotation != 0) {
-                fprintf(feps, "grestore\n");
+                fputs("grestore\n", feps);
             }
-            fprintf(feps, "setmatrix\n");
+            fputs("setmatrix\n", feps);
             string = string->next;
         } while (string);
     }
 
+    if (locale)
+        setlocale(LC_ALL, locale);
+
+    if (ferror(feps)) {
+        sprintf(symbol->errtxt, "647: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(feps);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(feps);
+        if (fflush(feps) != 0) {
+            sprintf(symbol->errtxt, "648: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
-        fclose(feps);
+        if (fclose(feps) != 0) {
+            sprintf(symbol->errtxt, "649: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
-    if (locale)
-        setlocale(LC_ALL, locale);
-
     return error_number;
 }
 
diff -urN zint-2.12.0/backend/qr.c zint/backend/qr.c
--- zint-2.12.0/backend/qr.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/qr.c	2023-05-08 14:39:44.864319364 +0200
@@ -1013,7 +1013,7 @@
 
     file = fopen("zintlog.txt", "a+");
     fprintf(file, "%c", log);
-    fclose(file);
+    (void) fclose(file);
     return 0;
 }
 
@@ -1023,7 +1023,7 @@
     file = fopen("zintlog.txt", "a+");
     fprintf(file, log); /*writes*/
     fprintf(file, "\r\n"); /*writes*/
-    fclose(file);
+    (void) fclose(file);
     return 0;
 }
 #endif
diff -urN zint-2.12.0/backend/raster.c zint/backend/raster.c
--- zint-2.12.0/backend/raster.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/raster.c	2023-05-08 14:39:44.865319370 +0200
@@ -1,7 +1,7 @@
 /* raster.c - Handles output to raster files */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -44,24 +44,24 @@
 
 #include "font.h" /* Font for human readable text */
 
-#define DEFAULT_INK     '1'
-#define DEFAULT_PAPER   '0'
+#define DEFAULT_INK     '1' /* Black */
+#define DEFAULT_PAPER   '0' /* White */
 
-#define UPCEAN_TEXT     1
+#define UPCEAN_TEXT     1   /* Helper flag for `draw_string()`/`draw_letter()` to indicate dealing with UPC/EAN */
 
 #ifndef ZINT_NO_PNG
-INTERNAL int png_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf);
+INTERNAL int png_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf);
 #endif /* ZINT_NO_PNG */
-INTERNAL int bmp_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf);
-INTERNAL int pcx_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf);
-INTERNAL int gif_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf);
-INTERNAL int tif_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf);
+INTERNAL int bmp_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf);
+INTERNAL int pcx_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf);
+INTERNAL int gif_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf);
+INTERNAL int tif_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf);
 
 static const char ultra_colour[] = "0CBMRYGKW";
 
 static int buffer_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
     /* Place pixelbuffer into symbol */
-    int fgalpha, bgalpha;
+    unsigned char alpha[2];
     unsigned char map[91][3] = {
         {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, /* 0x00-0F */
         {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, {0}, /* 0x10-1F */
@@ -77,25 +77,13 @@
     int plot_alpha = 0;
     const size_t bm_bitmap_width = (size_t) symbol->bitmap_width * 3;
 
-    map[DEFAULT_INK][0] = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    map[DEFAULT_INK][1] = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    map[DEFAULT_INK][2] = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    map[DEFAULT_PAPER][0] = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    map[DEFAULT_PAPER][1] = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    map[DEFAULT_PAPER][2] = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
-
-    if (strlen(symbol->fgcolour) > 6) {
-        fgalpha = (16 * ctoi(symbol->fgcolour[6])) + ctoi(symbol->fgcolour[7]);
+    if (out_colour_get_rgb(symbol->fgcolour, &map[DEFAULT_INK][0], &map[DEFAULT_INK][1], &map[DEFAULT_INK][2],
+            &alpha[0])) {
         plot_alpha = 1;
-    } else {
-        fgalpha = 0xff;
     }
-
-    if (strlen(symbol->bgcolour) > 6) {
-        bgalpha = (16 * ctoi(symbol->bgcolour[6])) + ctoi(symbol->bgcolour[7]);
+    if (out_colour_get_rgb(symbol->bgcolour, &map[DEFAULT_PAPER][0], &map[DEFAULT_PAPER][1], &map[DEFAULT_PAPER][2],
+            &alpha[1])) {
         plot_alpha = 1;
-    } else {
-        bgalpha = 0xff;
     }
 
     /* Free any previous bitmap */
@@ -131,7 +119,7 @@
                 const int pe = p + symbol->bitmap_width;
                 for (; p < pe; p++, bitmap += 3) {
                     memcpy(bitmap, map[pixelbuf[p]], 3);
-                    symbol->alphamap[p] = pixelbuf[p] == DEFAULT_PAPER ? bgalpha : fgalpha;
+                    symbol->alphamap[p] = alpha[pixelbuf[p] == DEFAULT_PAPER];
                 }
             }
         }
@@ -330,7 +318,7 @@
     }
 
     /* Following should never happen (ISBN check digit "X" not printed) */
-    if ((textflags & UPCEAN_TEXT) && (letter < '0' || letter > '9')) {
+    if ((textflags & UPCEAN_TEXT) && !z_isdigit(letter)) {
         return; /* Not reached */
     }
 
@@ -755,6 +743,7 @@
 
     image_width = (int) ceilf(hex_image_width + xoffset_si + roffset_si);
     image_height = (int) ceilf(hex_image_height + yoffset_si + boffset_si);
+    assert(image_width && image_height);
 
     if (!(pixelbuf = (unsigned char *) malloc((size_t) image_width * image_height))) {
         strcpy(symbol->errtxt, "655: Insufficient memory for pixel buffer");
@@ -877,7 +866,7 @@
     return error_number;
 }
 
-/* Convert UTF-8 to ISO 8859-1 for draw_string() human readable text */
+/* Convert UTF-8 to ISO/IEC 8859-1 for `draw_string()` human readable text */
 static void to_iso8859_1(const unsigned char source[], unsigned char preprocessed[]) {
     int j, i, input_length;
 
@@ -927,7 +916,7 @@
     float textoffset;
     int upceanflag = 0;
     int addon_latch = 0;
-    unsigned char textpart1[5], textpart2[7], textpart3[7], textpart4[2];
+    unsigned char textparts[4][7];
     int hide_text;
     int i, r;
     int block_width = 0;
@@ -979,13 +968,13 @@
     if (upceanflag) {
         textflags = UPCEAN_TEXT | (symbol->output_options & SMALL_TEXT); /* Bold not available for UPC/EAN */
         text_height = (UPCEAN_FONT_HEIGHT + 1) / 2;
-        text_gap = 1.0f;
+        text_gap = symbol->text_gap ? symbol->text_gap : 1.0f;
         /* Height of guard bar descent (none for EAN-2 and EAN-5) */
         guard_descent = upceanflag != 2 && upceanflag != 5 ? symbol->guard_descent : 0.0f;
     } else {
         textflags = symbol->output_options & (SMALL_TEXT | BOLD_TEXT);
         text_height = textflags & SMALL_TEXT ? (SMALL_FONT_HEIGHT + 1) / 2 : (NORMAL_FONT_HEIGHT + 1) / 2;
-        text_gap = 1.0f;
+        text_gap = symbol->text_gap ? symbol->text_gap : 1.0f;
         guard_descent = 0.0f;
     }
 
@@ -1001,6 +990,7 @@
 
     image_width = symbol->width * si + xoffset_si + roffset_si;
     image_height = symbol_height_si + textoffset * si + yoffset_si + boffset_si;
+    assert(image_width && image_height);
 
     if (!(pixelbuf = (unsigned char *) malloc((size_t) image_width * image_height))) {
         strcpy(symbol->errtxt, "658: Insufficient memory for pixel buffer");
@@ -1157,99 +1147,72 @@
         }
 
         if (upceanflag >= 6) { /* UPC-E, EAN-8, UPC-A, EAN-13 */
+            const int addon_len = (int) ustrlen(addon);
 
             /* Note font sizes halved as in pixels */
 
             /* Halved again to get middle position that draw_string() expects */
             const int upcea_width_adj = (UPCEAN_SMALL_FONT_WIDTH + 3) / 4;
-            const int upcea_height_adj = (UPCEAN_FONT_HEIGHT - UPCEAN_SMALL_FONT_HEIGHT) * si / 2;
+            const int upcea_height_adj = ((UPCEAN_FONT_HEIGHT - UPCEAN_SMALL_FONT_HEIGHT) * si + 1) / 2;
             /* Halved again to get middle position that draw_string() expects */
             const int ean_width_adj = (UPCEAN_FONT_WIDTH + 3) / 4;
 
-            out_upcean_split_text(upceanflag, symbol->text, textpart1, textpart2, textpart3, textpart4);
+            out_upcean_split_text(upceanflag, symbol->text, textparts);
 
             if (upceanflag == 6) { /* UPC-E */
                 int text_xposn = -(5 + upcea_width_adj) * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart1, text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
+                draw_string(pixelbuf, textparts[0], text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
                             image_width, image_height, si);
                 text_xposn = 24 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart2, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[1], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = (51 + 3 + upcea_width_adj) * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart3, text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
+                draw_string(pixelbuf, textparts[2], text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
                             image_width, image_height, si);
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = (61 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
-                    case 5:
-                        text_xposn = (75 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
+                if (addon_len) {
+                    text_xposn = ((addon_len == 2 ? 61 : 75) + addon_gap) * si + comp_xoffset_si;
+                    draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
+                                image_width, image_height, si);
                 }
 
             } else if (upceanflag == 8) { /* EAN-8 */
                 int text_xposn = 17 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart1, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[0], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = 50 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart2, text_xposn, text_yposn, textflags, image_width, image_height, si);
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = (77 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
-                    case 5:
-                        text_xposn = (91 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
+                draw_string(pixelbuf, textparts[1], text_xposn, text_yposn, textflags, image_width, image_height, si);
+                if (addon_len) {
+                    text_xposn = ((addon_len == 2 ? 77 : 91) + addon_gap) * si + comp_xoffset_si;
+                    draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
+                                image_width, image_height, si);
                 }
 
             } else if (upceanflag == 12) { /* UPC-A */
                 int text_xposn = (-(5 + upcea_width_adj)) * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart1, text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
+                draw_string(pixelbuf, textparts[0], text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
                             image_width, image_height, si);
                 text_xposn = 27 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart2, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[1], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = 67 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart3, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[2], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = (95 + 5 + upcea_width_adj) * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart4, text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
+                draw_string(pixelbuf, textparts[3], text_xposn, text_yposn + upcea_height_adj, textflags | SMALL_TEXT,
                             image_width, image_height, si);
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = (105 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
-                    case 5:
-                        text_xposn = (119 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
+                if (addon_len) {
+                    text_xposn = ((addon_len == 2 ? 105 : 119) + addon_gap) * si + comp_xoffset_si;
+                    draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
+                                image_width, image_height, si);
                 }
 
             } else { /* EAN-13 */
                 int text_xposn = (-(5 + ean_width_adj)) * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart1, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[0], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = 24 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart2, text_xposn, text_yposn, textflags, image_width, image_height, si);
+                draw_string(pixelbuf, textparts[1], text_xposn, text_yposn, textflags, image_width, image_height, si);
                 text_xposn = 71 * si + comp_xoffset_si;
-                draw_string(pixelbuf, textpart3, text_xposn, text_yposn, textflags, image_width, image_height, si);
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = (105 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
-                    case 5:
-                        text_xposn = (119 + addon_gap) * si + comp_xoffset_si;
-                        draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
-                                    image_width, image_height, si);
-                        break;
+                draw_string(pixelbuf, textparts[2], text_xposn, text_yposn, textflags, image_width, image_height, si);
+                if (addon_len) {
+                    text_xposn = ((addon_len == 2 ? 105 : 119) + addon_gap) * si + comp_xoffset_si;
+                    draw_string(pixelbuf, addon, text_xposn, addon_text_yposn, textflags,
+                                image_width, image_height, si);
                 }
             }
         } else {
diff -urN zint-2.12.0/backend/svg.c zint/backend/svg.c
--- zint-2.12.0/backend/svg.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/svg.c	2023-05-08 14:39:44.868319388 +0200
@@ -1,7 +1,7 @@
 /* svg.c - Scalable Vector Graphics */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -113,6 +113,7 @@
 }
 
 INTERNAL int svg_plot(struct zint_symbol *symbol) {
+    static const char font_family[] = "Helvetica, sans-serif";
     FILE *fsvg;
     int error_number = 0;
     const char *locale = NULL;
@@ -122,10 +123,9 @@
     int i;
     char fgcolour_string[7];
     char bgcolour_string[7];
-    int bg_alpha = 0xff;
-    int fg_alpha = 0xff;
-    float fg_alpha_opacity = 0.0f, bg_alpha_opacity = 0.0f;
-    const char font_family[] = "Helvetica, sans-serif";
+    unsigned char fgred, fggreen, fgblue, fg_alpha;
+    unsigned char bgred, bggreen, bgblue, bg_alpha;
+    float fg_alpha_opacity = 0.0f, bg_alpha_opacity = 0.0f; /* Suppress `-Wmaybe-uninitialized` */
     int bold;
 
     struct zint_vector_rect *rect;
@@ -136,27 +136,19 @@
     char colour_code[7];
     int len, html_len;
 
+    const int output_to_stdout = symbol->output_options & BARCODE_STDOUT;
     char *html_string;
 
-    for (i = 0; i < 6; i++) {
-        fgcolour_string[i] = symbol->fgcolour[i];
-        bgcolour_string[i] = symbol->bgcolour[i];
-    }
-    fgcolour_string[6] = '\0';
-    bgcolour_string[6] = '\0';
-
-    if (strlen(symbol->fgcolour) > 6) {
-        fg_alpha = (16 * ctoi(symbol->fgcolour[6])) + ctoi(symbol->fgcolour[7]);
-        if (fg_alpha != 0xff) {
-            fg_alpha_opacity = (float) (fg_alpha / 255.0);
-        }
-    }
-    if (strlen(symbol->bgcolour) > 6) {
-        bg_alpha = (16 * ctoi(symbol->bgcolour[6])) + ctoi(symbol->bgcolour[7]);
-        if (bg_alpha != 0xff) {
-            bg_alpha_opacity = (float) (bg_alpha / 255.0);
-        }
+    (void) out_colour_get_rgb(symbol->fgcolour, &fgred, &fggreen, &fgblue, &fg_alpha);
+    if (fg_alpha != 0xff) {
+        fg_alpha_opacity = fg_alpha / 255.0f;
+    }
+    sprintf(fgcolour_string, "%02X%02X%02X", fgred, fggreen, fgblue);
+    (void) out_colour_get_rgb(symbol->bgcolour, &bgred, &bggreen, &bgblue, &bg_alpha);
+    if (bg_alpha != 0xff) {
+        bg_alpha_opacity = bg_alpha / 255.0f;
     }
+    sprintf(bgcolour_string, "%02X%02X%02X", bgred, bggreen, bgblue);
 
     len = (int) ustrlen(symbol->text);
     html_len = len + 1;
@@ -181,7 +173,7 @@
         strcpy(symbol->errtxt, "681: Vector header NULL");
         return ZINT_ERROR_INVALID_DATA;
     }
-    if (symbol->output_options & BARCODE_STDOUT) {
+    if (output_to_stdout) {
         fsvg = stdout;
     } else {
         if (!(fsvg = out_fopen(symbol->outfile, "w"))) {
@@ -193,14 +185,14 @@
     locale = setlocale(LC_ALL, "C");
 
     /* Start writing the header */
-    fprintf(fsvg, "<?xml version=\"1.0\" standalone=\"no\"?>\n");
-    fprintf(fsvg, "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n");
-    fprintf(fsvg, "   \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n");
+    fputs("<?xml version=\"1.0\" standalone=\"no\"?>\n"
+          "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n"
+          "   \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n", fsvg);
     fprintf(fsvg, "<svg width=\"%d\" height=\"%d\" version=\"1.1\"\n",
             (int) ceilf(symbol->vector->width), (int) ceilf(symbol->vector->height));
-    fprintf(fsvg, "   xmlns=\"http://www.w3.org/2000/svg\">\n");
-    fprintf(fsvg, "   <desc>Zint Generated Symbol\n");
-    fprintf(fsvg, "   </desc>\n");
+    fputs("   xmlns=\"http://www.w3.org/2000/svg\">\n"
+          "   <desc>Zint Generated Symbol\n"
+          "   </desc>\n", fsvg);
     fprintf(fsvg, "\n   <g id=\"barcode\" fill=\"#%s\">\n", fgcolour_string);
 
     if (bg_alpha != 0) {
@@ -209,7 +201,7 @@
         if (bg_alpha != 0xff) {
             fprintf(fsvg, " opacity=\"%.3f\"", bg_alpha_opacity);
         }
-        fprintf(fsvg, " />\n");
+        fputs(" />\n", fsvg);
     }
 
     rect = symbol->vector->rectangles;
@@ -223,7 +215,7 @@
         if (fg_alpha != 0xff) {
             fprintf(fsvg, " opacity=\"%.3f\"", fg_alpha_opacity);
         }
-        fprintf(fsvg, " />\n");
+        fputs(" />\n", fsvg);
         rect = rect->next;
     }
 
@@ -268,7 +260,7 @@
         if (fg_alpha != 0xff) {
             fprintf(fsvg, " opacity=\"%.3f\"", fg_alpha_opacity);
         }
-        fprintf(fsvg, " />\n");
+        fputs(" />\n", fsvg);
         hex = hex->next;
     }
 
@@ -282,7 +274,7 @@
         fprintf(fsvg, "      <circle cx=\"%.2f\" cy=\"%.2f\" r=\"%.*f\"",
                 circle->x, circle->y, circle->width ? 3 : 2, radius);
 
-        if (circle->colour) {
+        if (circle->colour) { /* Legacy - no longer used */
             if (circle->width) {
                 fprintf(fsvg, " stroke=\"#%s\" stroke-width=\"%.3f\" fill=\"none\"", bgcolour_string, circle->width);
             } else {
@@ -300,19 +292,18 @@
                 fprintf(fsvg, " opacity=\"%.3f\"", fg_alpha_opacity);
             }
         }
-        fprintf(fsvg, " />\n");
+        fputs(" />\n", fsvg);
         circle = circle->next;
     }
 
-    bold = (symbol->output_options & BOLD_TEXT)
-            && (!is_extendable(symbol->symbology) || (symbol->output_options & SMALL_TEXT));
+    bold = (symbol->output_options & BOLD_TEXT) && !is_extendable(symbol->symbology);
     string = symbol->vector->strings;
     while (string) {
         const char *const halign = string->halign == 2 ? "end" : string->halign == 1 ? "start" : "middle";
         fprintf(fsvg, "      <text x=\"%.2f\" y=\"%.2f\" text-anchor=\"%s\"\n", string->x, string->y, halign);
         fprintf(fsvg, "         font-family=\"%s\" font-size=\"%.1f\"", font_family, string->fsize);
         if (bold) {
-            fprintf(fsvg, " font-weight=\"bold\"");
+            fputs(" font-weight=\"bold\"", fsvg);
         }
         if (fg_alpha != 0xff) {
             fprintf(fsvg, " opacity=\"%.3f\"", fg_alpha_opacity);
@@ -320,25 +311,39 @@
         if (string->rotation != 0) {
             fprintf(fsvg, " transform=\"rotate(%d,%.2f,%.2f)\"", string->rotation, string->x, string->y);
         }
-        fprintf(fsvg, " >\n");
+        fputs(" >\n", fsvg);
         make_html_friendly(string->text, html_string);
         fprintf(fsvg, "         %s\n", html_string);
-        fprintf(fsvg, "      </text>\n");
+        fputs("      </text>\n", fsvg);
         string = string->next;
     }
 
-    fprintf(fsvg, "   </g>\n");
-    fprintf(fsvg, "</svg>\n");
-
-    if (symbol->output_options & BARCODE_STDOUT) {
-        fflush(fsvg);
-    } else {
-        fclose(fsvg);
-    }
+    fputs("   </g>\n"
+          "</svg>\n", fsvg);
 
     if (locale)
         setlocale(LC_ALL, locale);
 
+    if (ferror(fsvg)) {
+        sprintf(symbol->errtxt, "682: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(fsvg);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
+    if (output_to_stdout) {
+        if (fflush(fsvg) != 0) {
+            sprintf(symbol->errtxt, "683: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
+    } else {
+        if (fclose(fsvg) != 0) {
+            sprintf(symbol->errtxt, "684: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
+    }
+
     return error_number;
 }
 
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold_100dpi.emf and zint/backend/tests/data/emf/code128_egrave_bold_100dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold_1200dpi.emf and zint/backend/tests/data/emf/code128_egrave_bold_1200dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold_150dpi.emf and zint/backend/tests/data/emf/code128_egrave_bold_150dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold_300dpi.emf and zint/backend/tests/data/emf/code128_egrave_bold_300dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold_400dpi.emf and zint/backend/tests/data/emf/code128_egrave_bold_400dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code128_egrave_bold.emf and zint/backend/tests/data/emf/code128_egrave_bold.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code39_rotate_180.emf and zint/backend/tests/data/emf/code39_rotate_180.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code39_rotate_270.emf and zint/backend/tests/data/emf/code39_rotate_270.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code39_rotate_90_300dpi.emf and zint/backend/tests/data/emf/code39_rotate_90_300dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/code39_rotate_90.emf and zint/backend/tests/data/emf/code39_rotate_90.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/ean13_5addon_#185.emf and zint/backend/tests/data/emf/ean13_5addon_#185.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/ean13_5addon_ggs_5.2.2.5.2-2.emf and zint/backend/tests/data/emf/ean13_5addon_ggs_5.2.2.5.2-2.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/itf14_bold_600dpi.emf and zint/backend/tests/data/emf/itf14_bold_600dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/itf14_bold.emf and zint/backend/tests/data/emf/itf14_bold.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/telenum_fg_bg_150dpi.emf and zint/backend/tests/data/emf/telenum_fg_bg_150dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/telenum_fg_bg.emf and zint/backend/tests/data/emf/telenum_fg_bg.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/upca_2addon_ggs_5.2.6.6-5.emf and zint/backend/tests/data/emf/upca_2addon_ggs_5.2.6.6-5.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/upce_2addon_150dpi.emf and zint/backend/tests/data/emf/upce_2addon_150dpi.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/upce_2addon.emf and zint/backend/tests/data/emf/upce_2addon.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/upce_2addon_small_bold.emf and zint/backend/tests/data/emf/upce_2addon_small_bold.emf differ
Binary files zint-2.12.0/backend/tests/data/emf/upu_s10_cmyk_nobg.emf and zint/backend/tests/data/emf/upu_s10_cmyk_nobg.emf differ
diff -urN zint-2.12.0/backend/tests/data/eps/code128_egrave_bold.eps zint/backend/tests/data/eps/code128_egrave_bold.eps
--- zint-2.12.0/backend/tests/data/eps/code128_egrave_bold.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/code128_egrave_bold.eps	2023-05-08 14:39:44.872319411 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 224 119
@@ -84,7 +84,7 @@
 matrix currentmatrix
 /Helvetica-ISOLatin1 findfont
 14.00 scalefont setfont
- 0 0 moveto 112.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 112.00 4.90 translate 0.00 rotate 0 0 moveto
  (Égjpqy) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/code128_egrave_bold_rotate_90.eps zint/backend/tests/data/eps/code128_egrave_bold_rotate_90.eps
--- zint-2.12.0/backend/tests/data/eps/code128_egrave_bold_rotate_90.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/code128_egrave_bold_rotate_90.eps	2023-05-08 14:39:44.873319417 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 119 224
@@ -84,7 +84,7 @@
 matrix currentmatrix
 /Helvetica-ISOLatin1 findfont
 14.00 scalefont setfont
- 0 0 moveto 3.50 112.00 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 4.90 112.00 translate 0.00 rotate 0 0 moveto
  (Égjpqy) stringwidth
 gsave
 270 rotate
diff -urN zint-2.12.0/backend/tests/data/eps/code128_escape_latin1.eps zint/backend/tests/data/eps/code128_escape_latin1.eps
--- zint-2.12.0/backend/tests/data/eps/code128_escape_latin1.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/code128_escape_latin1.eps	2023-05-08 14:39:44.873319417 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 246 119
@@ -90,7 +90,7 @@
 matrix currentmatrix
 /Helvetica-ISOLatin1 findfont
 14.00 scalefont setfont
- 0 0 moveto 123.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 123.00 4.90 translate 0.00 rotate 0 0 moveto
  (A\\B\)ç\(D) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/code39_fgalpha_bg_cmyk.eps zint/backend/tests/data/eps/code39_fgalpha_bg_cmyk.eps
--- zint-2.12.0/backend/tests/data/eps/code39_fgalpha_bg_cmyk.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/code39_fgalpha_bg_cmyk.eps	2023-05-08 14:39:44.873319417 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 128 119
@@ -8,10 +8,10 @@
 /TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill } bind def
 /TE { pop pop } bind def
 newpath
-0.00 0.40 0.81 0.02 setcmykcolor
+0.00 0.40 0.81 0.01 setcmykcolor
 118.90 0.00 TB 0.00 128.00 TR
 TE
-0.90 0.41 0.00 0.19 setcmykcolor
+0.90 0.41 0.00 0.18 setcmykcolor
 100.00 18.90 TB 0.00 2.00 TR
 TE
 100.00 18.90 TB 6.00 2.00 TR
@@ -65,7 +65,7 @@
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 64.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 64.00 4.90 translate 0.00 rotate 0 0 moveto
  (*123*) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/code39_fg_bg.eps zint/backend/tests/data/eps/code39_fg_bg.eps
--- zint-2.12.0/backend/tests/data/eps/code39_fg_bg.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/code39_fg_bg.eps	2023-05-08 14:39:44.873319417 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 128 119
@@ -8,10 +8,10 @@
 /TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill } bind def
 /TE { pop pop } bind def
 newpath
-0.98 0.59 0.19 setrgbcolor
+0.99 0.59 0.19 setrgbcolor
 118.90 0.00 TB 0.00 128.00 TR
 TE
-0.08 0.48 0.81 setrgbcolor
+0.08 0.48 0.82 setrgbcolor
 100.00 18.90 TB 0.00 2.00 TR
 TE
 100.00 18.90 TB 6.00 2.00 TR
@@ -65,7 +65,7 @@
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 64.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 64.00 4.90 translate 0.00 rotate 0 0 moveto
  (*123*) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/code39_nobg_cmyk.eps zint/backend/tests/data/eps/code39_nobg_cmyk.eps
--- zint-2.12.0/backend/tests/data/eps/code39_nobg_cmyk.eps	1970-01-01 01:00:00.000000000 +0100
+++ zint/backend/tests/data/eps/code39_nobg_cmyk.eps	2023-05-08 14:39:44.873319417 +0200
@@ -0,0 +1,70 @@
+%!PS-Adobe-3.0 EPSF-3.0
+%%Creator: Zint 2.12.0.9
+%%Title: Zint Generated Symbol
+%%Pages: 0
+%%BoundingBox: 0 0 128 119
+%%EndComments
+/TB { 2 copy } bind def
+/TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill } bind def
+/TE { pop pop } bind def
+newpath
+0.90 0.40 0.00 0.09 setcmykcolor
+100.00 18.90 TB 0.00 2.00 TR
+TE
+100.00 18.90 TB 6.00 2.00 TR
+TE
+100.00 18.90 TB 10.00 4.00 TR
+TE
+100.00 18.90 TB 16.00 4.00 TR
+TE
+100.00 18.90 TB 22.00 2.00 TR
+TE
+100.00 18.90 TB 26.00 4.00 TR
+TE
+100.00 18.90 TB 32.00 2.00 TR
+TE
+100.00 18.90 TB 38.00 2.00 TR
+TE
+100.00 18.90 TB 42.00 2.00 TR
+TE
+100.00 18.90 TB 46.00 4.00 TR
+TE
+100.00 18.90 TB 52.00 2.00 TR
+TE
+100.00 18.90 TB 56.00 4.00 TR
+TE
+100.00 18.90 TB 64.00 2.00 TR
+TE
+100.00 18.90 TB 68.00 2.00 TR
+TE
+100.00 18.90 TB 72.00 4.00 TR
+TE
+100.00 18.90 TB 78.00 4.00 TR
+TE
+100.00 18.90 TB 84.00 4.00 TR
+TE
+100.00 18.90 TB 92.00 2.00 TR
+TE
+100.00 18.90 TB 96.00 2.00 TR
+TE
+100.00 18.90 TB 100.00 2.00 TR
+TE
+100.00 18.90 TB 104.00 2.00 TR
+TE
+100.00 18.90 TB 110.00 2.00 TR
+TE
+100.00 18.90 TB 114.00 4.00 TR
+TE
+100.00 18.90 TB 120.00 4.00 TR
+TE
+100.00 18.90 TB 126.00 2.00 TR
+TE
+matrix currentmatrix
+/Helvetica findfont
+14.00 scalefont setfont
+ 0 0 moveto 64.00 4.90 translate 0.00 rotate 0 0 moveto
+ (*123*) stringwidth
+pop
+-2 div 0 rmoveto
+ (*123*) show
+setmatrix
diff -urN zint-2.12.0/backend/tests/data/eps/dbar_ltd_24724_fig7_bold.eps zint/backend/tests/data/eps/dbar_ltd_24724_fig7_bold.eps
--- zint-2.12.0/backend/tests/data/eps/dbar_ltd_24724_fig7_bold.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/dbar_ltd_24724_fig7_bold.eps	2023-05-08 14:39:44.873319417 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 158 119
@@ -61,7 +61,7 @@
 matrix currentmatrix
 /Helvetica-Bold findfont
 14.00 scalefont setfont
- 0 0 moveto 79.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 79.00 4.90 translate 0.00 rotate 0 0 moveto
  (\(01\)15012345678907) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/ean13_2addon_ggs_5.2.2.5.1-2.eps zint/backend/tests/data/eps/ean13_2addon_ggs_5.2.2.5.1-2.eps
--- zint-2.12.0/backend/tests/data/eps/ean13_2addon_ggs_5.2.2.5.1-2.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/ean13_2addon_ggs_5.2.2.5.1-2.eps	2023-05-08 14:39:44.875319429 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 276 117
@@ -9,87 +9,87 @@
 /TE { pop pop } bind def
 newpath
 1.00 1.00 1.00 setrgbcolor
-116.40 0.00 TB 0.00 276.00 TR
+116.90 0.00 TB 0.00 276.00 TR
 TE
 0.00 0.00 0.00 setrgbcolor
-110.00 6.40 TB 22.00 2.00 TR
+110.00 6.90 TB 22.00 2.00 TR
 TE
-110.00 6.40 TB 26.00 2.00 TR
+110.00 6.90 TB 26.00 2.00 TR
 TE
-100.00 16.40 TB 30.00 6.00 TR
+100.00 16.90 TB 30.00 6.00 TR
 TE
-100.00 16.40 TB 38.00 4.00 TR
+100.00 16.90 TB 38.00 4.00 TR
 TE
-100.00 16.40 TB 46.00 2.00 TR
+100.00 16.90 TB 46.00 2.00 TR
 TE
-100.00 16.40 TB 54.00 2.00 TR
+100.00 16.90 TB 54.00 2.00 TR
 TE
-100.00 16.40 TB 58.00 4.00 TR
+100.00 16.90 TB 58.00 4.00 TR
 TE
-100.00 16.40 TB 66.00 4.00 TR
+100.00 16.90 TB 66.00 4.00 TR
 TE
-100.00 16.40 TB 72.00 8.00 TR
+100.00 16.90 TB 72.00 8.00 TR
 TE
-100.00 16.40 TB 82.00 2.00 TR
+100.00 16.90 TB 82.00 2.00 TR
 TE
-100.00 16.40 TB 90.00 2.00 TR
+100.00 16.90 TB 90.00 2.00 TR
 TE
-100.00 16.40 TB 96.00 2.00 TR
+100.00 16.90 TB 96.00 2.00 TR
 TE
-100.00 16.40 TB 100.00 2.00 TR
+100.00 16.90 TB 100.00 2.00 TR
 TE
-100.00 16.40 TB 108.00 4.00 TR
+100.00 16.90 TB 108.00 4.00 TR
 TE
-110.00 6.40 TB 114.00 2.00 TR
+110.00 6.90 TB 114.00 2.00 TR
 TE
-110.00 6.40 TB 118.00 2.00 TR
+110.00 6.90 TB 118.00 2.00 TR
 TE
-100.00 16.40 TB 122.00 2.00 TR
+100.00 16.90 TB 122.00 2.00 TR
 TE
-100.00 16.40 TB 128.00 6.00 TR
+100.00 16.90 TB 128.00 6.00 TR
 TE
-100.00 16.40 TB 136.00 4.00 TR
+100.00 16.90 TB 136.00 4.00 TR
 TE
-100.00 16.40 TB 142.00 4.00 TR
+100.00 16.90 TB 142.00 4.00 TR
 TE
-100.00 16.40 TB 150.00 2.00 TR
+100.00 16.90 TB 150.00 2.00 TR
 TE
-100.00 16.40 TB 154.00 6.00 TR
+100.00 16.90 TB 154.00 6.00 TR
 TE
-100.00 16.40 TB 164.00 6.00 TR
+100.00 16.90 TB 164.00 6.00 TR
 TE
-100.00 16.40 TB 174.00 2.00 TR
+100.00 16.90 TB 174.00 2.00 TR
 TE
-100.00 16.40 TB 178.00 4.00 TR
+100.00 16.90 TB 178.00 4.00 TR
 TE
-100.00 16.40 TB 186.00 4.00 TR
+100.00 16.90 TB 186.00 4.00 TR
 TE
-100.00 16.40 TB 192.00 2.00 TR
+100.00 16.90 TB 192.00 2.00 TR
 TE
-100.00 16.40 TB 200.00 2.00 TR
+100.00 16.90 TB 200.00 2.00 TR
 TE
-110.00 6.40 TB 206.00 2.00 TR
+110.00 6.90 TB 206.00 2.00 TR
 TE
-110.00 6.40 TB 210.00 2.00 TR
+110.00 6.90 TB 210.00 2.00 TR
 TE
-91.00 6.40 TB 226.00 2.00 TR
+93.10 6.90 TB 226.00 2.00 TR
 TE
-91.00 6.40 TB 230.00 4.00 TR
+93.10 6.90 TB 230.00 4.00 TR
 TE
-91.00 6.40 TB 238.00 4.00 TR
+93.10 6.90 TB 238.00 4.00 TR
 TE
-91.00 6.40 TB 246.00 2.00 TR
+93.10 6.90 TB 246.00 2.00 TR
 TE
-91.00 6.40 TB 250.00 2.00 TR
+93.10 6.90 TB 250.00 2.00 TR
 TE
-91.00 6.40 TB 256.00 2.00 TR
+93.10 6.90 TB 256.00 2.00 TR
 TE
-91.00 6.40 TB 262.00 4.00 TR
+93.10 6.90 TB 262.00 4.00 TR
 TE
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 12.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 12.20 0.80 translate 0.00 rotate 0 0 moveto
  (9) stringwidth
 pop
 neg 0 rmoveto
@@ -98,7 +98,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 70.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 71.00 0.80 translate 0.00 rotate 0 0 moveto
  (771384) stringwidth
 pop
 -2 div 0 rmoveto
@@ -107,7 +107,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 164.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 163.00 0.80 translate 0.00 rotate 0 0 moveto
  (524017) stringwidth
 pop
 -2 div 0 rmoveto
@@ -116,7 +116,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 246.00 101.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 246.00 101.90 translate 0.00 rotate 0 0 moveto
  (12) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/ultra_fg_bg.eps zint/backend/tests/data/eps/ultra_fg_bg.eps
--- zint-2.12.0/backend/tests/data/eps/ultra_fg_bg.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/ultra_fg_bg.eps	2023-05-08 14:39:44.875319429 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 28 26
@@ -8,7 +8,7 @@
 /TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill } bind def
 /TE { pop pop } bind def
 newpath
-0.98 0.59 0.19 setrgbcolor
+0.99 0.59 0.19 setrgbcolor
 26.00 0.00 TB 0.00 28.00 TR
 TE
 0.00 1.00 1.00 setrgbcolor
diff -urN zint-2.12.0/backend/tests/data/eps/upca_2addon_ggs_5.2.6.6-5.eps zint/backend/tests/data/eps/upca_2addon_ggs_5.2.6.6-5.eps
--- zint-2.12.0/backend/tests/data/eps/upca_2addon_ggs_5.2.6.6-5.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/upca_2addon_ggs_5.2.6.6-5.eps	2023-05-08 14:39:44.876319435 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 276 117
@@ -9,87 +9,87 @@
 /TE { pop pop } bind def
 newpath
 1.00 1.00 1.00 setrgbcolor
-116.40 0.00 TB 0.00 276.00 TR
+116.90 0.00 TB 0.00 276.00 TR
 TE
 0.00 0.00 0.00 setrgbcolor
-110.00 6.40 TB 18.00 2.00 TR
+110.00 6.90 TB 18.00 2.00 TR
 TE
-110.00 6.40 TB 22.00 2.00 TR
+110.00 6.90 TB 22.00 2.00 TR
 TE
-110.00 6.40 TB 30.00 4.00 TR
+110.00 6.90 TB 30.00 4.00 TR
 TE
-110.00 6.40 TB 36.00 2.00 TR
+110.00 6.90 TB 36.00 2.00 TR
 TE
-100.00 16.40 TB 42.00 4.00 TR
+100.00 16.90 TB 42.00 4.00 TR
 TE
-100.00 16.40 TB 50.00 2.00 TR
+100.00 16.90 TB 50.00 2.00 TR
 TE
-100.00 16.40 TB 56.00 2.00 TR
+100.00 16.90 TB 56.00 2.00 TR
 TE
-100.00 16.40 TB 62.00 4.00 TR
+100.00 16.90 TB 62.00 4.00 TR
 TE
-100.00 16.40 TB 68.00 8.00 TR
+100.00 16.90 TB 68.00 8.00 TR
 TE
-100.00 16.40 TB 78.00 2.00 TR
+100.00 16.90 TB 78.00 2.00 TR
 TE
-100.00 16.40 TB 82.00 2.00 TR
+100.00 16.90 TB 82.00 2.00 TR
 TE
-100.00 16.40 TB 90.00 4.00 TR
+100.00 16.90 TB 90.00 4.00 TR
 TE
-100.00 16.40 TB 96.00 4.00 TR
+100.00 16.90 TB 96.00 4.00 TR
 TE
-100.00 16.40 TB 106.00 2.00 TR
+100.00 16.90 TB 106.00 2.00 TR
 TE
-110.00 6.40 TB 110.00 2.00 TR
+110.00 6.90 TB 110.00 2.00 TR
 TE
-110.00 6.40 TB 114.00 2.00 TR
+110.00 6.90 TB 114.00 2.00 TR
 TE
-100.00 16.40 TB 118.00 2.00 TR
+100.00 16.90 TB 118.00 2.00 TR
 TE
-100.00 16.40 TB 122.00 2.00 TR
+100.00 16.90 TB 122.00 2.00 TR
 TE
-100.00 16.40 TB 132.00 2.00 TR
+100.00 16.90 TB 132.00 2.00 TR
 TE
-100.00 16.40 TB 140.00 2.00 TR
+100.00 16.90 TB 140.00 2.00 TR
 TE
-100.00 16.40 TB 146.00 2.00 TR
+100.00 16.90 TB 146.00 2.00 TR
 TE
-100.00 16.40 TB 152.00 2.00 TR
+100.00 16.90 TB 152.00 2.00 TR
 TE
-100.00 16.40 TB 160.00 6.00 TR
+100.00 16.90 TB 160.00 6.00 TR
 TE
-100.00 16.40 TB 168.00 2.00 TR
+100.00 16.90 TB 168.00 2.00 TR
 TE
-100.00 16.40 TB 174.00 6.00 TR
+100.00 16.90 TB 174.00 6.00 TR
 TE
-100.00 16.40 TB 184.00 2.00 TR
+100.00 16.90 TB 184.00 2.00 TR
 TE
-110.00 6.40 TB 188.00 2.00 TR
+110.00 6.90 TB 188.00 2.00 TR
 TE
-110.00 6.40 TB 194.00 6.00 TR
+110.00 6.90 TB 194.00 6.00 TR
 TE
-110.00 6.40 TB 202.00 2.00 TR
+110.00 6.90 TB 202.00 2.00 TR
 TE
-110.00 6.40 TB 206.00 2.00 TR
+110.00 6.90 TB 206.00 2.00 TR
 TE
-81.00 16.40 TB 226.00 2.00 TR
+83.10 16.90 TB 226.00 2.00 TR
 TE
-81.00 16.40 TB 230.00 4.00 TR
+83.10 16.90 TB 230.00 4.00 TR
 TE
-81.00 16.40 TB 238.00 2.00 TR
+83.10 16.90 TB 238.00 2.00 TR
 TE
-81.00 16.40 TB 244.00 4.00 TR
+83.10 16.90 TB 244.00 4.00 TR
 TE
-81.00 16.40 TB 250.00 2.00 TR
+83.10 16.90 TB 250.00 2.00 TR
 TE
-81.00 16.40 TB 254.00 2.00 TR
+83.10 16.90 TB 254.00 2.00 TR
 TE
-81.00 16.40 TB 262.00 4.00 TR
+83.10 16.90 TB 262.00 4.00 TR
 TE
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 8.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 8.70 0.80 translate 0.00 rotate 0 0 moveto
  (0) stringwidth
 pop
 neg 0 rmoveto
@@ -98,7 +98,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 72.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 74.00 0.80 translate 0.00 rotate 0 0 moveto
  (12345) stringwidth
 pop
 -2 div 0 rmoveto
@@ -107,7 +107,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 152.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 152.00 0.80 translate 0.00 rotate 0 0 moveto
  (67890) stringwidth
 pop
 -2 div 0 rmoveto
@@ -116,13 +116,13 @@
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 218.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 217.30 0.80 translate 0.00 rotate 0 0 moveto
  (5) show
 setmatrix
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 246.00 101.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 246.00 101.90 translate 0.00 rotate 0 0 moveto
  (24) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/upce_5addon.eps zint/backend/tests/data/eps/upce_5addon.eps
--- zint-2.12.0/backend/tests/data/eps/upce_5addon.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/upce_5addon.eps	2023-05-08 14:39:44.876319435 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 238 117
@@ -9,79 +9,79 @@
 /TE { pop pop } bind def
 newpath
 1.00 1.00 1.00 setrgbcolor
-116.40 0.00 TB 0.00 238.00 TR
+116.90 0.00 TB 0.00 238.00 TR
 TE
 0.00 0.00 0.00 setrgbcolor
-110.00 6.40 TB 18.00 2.00 TR
+110.00 6.90 TB 18.00 2.00 TR
 TE
-110.00 6.40 TB 22.00 2.00 TR
+110.00 6.90 TB 22.00 2.00 TR
 TE
-100.00 16.40 TB 26.00 4.00 TR
+100.00 16.90 TB 26.00 4.00 TR
 TE
-100.00 16.40 TB 34.00 4.00 TR
+100.00 16.90 TB 34.00 4.00 TR
 TE
-100.00 16.40 TB 42.00 2.00 TR
+100.00 16.90 TB 42.00 2.00 TR
 TE
-100.00 16.40 TB 48.00 4.00 TR
+100.00 16.90 TB 48.00 4.00 TR
 TE
-100.00 16.40 TB 54.00 8.00 TR
+100.00 16.90 TB 54.00 8.00 TR
 TE
-100.00 16.40 TB 64.00 2.00 TR
+100.00 16.90 TB 64.00 2.00 TR
 TE
-100.00 16.40 TB 70.00 6.00 TR
+100.00 16.90 TB 70.00 6.00 TR
 TE
-100.00 16.40 TB 78.00 2.00 TR
+100.00 16.90 TB 78.00 2.00 TR
 TE
-100.00 16.40 TB 82.00 6.00 TR
+100.00 16.90 TB 82.00 6.00 TR
 TE
-100.00 16.40 TB 92.00 2.00 TR
+100.00 16.90 TB 92.00 2.00 TR
 TE
-100.00 16.40 TB 96.00 2.00 TR
+100.00 16.90 TB 96.00 2.00 TR
 TE
-100.00 16.40 TB 100.00 8.00 TR
+100.00 16.90 TB 100.00 8.00 TR
 TE
-110.00 6.40 TB 110.00 2.00 TR
+110.00 6.90 TB 110.00 2.00 TR
 TE
-110.00 6.40 TB 114.00 2.00 TR
+110.00 6.90 TB 114.00 2.00 TR
 TE
-110.00 6.40 TB 118.00 2.00 TR
+110.00 6.90 TB 118.00 2.00 TR
 TE
-81.00 16.40 TB 134.00 2.00 TR
+83.10 16.90 TB 134.00 2.00 TR
 TE
-81.00 16.40 TB 138.00 4.00 TR
+83.10 16.90 TB 138.00 4.00 TR
 TE
-81.00 16.40 TB 144.00 4.00 TR
+83.10 16.90 TB 144.00 4.00 TR
 TE
-81.00 16.40 TB 152.00 4.00 TR
+83.10 16.90 TB 152.00 4.00 TR
 TE
-81.00 16.40 TB 158.00 2.00 TR
+83.10 16.90 TB 158.00 2.00 TR
 TE
-81.00 16.40 TB 164.00 2.00 TR
+83.10 16.90 TB 164.00 2.00 TR
 TE
-81.00 16.40 TB 170.00 4.00 TR
+83.10 16.90 TB 170.00 4.00 TR
 TE
-81.00 16.40 TB 176.00 2.00 TR
+83.10 16.90 TB 176.00 2.00 TR
 TE
-81.00 16.40 TB 180.00 2.00 TR
+83.10 16.90 TB 180.00 2.00 TR
 TE
-81.00 16.40 TB 190.00 2.00 TR
+83.10 16.90 TB 190.00 2.00 TR
 TE
-81.00 16.40 TB 194.00 2.00 TR
+83.10 16.90 TB 194.00 2.00 TR
 TE
-81.00 16.40 TB 198.00 2.00 TR
+83.10 16.90 TB 198.00 2.00 TR
 TE
-81.00 16.40 TB 206.00 4.00 TR
+83.10 16.90 TB 206.00 4.00 TR
 TE
-81.00 16.40 TB 212.00 2.00 TR
+83.10 16.90 TB 212.00 2.00 TR
 TE
-81.00 16.40 TB 216.00 4.00 TR
+83.10 16.90 TB 216.00 4.00 TR
 TE
-81.00 16.40 TB 226.00 2.00 TR
+83.10 16.90 TB 226.00 2.00 TR
 TE
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 8.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 8.70 0.80 translate 0.00 rotate 0 0 moveto
  (0) stringwidth
 pop
 neg 0 rmoveto
@@ -90,7 +90,7 @@
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 66.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 67.00 0.80 translate 0.00 rotate 0 0 moveto
  (123456) stringwidth
 pop
 -2 div 0 rmoveto
@@ -99,13 +99,13 @@
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 126.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 125.30 0.80 translate 0.00 rotate 0 0 moveto
  (5) show
 setmatrix
 matrix currentmatrix
 /Helvetica findfont
 20.00 scalefont setfont
- 0 0 moveto 182.00 101.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 182.00 101.90 translate 0.00 rotate 0 0 moveto
  (12345) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/eps/upce_5addon_small_bold.eps zint/backend/tests/data/eps/upce_5addon_small_bold.eps
--- zint-2.12.0/backend/tests/data/eps/upce_5addon_small_bold.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/eps/upce_5addon_small_bold.eps	2023-05-08 14:39:44.876319435 +0200
@@ -1,111 +1,111 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
-%%BoundingBox: 0 0 238 112
+%%BoundingBox: 0 0 238 113
 %%EndComments
 /TB { 2 copy } bind def
 /TR { newpath 4 1 roll exch moveto 1 index 0 rlineto 0 exch rlineto neg 0 rlineto closepath fill } bind def
 /TE { pop pop } bind def
 newpath
 1.00 1.00 1.00 setrgbcolor
-111.90 0.00 TB 0.00 238.00 TR
+112.28 0.00 TB 0.00 238.00 TR
 TE
 0.00 0.00 0.00 setrgbcolor
-110.00 1.90 TB 18.00 2.00 TR
+110.00 2.28 TB 18.00 2.00 TR
 TE
-110.00 1.90 TB 22.00 2.00 TR
+110.00 2.28 TB 22.00 2.00 TR
 TE
-100.00 11.90 TB 26.00 4.00 TR
+100.00 12.28 TB 26.00 4.00 TR
 TE
-100.00 11.90 TB 34.00 4.00 TR
+100.00 12.28 TB 34.00 4.00 TR
 TE
-100.00 11.90 TB 42.00 2.00 TR
+100.00 12.28 TB 42.00 2.00 TR
 TE
-100.00 11.90 TB 48.00 4.00 TR
+100.00 12.28 TB 48.00 4.00 TR
 TE
-100.00 11.90 TB 54.00 8.00 TR
+100.00 12.28 TB 54.00 8.00 TR
 TE
-100.00 11.90 TB 64.00 2.00 TR
+100.00 12.28 TB 64.00 2.00 TR
 TE
-100.00 11.90 TB 70.00 6.00 TR
+100.00 12.28 TB 70.00 6.00 TR
 TE
-100.00 11.90 TB 78.00 2.00 TR
+100.00 12.28 TB 78.00 2.00 TR
 TE
-100.00 11.90 TB 82.00 6.00 TR
+100.00 12.28 TB 82.00 6.00 TR
 TE
-100.00 11.90 TB 92.00 2.00 TR
+100.00 12.28 TB 92.00 2.00 TR
 TE
-100.00 11.90 TB 96.00 2.00 TR
+100.00 12.28 TB 96.00 2.00 TR
 TE
-100.00 11.90 TB 100.00 8.00 TR
+100.00 12.28 TB 100.00 8.00 TR
 TE
-110.00 1.90 TB 110.00 2.00 TR
+110.00 2.28 TB 110.00 2.00 TR
 TE
-110.00 1.90 TB 114.00 2.00 TR
+110.00 2.28 TB 114.00 2.00 TR
 TE
-110.00 1.90 TB 118.00 2.00 TR
+110.00 2.28 TB 118.00 2.00 TR
 TE
-87.00 11.90 TB 134.00 2.00 TR
+87.72 12.28 TB 134.00 2.00 TR
 TE
-87.00 11.90 TB 138.00 4.00 TR
+87.72 12.28 TB 138.00 4.00 TR
 TE
-87.00 11.90 TB 144.00 4.00 TR
+87.72 12.28 TB 144.00 4.00 TR
 TE
-87.00 11.90 TB 152.00 4.00 TR
+87.72 12.28 TB 152.00 4.00 TR
 TE
-87.00 11.90 TB 158.00 2.00 TR
+87.72 12.28 TB 158.00 2.00 TR
 TE
-87.00 11.90 TB 164.00 2.00 TR
+87.72 12.28 TB 164.00 2.00 TR
 TE
-87.00 11.90 TB 170.00 4.00 TR
+87.72 12.28 TB 170.00 4.00 TR
 TE
-87.00 11.90 TB 176.00 2.00 TR
+87.72 12.28 TB 176.00 2.00 TR
 TE
-87.00 11.90 TB 180.00 2.00 TR
+87.72 12.28 TB 180.00 2.00 TR
 TE
-87.00 11.90 TB 190.00 2.00 TR
+87.72 12.28 TB 190.00 2.00 TR
 TE
-87.00 11.90 TB 194.00 2.00 TR
+87.72 12.28 TB 194.00 2.00 TR
 TE
-87.00 11.90 TB 198.00 2.00 TR
+87.72 12.28 TB 198.00 2.00 TR
 TE
-87.00 11.90 TB 206.00 4.00 TR
+87.72 12.28 TB 206.00 4.00 TR
 TE
-87.00 11.90 TB 212.00 2.00 TR
+87.72 12.28 TB 212.00 2.00 TR
 TE
-87.00 11.90 TB 216.00 4.00 TR
+87.72 12.28 TB 216.00 4.00 TR
 TE
-87.00 11.90 TB 226.00 2.00 TR
+87.72 12.28 TB 226.00 2.00 TR
 TE
 matrix currentmatrix
-/Helvetica-Bold findfont
+/Helvetica findfont
 12.00 scalefont setfont
- 0 0 moveto 8.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 8.70 0.56 translate 0.00 rotate 0 0 moveto
  (0) stringwidth
 pop
 neg 0 rmoveto
  (0) show
 setmatrix
 matrix currentmatrix
-/Helvetica-Bold findfont
+/Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 66.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 67.00 0.56 translate 0.00 rotate 0 0 moveto
  (123456) stringwidth
 pop
 -2 div 0 rmoveto
  (123456) show
 setmatrix
 matrix currentmatrix
-/Helvetica-Bold findfont
+/Helvetica findfont
 12.00 scalefont setfont
- 0 0 moveto 126.00 0.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 125.30 0.56 translate 0.00 rotate 0 0 moveto
  (5) show
 setmatrix
 matrix currentmatrix
-/Helvetica-Bold findfont
+/Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 182.00 101.40 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 182.00 101.78 translate 0.00 rotate 0 0 moveto
  (12345) stringwidth
 pop
 -2 div 0 rmoveto
Binary files zint-2.12.0/backend/tests/data/gif/dotcode_bgtrans.gif and zint/backend/tests/data/gif/dotcode_bgtrans.gif differ
Binary files zint-2.12.0/backend/tests/data/gif/dotcode_cmyk_fg.gif and zint/backend/tests/data/gif/dotcode_cmyk_fg.gif differ
Binary files zint-2.12.0/backend/tests/data/gif/dotcode_fgtrans.gif and zint/backend/tests/data/gif/dotcode_fgtrans.gif differ
Binary files zint-2.12.0/backend/tests/data/pcx/code11_fgbgtrans.pcx and zint/backend/tests/data/pcx/code11_fgbgtrans.pcx differ
Binary files zint-2.12.0/backend/tests/data/png/channel_cmyk_nobg.png and zint/backend/tests/data/png/channel_cmyk_nobg.png differ
Binary files zint-2.12.0/backend/tests/data/print/emf/code128_aim.emf and zint/backend/tests/data/print/emf/code128_aim.emf differ
diff -urN zint-2.12.0/backend/tests/data/print/eps/code128_aim.eps zint/backend/tests/data/print/eps/code128_aim.eps
--- zint-2.12.0/backend/tests/data/print/eps/code128_aim.eps	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/print/eps/code128_aim.eps	2023-05-08 14:39:44.895319547 +0200
@@ -1,5 +1,5 @@
 %!PS-Adobe-3.0 EPSF-3.0
-%%Creator: Zint 2.10.0.9
+%%Creator: Zint 2.12.0.9
 %%Title: Zint Generated Symbol
 %%Pages: 0
 %%BoundingBox: 0 0 136 119
@@ -53,7 +53,7 @@
 matrix currentmatrix
 /Helvetica findfont
 14.00 scalefont setfont
- 0 0 moveto 68.00 3.50 translate 0.00 rotate 0 0 moveto
+ 0 0 moveto 68.00 4.90 translate 0.00 rotate 0 0 moveto
  (AIM) stringwidth
 pop
 -2 div 0 rmoveto
diff -urN zint-2.12.0/backend/tests/data/print/svg/code128_aim.svg zint/backend/tests/data/print/svg/code128_aim.svg
--- zint-2.12.0/backend/tests/data/print/svg/code128_aim.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/print/svg/code128_aim.svg	2023-05-08 14:39:44.897319559 +0200
@@ -27,7 +27,7 @@
       <rect x="120.00" y="0.00" width="6.00" height="100.00" />
       <rect x="128.00" y="0.00" width="2.00" height="100.00" />
       <rect x="132.00" y="0.00" width="4.00" height="100.00" />
-      <text x="68.00" y="115.40" text-anchor="middle"
+      <text x="68.00" y="114.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          AIM
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/channel_cmyk_nobg.svg zint/backend/tests/data/svg/channel_cmyk_nobg.svg
--- zint-2.12.0/backend/tests/data/svg/channel_cmyk_nobg.svg	1970-01-01 01:00:00.000000000 +0100
+++ zint/backend/tests/data/svg/channel_cmyk_nobg.svg	2023-05-08 14:39:44.899319570 +0200
@@ -0,0 +1,24 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+   "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<svg width="46" height="59" version="1.1"
+   xmlns="http://www.w3.org/2000/svg">
+   <desc>Zint Generated Symbol
+   </desc>
+
+   <g id="barcode" fill="#001FCC">
+      <rect x="0.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="4.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="8.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="12.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="16.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="22.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="26.00" y="0.00" width="6.00" height="40.00" />
+      <rect x="38.00" y="0.00" width="2.00" height="40.00" />
+      <rect x="42.00" y="0.00" width="4.00" height="40.00" />
+      <text x="23.00" y="54.00" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="14.0" >
+         123
+      </text>
+   </g>
+</svg>
diff -urN zint-2.12.0/backend/tests/data/svg/code128_amperands.svg zint/backend/tests/data/svg/code128_amperands.svg
--- zint-2.12.0/backend/tests/data/svg/code128_amperands.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code128_amperands.svg	2023-05-08 14:39:44.899319570 +0200
@@ -33,7 +33,7 @@
       <rect x="164.00" y="0.00" width="6.00" height="100.00" />
       <rect x="172.00" y="0.00" width="2.00" height="100.00" />
       <rect x="176.00" y="0.00" width="4.00" height="100.00" />
-      <text x="90.00" y="115.40" text-anchor="middle"
+      <text x="90.00" y="114.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          &lt;&gt;&quot;&amp;&apos;
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_box3.svg zint/backend/tests/data/svg/code128_egrave_bold_box3.svg
--- zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_box3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code128_egrave_bold_box3.svg	2023-05-08 14:39:44.900319576 +0200
@@ -43,7 +43,7 @@
       <rect x="0.00" y="106.00" width="236.00" height="6.00" />
       <rect x="0.00" y="6.00" width="6.00" height="100.00" />
       <rect x="230.00" y="6.00" width="6.00" height="100.00" />
-      <text x="118.00" y="127.40" text-anchor="middle"
+      <text x="118.00" y="126.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
          Ãgjpqy
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_hvwsp2_box2.svg zint/backend/tests/data/svg/code128_egrave_bold_hvwsp2_box2.svg
--- zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_hvwsp2_box2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code128_egrave_bold_hvwsp2_box2.svg	2023-05-08 14:39:44.900319576 +0200
@@ -43,7 +43,7 @@
       <rect x="0.00" y="108.00" width="240.00" height="4.00" />
       <rect x="0.00" y="8.00" width="4.00" height="100.00" />
       <rect x="236.00" y="8.00" width="4.00" height="100.00" />
-      <text x="120.00" y="127.40" text-anchor="middle"
+      <text x="120.00" y="126.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
          Ãgjpqy
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_hvwsp3.svg zint/backend/tests/data/svg/code128_egrave_bold_hvwsp3.svg
--- zint-2.12.0/backend/tests/data/svg/code128_egrave_bold_hvwsp3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code128_egrave_bold_hvwsp3.svg	2023-05-08 14:39:44.900319576 +0200
@@ -39,7 +39,7 @@
       <rect x="214.00" y="6.00" width="6.00" height="100.00" />
       <rect x="222.00" y="6.00" width="2.00" height="100.00" />
       <rect x="226.00" y="6.00" width="4.00" height="100.00" />
-      <text x="118.00" y="121.40" text-anchor="middle"
+      <text x="118.00" y="120.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
          Ãgjpqy
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/code128_egrave_bold.svg zint/backend/tests/data/svg/code128_egrave_bold.svg
--- zint-2.12.0/backend/tests/data/svg/code128_egrave_bold.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code128_egrave_bold.svg	2023-05-08 14:39:44.900319576 +0200
@@ -39,7 +39,7 @@
       <rect x="208.00" y="0.00" width="6.00" height="100.00" />
       <rect x="216.00" y="0.00" width="2.00" height="100.00" />
       <rect x="220.00" y="0.00" width="4.00" height="100.00" />
-      <text x="112.00" y="115.40" text-anchor="middle"
+      <text x="112.00" y="114.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
          Ãgjpqy
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/code39_small.svg zint/backend/tests/data/svg/code39_small.svg
--- zint-2.12.0/backend/tests/data/svg/code39_small.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/code39_small.svg	2023-05-08 14:39:44.900319576 +0200
@@ -33,7 +33,7 @@
       <rect x="114.00" y="0.00" width="4.00" height="100.00" />
       <rect x="120.00" y="0.00" width="4.00" height="100.00" />
       <rect x="126.00" y="0.00" width="2.00" height="100.00" />
-      <text x="64.00" y="113.20" text-anchor="middle"
+      <text x="64.00" y="112.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="12.0" >
          *123*
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/dbar_ltd.svg zint/backend/tests/data/svg/dbar_ltd.svg
--- zint-2.12.0/backend/tests/data/svg/dbar_ltd.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/dbar_ltd.svg	2023-05-08 14:39:44.901319582 +0200
@@ -31,7 +31,7 @@
       <rect x="132.00" y="0.00" width="4.00" height="100.00" />
       <rect x="138.00" y="0.00" width="6.00" height="100.00" />
       <rect x="146.00" y="0.00" width="2.00" height="100.00" />
-      <text x="79.00" y="115.40" text-anchor="middle"
+      <text x="79.00" y="114.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          (01)00123456789098
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/dpd_compliant.svg zint/backend/tests/data/svg/dpd_compliant.svg
--- zint-2.12.0/backend/tests/data/svg/dpd_compliant.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/dpd_compliant.svg	2023-05-08 14:39:44.901319582 +0200
@@ -67,7 +67,7 @@
       <rect x="439.00" y="6.00" width="2.00" height="133.33" />
       <rect x="443.00" y="6.00" width="4.00" height="133.33" />
       <rect x="25.00" y="0.00" width="422.00" height="6.00" />
-      <text x="236.00" y="154.73" text-anchor="middle"
+      <text x="236.00" y="153.33" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0081 827 0998 0000 0200 28 101 276 B
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean13_2addon_ggs_5.2.2.5.1-2.svg zint/backend/tests/data/svg/ean13_2addon_ggs_5.2.2.5.1-2.svg
--- zint-2.12.0/backend/tests/data/svg/ean13_2addon_ggs_5.2.2.5.1-2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean13_2addon_ggs_5.2.2.5.1-2.svg	2023-05-08 14:39:44.901319582 +0200
@@ -38,22 +38,22 @@
       <rect x="200.00" y="0.00" width="2.00" height="100.00" />
       <rect x="206.00" y="0.00" width="2.00" height="110.00" />
       <rect x="210.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="230.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="238.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="246.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="250.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="256.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="262.00" y="19.00" width="4.00" height="91.00" />
-      <text x="12.00" y="116.00" text-anchor="end"
+      <rect x="226.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="230.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="238.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="246.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="250.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="256.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="262.00" y="16.90" width="4.00" height="93.10" />
+      <text x="12.20" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          9
       </text>
-      <text x="70.00" y="116.00" text-anchor="middle"
+      <text x="71.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          771384
       </text>
-      <text x="164.00" y="116.00" text-anchor="middle"
+      <text x="163.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          524017
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean13_5addon_ggs_5.2.2.5.2-2.svg zint/backend/tests/data/svg/ean13_5addon_ggs_5.2.2.5.2-2.svg
--- zint-2.12.0/backend/tests/data/svg/ean13_5addon_ggs_5.2.2.5.2-2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean13_5addon_ggs_5.2.2.5.2-2.svg	2023-05-08 14:39:44.901319582 +0200
@@ -38,31 +38,31 @@
       <rect x="196.00" y="0.00" width="2.00" height="100.00" />
       <rect x="206.00" y="0.00" width="2.00" height="110.00" />
       <rect x="210.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="230.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="236.00" y="19.00" width="6.00" height="91.00" />
-      <rect x="246.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="250.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="254.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="262.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="268.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="272.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="282.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="286.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="292.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="298.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="304.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="310.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="318.00" y="19.00" width="2.00" height="91.00" />
-      <text x="12.00" y="116.00" text-anchor="end"
+      <rect x="226.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="230.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="236.00" y="16.90" width="6.00" height="93.10" />
+      <rect x="246.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="250.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="254.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="262.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="268.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="272.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="282.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="286.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="292.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="298.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="304.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="310.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="318.00" y="16.90" width="2.00" height="93.10" />
+      <text x="12.20" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          9
       </text>
-      <text x="70.00" y="116.00" text-anchor="middle"
+      <text x="71.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          780877
       </text>
-      <text x="164.00" y="116.00" text-anchor="middle"
+      <text x="163.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          799306
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean13_cc_2addon_cca_4x4.svg zint/backend/tests/data/svg/ean13_cc_2addon_cca_4x4.svg
--- zint-2.12.0/backend/tests/data/svg/ean13_cc_2addon_cca_4x4.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean13_cc_2addon_cca_4x4.svg	2023-05-08 14:39:44.901319582 +0200
@@ -120,22 +120,22 @@
       <rect x="198.00" y="28.00" width="2.00" height="72.00" />
       <rect x="204.00" y="28.00" width="2.00" height="72.00" />
       <rect x="212.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="236.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="244.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="252.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="256.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="262.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="268.00" y="47.00" width="4.00" height="63.00" />
-      <text x="18.00" y="116.00" text-anchor="end"
+      <rect x="232.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="236.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="244.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="252.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="256.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="262.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="268.00" y="44.90" width="4.00" height="65.10" />
+      <text x="18.20" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          1
       </text>
-      <text x="76.00" y="116.00" text-anchor="middle"
+      <text x="77.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          234567
       </text>
-      <text x="170.00" y="116.00" text-anchor="middle"
+      <text x="169.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          890128
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4_notext.svg zint/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4_notext.svg
--- zint-2.12.0/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4_notext.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4_notext.svg	2023-05-08 14:39:44.901319582 +0200
@@ -118,21 +118,21 @@
       <rect x="198.00" y="28.00" width="2.00" height="72.00" />
       <rect x="204.00" y="28.00" width="2.00" height="72.00" />
       <rect x="212.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="236.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="242.00" y="47.00" width="6.00" height="63.00" />
-      <rect x="252.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="256.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="260.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="268.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="274.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="278.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="288.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="292.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="298.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="304.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="310.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="316.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="324.00" y="47.00" width="2.00" height="63.00" />
+      <rect x="232.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="236.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="242.00" y="44.90" width="6.00" height="65.10" />
+      <rect x="252.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="256.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="260.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="268.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="274.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="278.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="288.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="292.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="298.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="304.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="310.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="316.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="324.00" y="44.90" width="2.00" height="65.10" />
    </g>
 </svg>
diff -urN zint-2.12.0/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4.svg zint/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4.svg
--- zint-2.12.0/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean13_cc_5addon_ccb_3x4.svg	2023-05-08 14:39:44.901319582 +0200
@@ -118,31 +118,31 @@
       <rect x="198.00" y="28.00" width="2.00" height="72.00" />
       <rect x="204.00" y="28.00" width="2.00" height="72.00" />
       <rect x="212.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="236.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="242.00" y="47.00" width="6.00" height="63.00" />
-      <rect x="252.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="256.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="260.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="268.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="274.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="278.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="288.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="292.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="298.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="304.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="310.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="316.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="324.00" y="47.00" width="2.00" height="63.00" />
-      <text x="18.00" y="116.00" text-anchor="end"
+      <rect x="232.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="236.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="242.00" y="44.90" width="6.00" height="65.10" />
+      <rect x="252.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="256.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="260.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="268.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="274.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="278.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="288.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="292.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="298.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="304.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="310.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="316.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="324.00" y="44.90" width="2.00" height="65.10" />
+      <text x="18.20" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          1
       </text>
-      <text x="76.00" y="116.00" text-anchor="middle"
+      <text x="77.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          234567
       </text>
-      <text x="170.00" y="116.00" text-anchor="middle"
+      <text x="169.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          890128
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean2.svg zint/backend/tests/data/svg/ean2.svg
--- zint-2.12.0/backend/tests/data/svg/ean2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean2.svg	2023-05-08 14:39:44.901319582 +0200
@@ -15,7 +15,7 @@
       <rect x="38.00" y="0.00" width="2.00" height="100.00" />
       <rect x="44.00" y="0.00" width="2.00" height="100.00" />
       <rect x="50.00" y="0.00" width="4.00" height="100.00" />
-      <text x="34.00" y="116.00" text-anchor="middle"
+      <text x="34.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          12
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean5.svg zint/backend/tests/data/svg/ean5.svg
--- zint-2.12.0/backend/tests/data/svg/ean5.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean5.svg	2023-05-08 14:39:44.902319588 +0200
@@ -24,7 +24,7 @@
       <rect x="92.00" y="0.00" width="2.00" height="100.00" />
       <rect x="96.00" y="0.00" width="4.00" height="100.00" />
       <rect x="106.00" y="0.00" width="2.00" height="100.00" />
-      <text x="61.00" y="116.00" text-anchor="middle"
+      <text x="61.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          12345
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean8_2addon.svg zint/backend/tests/data/svg/ean8_2addon.svg
--- zint-2.12.0/backend/tests/data/svg/ean8_2addon.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean8_2addon.svg	2023-05-08 14:39:44.902319588 +0200
@@ -30,18 +30,18 @@
       <rect x="138.00" y="0.00" width="2.00" height="100.00" />
       <rect x="142.00" y="0.00" width="2.00" height="110.00" />
       <rect x="146.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="162.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="166.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="174.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="182.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="186.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="192.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="198.00" y="19.00" width="4.00" height="91.00" />
-      <text x="48.00" y="116.00" text-anchor="middle"
+      <rect x="162.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="166.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="174.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="182.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="186.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="192.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="198.00" y="16.90" width="4.00" height="93.10" />
+      <text x="49.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          1234
       </text>
-      <text x="114.00" y="116.00" text-anchor="middle"
+      <text x="113.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          5670
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean8_5addon.svg zint/backend/tests/data/svg/ean8_5addon.svg
--- zint-2.12.0/backend/tests/data/svg/ean8_5addon.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean8_5addon.svg	2023-05-08 14:39:44.902319588 +0200
@@ -30,27 +30,27 @@
       <rect x="138.00" y="0.00" width="2.00" height="100.00" />
       <rect x="142.00" y="0.00" width="2.00" height="110.00" />
       <rect x="146.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="162.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="166.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="172.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="180.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="186.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="192.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="198.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="204.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="208.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="218.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="222.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="234.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="240.00" y="19.00" width="2.00" height="91.00" />
-      <rect x="244.00" y="19.00" width="4.00" height="91.00" />
-      <rect x="254.00" y="19.00" width="2.00" height="91.00" />
-      <text x="48.00" y="116.00" text-anchor="middle"
+      <rect x="162.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="166.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="172.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="180.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="186.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="192.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="198.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="204.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="208.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="218.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="222.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="226.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="234.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="240.00" y="16.90" width="2.00" height="93.10" />
+      <rect x="244.00" y="16.90" width="4.00" height="93.10" />
+      <rect x="254.00" y="16.90" width="2.00" height="93.10" />
+      <text x="49.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          1234
       </text>
-      <text x="114.00" y="116.00" text-anchor="middle"
+      <text x="113.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          5670
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean8_cc_2addon_cca_4x3.svg zint/backend/tests/data/svg/ean8_cc_2addon_cca_4x3.svg
--- zint-2.12.0/backend/tests/data/svg/ean8_cc_2addon_cca_4x3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean8_cc_2addon_cca_4x3.svg	2023-05-08 14:39:44.902319588 +0200
@@ -93,18 +93,18 @@
       <rect x="136.00" y="28.00" width="6.00" height="72.00" />
       <rect x="146.00" y="28.00" width="2.00" height="72.00" />
       <rect x="150.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="170.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="174.00" y="47.00" width="4.00" height="63.00" />
-      <rect x="180.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="184.00" y="47.00" width="8.00" height="63.00" />
-      <rect x="194.00" y="47.00" width="2.00" height="63.00" />
-      <rect x="198.00" y="47.00" width="6.00" height="63.00" />
-      <rect x="208.00" y="47.00" width="2.00" height="63.00" />
-      <text x="56.00" y="116.00" text-anchor="middle"
+      <rect x="170.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="174.00" y="44.90" width="4.00" height="65.10" />
+      <rect x="180.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="184.00" y="44.90" width="8.00" height="65.10" />
+      <rect x="194.00" y="44.90" width="2.00" height="65.10" />
+      <rect x="198.00" y="44.90" width="6.00" height="65.10" />
+      <rect x="208.00" y="44.90" width="2.00" height="65.10" />
+      <text x="57.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          9876
       </text>
-      <text x="122.00" y="116.00" text-anchor="middle"
+      <text x="121.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          5430
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/ean8_cc_5addon_ccb_8x3.svg zint/backend/tests/data/svg/ean8_cc_5addon_ccb_8x3.svg
--- zint-2.12.0/backend/tests/data/svg/ean8_cc_5addon_ccb_8x3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/ean8_cc_5addon_ccb_8x3.svg	2023-05-08 14:39:44.902319588 +0200
@@ -150,27 +150,27 @@
       <rect x="156.00" y="44.00" width="6.00" height="56.00" />
       <rect x="166.00" y="44.00" width="2.00" height="56.00" />
       <rect x="170.00" y="44.00" width="2.00" height="66.00" />
-      <rect x="190.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="194.00" y="63.00" width="4.00" height="47.00" />
-      <rect x="200.00" y="63.00" width="6.00" height="47.00" />
-      <rect x="208.00" y="63.00" width="4.00" height="47.00" />
-      <rect x="214.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="220.00" y="63.00" width="6.00" height="47.00" />
-      <rect x="228.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="232.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="240.00" y="63.00" width="4.00" height="47.00" />
-      <rect x="246.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="250.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="254.00" y="63.00" width="4.00" height="47.00" />
-      <rect x="260.00" y="63.00" width="6.00" height="47.00" />
-      <rect x="268.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="272.00" y="63.00" width="2.00" height="47.00" />
-      <rect x="282.00" y="63.00" width="2.00" height="47.00" />
-      <text x="76.00" y="116.00" text-anchor="middle"
+      <rect x="190.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="194.00" y="60.90" width="4.00" height="49.10" />
+      <rect x="200.00" y="60.90" width="6.00" height="49.10" />
+      <rect x="208.00" y="60.90" width="4.00" height="49.10" />
+      <rect x="214.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="220.00" y="60.90" width="6.00" height="49.10" />
+      <rect x="228.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="232.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="240.00" y="60.90" width="4.00" height="49.10" />
+      <rect x="246.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="250.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="254.00" y="60.90" width="4.00" height="49.10" />
+      <rect x="260.00" y="60.90" width="6.00" height="49.10" />
+      <rect x="268.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="272.00" y="60.90" width="2.00" height="49.10" />
+      <rect x="282.00" y="60.90" width="2.00" height="49.10" />
+      <text x="77.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          9876
       </text>
-      <text x="142.00" y="116.00" text-anchor="middle"
+      <text x="141.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          5430
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/gs1_128_cc_fig12.svg zint/backend/tests/data/svg/gs1_128_cc_fig12.svg
--- zint-2.12.0/backend/tests/data/svg/gs1_128_cc_fig12.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/gs1_128_cc_fig12.svg	2023-05-08 14:39:44.902319588 +0200
@@ -244,7 +244,7 @@
       <rect x="332.00" y="32.00" width="6.00" height="68.00" />
       <rect x="340.00" y="32.00" width="2.00" height="68.00" />
       <rect x="344.00" y="32.00" width="4.00" height="68.00" />
-      <text x="174.00" y="115.40" text-anchor="middle"
+      <text x="174.00" y="114.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          (00)030123456789012340
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/telepen_height0.4_rotate_180.svg zint/backend/tests/data/svg/telepen_height0.4_rotate_180.svg
--- zint-2.12.0/backend/tests/data/svg/telepen_height0.4_rotate_180.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/telepen_height0.4_rotate_180.svg	2023-05-08 14:39:44.904319600 +0200
@@ -30,8 +30,8 @@
       <rect x="10.00" y="18.90" width="2.00" height="1.00" />
       <rect x="6.00" y="18.90" width="2.00" height="1.00" />
       <rect x="2.00" y="18.90" width="2.00" height="1.00" />
-      <text x="64.00" y="3.50" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(180,64.00,3.50)" >
+      <text x="64.00" y="4.90" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(180,64.00,4.90)" >
          A
       </text>
    </g>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_2addon_ggs_5.2.6.6-5.svg zint/backend/tests/data/svg/upca_2addon_ggs_5.2.6.6-5.svg
--- zint-2.12.0/backend/tests/data/svg/upca_2addon_ggs_5.2.6.6-5.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_2addon_ggs_5.2.6.6-5.svg	2023-05-08 14:39:44.904319600 +0200
@@ -38,26 +38,26 @@
       <rect x="194.00" y="0.00" width="6.00" height="110.00" />
       <rect x="202.00" y="0.00" width="2.00" height="110.00" />
       <rect x="206.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="230.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="238.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="244.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="250.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="254.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="262.00" y="19.00" width="4.00" height="81.00" />
-      <text x="8.00" y="116.00" text-anchor="end"
+      <rect x="226.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="230.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="238.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="244.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="250.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="254.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="262.00" y="16.90" width="4.00" height="83.10" />
+      <text x="8.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="74.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          12345
       </text>
-      <text x="152.00" y="116.00" text-anchor="middle"
+      <text x="152.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          67890
       </text>
-      <text x="218.00" y="116.00" text-anchor="start"
+      <text x="217.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          5
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_5addon_bind3.svg zint/backend/tests/data/svg/upca_5addon_bind3.svg
--- zint-2.12.0/backend/tests/data/svg/upca_5addon_bind3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_5addon_bind3.svg	2023-05-08 14:39:44.904319600 +0200
@@ -38,37 +38,37 @@
       <rect x="196.00" y="6.00" width="2.00" height="110.00" />
       <rect x="202.00" y="6.00" width="2.00" height="110.00" />
       <rect x="206.00" y="6.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="230.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="236.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="244.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="250.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="256.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="262.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="268.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="272.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="282.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="286.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="290.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="298.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="304.00" y="25.00" width="2.00" height="81.00" />
-      <rect x="308.00" y="25.00" width="4.00" height="81.00" />
-      <rect x="318.00" y="25.00" width="2.00" height="81.00" />
+      <rect x="226.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="230.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="236.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="244.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="250.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="256.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="262.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="268.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="272.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="282.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="286.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="290.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="298.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="304.00" y="22.90" width="2.00" height="83.10" />
+      <rect x="308.00" y="22.90" width="4.00" height="83.10" />
+      <rect x="318.00" y="22.90" width="2.00" height="83.10" />
       <rect x="0.00" y="0.00" width="330.00" height="6.00" />
       <rect x="0.00" y="106.00" width="330.00" height="6.00" />
-      <text x="8.00" y="128.00" text-anchor="end"
+      <text x="8.70" y="128.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          6
       </text>
-      <text x="72.00" y="128.00" text-anchor="middle"
+      <text x="74.00" y="128.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          14141
       </text>
-      <text x="152.00" y="128.00" text-anchor="middle"
+      <text x="152.00" y="128.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          23441
       </text>
-      <text x="218.00" y="128.00" text-anchor="start"
+      <text x="217.30" y="128.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          7
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_5addon_small_bold.svg zint/backend/tests/data/svg/upca_5addon_small_bold.svg
--- zint-2.12.0/backend/tests/data/svg/upca_5addon_small_bold.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_5addon_small_bold.svg	2023-05-08 14:39:44.904319600 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="330" height="112" version="1.1"
+<svg width="330" height="113" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="330" height="112" fill="#FFFFFF" />
+      <rect x="0" y="0" width="330" height="113" fill="#FFFFFF" />
       <rect x="18.00" y="0.00" width="2.00" height="110.00" />
       <rect x="22.00" y="0.00" width="2.00" height="110.00" />
       <rect x="26.00" y="0.00" width="2.00" height="110.00" />
@@ -38,40 +38,40 @@
       <rect x="196.00" y="0.00" width="2.00" height="110.00" />
       <rect x="202.00" y="0.00" width="2.00" height="110.00" />
       <rect x="206.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="230.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="236.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="244.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="250.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="256.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="262.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="268.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="272.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="282.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="286.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="290.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="298.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="304.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="308.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="318.00" y="13.00" width="2.00" height="87.00" />
-      <text x="8.00" y="111.50" text-anchor="end"
-         font-family="Helvetica, sans-serif" font-size="12.0" font-weight="bold" >
+      <rect x="226.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="230.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="236.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="244.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="250.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="256.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="262.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="268.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="272.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="282.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="286.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="290.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="298.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="304.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="308.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="318.00" y="12.28" width="2.00" height="87.72" />
+      <text x="8.70" y="111.72" text-anchor="end"
+         font-family="Helvetica, sans-serif" font-size="12.0" >
          6
       </text>
-      <text x="72.00" y="111.50" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
+      <text x="74.00" y="111.72" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="14.0" >
          14141
       </text>
-      <text x="152.00" y="111.50" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
+      <text x="152.00" y="111.72" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="14.0" >
          23441
       </text>
-      <text x="218.00" y="111.50" text-anchor="start"
-         font-family="Helvetica, sans-serif" font-size="12.0" font-weight="bold" >
+      <text x="217.30" y="111.72" text-anchor="start"
+         font-family="Helvetica, sans-serif" font-size="12.0" >
          7
       </text>
       <text x="274.00" y="10.50" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="14.0" font-weight="bold" >
+         font-family="Helvetica, sans-serif" font-size="14.0" >
          12345
       </text>
    </g>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_5addon.svg zint/backend/tests/data/svg/upca_5addon.svg
--- zint-2.12.0/backend/tests/data/svg/upca_5addon.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_5addon.svg	2023-05-08 14:39:44.904319600 +0200
@@ -38,35 +38,35 @@
       <rect x="196.00" y="0.00" width="2.00" height="110.00" />
       <rect x="202.00" y="0.00" width="2.00" height="110.00" />
       <rect x="206.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="230.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="236.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="244.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="250.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="256.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="262.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="268.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="272.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="282.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="286.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="290.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="298.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="304.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="308.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="318.00" y="19.00" width="2.00" height="81.00" />
-      <text x="8.00" y="116.00" text-anchor="end"
+      <rect x="226.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="230.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="236.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="244.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="250.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="256.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="262.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="268.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="272.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="282.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="286.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="290.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="298.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="304.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="308.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="318.00" y="16.90" width="2.00" height="83.10" />
+      <text x="8.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          6
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="74.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          14141
       </text>
-      <text x="152.00" y="116.00" text-anchor="middle"
+      <text x="152.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          23441
       </text>
-      <text x="218.00" y="116.00" text-anchor="start"
+      <text x="217.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          7
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_cc_2addon_cca_3x4.svg zint/backend/tests/data/svg/upca_cc_2addon_cca_3x4.svg
--- zint-2.12.0/backend/tests/data/svg/upca_cc_2addon_cca_3x4.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_cc_2addon_cca_3x4.svg	2023-05-08 14:39:44.904319600 +0200
@@ -103,26 +103,26 @@
       <rect x="194.00" y="24.00" width="4.00" height="86.00" />
       <rect x="200.00" y="24.00" width="4.00" height="86.00" />
       <rect x="208.00" y="24.00" width="2.00" height="86.00" />
-      <rect x="232.00" y="43.00" width="2.00" height="57.00" />
-      <rect x="236.00" y="43.00" width="4.00" height="57.00" />
-      <rect x="244.00" y="43.00" width="4.00" height="57.00" />
-      <rect x="252.00" y="43.00" width="2.00" height="57.00" />
-      <rect x="256.00" y="43.00" width="2.00" height="57.00" />
-      <rect x="262.00" y="43.00" width="2.00" height="57.00" />
-      <rect x="268.00" y="43.00" width="4.00" height="57.00" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="232.00" y="40.90" width="2.00" height="59.10" />
+      <rect x="236.00" y="40.90" width="4.00" height="59.10" />
+      <rect x="244.00" y="40.90" width="4.00" height="59.10" />
+      <rect x="252.00" y="40.90" width="2.00" height="59.10" />
+      <rect x="256.00" y="40.90" width="2.00" height="59.10" />
+      <rect x="262.00" y="40.90" width="2.00" height="59.10" />
+      <rect x="268.00" y="40.90" width="4.00" height="59.10" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="78.00" y="116.00" text-anchor="middle"
+      <text x="80.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          23456
       </text>
-      <text x="158.00" y="116.00" text-anchor="middle"
+      <text x="158.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          78901
       </text>
-      <text x="224.00" y="116.00" text-anchor="start"
+      <text x="223.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          2
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_bind3.svg zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_bind3.svg
--- zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_bind3.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_bind3.svg	2023-05-08 14:39:44.904319600 +0200
@@ -118,37 +118,37 @@
       <rect x="194.00" y="34.00" width="4.00" height="82.00" />
       <rect x="200.00" y="34.00" width="4.00" height="82.00" />
       <rect x="208.00" y="34.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="236.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="244.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="252.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="256.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="262.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="268.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="274.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="278.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="286.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="292.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="298.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="304.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="310.00" y="53.00" width="2.00" height="53.00" />
-      <rect x="316.00" y="53.00" width="4.00" height="53.00" />
-      <rect x="324.00" y="53.00" width="2.00" height="53.00" />
+      <rect x="232.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="236.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="244.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="252.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="256.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="262.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="268.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="274.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="278.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="286.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="292.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="298.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="304.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="310.00" y="50.90" width="2.00" height="55.10" />
+      <rect x="316.00" y="50.90" width="4.00" height="55.10" />
+      <rect x="324.00" y="50.90" width="2.00" height="55.10" />
       <rect x="0.00" y="0.00" width="338.00" height="6.00" />
       <rect x="0.00" y="106.00" width="338.00" height="6.00" />
-      <text x="14.00" y="128.00" text-anchor="end"
+      <text x="14.70" y="128.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="78.00" y="128.00" text-anchor="middle"
+      <text x="80.00" y="128.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          23456
       </text>
-      <text x="158.00" y="128.00" text-anchor="middle"
+      <text x="158.00" y="128.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          78901
       </text>
-      <text x="224.00" y="128.00" text-anchor="start"
+      <text x="223.30" y="128.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          2
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_notext.svg zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_notext.svg
--- zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_notext.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4_notext.svg	2023-05-08 14:39:44.905319606 +0200
@@ -118,21 +118,21 @@
       <rect x="194.00" y="28.00" width="4.00" height="82.00" />
       <rect x="200.00" y="28.00" width="4.00" height="82.00" />
       <rect x="208.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="236.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="244.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="252.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="256.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="262.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="268.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="274.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="278.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="286.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="292.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="298.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="304.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="310.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="316.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="324.00" y="47.00" width="2.00" height="53.00" />
+      <rect x="232.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="236.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="244.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="252.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="256.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="262.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="268.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="274.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="278.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="286.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="292.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="298.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="304.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="310.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="316.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="324.00" y="44.90" width="2.00" height="55.10" />
    </g>
 </svg>
diff -urN zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4.svg zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4.svg
--- zint-2.12.0/backend/tests/data/svg/upca_cc_5addon_ccb_4x4.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upca_cc_5addon_ccb_4x4.svg	2023-05-08 14:39:44.904319600 +0200
@@ -118,35 +118,35 @@
       <rect x="194.00" y="28.00" width="4.00" height="82.00" />
       <rect x="200.00" y="28.00" width="4.00" height="82.00" />
       <rect x="208.00" y="28.00" width="2.00" height="82.00" />
-      <rect x="232.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="236.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="244.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="252.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="256.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="262.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="268.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="274.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="278.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="286.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="292.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="298.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="304.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="310.00" y="47.00" width="2.00" height="53.00" />
-      <rect x="316.00" y="47.00" width="4.00" height="53.00" />
-      <rect x="324.00" y="47.00" width="2.00" height="53.00" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="232.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="236.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="244.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="252.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="256.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="262.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="268.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="274.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="278.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="286.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="292.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="298.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="304.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="310.00" y="44.90" width="2.00" height="55.10" />
+      <rect x="316.00" y="44.90" width="4.00" height="55.10" />
+      <rect x="324.00" y="44.90" width="2.00" height="55.10" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="78.00" y="116.00" text-anchor="middle"
+      <text x="80.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          23456
       </text>
-      <text x="158.00" y="116.00" text-anchor="middle"
+      <text x="158.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          78901
       </text>
-      <text x="224.00" y="116.00" text-anchor="start"
+      <text x="223.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          2
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_2addon.svg zint/backend/tests/data/svg/upce_2addon.svg
--- zint-2.12.0/backend/tests/data/svg/upce_2addon.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_2addon.svg	2023-05-08 14:39:44.905319606 +0200
@@ -25,22 +25,22 @@
       <rect x="110.00" y="0.00" width="2.00" height="110.00" />
       <rect x="114.00" y="0.00" width="2.00" height="110.00" />
       <rect x="118.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="134.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="138.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="146.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="154.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="158.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="164.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="170.00" y="19.00" width="4.00" height="81.00" />
-      <text x="8.00" y="116.00" text-anchor="end"
+      <rect x="134.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="138.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="146.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="154.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="158.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="164.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="170.00" y="16.90" width="4.00" height="83.10" />
+      <text x="8.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="66.00" y="116.00" text-anchor="middle"
+      <text x="67.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          234567
       </text>
-      <text x="126.00" y="116.00" text-anchor="start"
+      <text x="125.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_5addon_notext.svg zint/backend/tests/data/svg/upce_5addon_notext.svg
--- zint-2.12.0/backend/tests/data/svg/upce_5addon_notext.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_5addon_notext.svg	2023-05-08 14:39:44.905319606 +0200
@@ -25,21 +25,21 @@
       <rect x="110.00" y="0.00" width="2.00" height="110.00" />
       <rect x="114.00" y="0.00" width="2.00" height="110.00" />
       <rect x="118.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="134.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="138.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="144.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="152.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="158.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="164.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="170.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="176.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="180.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="190.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="194.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="198.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="206.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="212.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="216.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="81.00" />
+      <rect x="134.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="138.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="144.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="152.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="158.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="164.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="170.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="176.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="180.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="190.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="194.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="198.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="206.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="212.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="216.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="226.00" y="16.90" width="2.00" height="83.10" />
    </g>
 </svg>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_5addon_small.svg zint/backend/tests/data/svg/upce_5addon_small.svg
--- zint-2.12.0/backend/tests/data/svg/upce_5addon_small.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_5addon_small.svg	2023-05-08 14:39:44.905319606 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="238" height="112" version="1.1"
+<svg width="238" height="113" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="238" height="112" fill="#FFFFFF" />
+      <rect x="0" y="0" width="238" height="113" fill="#FFFFFF" />
       <rect x="18.00" y="0.00" width="2.00" height="110.00" />
       <rect x="22.00" y="0.00" width="2.00" height="110.00" />
       <rect x="28.00" y="0.00" width="2.00" height="100.00" />
@@ -25,31 +25,31 @@
       <rect x="110.00" y="0.00" width="2.00" height="110.00" />
       <rect x="114.00" y="0.00" width="2.00" height="110.00" />
       <rect x="118.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="134.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="138.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="144.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="152.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="158.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="164.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="170.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="176.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="180.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="190.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="194.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="198.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="206.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="212.00" y="13.00" width="2.00" height="87.00" />
-      <rect x="216.00" y="13.00" width="4.00" height="87.00" />
-      <rect x="226.00" y="13.00" width="2.00" height="87.00" />
-      <text x="8.00" y="111.50" text-anchor="end"
+      <rect x="134.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="138.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="144.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="152.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="158.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="164.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="170.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="176.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="180.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="190.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="194.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="198.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="206.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="212.00" y="12.28" width="2.00" height="87.72" />
+      <rect x="216.00" y="12.28" width="4.00" height="87.72" />
+      <rect x="226.00" y="12.28" width="2.00" height="87.72" />
+      <text x="8.70" y="111.72" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="12.0" >
          1
       </text>
-      <text x="66.00" y="111.50" text-anchor="middle"
+      <text x="67.00" y="111.72" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          234567
       </text>
-      <text x="126.00" y="111.50" text-anchor="start"
+      <text x="125.30" y="111.72" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="12.0" >
          0
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_5addon.svg zint/backend/tests/data/svg/upce_5addon.svg
--- zint-2.12.0/backend/tests/data/svg/upce_5addon.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_5addon.svg	2023-05-08 14:39:44.905319606 +0200
@@ -25,31 +25,31 @@
       <rect x="110.00" y="0.00" width="2.00" height="110.00" />
       <rect x="114.00" y="0.00" width="2.00" height="110.00" />
       <rect x="118.00" y="0.00" width="2.00" height="110.00" />
-      <rect x="134.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="138.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="144.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="152.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="158.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="164.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="170.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="176.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="180.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="190.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="194.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="198.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="206.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="212.00" y="19.00" width="2.00" height="81.00" />
-      <rect x="216.00" y="19.00" width="4.00" height="81.00" />
-      <rect x="226.00" y="19.00" width="2.00" height="81.00" />
-      <text x="8.00" y="116.00" text-anchor="end"
+      <rect x="134.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="138.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="144.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="152.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="158.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="164.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="170.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="176.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="180.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="190.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="194.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="198.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="206.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="212.00" y="16.90" width="2.00" height="83.10" />
+      <rect x="216.00" y="16.90" width="4.00" height="83.10" />
+      <rect x="226.00" y="16.90" width="2.00" height="83.10" />
+      <text x="8.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="66.00" y="116.00" text-anchor="middle"
+      <text x="67.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          234567
       </text>
-      <text x="126.00" y="116.00" text-anchor="start"
+      <text x="125.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_fgbgalpha.svg zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_fgbgalpha.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_fgbgalpha.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_fgbgalpha.svg	2023-05-08 14:39:44.905319606 +0200
@@ -80,22 +80,22 @@
       <rect x="112.00" y="32.00" width="2.00" height="68.00" opacity="0.933" />
       <rect x="116.00" y="32.00" width="2.00" height="78.00" opacity="0.933" />
       <rect x="120.00" y="32.00" width="2.00" height="78.00" opacity="0.933" />
-      <rect x="140.00" y="51.00" width="2.00" height="49.00" opacity="0.933" />
-      <rect x="144.00" y="51.00" width="4.00" height="49.00" opacity="0.933" />
-      <rect x="150.00" y="51.00" width="4.00" height="49.00" opacity="0.933" />
-      <rect x="156.00" y="51.00" width="6.00" height="49.00" opacity="0.933" />
-      <rect x="164.00" y="51.00" width="2.00" height="49.00" opacity="0.933" />
-      <rect x="170.00" y="51.00" width="2.00" height="49.00" opacity="0.933" />
-      <rect x="174.00" y="51.00" width="6.00" height="49.00" opacity="0.933" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="140.00" y="48.90" width="2.00" height="51.10" opacity="0.933" />
+      <rect x="144.00" y="48.90" width="4.00" height="51.10" opacity="0.933" />
+      <rect x="150.00" y="48.90" width="4.00" height="51.10" opacity="0.933" />
+      <rect x="156.00" y="48.90" width="6.00" height="51.10" opacity="0.933" />
+      <rect x="164.00" y="48.90" width="2.00" height="51.10" opacity="0.933" />
+      <rect x="170.00" y="48.90" width="2.00" height="51.10" opacity="0.933" />
+      <rect x="174.00" y="48.90" width="6.00" height="51.10" opacity="0.933" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" opacity="0.933" >
          0
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="73.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" opacity="0.933" >
          654321
       </text>
-      <text x="132.00" y="116.00" text-anchor="start"
+      <text x="131.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" opacity="0.933" >
          7
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_nobg.svg zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_nobg.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_nobg.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_nobg.svg	2023-05-08 14:39:44.905319606 +0200
@@ -79,22 +79,22 @@
       <rect x="112.00" y="32.00" width="2.00" height="68.00" />
       <rect x="116.00" y="32.00" width="2.00" height="78.00" />
       <rect x="120.00" y="32.00" width="2.00" height="78.00" />
-      <rect x="140.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="144.00" y="51.00" width="4.00" height="49.00" />
-      <rect x="150.00" y="51.00" width="4.00" height="49.00" />
-      <rect x="156.00" y="51.00" width="6.00" height="49.00" />
-      <rect x="164.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="170.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="174.00" y="51.00" width="6.00" height="49.00" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="140.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="144.00" y="48.90" width="4.00" height="51.10" />
+      <rect x="150.00" y="48.90" width="4.00" height="51.10" />
+      <rect x="156.00" y="48.90" width="6.00" height="51.10" />
+      <rect x="164.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="170.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="174.00" y="48.90" width="6.00" height="51.10" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="73.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          654321
       </text>
-      <text x="132.00" y="116.00" text-anchor="start"
+      <text x="131.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          7
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_rotate_270.svg zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_rotate_270.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2_rotate_270.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2_rotate_270.svg	2023-05-08 14:39:44.905319606 +0200
@@ -80,23 +80,23 @@
       <rect x="32.00" y="78.00" width="68.00" height="2.00" />
       <rect x="32.00" y="74.00" width="78.00" height="2.00" />
       <rect x="32.00" y="70.00" width="78.00" height="2.00" />
-      <rect x="51.00" y="50.00" width="49.00" height="2.00" />
-      <rect x="51.00" y="44.00" width="49.00" height="4.00" />
-      <rect x="51.00" y="38.00" width="49.00" height="4.00" />
-      <rect x="51.00" y="30.00" width="49.00" height="6.00" />
-      <rect x="51.00" y="26.00" width="49.00" height="2.00" />
-      <rect x="51.00" y="20.00" width="49.00" height="2.00" />
-      <rect x="51.00" y="12.00" width="49.00" height="6.00" />
-      <text x="116.00" y="178.00" text-anchor="end"
-         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(270,116.00,178.00)" >
+      <rect x="48.90" y="50.00" width="51.10" height="2.00" />
+      <rect x="48.90" y="44.00" width="51.10" height="4.00" />
+      <rect x="48.90" y="38.00" width="51.10" height="4.00" />
+      <rect x="48.90" y="30.00" width="51.10" height="6.00" />
+      <rect x="48.90" y="26.00" width="51.10" height="2.00" />
+      <rect x="48.90" y="20.00" width="51.10" height="2.00" />
+      <rect x="48.90" y="12.00" width="51.10" height="6.00" />
+      <text x="116.10" y="177.30" text-anchor="end"
+         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(270,116.10,177.30)" >
          0
       </text>
-      <text x="116.00" y="120.00" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="20.0" transform="rotate(270,116.00,120.00)" >
+      <text x="116.10" y="119.00" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="20.0" transform="rotate(270,116.10,119.00)" >
          654321
       </text>
-      <text x="116.00" y="60.00" text-anchor="start"
-         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(270,116.00,60.00)" >
+      <text x="116.10" y="60.70" text-anchor="start"
+         font-family="Helvetica, sans-serif" font-size="14.0" transform="rotate(270,116.10,60.70)" >
          7
       </text>
       <text x="47.00" y="32.00" text-anchor="middle"
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2.svg zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_2addon_cca_5x2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_2addon_cca_5x2.svg	2023-05-08 14:39:44.905319606 +0200
@@ -80,22 +80,22 @@
       <rect x="112.00" y="32.00" width="2.00" height="68.00" />
       <rect x="116.00" y="32.00" width="2.00" height="78.00" />
       <rect x="120.00" y="32.00" width="2.00" height="78.00" />
-      <rect x="140.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="144.00" y="51.00" width="4.00" height="49.00" />
-      <rect x="150.00" y="51.00" width="4.00" height="49.00" />
-      <rect x="156.00" y="51.00" width="6.00" height="49.00" />
-      <rect x="164.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="170.00" y="51.00" width="2.00" height="49.00" />
-      <rect x="174.00" y="51.00" width="6.00" height="49.00" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="140.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="144.00" y="48.90" width="4.00" height="51.10" />
+      <rect x="150.00" y="48.90" width="4.00" height="51.10" />
+      <rect x="156.00" y="48.90" width="6.00" height="51.10" />
+      <rect x="164.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="170.00" y="48.90" width="2.00" height="51.10" />
+      <rect x="174.00" y="48.90" width="6.00" height="51.10" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          0
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="73.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          654321
       </text>
-      <text x="132.00" y="116.00" text-anchor="start"
+      <text x="131.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          7
       </text>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_5addon_ccb_8x2_notext.svg zint/backend/tests/data/svg/upce_cc_5addon_ccb_8x2_notext.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_5addon_ccb_8x2_notext.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_5addon_ccb_8x2_notext.svg	2023-05-08 14:39:44.905319606 +0200
@@ -106,21 +106,21 @@
       <rect x="112.00" y="44.00" width="2.00" height="56.00" />
       <rect x="116.00" y="44.00" width="2.00" height="66.00" />
       <rect x="120.00" y="44.00" width="2.00" height="66.00" />
-      <rect x="140.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="144.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="150.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="160.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="164.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="168.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="172.00" y="63.00" width="8.00" height="37.00" />
-      <rect x="182.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="188.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="196.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="200.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="204.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="210.00" y="63.00" width="6.00" height="37.00" />
-      <rect x="218.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="224.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="228.00" y="63.00" width="6.00" height="37.00" />
+      <rect x="140.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="144.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="150.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="160.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="164.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="168.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="172.00" y="60.90" width="8.00" height="39.10" />
+      <rect x="182.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="188.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="196.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="200.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="204.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="210.00" y="60.90" width="6.00" height="39.10" />
+      <rect x="218.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="224.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="228.00" y="60.90" width="6.00" height="39.10" />
    </g>
 </svg>
diff -urN zint-2.12.0/backend/tests/data/svg/upce_cc_5addon_ccb_8x2.svg zint/backend/tests/data/svg/upce_cc_5addon_ccb_8x2.svg
--- zint-2.12.0/backend/tests/data/svg/upce_cc_5addon_ccb_8x2.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/data/svg/upce_cc_5addon_ccb_8x2.svg	2023-05-08 14:39:44.905319606 +0200
@@ -106,31 +106,31 @@
       <rect x="112.00" y="44.00" width="2.00" height="56.00" />
       <rect x="116.00" y="44.00" width="2.00" height="66.00" />
       <rect x="120.00" y="44.00" width="2.00" height="66.00" />
-      <rect x="140.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="144.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="150.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="160.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="164.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="168.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="172.00" y="63.00" width="8.00" height="37.00" />
-      <rect x="182.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="188.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="196.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="200.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="204.00" y="63.00" width="4.00" height="37.00" />
-      <rect x="210.00" y="63.00" width="6.00" height="37.00" />
-      <rect x="218.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="224.00" y="63.00" width="2.00" height="37.00" />
-      <rect x="228.00" y="63.00" width="6.00" height="37.00" />
-      <text x="14.00" y="116.00" text-anchor="end"
+      <rect x="140.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="144.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="150.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="160.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="164.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="168.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="172.00" y="60.90" width="8.00" height="39.10" />
+      <rect x="182.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="188.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="196.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="200.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="204.00" y="60.90" width="4.00" height="39.10" />
+      <rect x="210.00" y="60.90" width="6.00" height="39.10" />
+      <rect x="218.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="224.00" y="60.90" width="2.00" height="39.10" />
+      <rect x="228.00" y="60.90" width="6.00" height="39.10" />
+      <text x="14.70" y="116.10" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          1
       </text>
-      <text x="72.00" y="116.00" text-anchor="middle"
+      <text x="73.00" y="116.10" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="20.0" >
          876543
       </text>
-      <text x="132.00" y="116.00" text-anchor="start"
+      <text x="131.30" y="116.10" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="14.0" >
          5
       </text>
Binary files zint-2.12.0/backend/tests/data/tif/code128_cmyk_fgbgalpha.tif and zint/backend/tests/data/tif/code128_cmyk_fgbgalpha.tif differ
Binary files zint-2.12.0/backend/tests/data/tif/code128_cmyk_fgbgcmyk.tif and zint/backend/tests/data/tif/code128_cmyk_fgbgcmyk.tif differ
Binary files zint-2.12.0/backend/tests/data/tif/code128_cmyk_fgbg.tif and zint/backend/tests/data/tif/code128_cmyk_fgbg.tif differ
Binary files zint-2.12.0/backend/tests/data/tif/code128_cmyk.tif and zint/backend/tests/data/tif/code128_cmyk.tif differ
Binary files zint-2.12.0/backend/tests/data/tif/ultra_cmyk_bgalpha.tif and zint/backend/tests/data/tif/ultra_cmyk_bgalpha.tif differ
diff -urN zint-2.12.0/backend/tests/README zint/backend/tests/README
--- zint-2.12.0/backend/tests/README	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/README	2023-05-08 14:39:44.868319388 +0200
@@ -17,8 +17,11 @@
   cd <project-dir>
   mkdir build
   cd build
-  cmake -DZINT_TEST=ON ..
+  cmake -DZINT_TEST=ON -DCMAKE_BUILD_TYPE=Debug ..
   cmake --build . --config Debug
+
+Note specifying a matching CMAKE_BUILD_TYPE is required to set the test PATH
+environment for Windows.
   
 ------------------------------------------------------------------------------
 
@@ -33,7 +36,11 @@
 
 Setting LD_LIBRARY_PATH is not required if the zint library to be tested is
 installed into a system library path ( /usr/lib for example ) prior to running
-the tests.
+the tests, or if the tests are not run individually.
+
+(On Windows, the PATH may need to be set to include the DLL location.)
+
+------------------------------------------------------------------------------
 
 To run all tests (within <build-dir>):
 
@@ -72,7 +79,7 @@
 
 This can also take a range, '-x <start>-<end>':
 
-  backend/tests/test_dotcode -f input -x 4,6
+  backend/tests/test_dotcode -f input -x 4-6
 
 Exclude can be used multiple times (unlike '-i'):
 
diff -urN zint-2.12.0/backend/tests/test_aztec.c zint/backend/tests/test_aztec.c
--- zint-2.12.0/backend/tests/test_aztec.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_aztec.c	2023-05-08 14:39:44.910319635 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -128,7 +128,7 @@
         char *expected;
     };
     struct item data[] = {
-        /*  0*/ { BARCODE_AZTEC, UNICODE_MODE, -1, -1, -1, -1, "123456789012", -1, 0, 15, 15, 1, "ISO/IEC 24778:2008 Figure 1 (left)",
+        /*  0*/ { BARCODE_AZTEC, UNICODE_MODE, -1, -1, -1, 1, "123456789012", -1, 0, 15, 15, 1, "ISO/IEC 24778:2008 Figure 1 (left)",
                     "000111000011100"
                     "110111001110010"
                     "111100001000100"
@@ -188,7 +188,7 @@
                     "00010010010011001011011010000110001000101"
                     "10001000001010100110100000001001001110000"
                 },
-        /*  2*/ { BARCODE_AZTEC, UNICODE_MODE, -1, -1, -1, -1, "Code 2D!", -1, 0, 15, 15, 1, "ISO/IEC 24778:2008 Figure G.2",
+        /*  2*/ { BARCODE_AZTEC, UNICODE_MODE, -1, -1, -1, -1, "Code 2D!", -1, 0, 15, 15, 0, "ISO/IEC 24778:2008 Figure G.2; BWIPP defaults to full (see following)",
                     "000110001100000"
                     "000000110000010"
                     "101100001000101"
@@ -563,7 +563,7 @@
                     "011010111000111110011011110"
                     "000010010001000011010000001"
                 },
-        /* 15*/ { BARCODE_AZTEC, DATA_MODE, -1, -1, -1, -1, "\377\000\000\377\300\000\017\377\376\217\300\017", 12, 0, 19, 19, 1, "6 bit words",
+        /* 15*/ { BARCODE_AZTEC, DATA_MODE, -1, -1, -1, 2, "\377\000\000\377\300\000\017\377\376\217\300\017", 12, 0, 19, 19, 1, "6 bit words",
                     "1101000001111000001"
                     "1101011000011100000"
                     "1000001010001001001"
@@ -779,7 +779,7 @@
                     "11000000001000001011101101101101101001100000101000000000010111000000100101000110010000110010000011000101011111000"
                     "11100000100000001110111110110000111110011100000010001110101010101111000011001011111001101101010010001011111011101"
                 },
-        /* 19*/ { BARCODE_AZTEC, UNICODE_MODE, -1, READER_INIT, -1, -1, "A", -1, 0, 15, 15, 1, "",
+        /* 19*/ { BARCODE_AZTEC, UNICODE_MODE, -1, READER_INIT, -1, 1, "A", -1, 0, 15, 15, 1, "",
                     "000011000111101"
                     "001110010011000"
                     "011100100000100"
@@ -817,7 +817,7 @@
                     "0011111001001010011"
                     "1001101000100100001"
                 },
-        /* 21*/ { BARCODE_AZTEC, DATA_MODE, 3, -1, -1, -1, "\101\300", -1, 0, 15, 15, 1, "AÃ",
+        /* 21*/ { BARCODE_AZTEC, DATA_MODE, 3, -1, -1, 1, "\101\300", -1, 0, 15, 15, 1, "AÃ",
                     "000000101011100"
                     "000100010100111"
                     "001100000110110"
@@ -834,7 +834,7 @@
                     "110001000111110"
                     "111001100011011"
                 },
-        /* 22*/ { BARCODE_AZTEC, UNICODE_MODE, 26, -1, -1, -1, "AÃ", -1, 0, 15, 15, 1, "AÃ",
+        /* 22*/ { BARCODE_AZTEC, UNICODE_MODE, 26, -1, -1, 1, "AÃ", -1, 0, 15, 15, 1, "AÃ",
                     "001111011000101"
                     "000110100011000"
                     "001100001000111"
@@ -851,7 +851,7 @@
                     "001100010010010"
                     "011110110011000"
                 },
-        /* 23*/ { BARCODE_AZTEC, UNICODE_MODE, 100, -1, -1, -1, "A", -1, 0, 15, 15, 1, "FLG(3)",
+        /* 23*/ { BARCODE_AZTEC, UNICODE_MODE, 100, -1, -1, 1, "A", -1, 0, 15, 15, 1, "FLG(3)",
                     "001101001111101"
                     "000000111011100"
                     "001100000100101"
@@ -868,7 +868,7 @@
                     "100011101111100"
                     "000111110001110"
                 },
-        /* 24*/ { BARCODE_AZTEC, UNICODE_MODE, 1000, -1, -1, -1, "A", -1, 0, 15, 15, 1, "FLG(4)",
+        /* 24*/ { BARCODE_AZTEC, UNICODE_MODE, 1000, -1, -1, 1, "A", -1, 0, 15, 15, 1, "FLG(4)",
                     "001010100011011"
                     "001000100000101"
                     "001100000100111"
@@ -885,7 +885,7 @@
                     "101000000111010"
                     "000001110101111"
                 },
-        /* 25*/ { BARCODE_AZTEC, UNICODE_MODE, 10000, -1, -1, -1, "A", -1, 0, 15, 15, 1, "FLG(5)",
+        /* 25*/ { BARCODE_AZTEC, UNICODE_MODE, 10000, -1, -1, 1, "A", -1, 0, 15, 15, 1, "FLG(5)",
                     "000100110110010"
                     "000001000010111"
                     "001100000110101"
@@ -902,7 +902,7 @@
                     "101010001110110"
                     "000000011000101"
                 },
-        /* 26*/ { BARCODE_AZTEC, UNICODE_MODE, 100000, -1, -1, -1, "A", -1, 0, 15, 15, 1, "FLG(6)",
+        /* 26*/ { BARCODE_AZTEC, UNICODE_MODE, 100000, -1, -1, 1, "A", -1, 0, 15, 15, 1, "FLG(6)",
                     "000010010000010"
                     "001101000100110"
                     "001100000110111"
@@ -2480,7 +2480,7 @@
         char *expected;
     };
     struct item data[] = {
-        /*  0*/ { UNICODE_MODE, -1, -1, -1, { { TU("Â¶"), -1, 0 }, { TU("Ð"), -1, 7 }, { TU(""), 0, 0 } }, 0, 15, 15, 1, "ISO/IEC 24778:2008 16.5 example",
+        /*  0*/ { UNICODE_MODE, -1, -1, 1, { { TU("Â¶"), -1, 0 }, { TU("Ð"), -1, 7 }, { TU(""), 0, 0 } }, 0, 15, 15, 1, "ISO/IEC 24778:2008 16.5 example",
                     "001111000011111"
                     "110111100100011"
                     "111100001000111"
@@ -2497,7 +2497,7 @@
                     "001010111001010"
                     "000001011100111"
                 },
-        /*  1*/ { UNICODE_MODE, -1, -1, -1, { { TU("Â¶"), -1, 0 }, { TU("Ð"), -1, 0 }, { TU(""), 0, 0 } }, ZINT_WARN_USES_ECI, 15, 15, 1, "ISO/IEC 24778:2008 16.5 example auto-ECI",
+        /*  1*/ { UNICODE_MODE, -1, -1, 1, { { TU("Â¶"), -1, 0 }, { TU("Ð"), -1, 0 }, { TU(""), 0, 0 } }, ZINT_WARN_USES_ECI, 15, 15, 1, "ISO/IEC 24778:2008 16.5 example auto-ECI",
                     "001111000011111"
                     "110111100100011"
                     "111100001000111"
@@ -2607,7 +2607,7 @@
                     "1001101000110101111010100111100011111001000100101"
                     "0001001010011000000100101101100110101000100000000"
                 },
-        /*  5*/ { DATA_MODE, -1, -1, -1, { { TU("\357"), 1, 0 }, { TU("\357"), 1, 7 }, { TU("\357"), 1, 0 } }, 0, 19, 19, 1, "Standard example + extra seg, data mode",
+        /*  5*/ { DATA_MODE, -1, -1, 2, { { TU("\357"), 1, 0 }, { TU("\357"), 1, 7 }, { TU("\357"), 1, 0 } }, 0, 19, 19, 1, "Standard example + extra seg, data mode",
                     "1110011101010111000"
                     "1100010001011100011"
                     "1001110101000010110"
diff -urN zint-2.12.0/backend/tests/test_code128.c zint/backend/tests/test_code128.c
--- zint-2.12.0/backend/tests/test_code128.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_code128.c	2023-05-08 14:39:44.918319682 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -356,52 +356,82 @@
         /*  0*/ { UNICODE_MODE, "\302\200", -1, ZINT_ERROR_INVALID_DATA, 0, 1, "Error 204: Invalid character in input data (ISO/IEC 8859-1 only)", "PAD not in ISO 8859-1" },
         /*  1*/ { DATA_MODE, "\200", -1, 0, 57, 1, "(5) 103 101 64 23 106", "PAD ok using binary" },
         /*  2*/ { UNICODE_MODE, "AIM1234", -1, 0, 101, 1, "(9) 104 33 41 45 99 12 34 87 106", "Example from Annex A.1, check char value 87" },
-        /*  3*/ { GS1_MODE, "[90]12", -1, ZINT_ERROR_INVALID_OPTION, 0, 1, "Error 220: Selected symbology does not support GS1 mode", "" },
-        /*  4*/ { UNICODE_MODE, "1", -1, 0, 46, 1, "(4) 104 17 18 106", "StartB 1" },
-        /*  5*/ { UNICODE_MODE, "12", -1, 0, 46, 1, "(4) 105 12 14 106", "StartC 12" },
-        /*  6*/ { UNICODE_MODE, "123", -1, 0, 68, 1, "(6) 104 17 18 19 8 106", "StartB 1 2 3" },
-        /*  7*/ { UNICODE_MODE, "1234", -1, 0, 57, 1, "(5) 105 12 34 82 106", "StartC 12 34" },
-        /*  8*/ { UNICODE_MODE, "12345", -1, 0, 79, 1, "(7) 105 12 34 100 21 54 106", "StartC 12 34 CodeB 5" },
-        /*  9*/ { UNICODE_MODE, "\037", -1, 0, 46, 1, "(4) 103 95 95 106", "StartA US" },
-        /* 10*/ { UNICODE_MODE, "1\037", -1, 0, 57, 1, "(5) 103 17 95 1 106", "StartA 1 US" },
-        /* 11*/ { UNICODE_MODE, "12\037", -1, 0, 68, 1, "(6) 103 17 18 95 29 106", "StartA 1 2 US" },
-        /* 12*/ { UNICODE_MODE, "a\037a", -1, 0, 79, 1, "(7) 104 65 98 95 65 86 106", "StartB a Shift US a" },
-        /* 13*/ { UNICODE_MODE, "1234\037a", -1, 0, 101, 0, "(9) 105 12 34 101 95 98 65 100 106", "StartC 12 34 CodeA US Shift a; BWIPP different encodation" },
-        /* 14*/ { UNICODE_MODE, "\037AAa\037", -1, 0, 101, 1, "(9) 103 95 33 33 98 65 95 2 106", "StartA US A A Shift a US" },
-        /* 15*/ { UNICODE_MODE, "\037AAaa\037", -1, 0, 123, 0, "(11) 103 95 33 33 100 65 65 98 95 40 106", "StartA US A A CodeB a a Shift US; BWIPP different encodation" },
-        /* 16*/ { UNICODE_MODE, "AAAa12345aAA", -1, 0, 167, 1, "(15) 104 33 33 33 65 17 99 23 45 100 65 33 33 54 106", "StartB A (3) a 1 CodeC 23 45 CodeB a A A" },
-        /* 17*/ { UNICODE_MODE, "a\037Aa\037\037a\037aa\037a", -1, 0, 222, 1, "(20) 104 65 98 95 33 65 101 95 95 98 65 95 100 65 65 98 95 65 96 106", "StartB a Shift US A a CodeA US US Shift a US CodeB a a Shift US a" },
-        /* 18*/ { UNICODE_MODE, "\000\037Ã", 4, 0, 79, 1, "(7) 103 64 95 101 63 88 106", "StartA NUL US FNC4 Ã" },
-        /* 19*/ { UNICODE_MODE, "\000\037Ã©", 4, 0, 90, 0, "(8) 103 64 95 101 98 73 78 106", "StartA NUL US FNC4 Shift Ã©; BWIPP different encodation" },
-        /* 20*/ { UNICODE_MODE, "\000\037Ã©a", 5, 0, 101, 0, "(9) 103 64 95 100 100 73 65 61 106", "StartA NUL US LatchB FNC4 Ã© a; BWIPP different encodation" },
-        /* 21*/ { UNICODE_MODE, "abÃ", -1, 0, 79, 1, "(7) 104 65 66 100 63 29 106", "StartB a b FNC4 Ã" },
-        /* 22*/ { DATA_MODE, "\141\142\237", -1, 0, 90, 0, "(8) 104 65 66 100 98 95 26 106", "StartB a b FNC4 Shift APC; BWIPP different encodation" },
-        /* 23*/ { DATA_MODE, "\141\142\237\037", -1, 0, 101, 0, "(9) 104 65 66 101 101 95 95 96 106", "StartB a b LatchA FNC4 APC US; BWIPP different encodation" },
-        /* 24*/ { UNICODE_MODE, "Ã©Ã©Ã©", -1, 0, 90, 1, "(8) 104 100 100 73 73 73 44 106", "StartB LatchFNC4 Ã© Ã© Ã©" },
-        /* 25*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©b", -1, 0, 145, 1, "(13) 104 65 100 73 100 73 100 73 100 73 66 49 106", "StartB a FNC4 Ã© (4) b" },
-        /* 26*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©b", -1, 0, 145, 1, "(13) 104 65 100 100 73 73 73 73 73 100 66 93 106", "StartB a Latch Ã© (5) Shift b" },
-        /* 27*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bc", -1, 0, 167, 1, "(15) 104 65 100 100 73 73 73 73 73 100 66 100 67 40 106", "StartB a Latch Ã© (5) Shift b Shift c" },
-        /* 28*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcd", -1, 0, 178, 1, "(16) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 66 106", "StartB a Latch Ã© (5) Unlatch b c d" },
-        /* 29*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcde", -1, 0, 189, 1, "(17) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 2 106", "StartB a Latch Ã© (5) Unlatch b c d e" },
-        /* 30*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©", -1, 0, 211, 0, "(19) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 100 73 95 106", "StartB a Latch Ã© (5) Unlatch b c d e FNC4 Ã©; BWIPP different encodation" },
-        /* 31*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©Ã©", -1, 0, 233, 0, "(21) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 100 73 100 73 19 106", "StartB a Latch Ã© (5) Unlatch b c d e FNC4 Ã© (2); BWIPP different encodation" },
-        /* 32*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©Ã©Ã©", -1, 0, 244, 1, "(22) 104 65 100 100 73 73 73 73 73 100 66 100 67 100 68 100 69 73 73 73 83 106", "StartB a Latch Ã© (5) Shift b Shift c Shift d Shift e Ã© (3)" },
-        /* 33*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdefÃ©Ã©Ã©", -1, 0, 255, 1, "(23) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 70 100 100 73 73 73 67 106", "StartB a Latch Ã© (5) Unlatch b c d e f Latch Ã© (3)" },
-        /* 34*/ { DATA_MODE, "\200\200\200\200\200\101\060\060\060\060\101\200", -1, 0, 222, 1, "(20) 103 101 101 64 64 64 64 64 101 101 33 99 0 0 101 33 101 64 73 106", "StartA Latch PAD (4) Unlatch A CodeC 00 00 CodeA A FNC4 PAD" },
-        /* 35*/ { UNICODE_MODE, "ÃÃÃÃÃÃ99999999999999", -1, 0, 211, 0, "(19) 104 100 100 33 33 33 33 33 33 99 99 99 99 99 99 99 99 63 106", "Okapi code128/extended-mode-exit-before-code-set-c.png (chose different solution); BWIPP different encodation" },
-        /* 36*/ { UNICODE_MODE, "ÃÃÃÃÃÃ99999999999999Ã", -1, 0, 233, 0, "(21) 104 100 100 33 33 33 33 33 33 99 99 99 99 99 99 99 99 100 33 91 106", "Above with trailing non-shifted (as still latched) extended; BWIPP different encodation" },
-        /* 37*/ { DATA_MODE | ESCAPE_MODE, "@g(\302\302\302\302\3025555\302\302\302\302\302\302\302\302", -1, 0, 277, 0, "(25) 104 32 71 8 100 100 34 34 34 34 34 99 55 55 100 34 34 34 34 34 34 34 34 25 106", "Okapi code128/extended-mode-with-short-embedded-code-set-c.png (chose different solution); BWIPP different encodation" },
-        /* 38*/ { DATA_MODE | ESCAPE_MODE, "@g(\302\302\302\302\302555555\302\302\302\302\302\302\302", -1, 0, 277, 0, "(25) 104 32 71 8 100 100 34 34 34 34 34 99 55 55 55 100 34 34 34 34 34 34 34 76 106", "Above with extra 55 instead of \xC2; BWIPP different encodation" },
-        /* 39*/ { UNICODE_MODE, "ÃÃÃ¨ÃÃFÃ§7Z", -1, 0, 189, 0, "(17) 104 100 100 33 33 72 33 33 100 38 71 100 100 23 58 95 106", "Okapi code128/extended-mode-shift.png; BWIPP different encodation" },
-        /* 40*/ { UNICODE_MODE, "m\nm\nm", -1, 0, 112, 1, "(10) 104 77 98 74 77 98 74 77 11 106", "Okapi code128/code-set-b-a-b-a-b.png" },
-        /* 41*/ { UNICODE_MODE, "c\naDEF", -1, 0, 112, 1, "(10) 104 67 98 74 65 36 37 38 75 106", "Okapi bug-36-1.png" },
-        /* 42*/ { UNICODE_MODE, "\na\nDEF", -1, 0, 112, 1, "(10) 103 74 98 65 74 36 37 38 90 106", "Okapi bug-36-2.png" },
-        /* 43*/ { UNICODE_MODE, "Ã¿\012Ã a\0121\012Ã AÃ ", -1, 0, 222, 0, "(20) 104 100 95 98 74 100 64 65 98 74 17 98 74 100 64 33 100 64 61 106", "BWIPP different encodation, ShA instead of CodeA" },
-        /* 44*/ { UNICODE_MODE, "Ã¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 387, 0, "(35) 104 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100 64", "BWIPP different encodation, CodeA instead of ShA, shorter" },
-        /* 45*/ { UNICODE_MODE, "yÃ¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 398, 0, "(36) 104 89 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100", "BWIPP different encodation, CodeA instead of ShA, shorter" },
-        /* 46*/ { UNICODE_MODE, "Ã¿y1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 398, 0, "(36) 104 100 95 89 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100", "BWIPP different encodation, CodeA instead of ShA, shorter" },
-        /* 47*/ { UNICODE_MODE, "Ã¿Ã¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 409, 0, "(37) 104 100 95 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33", "BWIPP different encodation, CodeA instead of ShA, shorter" },
-        /* 48*/ { UNICODE_MODE, "Ã¿12345678\012Ã 12345678abcdef\0121\01223456\012\0127890Ã AÃ BCDEFÃ \012\012Ã ", -1, 0, 684, 0, "(62) 104 100 95 99 12 34 56 78 101 74 101 98 64 99 12 34 56 78 100 65 66 67 68 69 70 98 74", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /*  3*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B12345\\^C6789", -1, 0, 123, 0, "(11) 104 17 18 19 20 21 99 67 89 11 106", "Ticket #204 ZPL example; BWIPP no manual mode" },
+        /*  4*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B12345\\^D6789", -1, 0, 167, 0, "(15) 104 17 18 19 20 21 60 62 36 22 23 24 25 1 106", "Unrecognized extra escape ignored; BWIPP no manual mode" },
+        /*  5*/ { UNICODE_MODE | ESCAPE_MODE | EXTRA_ESCAPE_MODE, "\\^B12345\\^D6789", -1, 0, 167, 0, "(15) 104 17 18 19 20 21 60 62 36 22 23 24 25 1 106", "Unrecognized extra escape ignored; BWIPP no manual mode" },
+        /*  6*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A\\^B\\^C", -1, ZINT_ERROR_INVALID_DATA, 0, 1, "Error 842: No input data", "" },
+        /*  7*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A\\^^B\\^C", -1, 0, 68, 0, "(6) 103 60 62 34 80 106", "BWIPP no manual mode" },
+        /*  8*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A\\^B\\^^C", -1, 0, 68, 1, "(6) 104 60 62 35 84 106", "" },
+        /*  9*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^^A\\^B\\^^C", -1, 0, 101, 1, "(9) 104 60 62 33 60 62 35 14 106", "" },
+        /* 10*/ { UNICODE_MODE | ESCAPE_MODE | EXTRA_ESCAPE_MODE, "\\^^A\\^B\\^^C", -1, 0, 101, 1, "(9) 104 60 62 33 60 62 35 14 106", "" },
+        /* 11*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^^A", -1, 0, 68, 1, "(6) 104 60 62 33 78 106", "" },
+        /* 12*/ { GS1_MODE, "[90]12", -1, ZINT_ERROR_INVALID_OPTION, 0, 1, "Error 220: Selected symbology does not support GS1 mode", "" },
+        /* 13*/ { UNICODE_MODE, "1", -1, 0, 46, 1, "(4) 104 17 18 106", "StartB 1" },
+        /* 14*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A1", -1, 0, 46, 0, "(4) 103 17 17 106", "StartA 1; BWIPP no manual mode" },
+        /* 15*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^C1", -1, 0, 46, 1, "(4) 104 17 18 106", "StartB 1 (manual C ignored as odd); BWIPP no manual mode" },
+        /* 16*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "1\\^A", -1, 0, 46, 1, "(4) 104 17 18 106", "StartB 1 (escape at end ignored); BWIPP no manual mode" },
+        /* 17*/ { UNICODE_MODE, "12", -1, 0, 46, 1, "(4) 105 12 14 106", "StartC 12" },
+        /* 18*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^C12", -1, 0, 46, 1, "(4) 105 12 14 106", "StartC 12" },
+        /* 19*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B12", -1, 0, 57, 0, "(5) 104 17 18 54 106", "StartB 1 2; BWIPP no manual mode" },
+        /* 20*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A12", -1, 0, 57, 0, "(5) 103 17 18 53 106", "StartA 1 2; BWIPP no manual mode" },
+        /* 21*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A1\\^B2", -1, 0, 68, 0, "(6) 103 17 100 18 65 106", "StartA 1 CodeB 2; BWIPP no manual mode" },
+        /* 22*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B1\\^A2", -1, 0, 68, 0, "(6) 104 17 101 18 68 106", "StartB 1 CodeA 2; BWIPP no manual mode" },
+        /* 23*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A1\\^C2", -1, 0, 57, 0, "(5) 103 17 18 53 106", "StartA 1 2 (manual C ignored as odd); BWIPP no manual mode" },
+        /* 24*/ { UNICODE_MODE, "123", -1, 0, 68, 1, "(6) 104 17 18 19 8 106", "StartB 1 2 3" },
+        /* 25*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^A123", -1, 0, 68, 0, "(6) 103 17 18 19 7 106", "StartA 1 2 3; BWIPP no manual mode" },
+        /* 26*/ { UNICODE_MODE, "1234", -1, 0, 57, 1, "(5) 105 12 34 82 106", "StartC 12 34" },
+        /* 27*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B1234", -1, 0, 79, 0, "(7) 104 17 18 19 20 88 106", "StartB 1 2 3 4; BWIPP no manual mode" },
+        /* 28*/ { UNICODE_MODE, "12345", -1, 0, 79, 1, "(7) 105 12 34 100 21 54 106", "StartC 12 34 CodeB 5" },
+        /* 29*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "1234\\^A5", -1, 0, 79, 0, "(7) 105 12 34 101 21 57 106", "StartC 12 34 CodeA 5; BWIPP no manual mode" },
+        /* 30*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B1\\^C2345", -1, 0, 79, 0, "(7) 104 17 99 23 45 53 106", "StartB 1 CodeC 23 45; BWIPP no manual mode" },
+        /* 31*/ { UNICODE_MODE, "\037", -1, 0, 46, 1, "(4) 103 95 95 106", "StartA US" },
+        /* 32*/ { UNICODE_MODE, "1\037", -1, 0, 57, 1, "(5) 103 17 95 1 106", "StartA 1 US" },
+        /* 33*/ { UNICODE_MODE, "12\037", -1, 0, 68, 1, "(6) 103 17 18 95 29 106", "StartA 1 2 US" },
+        /* 34*/ { UNICODE_MODE, "a\037a", -1, 0, 79, 1, "(7) 104 65 98 95 65 86 106", "StartB a Shift US a" },
+        /* 35*/ { UNICODE_MODE, "1234\037a", -1, 0, 101, 0, "(9) 105 12 34 101 95 98 65 100 106", "StartC 12 34 CodeA US Shift a; BWIPP different encodation" },
+        /* 36*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "1234\037\\^Ba", -1, 0, 101, 1, "(9) 105 12 34 101 95 100 65 7 106", "StartC 12 34 CodeA US CodeB a" },
+        /* 37*/ { UNICODE_MODE, "\037AAa\037", -1, 0, 101, 1, "(9) 103 95 33 33 98 65 95 2 106", "StartA US A A Shift a US" },
+        /* 38*/ { UNICODE_MODE, "\037AAaa\037", -1, 0, 123, 0, "(11) 103 95 33 33 100 65 65 98 95 40 106", "StartA US A A CodeB a a Shift US; BWIPP different encodation" },
+        /* 39*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\037AAaa\\^A\037", -1, 0, 123, 1, "(11) 103 95 33 33 100 65 65 101 95 61 106", "StartA US A A CodeB a a CodeA US" },
+        /* 40*/ { UNICODE_MODE, "AAAa12345aAA", -1, 0, 167, 1, "(15) 104 33 33 33 65 17 99 23 45 100 65 33 33 54 106", "StartB A (3) a 1 CodeC 23 45 CodeB a A A" },
+        /* 41*/ { UNICODE_MODE, "a\037Aa\037\037a\037aa\037a", -1, 0, 222, 1, "(20) 104 65 98 95 33 65 101 95 95 98 65 95 100 65 65 98 95 65 96 106", "StartB a Shift US A a CodeA US US Shift a US CodeB a a Shift US a" },
+        /* 42*/ { UNICODE_MODE, "\000\037Ã", 4, 0, 79, 1, "(7) 103 64 95 101 63 88 106", "StartA NUL US FNC4 Ã" },
+        /* 43*/ { UNICODE_MODE, "\000\037Ã©", 4, 0, 90, 0, "(8) 103 64 95 101 98 73 78 106", "StartA NUL US FNC4 Shift Ã©; BWIPP different encodation (CodeB instead of Shift)" },
+        /* 44*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\000\037\\^BÃ©", 7, 0, 90, 0, "(8) 103 64 95 100 100 73 83 106", "StartA NUL US CodeB FNC4 Ã©; BWIPP different encodation (FNC4 before CodeB)" },
+        /* 45*/ { UNICODE_MODE, "\000\037Ã©a", 5, 0, 101, 0, "(9) 103 64 95 100 100 73 65 61 106", "StartA NUL US CodeB FNC4 Ã© a; BWIPP different encodation (FNC4 before CodeB)" },
+        /* 46*/ { UNICODE_MODE, "abÃ", -1, 0, 79, 1, "(7) 104 65 66 100 63 29 106", "StartB a b FNC4 Ã" },
+        /* 47*/ { DATA_MODE, "\141\142\237", -1, 0, 90, 0, "(8) 104 65 66 100 98 95 26 106", "StartB a b FNC4 Shift APC; BWIPP different encodation" },
+        /* 48*/ { DATA_MODE, "\141\142\237\037", -1, 0, 101, 0, "(9) 104 65 66 101 101 95 95 96 106", "StartB a b CodeA FNC4 APC US; BWIPP different encodation" },
+        /* 49*/ { UNICODE_MODE, "Ã©Ã©Ã©", -1, 0, 90, 1, "(8) 104 100 100 73 73 73 44 106", "StartB LatchFNC4 Ã© Ã© Ã©" },
+        /* 50*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©b", -1, 0, 145, 1, "(13) 104 65 100 73 100 73 100 73 100 73 66 49 106", "StartB a FNC4 Ã© (4) b" },
+        /* 51*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©b", -1, 0, 145, 1, "(13) 104 65 100 100 73 73 73 73 73 100 66 93 106", "StartB a Latch Ã© (5) Shift b" },
+        /* 52*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bc", -1, 0, 167, 1, "(15) 104 65 100 100 73 73 73 73 73 100 66 100 67 40 106", "StartB a Latch Ã© (5) Shift b Shift c" },
+        /* 53*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcd", -1, 0, 178, 1, "(16) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 66 106", "StartB a Latch Ã© (5) Unlatch b c d" },
+        /* 54*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcde", -1, 0, 189, 1, "(17) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 2 106", "StartB a Latch Ã© (5) Unlatch b c d e" },
+        /* 55*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©", -1, 0, 211, 0, "(19) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 100 73 95 106", "StartB a Latch Ã© (5) Unlatch b c d e FNC4 Ã©; BWIPP different encodation" },
+        /* 56*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©Ã©", -1, 0, 233, 0, "(21) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 100 73 100 73 19 106", "StartB a Latch Ã© (5) Unlatch b c d e FNC4 Ã© (2); BWIPP different encodation" },
+        /* 57*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdeÃ©Ã©Ã©", -1, 0, 244, 1, "(22) 104 65 100 100 73 73 73 73 73 100 66 100 67 100 68 100 69 73 73 73 83 106", "StartB a Latch Ã© (5) Shift b Shift c Shift d Shift e Ã© (3)" },
+        /* 58*/ { UNICODE_MODE, "aÃ©Ã©Ã©Ã©Ã©bcdefÃ©Ã©Ã©", -1, 0, 255, 1, "(23) 104 65 100 100 73 73 73 73 73 100 100 66 67 68 69 70 100 100 73 73 73 67 106", "StartB a Latch Ã© (5) Unlatch b c d e f Latch Ã© (3)" },
+        /* 59*/ { DATA_MODE, "\200\200\200\200\200\101\060\060\060\060\101\200", -1, 0, 222, 1, "(20) 103 101 101 64 64 64 64 64 101 101 33 99 0 0 101 33 101 64 73 106", "StartA Latch PAD (4) Unlatch A CodeC 00 00 CodeA A FNC4 PAD" },
+        /* 60*/ { UNICODE_MODE, "ÃÃÃÃÃÃ99999999999999", -1, 0, 211, 0, "(19) 104 100 100 33 33 33 33 33 33 99 99 99 99 99 99 99 99 63 106", "Okapi code128/extended-mode-exit-before-code-set-c.png (chose different solution); BWIPP different encodation" },
+        /* 61*/ { UNICODE_MODE, "ÃÃÃÃÃÃ99999999999999Ã", -1, 0, 233, 0, "(21) 104 100 100 33 33 33 33 33 33 99 99 99 99 99 99 99 99 100 33 91 106", "Above with trailing non-shifted (as still latched) extended; BWIPP different encodation" },
+        /* 62*/ { DATA_MODE | EXTRA_ESCAPE_MODE, "@g(\302\302\302\302\3025555\302\302\302\302\302\302\302\302", -1, 0, 277, 0, "(25) 104 32 71 8 100 100 34 34 34 34 34 99 55 55 100 34 34 34 34 34 34 34 34 25 106", "Okapi code128/extended-mode-with-short-embedded-code-set-c.png (chose different solution); BWIPP different encodation" },
+        /* 63*/ { DATA_MODE | EXTRA_ESCAPE_MODE, "@g(\302\302\302\302\302555555\302\302\302\302\302\302\302", -1, 0, 277, 0, "(25) 104 32 71 8 100 100 34 34 34 34 34 99 55 55 55 100 34 34 34 34 34 34 34 76 106", "Above with extra 55 instead of \xC2; BWIPP different encodation" },
+        /* 64*/ { UNICODE_MODE, "ÃÃÃ¨ÃÃFÃ§7Z", -1, 0, 189, 0, "(17) 104 100 100 33 33 72 33 33 100 38 71 100 100 23 58 95 106", "Okapi code128/extended-mode-shift.png; BWIPP different encodation" },
+        /* 65*/ { UNICODE_MODE, "m\nm\nm", -1, 0, 112, 1, "(10) 104 77 98 74 77 98 74 77 11 106", "Okapi code128/code-set-b-a-b-a-b.png" },
+        /* 66*/ { UNICODE_MODE, "c\naDEF", -1, 0, 112, 1, "(10) 104 67 98 74 65 36 37 38 75 106", "Okapi bug-36-1.png" },
+        /* 67*/ { UNICODE_MODE, "\na\nDEF", -1, 0, 112, 1, "(10) 103 74 98 65 74 36 37 38 90 106", "Okapi bug-36-2.png" },
+        /* 68*/ { UNICODE_MODE, "Ã¿\012Ã a\0121\012Ã AÃ ", -1, 0, 222, 0, "(20) 104 100 95 98 74 100 64 65 98 74 17 98 74 100 64 33 100 64 61 106", "BWIPP different encodation, ShA instead of CodeA" },
+        /* 69*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "Ã¿\012Ã a\\^A\0121\012\\^BÃ AÃ ", -1, 0, 222, 0, "(20) 104 100 95 98 74 100 64 65 101 74 17 74 100 100 64 33 100 64 30 106", "BWIPP different encodation, FNC4 before CodeB" },
+        /* 70*/ { UNICODE_MODE, "Ã¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 387, 0, "(35) 104 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100 64", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /* 71*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "Ã¿1234\012Ã \\^Aa\0121\012\\^C7890\\^BÃ AÃ DÃ \012Ã ", -1, 0, 376, 0, "(34) 104 100 95 99 12 34 101 74 101 98 64 98 65 74 17 74 99 78 90 100 100 64 33 100 64 36", "BWIPP different encodation, FNC4 before CodeB, same width" },
+        /* 72*/ { UNICODE_MODE, "yÃ¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 398, 0, "(36) 104 89 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /* 73*/ { UNICODE_MODE, "Ã¿y1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 398, 0, "(36) 104 100 95 89 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33 100", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /* 74*/ { UNICODE_MODE, "Ã¿Ã¿1234\012Ã a\0121\0127890Ã AÃ DÃ \012Ã ", -1, 0, 409, 0, "(37) 104 100 95 100 95 99 12 34 101 74 100 100 64 65 98 74 17 98 74 99 78 90 100 100 64 33", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /* 75*/ { UNICODE_MODE, "Ã¿12345678\012Ã 12345678abcdef\0121\01223456\012\0127890Ã AÃ BCDEFÃ \012\012Ã ", -1, 0, 684, 0, "(62) 104 100 95 99 12 34 56 78 101 74 101 98 64 99 12 34 56 78 100 65 66 67 68 69 70 98 74", "BWIPP different encodation, CodeA instead of ShA, shorter" },
+        /* 76*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^B\\^A12\\^C34\\^A\\^B5\\^C67\\^A\\^B\\^CA\\^B\\^A", -1, 0, 145, 0, "(13) 103 17 18 99 34 100 21 99 67 100 33 69 106", "BWIPP no manual mode" },
+        /* 77*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "\\^C1234ABC12\012", -1, 0, 145, 0, "(13) 105 12 34 100 33 34 35 99 12 101 74 36 106", "StartC 12 34 CodeB A B C CodeC 12 CodeA LF; BWIPP no manual mode" },
+        /* 78*/ { UNICODE_MODE | EXTRA_ESCAPE_MODE, "A\\^", -1, 0, 68, 1, "(6) 104 33 60 62 31 106", "StartC 12 34 CodeB A B C CodeC 12 CodeA LF" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -428,14 +458,14 @@
         length = testUtilSetSymbol(symbol, BARCODE_CODE128, data[i].input_mode, -1 /*eci*/, -1 /*option_1*/, -1, -1, -1 /*output_options*/, data[i].data, data[i].length, debug);
 
         ret = ZBarcode_Encode(symbol, (unsigned char *) data[i].data, length);
-        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Encode ret %d != %d (%s)\n", i, ret, data[i].ret, symbol->errtxt);
 
         if (p_ctx->generate) {
             printf("        /*%3d*/ { %s, \"%s\", %d, %s, %d, %d, \"%s\", \"%s\" },\n",
                     i, testUtilInputModeName(data[i].input_mode), testUtilEscape(data[i].data, length, escaped, sizeof(escaped)), data[i].length,
-                    testUtilErrorName(data[i].ret), symbol->width, data[i].bwipp_cmp, symbol->errtxt, data[i].comment);
+                    testUtilErrorName(ret), symbol->width, data[i].bwipp_cmp, symbol->errtxt, data[i].comment);
         } else {
-            assert_zero(strcmp(symbol->errtxt, data[i].expected), "i:%d strcmp(%s, %s) != 0\n", i, symbol->errtxt, data[i].expected);
+            assert_equal(ret, data[i].ret, "i:%d ZBarcode_Encode ret %d != %d (%s)\n", i, ret, data[i].ret, symbol->errtxt);
+            assert_zero(strcmp(symbol->errtxt, data[i].expected), "i:%d strcmp(%s, %s) != 0 (width %d)\n", i, symbol->errtxt, data[i].expected, symbol->width);
             if (ret < ZINT_ERROR) {
                 assert_equal(symbol->width, data[i].expected_width, "i:%d symbol->width %d != %d (%s)\n", i, symbol->width, data[i].expected_width, data[i].data);
 
@@ -667,43 +697,46 @@
 
     struct item {
         int option_2;
+        int output_options;
         char *data;
         int ret;
         int expected_width;
+        float expected_height;
         char *expected;
         char *comment;
     };
     struct item data[] = {
-        /*  0*/ { -1, "12345678901234567890123456", ZINT_ERROR_TOO_LONG, -1, "Error 349: DPD input wrong length (27 or 28 characters required)", "" },
-        /*  1*/ { 1, "12345678901234567890123456", ZINT_ERROR_TOO_LONG, -1, "Error 830: DPD relabel input wrong length (27 characters required)", "" },
-        /*  2*/ { -1, "123456789012345678901234567", 0, 211, "(19) 104 5 17 99 23 45 67 89 1 23 45 67 89 1 23 45 67 51 106", "27 chars ok now, ident tag prefixed" },
-        /*  3*/ { -1, "%123456789012345678901234567", 0, 211, "(19) 104 5 17 99 23 45 67 89 1 23 45 67 89 1 23 45 67 51 106", "" },
-        /*  4*/ { 1, "123456789012345678901234567", 0, 200, "(18) 105 12 34 56 78 90 12 34 56 78 90 12 34 56 100 23 102 106", "27 chars also ok (and necessary) for relabel" },
-        /*  5*/ { -1, "12345678901234567890123456789", ZINT_ERROR_TOO_LONG, -1, "Error 349: DPD input wrong length (27 or 28 characters required)", "" },
-        /*  6*/ { 1, "1234567890123456789012345678", ZINT_ERROR_TOO_LONG, -1, "Error 830: DPD relabel input wrong length (27 characters required)", "" },
-        /*  7*/ { -1, "123456789012345678901234567,", ZINT_ERROR_INVALID_DATA, -1, "Error 299: Invalid character in data (alphanumerics only after first character)", "Alphanumerics only in body" },
-        /*  8*/ { -1, "12345678901234567890123456,", ZINT_ERROR_INVALID_DATA, -1, "Error 300: Invalid character in data (alphanumerics only)", "Alphanumerics only in body" },
-        /*  9*/ { -1, ",234567890123456789012345678", 0, 211, "(19) 104 12 18 99 34 56 78 90 12 34 56 78 90 12 34 56 78 64 106", "Non-alphanumeric DPD ident tag (Barcode ID) allowed" },
-        /* 10*/ { -1, "\037234567890123456789012345678", ZINT_ERROR_INVALID_DATA, -1, "Error 343: Invalid DPD identification tag (first character), ASCII values 32 to 127 only", "Control char <US> as DPD ident tag" },
-        /* 11*/ { -1, "Ã©234567890123456789012345678", ZINT_ERROR_INVALID_DATA, -1, "Error 343: Invalid DPD identification tag (first character), ASCII values 32 to 127 only", "Extended ASCII as DPD ident tag" },
-        /* 12*/ { -1, "12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 222, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 13*/ { -1, "%12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 222, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 14*/ { 1, "12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 200, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 15*/ { -1, "123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 233, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 16*/ { -1, "%123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 233, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 17*/ { 1, "123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 211, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
-        /* 18*/ { -1, "12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 19*/ { -1, "%12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 20*/ { 1, "12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 222, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 21*/ { -1, "123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 22*/ { -1, "%123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 23*/ { 1, "123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 222, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
-        /* 24*/ { -1, "12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 233, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
-        /* 25*/ { -1, "%12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 233, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
-        /* 26*/ { 1, "12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 211, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
-        /* 27*/ { -1, "12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
-        /* 28*/ { -1, "%12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 244, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
-        /* 29*/ { 1, "12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 222, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /*  0*/ { -1, -1, "12345678901234567890123456", ZINT_ERROR_TOO_LONG, -1, 0, "Error 349: DPD input wrong length (27 or 28 characters required)", "" },
+        /*  1*/ { 1, -1, "12345678901234567890123456", ZINT_ERROR_TOO_LONG, -1, 0, "Error 830: DPD relabel input wrong length (27 characters required)", "" },
+        /*  2*/ { -1, -1, "123456789012345678901234567", 0, 211, 50, "(19) 104 5 17 99 23 45 67 89 1 23 45 67 89 1 23 45 67 51 106", "27 chars ok now, ident tag prefixed" },
+        /*  3*/ { -1, -1, "%123456789012345678901234567", 0, 211, 50, "(19) 104 5 17 99 23 45 67 89 1 23 45 67 89 1 23 45 67 51 106", "" },
+        /*  4*/ { 1, -1, "123456789012345678901234567", 0, 200, 25, "(18) 105 12 34 56 78 90 12 34 56 78 90 12 34 56 100 23 102 106", "27 chars also ok (and necessary) for relabel" },
+        /*  5*/ { -1, -1, "12345678901234567890123456789", ZINT_ERROR_TOO_LONG, -1, 0, "Error 349: DPD input wrong length (27 or 28 characters required)", "" },
+        /*  6*/ { 1, -1, "1234567890123456789012345678", ZINT_ERROR_TOO_LONG, -1, 0, "Error 830: DPD relabel input wrong length (27 characters required)", "" },
+        /*  7*/ { -1, -1, "123456789012345678901234567,", ZINT_ERROR_INVALID_DATA, -1, 0, "Error 299: Invalid character in data (alphanumerics only after first character)", "Alphanumerics only in body" },
+        /*  8*/ { -1, -1, "12345678901234567890123456,", ZINT_ERROR_INVALID_DATA, -1, 0, "Error 300: Invalid character in data (alphanumerics only)", "Alphanumerics only in body" },
+        /*  9*/ { -1, -1, ",234567890123456789012345678", 0, 211, 50, "(19) 104 12 18 99 34 56 78 90 12 34 56 78 90 12 34 56 78 64 106", "Non-alphanumeric DPD ident tag (Barcode ID) allowed" },
+        /* 10*/ { -1, -1, "\037234567890123456789012345678", ZINT_ERROR_INVALID_DATA, -1, 0, "Error 343: Invalid DPD identification tag (first character), ASCII values 32 to 127 only", "Control char <US> as DPD ident tag" },
+        /* 11*/ { -1, -1, "Ã©234567890123456789012345678", ZINT_ERROR_INVALID_DATA, -1, 0, "Error 343: Invalid DPD identification tag (first character), ASCII values 32 to 127 only", "Extended ASCII as DPD ident tag" },
+        /* 12*/ { -1, -1, "12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 222, 50, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 13*/ { -1, -1, "%12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 222, 50, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 14*/ { 1, -1, "12345678901234567890123456A", ZINT_WARN_NONCOMPLIANT, 200, 25, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 15*/ { -1, -1, "123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 233, 50, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 16*/ { -1, -1, "%123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 233, 50, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 17*/ { 1, -1, "123456789012345678901234A67", ZINT_WARN_NONCOMPLIANT, 211, 25, "Warning 831: Destination Country Code (last 3 characters) should be numeric", "" },
+        /* 18*/ { -1, -1, "12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 19*/ { -1, -1, "%12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 20*/ { 1, -1, "12345678901234567890123A567", ZINT_WARN_NONCOMPLIANT, 222, 25, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 21*/ { -1, -1, "123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 22*/ { -1, -1, "%123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 23*/ { 1, -1, "123456789012345678901A34567", ZINT_WARN_NONCOMPLIANT, 222, 25, "Warning 832: Service Code (characters 6-4 from end) should be numeric", "" },
+        /* 24*/ { -1, -1, "12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 233, 50, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 25*/ { -1, -1, "%12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 233, 50, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 26*/ { 1, -1, "12345678901234567890A234567", ZINT_WARN_NONCOMPLIANT, 211, 25, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 27*/ { -1, -1, "12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 28*/ { -1, -1, "%12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 244, 50, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 29*/ { 1, -1, "12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 222, 25, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
+        /* 30*/ { 1, COMPLIANT_HEIGHT, "12345678901A345678901234567", ZINT_WARN_NONCOMPLIANT, 222, 33.333332, "Warning 833: Last 10 characters of Tracking Number (characters 16-7 from end) should be numeric", "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -722,18 +755,20 @@
 
         symbol->debug = ZINT_DEBUG_TEST; /* Needed to get codeword dump in errtxt */
 
-        length = testUtilSetSymbol(symbol, BARCODE_DPD, UNICODE_MODE, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, -1 /*output_options*/, data[i].data, -1, debug);
+        length = testUtilSetSymbol(symbol, BARCODE_DPD, UNICODE_MODE, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, data[i].output_options, data[i].data, -1, debug);
 
         ret = ZBarcode_Encode(symbol, (unsigned char *) data[i].data, length);
         assert_equal(ret, data[i].ret, "i:%d ZBarcode_Encode ret %d != %d (%s)\n", i, ret, data[i].ret, symbol->errtxt);
 
         if (p_ctx->generate) {
-            printf("        /*%3d*/ { %d, \"%s\", %s, %d, \"%s\", \"%s\" },\n",
-                    i, data[i].option_2, testUtilEscape(data[i].data, length, escaped, sizeof(escaped)),
-                    testUtilErrorName(data[i].ret), symbol->width, symbol->errtxt, data[i].comment);
+            printf("        /*%3d*/ { %d, %s, \"%s\", %s, %d, %.8g, \"%s\", \"%s\" },\n",
+                    i, data[i].option_2, testUtilOutputOptionsName(data[i].output_options),
+                    testUtilEscape(data[i].data, length, escaped, sizeof(escaped)),
+                    testUtilErrorName(data[i].ret), symbol->width, symbol->height, symbol->errtxt, data[i].comment);
         } else {
             if (ret < ZINT_ERROR) {
                 assert_equal(symbol->width, data[i].expected_width, "i:%d symbol->width %d != %d (%s)\n", i, symbol->width, data[i].expected_width, data[i].data);
+                assert_equal(symbol->height, data[i].expected_height, "i:%d symbol->height %.8g != %.8g (%s)\n", i, symbol->height, data[i].expected_height, data[i].data);
             }
             assert_zero(strcmp(symbol->errtxt, data[i].expected), "i:%d strcmp(%s, %s) != 0\n", i, symbol->errtxt, data[i].expected);
         }
@@ -773,6 +808,8 @@
         /* 15*/ { "JB123456785AB", ZINT_WARN_NONCOMPLIANT, 156, "Warning 839: Invalid Service Indicator (first character should not be any of \"JKSTW\")", "" },
         /* 16*/ { "FB123456785AB", ZINT_WARN_NONCOMPLIANT, 156, "Warning 840: Non-standard Service Indicator (first 2 characters)", "" },
         /* 17*/ { "AB123456785AB", ZINT_WARN_NONCOMPLIANT, 156, "Warning 841: Country code (last two characters) is not ISO 3166-1", "" },
+        /* 18*/ { "AB123100000IE", 0, 156, "", "Check digit 10 -> 0" },
+        /* 19*/ { "AB000000005IE", 0, 156, "", "Check digit 11 -> 5" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_common.c zint/backend/tests/test_common.c
--- zint-2.12.0/backend/tests/test_common.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_common.c	2023-05-08 14:39:44.919319688 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -381,6 +381,8 @@
     testFinish();
 }
 
+INTERNAL void debug_test_codeword_dump_int(struct zint_symbol *symbol, const int *codewords, const int length);
+
 static void test_debug_test_codeword_dump_int(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
diff -urN zint-2.12.0/backend/tests/testcommon.c zint/backend/tests/testcommon.c
--- zint-2.12.0/backend/tests/testcommon.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/testcommon.c	2023-05-08 14:39:44.953319888 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -364,7 +364,7 @@
 
 /* Helper to set common symbol fields */
 int testUtilSetSymbol(struct zint_symbol *symbol, int symbology, int input_mode, int eci, int option_1, int option_2,
-            int option_3, int output_options, char *data, int length, int debug) {
+            int option_3, int output_options, const char *data, int length, int debug) {
     symbol->symbology = symbology;
     if (input_mode != -1) {
         symbol->input_mode = input_mode;
@@ -453,6 +453,7 @@
         { "GS1NOCHECK_MODE", GS1NOCHECK_MODE, 0x0020 },
         { "HEIGHTPERROW_MODE", HEIGHTPERROW_MODE, 0x0040 },
         { "FAST_MODE", FAST_MODE, 0x0080 },
+        { "EXTRA_ESCAPE_MODE", EXTRA_ESCAPE_MODE, 0x0100 },
     };
     static const int data_size = ARRAY_SIZE(data);
     int set, i;
@@ -2308,14 +2309,31 @@
                 /*case 'x': val = 0; TODO: implement break; */
                 case '\\': val = '\\'; break;
                 /*case 'u': val = 0; TODO: implement break; */
+                case '^': val = -1; break; /* Code 128 special escapes */
                 default: fprintf(stderr, "testUtilBwippEscape: unknown escape %c\n", *d); return NULL; break;
             }
-            if (b + 4 >= be) {
-                fprintf(stderr, "testUtilBwippEscape: loop bwipp_data buffer full (%d)\n", bwipp_data_size);
-                return NULL;
+            if (val >= 0) {
+                if (b + 4 >= be) {
+                    fprintf(stderr, "testUtilBwippEscape: loop bwipp_data buffer full (%d)\n", bwipp_data_size);
+                    return NULL;
+                }
+                sprintf(b, "^%03d", val);
+                b += 4;
+            } else {
+                if (d + 1 < de && *(d + 1) >= 'A' && *(d + 1) <= 'C') {
+                    d++;
+                } else {
+                    if (b + 8 >= be) {
+                        fprintf(stderr, "testUtilBwippEscape: loop bwipp_data buffer full (%d)\n", bwipp_data_size);
+                        return NULL;
+                    }
+                    sprintf(b, "^%03d^%03d", '\\', *d);
+                    b += 8;
+                    if (*d == '^') {
+                        d++;
+                    }
+                }
             }
-            sprintf(b, "^%03d", val);
-            b += 4;
             d++;
             *parse = 1;
         } else {
@@ -2416,11 +2434,21 @@
                                     " backend/tests/tools/bwipp_dump.ps";
     static const char cmd_opts_fmt[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%s' -so='%s'"
                                         " backend/tests/tools/bwipp_dump.ps";
-    /* If data > 2K */
-    static const char cmd_fmt2[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2043s' -sd2='%s'"
+    /* If data > 2K and < ~4K */
+    static const char cmd_fmt2[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%s'"
+                                        " backend/tests/tools/bwipp_dump.ps";
+    static const char cmd_opts_fmt2[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%s' -so='%s'"
                                         " backend/tests/tools/bwipp_dump.ps";
-    static const char cmd_opts_fmt2[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2043s' -sd2='%s' -so='%s'"
+    /* If data > ~4K and < ~6K */
+    static const char cmd_fmt3[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%.2040s' -sd3='%s'"
                                         " backend/tests/tools/bwipp_dump.ps";
+    static const char cmd_opts_fmt3[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%.2040s' -sd3='%s'"
+                                        " -so='%s' backend/tests/tools/bwipp_dump.ps";
+    /* If data > ~6K and < ~8K */
+    static const char cmd_fmt4[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%.2040s' -sd3='%.2040s'"
+                                        " -sd4='%s' backend/tests/tools/bwipp_dump.ps";
+    static const char cmd_opts_fmt4[] = "gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=%s -sd='%.2040s' -sd2='%.2040s'"
+                                        " -sd3='%.2040s' -sd4='%s' -so='%s' backend/tests/tools/bwipp_dump.ps";
 
     const int symbology = symbol->symbology;
     int data_len = length == -1 ? (int) strlen(data) : length;
@@ -2565,8 +2593,8 @@
                 /* sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%sdontlint", strlen(bwipp_opts_buf) ? " " : ""); */
             }
         } else {
-            if (testUtilBwippEscape(bwipp_data, bwipp_data_size, data, data_len, symbol->input_mode & ESCAPE_MODE,
-                    eci, &parse, &parsefnc) == NULL) {
+            if (testUtilBwippEscape(bwipp_data, bwipp_data_size, data, data_len,
+                    symbol->input_mode & (ESCAPE_MODE | EXTRA_ESCAPE_MODE), eci, &parse, &parsefnc) == NULL) {
                 return -1;
             }
             if (parse) {
@@ -2600,7 +2628,6 @@
                     *bwipp_data = '0';
                 }
             } else if (symbology == BARCODE_CODABLOCKF || symbology == BARCODE_HIBC_BLOCKF) {
-                sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%ssepheight=0", strlen(bwipp_opts_buf) ? " " : "");
                 if (option_1 > 0) {
                     sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%srows=%d",
                             strlen(bwipp_opts_buf) ? " " : "", option_1);
@@ -2713,14 +2740,13 @@
                 strcpy(bwipp_data, "fima");
                 bwipp_data[3] = z_isupper(data[0]) ? data[0] - 'A' + 'a' : data[0];
             } else if (symbology == BARCODE_CODE16K || symbology == BARCODE_CODE49) {
-                sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%ssepheight=0", strlen(bwipp_opts_buf) ? " " : "");
-                bwipp_opts = bwipp_opts_buf;
                 if (option_1 >= 2) {
                     if ((symbology == BARCODE_CODE16K && option_1 <= 16)
                             || (symbology == BARCODE_CODE49 && option_1 <= 8 && option_1 >= symbol->rows)) {
                         sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%srows=%d",
                             strlen(bwipp_opts_buf) ? " " : "", option_1);
                     }
+                    bwipp_opts = bwipp_opts_buf;
                 }
             } else if (symbology == BARCODE_AZTEC || symbology == BARCODE_HIBC_AZTEC) {
                 int compact = 0, full = 0;
@@ -2832,7 +2858,7 @@
                             strlen(bwipp_opts_buf) ? " " : "", mode);
                     bwipp_opts = bwipp_opts_buf;
                 }
-                if (primary_len) {
+                if (primary_len >= 6) { /* Keep gcc happy */
                     char prefix_buf[30];
                     int prefix_len;
                     int postcode_len = primary_len - 6;
@@ -2998,16 +3024,13 @@
                 }
             }
         } else if (symbology == BARCODE_ULTRA) {
+            const int rev = option_2 == 2 ? 2 : 1;
             if (option_1 >= 1 && option_1 <= 6) {
                 sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%seclevel=EC%d",
                         strlen(bwipp_opts_buf) ? " " : "", option_1 - 1);
-                bwipp_opts = bwipp_opts_buf;
-            }
-            if (option_2 >= 1 && option_2 <= 2) {
-                sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%srev=%d",
-                        strlen(bwipp_opts_buf) ? " " : "", option_2);
-                bwipp_opts = bwipp_opts_buf;
             }
+            sprintf(bwipp_opts_buf + strlen(bwipp_opts_buf), "%srev=%d", strlen(bwipp_opts_buf) ? " " : "", rev);
+            bwipp_opts = bwipp_opts_buf;
         }
     }
 
@@ -3019,14 +3042,33 @@
     }
 
     if (bwipp_opts && strlen(bwipp_opts)) {
-        if (strlen(bwipp_data) >= 2043) { /* Ghostscript's `arg_str_max` 2048 less "-sd=" */
-            sprintf(cmd, cmd_opts_fmt2, bwipp_barcode, bwipp_data, bwipp_data + 2043, bwipp_opts);
+        if (strlen(bwipp_data) >= 2040) { /* Ghostscript's `arg_str_max` 2048 less "-sd?=" + quotes */
+            if (strlen(bwipp_data) >= 2040 * 2) {
+                if (strlen(bwipp_data) >= 2040 * 3) {
+                    sprintf(cmd, cmd_opts_fmt4, bwipp_barcode, bwipp_data, bwipp_data + 2040, bwipp_data + 2040 * 2,
+                            bwipp_data + 2040 * 3, bwipp_opts);
+                } else {
+                    sprintf(cmd, cmd_opts_fmt3, bwipp_barcode, bwipp_data, bwipp_data + 2040, bwipp_data + 2040 * 2,
+                            bwipp_opts);
+                }
+            } else {
+                sprintf(cmd, cmd_opts_fmt2, bwipp_barcode, bwipp_data, bwipp_data + 2040, bwipp_opts);
+            }
         } else {
             sprintf(cmd, cmd_opts_fmt, bwipp_barcode, bwipp_data, bwipp_opts);
         }
     } else {
-        if (strlen(bwipp_data) >= 2043) {
-            sprintf(cmd, cmd_fmt2, bwipp_barcode, bwipp_data, bwipp_data + 2043);
+        if (strlen(bwipp_data) >= 2040) {
+            if (strlen(bwipp_data) >= 2040 * 2) {
+                if (strlen(bwipp_data) >= 2040 * 3) {
+                    sprintf(cmd, cmd_fmt4, bwipp_barcode, bwipp_data, bwipp_data + 2040, bwipp_data + 2040 * 2,
+                            bwipp_data + 2040 * 3);
+                } else {
+                    sprintf(cmd, cmd_fmt3, bwipp_barcode, bwipp_data, bwipp_data + 2040, bwipp_data + 2040 * 2);
+                }
+            } else {
+                sprintf(cmd, cmd_fmt2, bwipp_barcode, bwipp_data, bwipp_data + 2040);
+            }
         } else {
             sprintf(cmd, cmd_fmt, bwipp_barcode, bwipp_data);
         }
@@ -3669,7 +3711,8 @@
 
     const int is_dbar_exp = symbology == BARCODE_DBAR_EXP || symbology == BARCODE_DBAR_EXPSTK;
     const int gs1 = (symbol->input_mode & 0x07) == GS1_MODE || is_dbar_exp;
-    const int is_escaped = symbol->input_mode & ESCAPE_MODE;
+    const int is_extra_escaped = (symbol->input_mode & EXTRA_ESCAPE_MODE) && symbol->symbology == BARCODE_CODE128;
+    const int is_escaped = (symbol->input_mode & ESCAPE_MODE) || is_extra_escaped;
     const int is_hibc = symbology >= BARCODE_HIBC_128 && symbology <= BARCODE_HIBC_AZTEC;
     const int have_c25checkdigit = symbol->option_2 == 1 || symbol->option_2 == 2;
     const int have_c25inter = (symbology == BARCODE_C25INTER && ((expected_len & 1) || have_c25checkdigit))
@@ -3677,13 +3720,14 @@
                                 || symbology == BARCODE_DPIDENT;
     const int is_upcean = is_extendable(symbology);
     const int need_dpd_prefix = (symbology == BARCODE_DPD && expected_len == 27 && symbol->option_2 != 1);
+    const int is_vin_international = symbology == BARCODE_VIN && (symbol->option_2 & 1);
 
     char *reduced = gs1 ? (char *) z_alloca(expected_len + 1) : NULL;
     char *escaped = is_escaped ? (char *) z_alloca(expected_len + 1) : NULL;
     char *hibc = is_hibc ? (char *) z_alloca(expected_len + 2 + 1) : NULL;
     char *maxi = symbology == BARCODE_MAXICODE && primary
                     ? (char *) z_alloca(expected_len + strlen(primary) + 6 + 9 + 1) : NULL;
-    char *vin = symbology == BARCODE_VIN && (symbol->option_2 & 1) ? (char *) z_alloca(expected_len + 1 + 1) : NULL;
+    char *vin = is_vin_international ? (char *) z_alloca(expected_len + 1 + 1) : NULL;
     char *c25inter = have_c25inter ? (char *) z_alloca(expected_len + 13 + 1 + 1) : NULL;
     char *upcean = is_upcean ? (char *) z_alloca(expected_len + 1 + 1) : NULL;
     char *ean14_nve18 = symbology == BARCODE_EAN14 || symbology == BARCODE_NVE18
@@ -3704,10 +3748,31 @@
 
     if (is_escaped) {
         memcpy(escaped, expected, expected_len);
-        ret = escape_char_process_test(symbol, (unsigned char *) escaped, &expected_len);
-        if (ret != 0) {
-            sprintf(msg, "escape_char_process %d != 0", ret);
-            return 3;
+        if (symbol->input_mode & ESCAPE_MODE) {
+            ret = escape_char_process_test(symbol, (unsigned char *) escaped, &expected_len);
+            if (ret != 0) {
+                sprintf(msg, "escape_char_process %d != 0", ret);
+                return 3;
+            }
+        }
+        if (is_extra_escaped) {
+            /* Remove any Code 128 special escapes */
+            int j = 0;
+            for (i = 0; i < expected_len; i++) {
+                if (escaped[i] == '\\' && i + 2 < expected_len && escaped[i + 1] == '^'
+                        && ((escaped[i + 2] >= 'A' && escaped[i + 2] <= 'C') || escaped[i + 2] == '^')) {
+                    if (escaped[i + 2] != '^') {
+                        i += 2;
+                    } else {
+                        escaped[j++] = escaped[i++];
+                        escaped[j++] = escaped[i++];
+                    }
+                } else {
+                    escaped[j++] = escaped[i];
+                }
+            }
+            expected_len = j;
+            escaped[expected_len] = '\0';
         }
         expected = escaped;
     }
@@ -3778,13 +3843,11 @@
         if (symbol->option_2 == 1 || symbol->option_2 == 2) {
             cmp_len--; /* Too messy to calc the check digit so ignore */
         }
-    } else if (symbology == BARCODE_VIN) {
-        if (symbol->option_2 & 1) {
-            vin[0] = 'I';
-            memcpy(vin + 1, expected, expected_len);
-            vin[++expected_len] = '\0';
-            expected = vin;
-        }
+    } else if (is_vin_international) {
+        vin[0] = 'I';
+        memcpy(vin + 1, expected, expected_len);
+        vin[++expected_len] = '\0';
+        expected = vin;
     } else if (have_c25inter) {
         if (symbology == BARCODE_C25INTER) {
             if ((expected_len & 1) || have_c25checkdigit) {
diff -urN zint-2.12.0/backend/tests/testcommon.h zint/backend/tests/testcommon.h
--- zint-2.12.0/backend/tests/testcommon.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/testcommon.h	2023-05-08 14:39:44.953319888 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -129,7 +129,7 @@
 INTERNAL void vector_free(struct zint_symbol *symbol); /* Free vector structures */
 
 int testUtilSetSymbol(struct zint_symbol *symbol, int symbology, int input_mode, int eci,
-            int option_1, int option_2, int option_3, int output_options, char *data, int length, int debug);
+            int option_1, int option_2, int option_3, int output_options, const char *data, int length, int debug);
 
 const char *testUtilBarcodeName(int symbology);
 const char *testUtilErrorName(int error_number);
diff -urN zint-2.12.0/backend/tests/test_dmatrix.c zint/backend/tests/test_dmatrix.c
--- zint-2.12.0/backend/tests/test_dmatrix.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_dmatrix.c	2023-05-08 14:39:44.922319706 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -1607,7 +1607,31 @@
                     "10110000011010101010011010011000"
                     "11111111111111111111111111111111"
                 },
-        /* 26*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]09512345678901[15]170810[21]abcde", -1, 0, 20, 20, 1, "GGS Figure 5.6.2-1", 0,
+        /* 26*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]09524000059109[21]12345678p901[10]1234567p[17]271120", -1, 0, 22, 22, 1, "GGS v23 Figure 4.15.1-1 (and 4.15.1-3 and 4.15.1-4)", 0,
+                    "1010101010101010101010"
+                    "1100111101000011000111"
+                    "1000101101111100100100"
+                    "1011101100100110001001"
+                    "1110010100001000011100"
+                    "1000010100110100101101"
+                    "1001000111010000011000"
+                    "1001011010110001101111"
+                    "1110101000001000100100"
+                    "1101110011011000101001"
+                    "1001101000010110100010"
+                    "1011001101011011001001"
+                    "1110110011101011011010"
+                    "1110010101001100110001"
+                    "1010001000011110011100"
+                    "1111101111110110001111"
+                    "1101011110011111010010"
+                    "1010001011101101101101"
+                    "1110010011011110100010"
+                    "1001011100110011100111"
+                    "1001110001100110100100"
+                    "1111111111111111111111"
+                },
+        /* 27*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]09512345678901[15]170810[21]abcde", -1, 0, 20, 20, 1, "GGS Figure 5.6.2-1", 0,
                     "10101010101010101010"
                     "11001111010111100111"
                     "10001010100101010100"
@@ -1629,7 +1653,7 @@
                     "10011010101001110010"
                     "11111111111111111111"
                 },
-        /* 27*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]09512345678901[15]170810[21]abcde", -1, 0, 20, 20, 1, "GGS Figure 5.6.2-1", 0,
+        /* 28*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]09512345678901[15]170810[21]abcde", -1, 0, 20, 20, 1, "GGS Figure 5.6.2-1", 0,
                     "10101010101010101010"
                     "11001111010111100111"
                     "10001010100101010100"
@@ -1651,7 +1675,7 @@
                     "10011010101001110010"
                     "11111111111111111111"
                 },
-        /* 28*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]00012345678905[17]040115", -1, 0, 12, 26, 1, "GGS Figure 5.6.3.1-1 (left)", 0,
+        /* 29*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]00012345678905[17]040115", -1, 0, 12, 26, 1, "GGS Figure 5.6.3.1-1 (left)", 0,
                     "10101010101010101010101010"
                     "11001000010011010100111111"
                     "10001001100010001111001010"
@@ -1665,7 +1689,7 @@
                     "10001001100010100010100000"
                     "11111111111111111111111111"
                 },
-        /* 29*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]00012345678905[17]040115", -1, 0, 12, 26, 1, "GGS Figure 5.6.3.1-1 (left)", 0,
+        /* 30*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]00012345678905[17]040115", -1, 0, 12, 26, 1, "GGS Figure 5.6.3.1-1 (left)", 0,
                     "10101010101010101010101010"
                     "11001000010011010100111111"
                     "10001001100010001111001010"
@@ -1679,7 +1703,7 @@
                     "10001001100010100010100000"
                     "11111111111111111111111111"
                 },
-        /* 30*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "[01]00012345678905[17]040115", -1, 0, 18, 18, 1, "GGS Figure 5.6.3.1-1 (right)", 0,
+        /* 31*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "[01]00012345678905[17]040115", -1, 0, 18, 18, 1, "GGS Figure 5.6.3.1-1 (right)", 0,
                     "101010101010101010"
                     "110010000100010101"
                     "100010011010111110"
@@ -1699,7 +1723,7 @@
                     "100000101110000100"
                     "111111111111111111"
                 },
-        /* 31*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, DM_SQUARE, "[01]00012345678905[17]040115", -1, 0, 18, 18, 1, "GGS Figure 5.6.3.1-1 (right)", 0,
+        /* 32*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, DM_SQUARE, "[01]00012345678905[17]040115", -1, 0, 18, 18, 1, "GGS Figure 5.6.3.1-1 (right)", 0,
                     "101010101010101010"
                     "110010000100010101"
                     "100010011010111110"
@@ -1719,7 +1743,7 @@
                     "100000101110000100"
                     "111111111111111111"
                 },
-        /* 32*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]ABCDEFGHI123456789[92]abcdefghi", -1, 0, 32, 32, 0, "GGS Figure 5.6.3.2-3 (left) **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /* 33*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]ABCDEFGHI123456789[92]abcdefghi", -1, 0, 32, 32, 0, "GGS Figure 5.6.3.2-3 (left) **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "10101010101010101010101010101010"
                     "11001000010111111000100110101011"
                     "10001001100001101100110010100010"
@@ -1753,7 +1777,7 @@
                     "11110110001001001010110111010110"
                     "11111111111111111111111111111111"
                 },
-        /* 33*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]ABCDEFGHI123456789[92]abcdefghi", -1, 0, 32, 32, 0, "GGS Figure 5.6.3.2-3 (left) **NOT SAME** different encodation; BWIPP different encodation", 2,
+        /* 34*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]ABCDEFGHI123456789[92]abcdefghi", -1, 0, 32, 32, 0, "GGS Figure 5.6.3.2-3 (left) **NOT SAME** different encodation; BWIPP different encodation", 2,
                     "10101010101010101010101010101010"
                     "11001000010111111001100001001011"
                     "10001001100001101101000101000010"
@@ -1787,7 +1811,7 @@
                     "11110000001011001010110001000110"
                     "11111111111111111111111111111111"
                 },
-        /* 34*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, 30, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]abcdefghi", -1, 0, 16, 48, 1, "GGS Figure 5.6.3.2-3 (right) **NOT SAME** different encodation", 0,
+        /* 35*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, 30, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]abcdefghi", -1, 0, 16, 48, 1, "GGS Figure 5.6.3.2-3 (right) **NOT SAME** different encodation", 0,
                     "101010101010101010101010101010101010101010101010"
                     "110010000101111001000011101101100100111011001111"
                     "100010011000011101111100100100011000110010111100"
@@ -1805,7 +1829,7 @@
                     "101110001010001011101010101101111111111000000100"
                     "111111111111111111111111111111111111111111111111"
                 },
-        /* 35*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, 30, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]abcdefghi", -1, 0, 16, 48, 0, "GGS Figure 5.6.3.2-3 (right) **NOT SAME** different encodation; BWIPP same as FAST_MODE", 2,
+        /* 36*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, 30, -1, "[01]00012345678905[17]180401[21]ABCDEFGHIJKL12345678[91]abcdefghi", -1, 0, 16, 48, 0, "GGS Figure 5.6.3.2-3 (right) **NOT SAME** different encodation; BWIPP same as FAST_MODE", 2,
                     "101010101010101010101010101010101010101010101010"
                     "110010000101111001000011101101100100111011001111"
                     "100010011000011101111100100100011000110010111100"
@@ -1823,7 +1847,7 @@
                     "101110001010001011101010101101111111111000000100"
                     "111111111111111111111111111111111111111111111111"
                 },
-        /* 36*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "[00]395011010013000129[403]123+1021JK+0320+12[421]5281500KM", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-6 **NOT SAME** figure has unnecessary FNC1 at end of data", 0,
+        /* 37*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "[00]395011010013000129[403]123+1021JK+0320+12[421]5281500KM", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-6 **NOT SAME** figure has unnecessary FNC1 at end of data", 0,
                     "101010101010101010101010"
                     "110001110100011010101101"
                     "100010100100101000011000"
@@ -1849,7 +1873,7 @@
                     "111001011011101100011010"
                     "111111111111111111111111"
                 },
-        /* 37*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, DM_SQUARE, "[00]395011010013000129[403]123+1021JK+0320+12[421]5281500KM", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-6 **NOT SAME** figure has unnecessary FNC1 at end of data", 0,
+        /* 38*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, DM_SQUARE, "[00]395011010013000129[403]123+1021JK+0320+12[421]5281500KM", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-6 **NOT SAME** figure has unnecessary FNC1 at end of data", 0,
                     "101010101010101010101010"
                     "110001110100011010101101"
                     "100010100100101000011000"
@@ -1875,7 +1899,7 @@
                     "111001011011101100011010"
                     "111111111111111111111111"
                 },
-        /* 38*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[00]093123450000000012[421]0362770[401]931234518430GR[403]MEL", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-7 **NOT SAME** different encodation", 0,
+        /* 39*/ { BARCODE_DATAMATRIX, GS1_MODE | FAST_MODE, -1, -1, -1, -1, "[00]093123450000000012[421]0362770[401]931234518430GR[403]MEL", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-7 **NOT SAME** different encodation", 0,
                     "101010101010101010101010"
                     "110011100101100110110101"
                     "100010001001111010000100"
@@ -1901,7 +1925,7 @@
                     "101110011001110010101010"
                     "111111111111111111111111"
                 },
-        /* 39*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[00]093123450000000012[421]0362770[401]931234518430GR[403]MEL", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-7 **NOT SAME** different encodation", 0,
+        /* 40*/ { BARCODE_DATAMATRIX, GS1_MODE, -1, -1, -1, -1, "[00]093123450000000012[421]0362770[401]931234518430GR[403]MEL", -1, 0, 24, 24, 1, "GGS Figure 6.6.5-7 **NOT SAME** different encodation", 0,
                     "101010101010101010101010"
                     "110011100101100110110101"
                     "100010001001111010000100"
@@ -1927,7 +1951,7 @@
                     "101110011001110010101010"
                     "111111111111111111111111"
                 },
-        /* 40*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "A123BJC5D6E71", -1, 0, 16, 16, 0, "HIBC/LIC Figure 3 same; BWIPP different encodation, same no. of codewords", 0,
+        /* 41*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "A123BJC5D6E71", -1, 0, 16, 16, 0, "HIBC/LIC Figure 3 same; BWIPP different encodation, same no. of codewords", 0,
                     "1010101010101010"
                     "1011101001111011"
                     "1000001100010100"
@@ -1945,7 +1969,7 @@
                     "1111100111000010"
                     "1111111111111111"
                 },
-        /* 41*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "A123BJC5D6E71", -1, 0, 16, 16, 0, "HIBC/LIC Figure 3 **NOT SAME** (see FAST_MODE); BWIPP different encodation", 0,
+        /* 42*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "A123BJC5D6E71", -1, 0, 16, 16, 0, "HIBC/LIC Figure 3 **NOT SAME** (see FAST_MODE); BWIPP different encodation", 0,
                     "1010101010101010"
                     "1011101100110101"
                     "1000110001101100"
@@ -1963,7 +1987,7 @@
                     "1000100111000010"
                     "1111111111111111"
                 },
-        /* 42*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "A123BJC5D6E71/$$52001510X3", -1, 0, 20, 20, 0, "HIBC/LIC Section 4.3.3 **NOT SAME** different encodation; also figure has weird CRLF after check digit; BWIPP different encodation", 0,
+        /* 43*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "A123BJC5D6E71/$$52001510X3", -1, 0, 20, 20, 0, "HIBC/LIC Section 4.3.3 **NOT SAME** different encodation; also figure has weird CRLF after check digit; BWIPP different encodation", 0,
                     "10101010101010101010"
                     "10111011000101100001"
                     "10000110011010101100"
@@ -1985,7 +2009,7 @@
                     "10010010010000100010"
                     "11111111111111111111"
                 },
-        /* 43*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "A123BJC5D6E71/$$52001510X3", -1, 0, 20, 20, 0, "HIBC/LIC Section 4.3.3 **NOT SAME** different encodation; also figure has weird CRLF after check digit; BWIPP different encodation", 0,
+        /* 44*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "A123BJC5D6E71/$$52001510X3", -1, 0, 20, 20, 0, "HIBC/LIC Section 4.3.3 **NOT SAME** different encodation; also figure has weird CRLF after check digit; BWIPP different encodation", 0,
                     "10101010101010101010"
                     "10111011011011011001"
                     "10001100010010100100"
@@ -2007,7 +2031,7 @@
                     "10011111101001100010"
                     "11111111111111111111"
                 },
-        /* 44*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "H123ABC01234567890", -1, 0, 12, 26, 1, "HIBC/LIC Figure C2, same", 0,
+        /* 45*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "H123ABC01234567890", -1, 0, 12, 26, 1, "HIBC/LIC Figure C2, same", 0,
                     "10101010101010101010101010"
                     "10111011011011110101001101"
                     "10010110000001001100110100"
@@ -2021,7 +2045,7 @@
                     "10010010001100110000011010"
                     "11111111111111111111111111"
                 },
-        /* 45*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "H123ABC01234567890", -1, 0, 12, 26, 1, "HIBC/LIC Figure C2, same", 0,
+        /* 46*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "H123ABC01234567890", -1, 0, 12, 26, 1, "HIBC/LIC Figure C2, same", 0,
                     "10101010101010101010101010"
                     "10111011011011110101001101"
                     "10010110000001001100110100"
@@ -2035,7 +2059,7 @@
                     "10010010001100110000011010"
                     "11111111111111111111111111"
                 },
-        /* 46*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, DM_SQUARE, "/ACMRN123456/V200912190833", -1, 0, 20, 20, 1, "HIBC/PAS Section 2.2 Patient Id, same", 0,
+        /* 47*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, DM_SQUARE, "/ACMRN123456/V200912190833", -1, 0, 20, 20, 1, "HIBC/PAS Section 2.2 Patient Id, same", 0,
                     "10101010101010101010"
                     "10001000010011001001"
                     "11100110001010110100"
@@ -2057,7 +2081,7 @@
                     "10000100100110010010"
                     "11111111111111111111"
                 },
-        /* 47*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, DM_SQUARE, "/ACMRN123456/V200912190833", -1, 0, 20, 20, 0, "HIBC/PAS Section 2.2 Patient Id **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
+        /* 48*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, DM_SQUARE, "/ACMRN123456/V200912190833", -1, 0, 20, 20, 0, "HIBC/PAS Section 2.2 Patient Id **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
                     "10101010101010101010"
                     "11000000010011001111"
                     "11010001101010110110"
@@ -2079,7 +2103,7 @@
                     "11100110100110001010"
                     "11111111111111111111"
                 },
-        /* 48*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/ACMRN123456/V2009121908334\\R\\E", -1, 0, 20, 20, 1, "HIBC/PAS 1.3-2010 Section 2.2 Patient Id Macro, same", 0,
+        /* 49*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/ACMRN123456/V2009121908334\\R\\E", -1, 0, 20, 20, 1, "HIBC/PAS 1.3-2010 Section 2.2 Patient Id Macro, same", 0,
                     "10101010101010101010"
                     "10000000001110001111"
                     "11010101001010011100"
@@ -2101,7 +2125,7 @@
                     "11100110001010111010"
                     "11111111111111111111"
                 },
-        /* 49*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/ACMRN123456/V2009121908334\\R\\E", -1, 0, 20, 20, 0, "HIBC/PAS 1.3-2010 Section 2.2 Patient Id Macro **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
+        /* 50*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/ACMRN123456/V2009121908334\\R\\E", -1, 0, 20, 20, 0, "HIBC/PAS 1.3-2010 Section 2.2 Patient Id Macro **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
                     "10101010101010101010"
                     "11111011001110001111"
                     "11100100001010011100"
@@ -2123,7 +2147,7 @@
                     "11011111001010100010"
                     "11111111111111111111"
                 },
-        /* 50*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/EO523201", -1, 0, 14, 14, 1, "HIBC/PAS Section 2.2 Purchase Order, same", 0,
+        /* 51*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/EO523201", -1, 0, 14, 14, 1, "HIBC/PAS Section 2.2 Purchase Order, same", 0,
                     "10101010101010"
                     "10011001010101"
                     "11101000011010"
@@ -2139,7 +2163,7 @@
                     "10010010000100"
                     "11111111111111"
                 },
-        /* 51*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/EO523201", -1, 0, 14, 14, 1, "HIBC/PAS Section 2.2 Purchase Order, same", 0,
+        /* 52*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/EO523201", -1, 0, 14, 14, 1, "HIBC/PAS Section 2.2 Purchase Order, same", 0,
                     "10101010101010"
                     "10011001010101"
                     "11101000011010"
@@ -2155,7 +2179,7 @@
                     "10010010000100"
                     "11111111111111"
                 },
-        /* 52*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, DM_SQUARE, "/EU720060FF0/O523201", -1, 0, 18, 18, 1, "HIBC/PAS Section 2.2 2nd Purchase Order, same", 0,
+        /* 53*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, DM_SQUARE, "/EU720060FF0/O523201", -1, 0, 18, 18, 1, "HIBC/PAS Section 2.2 2nd Purchase Order, same", 0,
                     "101010101010101010"
                     "100110010100100001"
                     "111011110110010110"
@@ -2175,7 +2199,7 @@
                     "111000010011001010"
                     "111111111111111111"
                 },
-        /* 53*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, DM_SQUARE, "/EU720060FF0/O523201", -1, 0, 18, 18, 1, "HIBC/PAS Section 2.2 2nd Purchase Order, same", 0,
+        /* 54*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, DM_SQUARE, "/EU720060FF0/O523201", -1, 0, 18, 18, 1, "HIBC/PAS Section 2.2 2nd Purchase Order, same", 0,
                     "101010101010101010"
                     "100110010100100001"
                     "111011110110010110"
@@ -2195,7 +2219,7 @@
                     "111000010011001010"
                     "111111111111111111"
                 },
-        /* 54*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/EU720060FF0/O523201/Z34H159/M9842431340", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (left), same", 0,
+        /* 55*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/EU720060FF0/O523201/Z34H159/M9842431340", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (left), same", 0,
                     "1010101010101010101010"
                     "1001100101001000000011"
                     "1110111101100001111010"
@@ -2219,7 +2243,7 @@
                     "1010110000010001001000"
                     "1111111111111111111111"
                 },
-        /* 55*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/EU720060FF0/O523201/Z34H159/M9842431340", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (left), same", 0,
+        /* 56*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/EU720060FF0/O523201/Z34H159/M9842431340", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (left), same", 0,
                     "1010101010101010101010"
                     "1001100101001000000011"
                     "1110111101100001111010"
@@ -2243,7 +2267,7 @@
                     "1010110000010001001000"
                     "1111111111111111111111"
                 },
-        /* 56*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/EU720060FF0/O523201/Z34H159/M9842431340V\\R\\E", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (right), same", 0,
+        /* 57*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/EU720060FF0/O523201/Z34H159/M9842431340V\\R\\E", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (right), same", 0,
                     "1010101010101010101010"
                     "1000000000111010011101"
                     "1101011100101001011100"
@@ -2267,7 +2291,7 @@
                     "1001110110011101101000"
                     "1111111111111111111111"
                 },
-        /* 57*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/EU720060FF0/O523201/Z34H159/M9842431340V\\R\\E", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (right), same", 0,
+        /* 58*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G+/EU720060FF0/O523201/Z34H159/M9842431340V\\R\\E", -1, 0, 22, 22, 1, "HIBC/PAS Section 2.2 3rd Purchase Order (right), same", 0,
                     "1010101010101010101010"
                     "1000000000111010011101"
                     "1101011100101001011100"
@@ -2291,7 +2315,7 @@
                     "1001110110011101101000"
                     "1111111111111111111111"
                 },
-        /* 58*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/E+/KN12345", -1, 0, 16, 16, 1, "HIBC/PAS Section 2.2 Asset Tag **NOT SAME** check digit 'A' in figure is for '/KN12345', but actual data is as given here, when check digit is 'J'", 0,
+        /* 59*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/E+/KN12345", -1, 0, 16, 16, 1, "HIBC/PAS Section 2.2 Asset Tag **NOT SAME** check digit 'A' in figure is for '/KN12345', but actual data is as given here, when check digit is 'J'", 0,
                     "1010101010101010"
                     "1001101010001111"
                     "1110001000101100"
@@ -2309,7 +2333,7 @@
                     "1001000000000010"
                     "1111111111111111"
                 },
-        /* 59*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/E+/KN12345", -1, 0, 16, 16, 0, "HIBC/PAS Section 2.2 Asset Tag **NOT SAME** see above; BWIPP same as FAST_MODE", 0,
+        /* 60*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/E+/KN12345", -1, 0, 16, 16, 0, "HIBC/PAS Section 2.2 Asset Tag **NOT SAME** see above; BWIPP same as FAST_MODE", 0,
                     "1010101010101010"
                     "1100011011001011"
                     "1101100111000110"
@@ -2327,7 +2351,7 @@
                     "1001111001100010"
                     "1111111111111111"
                 },
-        /* 60*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/LAH123/NC903", -1, 0, 16, 16, 1, "HIBC/PAS Section 2.2 Surgical Instrument, same", 0,
+        /* 61*/ { BARCODE_HIBC_DM, FAST_MODE, -1, -1, -1, -1, "/LAH123/NC903", -1, 0, 16, 16, 1, "HIBC/PAS Section 2.2 Surgical Instrument, same", 0,
                     "1010101010101010"
                     "1001010001010001"
                     "1110010100000100"
@@ -2345,7 +2369,7 @@
                     "1100000101010010"
                     "1111111111111111"
                 },
-        /* 61*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/LAH123/NC903", -1, 0, 16, 16, 0, "HIBC/PAS Section 2.2 Surgical Instrument **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
+        /* 62*/ { BARCODE_HIBC_DM, -1, -1, -1, -1, -1, "/LAH123/NC903", -1, 0, 16, 16, 0, "HIBC/PAS Section 2.2 Surgical Instrument **NOT SAME** (see FAST_MODE); BWIPP same as FAST_MODE", 0,
                     "1010101010101010"
                     "1111000001001111"
                     "1110010001010110"
@@ -2363,7 +2387,7 @@
                     "1110011111101010"
                     "1111111111111111"
                 },
-        /* 62*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, 7, -1, "[)>\\R06\\G18VD89536\\G1P8902A\\GS3122A02965\\R\\E", -1, 0, 22, 22, 1, "ANSI MH10.8.17-2017 Figure 4 Macro06 **NOT SAME** 253-state randomising of padding in figure seems incorrect", 0,
+        /* 63*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, 7, -1, "[)>\\R06\\G18VD89536\\G1P8902A\\GS3122A02965\\R\\E", -1, 0, 22, 22, 1, "ANSI MH10.8.17-2017 Figure 4 Macro06 **NOT SAME** 253-state randomising of padding in figure seems incorrect", 0,
                     "1010101010101010101010"
                     "1101110000111001011011"
                     "1010111010001010001110"
@@ -2387,7 +2411,7 @@
                     "1000001010010010110100"
                     "1111111111111111111111"
                 },
-        /* 63*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, 7, -1, "[)>\\R06\\G18VD89536\\G1P8902A\\GS3122A02965\\R\\E", -1, 0, 22, 22, 1, "ANSI MH10.8.17-2017 Figure 4 Macro06 **NOT SAME** 253-state randomising of padding in figure seems incorrect", 0,
+        /* 64*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, 7, -1, "[)>\\R06\\G18VD89536\\G1P8902A\\GS3122A02965\\R\\E", -1, 0, 22, 22, 1, "ANSI MH10.8.17-2017 Figure 4 Macro06 **NOT SAME** 253-state randomising of padding in figure seems incorrect", 0,
                     "1010101010101010101010"
                     "1101110000111001011011"
                     "1010111010001010001110"
@@ -2411,7 +2435,7 @@
                     "1000001010010010110100"
                     "1111111111111111111111"
                 },
-        /* 64*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G25S0614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B7", 0,
+        /* 65*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R06\\G25S0614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B7", 0,
                     "1010101010101010"
                     "1101000010101111"
                     "1011100001011100"
@@ -2429,7 +2453,7 @@
                     "1010101010001010"
                     "1111111111111111"
                 },
-        /* 65*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G25S0614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B7", 0,
+        /* 66*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R06\\G25S0614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B7", 0,
                     "1010101010101010"
                     "1101000010101111"
                     "1011100001011100"
@@ -2447,7 +2471,7 @@
                     "1010101010001010"
                     "1111111111111111"
                 },
-        /* 66*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R05\\G80040614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B8", 0,
+        /* 67*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE | FAST_MODE, -1, -1, -1, -1, "[)>\\R05\\G80040614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B8", 0,
                     "1010101010101010"
                     "1111100010001111"
                     "1010100001100100"
@@ -2465,7 +2489,7 @@
                     "1010000010101010"
                     "1111111111111111"
                 },
-        /* 67*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R05\\G80040614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B8", 0,
+        /* 68*/ { BARCODE_DATAMATRIX, DATA_MODE | ESCAPE_MODE, -1, -1, -1, -1, "[)>\\R05\\G80040614141MH80312\\R\\E", -1, 0, 16, 16, 1, "ANSI MH10.8.17-2017 Table B.1 B8", 0,
                     "1010101010101010"
                     "1111100010001111"
                     "1010100001100100"
@@ -2483,7 +2507,7 @@
                     "1010000010101010"
                     "1111111111111111"
                 },
-        /* 68*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 3 Example 1", 0,
+        /* 69*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 3 Example 1", 0,
                     "1010101010101010"
                     "1001001011100001"
                     "1000111110110000"
@@ -2501,7 +2525,7 @@
                     "1001011001111010"
                     "1111111111111111"
                 },
-        /* 69*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "price:Â£20.00", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 3 Example 2", 0,
+        /* 70*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "price:Â£20.00", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 3 Example 2", 0,
                     "10101010101010101010101010"
                     "10000111010111000110110001"
                     "10000101101010010011011000"
@@ -2515,7 +2539,7 @@
                     "11100101010110100111011000"
                     "11111111111111111111111111"
                 },
-        /* 70*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "C:\\DOCS\\EXAMPLE.TXT", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 3 Example 3", 0,
+        /* 71*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 3, -1, -1, -1, "C:\\DOCS\\EXAMPLE.TXT", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 3 Example 3", 0,
                     "101010101010101010"
                     "100000001010011011"
                     "100010111000011100"
@@ -2535,7 +2559,7 @@
                     "100110001010000100"
                     "111111111111111111"
                 },
-        /* 71*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 4, -1, -1, -1, "Å tudentska Å¡t. 2198390", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 4 Example 1; BWIPP same as FAST_MODE", 0,
+        /* 72*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 4, -1, -1, -1, "Å tudentska Å¡t. 2198390", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 4 Example 1; BWIPP same as FAST_MODE", 0,
                     "10101010101010101010"
                     "10001110100110101111"
                     "10001101000001010110"
@@ -2557,7 +2581,7 @@
                     "11010000001001011010"
                     "11111111111111111111"
                 },
-        /* 72*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 4, -1, 10, -1, "SzczegÃ³Åowe dane kontaktowe:+48 22 694 60 00", -1, 0, 32, 32, 0, "AIM ITS/04-023:2022 ECI 4 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /* 73*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 4, -1, 10, -1, "SzczegÃ³Åowe dane kontaktowe:+48 22 694 60 00", -1, 0, 32, 32, 0, "AIM ITS/04-023:2022 ECI 4 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "10101010101010101010101010101010"
                     "10010010111100111011110110001111"
                     "10001111110010101000001000100000"
@@ -2591,7 +2615,7 @@
                     "11001100101101101010010101100000"
                     "11111111111111111111111111111111"
                 },
-        /* 73*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 5, -1, -1, DM_SQUARE, "LiÄ¥tenÅtejno", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 5 Example 1; BWIPP different encodation", 0,
+        /* 74*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 5, -1, -1, DM_SQUARE, "LiÄ¥tenÅtejno", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 5 Example 1; BWIPP different encodation", 0,
                     "101010101010101010"
                     "100101101010111011"
                     "100011010100011110"
@@ -2611,7 +2635,7 @@
                     "110001011101010110"
                     "111111111111111111"
                 },
-        /* 74*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 6, -1, -1, DM_SQUARE, "LietuvÄ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 6 Example 1", 0,
+        /* 75*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 6, -1, -1, DM_SQUARE, "LietuvÄ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 6 Example 1", 0,
                     "1010101010101010"
                     "1001011011110111"
                     "1000010100001110"
@@ -2629,7 +2653,7 @@
                     "1100100101110010"
                     "1111111111111111"
                 },
-        /* 75*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 7, -1, -1, DM_SQUARE, "Ð Ð¾ÑÑÐ¸Ñ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 7 Example 1", 0,
+        /* 76*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 7, -1, -1, DM_SQUARE, "Ð Ð¾ÑÑÐ¸Ñ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 7 Example 1", 0,
                     "1010101010101010"
                     "1001110110001111"
                     "1001101010110100"
@@ -2647,7 +2671,7 @@
                     "1010110001000010"
                     "1111111111111111"
                 },
-        /* 76*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 7, -1, -1, DM_SQUARE, "ÐÐ¾Ð½Ð³Ð¾Ð»ÑÐ»Ñ", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 7 Example 2", 0,
+        /* 77*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 7, -1, -1, DM_SQUARE, "ÐÐ¾Ð½Ð³Ð¾Ð»ÑÐ»Ñ", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 7 Example 2", 0,
                     "101010101010101010"
                     "100111100010010101"
                     "100110000111111110"
@@ -2667,7 +2691,7 @@
                     "110100011110000100"
                     "111111111111111111"
                 },
-        /* 77*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 8, -1, -1, DM_SQUARE, "Ø¬ÙØ§Ø² Ø§ÙØ³ÙØ±", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 8 Example 1", 0,
+        /* 78*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 8, -1, -1, DM_SQUARE, "Ø¬ÙØ§Ø² Ø§ÙØ³ÙØ±", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 8 Example 1", 0,
                     "101010101010101010"
                     "100111100010000001"
                     "100110001111110010"
@@ -2687,7 +2711,7 @@
                     "101100011100001010"
                     "111111111111111111"
                 },
-        /* 78*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 8, -1, -1, -1, "Ø§ÙÙÙØ´Ø£: Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©", -1, 0, 24, 24, 1, "AIM ITS/04-023:2022 ECI 8 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /* 79*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 8, -1, -1, -1, "Ø§ÙÙÙØ´Ø£: Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©", -1, 0, 24, 24, 1, "AIM ITS/04-023:2022 ECI 8 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "101010101010101010101010"
                     "100111010010111011001011"
                     "100110111100000010010000"
@@ -2713,7 +2737,7 @@
                     "100111000101101010110010"
                     "111111111111111111111111"
                 },
-        /* 79*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 9, -1, -1, DM_SQUARE, "ÎÎ­ÏÎ¿Ï #. Î±123", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 9 Example 1", 0,
+        /* 80*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 9, -1, -1, DM_SQUARE, "ÎÎ­ÏÎ¿Ï #. Î±123", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 9 Example 1", 0,
                     "101010101010101010"
                     "100111100100000011"
                     "100110001111001100"
@@ -2733,7 +2757,7 @@
                     "111100011110101000"
                     "111111111111111111"
                 },
-        /* 80*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 10, -1, -1, -1, "××¨×××", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 10 Example 1", 0,
+        /* 81*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 10, -1, -1, -1, "××¨×××", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 10 Example 1", 0,
                     "10101010101010101010101010101010"
                     "10011101110010011001011101110101"
                     "10011110001001001011101011110100"
@@ -2743,7 +2767,7 @@
                     "11010100010001101010000011101010"
                     "11111111111111111111111111111111"
                 },
-        /* 81*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 10, -1, -1, -1, "××¡×¤×¨ ×××§: A20200715001", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 10 Example 2 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
+        /* 82*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 10, -1, -1, -1, "××¡×¤×¨ ×××§: A20200715001", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 10 Example 2 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
                     "10101010101010101010"
                     "10011110011111000111"
                     "10011101101010101110"
@@ -2765,7 +2789,7 @@
                     "11000111100100101010"
                     "11111111111111111111"
                 },
-        /* 82*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 10, -1, -1, -1, "××¡×¤×¨ ×××§: A20200715001", -1, 0, 20, 20, 1, "AIM ITS/04-023:2022 ECI 10 Example 2 **NOT SAME** different encodation", 0,
+        /* 83*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 10, -1, -1, -1, "××¡×¤×¨ ×××§: A20200715001", -1, 0, 20, 20, 1, "AIM ITS/04-023:2022 ECI 10 Example 2 **NOT SAME** different encodation", 0,
                     "10101010101010101010"
                     "10011101100001000111"
                     "10011111111110010110"
@@ -2787,7 +2811,7 @@
                     "11000111010001111010"
                     "11111111111111111111"
                 },
-        /* 83*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 11, -1, -1, -1, "Amerika BirleÅik Devletleri", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 11 Example 1 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
+        /* 84*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 11, -1, -1, -1, "Amerika BirleÅik Devletleri", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 11 Example 1 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
                     "1010101010101010101010"
                     "1000101011001011000001"
                     "1001111101111001101100"
@@ -2811,7 +2835,7 @@
                     "1110010000010000011110"
                     "1111111111111111111111"
                 },
-        /* 84*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 11, -1, -1, -1, "Amerika BirleÅik Devletleri", -1, 0, 22, 22, 1, "AIM ITS/04-023:2022 ECI 11 Example 1 **NOT SAME** different encodation", 0,
+        /* 85*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 11, -1, -1, -1, "Amerika BirleÅik Devletleri", -1, 0, 22, 22, 1, "AIM ITS/04-023:2022 ECI 11 Example 1 **NOT SAME** different encodation", 0,
                     "1010101010101010101010"
                     "1001110011001011001001"
                     "1001111001111001110100"
@@ -2835,7 +2859,7 @@
                     "1110111101000010011110"
                     "1111111111111111111111"
                 },
-        /* 85*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 11, -1, -1, -1, "BiniÅ kartÄ± #120921039", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 11 Example 2; BWIPP different encodation", 0,
+        /* 86*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 11, -1, -1, -1, "BiniÅ kartÄ± #120921039", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 11 Example 2; BWIPP different encodation", 0,
                     "10101010101010101010"
                     "10001110101011111111"
                     "10010101011000110110"
@@ -2857,7 +2881,7 @@
                     "10000100110101011010"
                     "11111111111111111111"
                 },
-        /* 86*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 12, -1, -1, -1, "KÅ«rybiÅ¡kumÄ", -1, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 12 Example 1 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
+        /* 87*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 12, -1, -1, -1, "KÅ«rybiÅ¡kumÄ", -1, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 12 Example 1 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
                     "10101010101010101010101010"
                     "10010010000111001101100011"
                     "10011111110110110110111000"
@@ -2871,7 +2895,7 @@
                     "10011101110100000011000100"
                     "11111111111111111111111111"
                 },
-        /* 87*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 12, -1, -1, -1, "KÅ«rybiÅ¡kumÄ", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 12 Example 1 **NOT SAME** different encodation", 0,
+        /* 88*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 12, -1, -1, -1, "KÅ«rybiÅ¡kumÄ", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 12 Example 1 **NOT SAME** different encodation", 0,
                     "10101010101010101010101010"
                     "10011110000111001010011111"
                     "10010001010110110011110000"
@@ -2885,7 +2909,7 @@
                     "11000101010100110000011010"
                     "11111111111111111111111111"
                 },
-        /* 88*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 13, -1, -1, -1, "à¸à¸²à¸£à¹à¹à¸à¹à¸", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 13 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /* 89*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 13, -1, -1, -1, "à¸à¸²à¸£à¹à¹à¸à¹à¸", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 13 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "1010101010101010"
                     "1001110100011001"
                     "1001101111101000"
@@ -2903,7 +2927,7 @@
                     "1001010001001010"
                     "1111111111111111"
                 },
-        /* 89*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 15, -1, -1, -1, "uzÅÄmums", -1, 0, 16, 16, 0, "AIM ITS/04-023:2022 ECI 15 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /* 90*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 15, -1, -1, -1, "uzÅÄmums", -1, 0, 16, 16, 0, "AIM ITS/04-023:2022 ECI 15 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "1010101010101010"
                     "1001101111101001"
                     "1010110111010100"
@@ -2921,7 +2945,7 @@
                     "1110011001011010"
                     "1111111111111111"
                 },
-        /* 90*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 16, -1, -1, -1, "á¹Ã³rá¹¡Ã¡Ä", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 16 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /* 91*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 16, -1, -1, -1, "á¹Ã³rá¹¡Ã¡Ä", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 16 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010101010101010101010"
                     "10011101001100111111001100100101"
                     "10101011110110101011000000111100"
@@ -2931,7 +2955,7 @@
                     "11101100010001001001011110100100"
                     "11111111111111111111111111111111"
                 },
-        /* 91*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 17, -1, -1, -1, "Price: â¬13.50", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 17 Example 1", 0,
+        /* 92*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 17, -1, -1, -1, "Price: â¬13.50", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 17 Example 1", 0,
                     "10101010101010101010101010"
                     "10000111000111101110001001"
                     "10100101110010111101000010"
@@ -2945,7 +2969,7 @@
                     "10100111000100011110100110"
                     "11111111111111111111111111"
                 },
-        /* 92*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 18, -1, -1, -1, "Te sÅowa sÄ gÅÄbokie", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 18 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /* 93*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 18, -1, -1, -1, "Te sÅowa sÄ gÅÄbokie", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 18 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "1010101010101010101010"
                     "1001011001001010011011"
                     "1010001101110111011000"
@@ -2969,7 +2993,7 @@
                     "1011000010010101000110"
                     "1111111111111111111111"
                 },
-        /* 93*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 20, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 20 Example 1 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
+        /* 94*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 20, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 20 Example 1 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
                     "10101010101010101010101010"
                     "10011110011111011010110101"
                     "10100100010101100010110110"
@@ -2983,7 +3007,7 @@
                     "11000110001100101101001010"
                     "11111111111111111111111111"
                 },
-        /* 94*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 20, -1, -1, DM_SQUARE, "æ±äº¬é½", -1, 0, 16, 16, 0, "AIM ITS/04-023:2022 ECI 20 Example 2 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
+        /* 95*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 20, -1, -1, DM_SQUARE, "æ±äº¬é½", -1, 0, 16, 16, 0, "AIM ITS/04-023:2022 ECI 20 Example 2 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
                     "1010101010101010"
                     "1001110111101011"
                     "1010011001101010"
@@ -3001,7 +3025,7 @@
                     "1010010001000010"
                     "1111111111111111"
                 },
-        /* 95*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 21, -1, -1, -1, "Å tudentska Å¡t. 2198390", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 21 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /* 96*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 21, -1, -1, -1, "Å tudentska Å¡t. 2198390", -1, 0, 20, 20, 0, "AIM ITS/04-023:2022 ECI 21 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "10101010101010101010"
                     "10001100100001100111"
                     "10100101100110111110"
@@ -3023,7 +3047,7 @@
                     "11010010011010100010"
                     "11111111111111111111"
                 },
-        /* 96*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 22, -1, -1, DM_SQUARE, "Ð Ð¾ÑÑÐ¸Ñ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 22 Example 1", 0,
+        /* 97*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 22, -1, -1, DM_SQUARE, "Ð Ð¾ÑÑÐ¸Ñ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 22 Example 1", 0,
                     "1010101010101010"
                     "1001110111011111"
                     "1010101011100000"
@@ -3041,7 +3065,7 @@
                     "1011010001101010"
                     "1111111111111111"
                 },
-        /* 97*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 22, -1, -1, DM_SQUARE, "ÐÐ¾Ð½Ð³Ð¾Ð»ÑÐ»Ñ", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 22 Example 2", 0,
+        /* 98*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 22, -1, -1, DM_SQUARE, "ÐÐ¾Ð½Ð³Ð¾Ð»ÑÐ»Ñ", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 22 Example 2", 0,
                     "101010101010101010"
                     "100111100100010101"
                     "101010000001111110"
@@ -3061,7 +3085,7 @@
                     "101100011000000110"
                     "111111111111111111"
                 },
-        /* 98*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 23, -1, -1, -1, "bÅuf", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 23 Example 1", 0,
+        /* 99*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 23, -1, -1, -1, "bÅuf", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 23 Example 1", 0,
                     "10101010101010"
                     "10001110110001"
                     "10110001110100"
@@ -3077,7 +3101,7 @@
                     "11000001001110"
                     "11111111111111"
                 },
-        /* 99*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 24, -1, -1, DM_SQUARE, "Ø¬ÙØ§Ø² Ø§ÙØ³ÙØ±", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 24 Example 1", 0,
+        /*100*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 24, -1, -1, DM_SQUARE, "Ø¬ÙØ§Ø² Ø§ÙØ³ÙØ±", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 24 Example 1", 0,
                     "101010101010101010"
                     "100111100010000001"
                     "101110001110110010"
@@ -3097,7 +3121,7 @@
                     "110100011110001010"
                     "111111111111111111"
                 },
-        /*100*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 24, -1, -1, -1, "Ø§ÙÙÙØ´Ø£: Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©", -1, 0, 24, 24, 1, "AIM ITS/04-023:2022 ECI 24 Example 2", 0,
+        /*101*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 24, -1, -1, -1, "Ø§ÙÙÙØ´Ø£: Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©", -1, 0, 24, 24, 1, "AIM ITS/04-023:2022 ECI 24 Example 2", 0,
                     "101010101010101010101010"
                     "100111010010001001001011"
                     "101110111100001110010010"
@@ -3123,7 +3147,7 @@
                     "101111000110001010111010"
                     "111111111111111111111111"
                 },
-        /*101*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 25, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 25 Example 1", 0,
+        /*102*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 25, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 25 Example 1", 0,
                     "10101010101010"
                     "10000010011111"
                     "10110101011100"
@@ -3139,7 +3163,7 @@
                     "10011101010100"
                     "11111111111111"
                 },
-        /*102*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 25, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 25 Example 2", 0,
+        /*103*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 25, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 12, 26, 1, "AIM ITS/04-023:2022 ECI 25 Example 2", 0,
                     "10101010101010101010101010"
                     "10011110010000001001101001"
                     "10110000101111001011001010"
@@ -3153,7 +3177,7 @@
                     "11000100100011011100111100"
                     "11111111111111111111111111"
                 },
-        /*103*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 25, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 25 Example 3 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*104*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 25, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 25 Example 3 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010101010101010101010"
                     "10011101000111111101100100000101"
                     "10111011100010101000011111001100"
@@ -3163,7 +3187,7 @@
                     "11110100011001101010111111010110"
                     "11111111111111111111111111111111"
                 },
-        /*104*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, DM_SQUARE, "æ¡ç ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 26 Example 1", 0,
+        /*105*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, DM_SQUARE, "æ¡ç ", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 26 Example 1", 0,
                     "1010101010101010"
                     "1001110111110101"
                     "1011111011000100"
@@ -3181,7 +3205,7 @@
                     "1001110001111010"
                     "1111111111111111"
                 },
-        /*105*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 20, 20, 1, "AIM ITS/04-023:2022 ECI 26 Example 2", 0,
+        /*106*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 20, 20, 1, "AIM ITS/04-023:2022 ECI 26 Example 2", 0,
                     "10101010101010101010"
                     "10011110001010000111"
                     "10111111000100111110"
@@ -3203,7 +3227,7 @@
                     "11000101001001010010"
                     "11111111111111111111"
                 },
-        /*106*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 26 Example 3", 0,
+        /*107*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 26 Example 3", 0,
                     "101010101010101010"
                     "100111100000010101"
                     "101111000110111110"
@@ -3223,7 +3247,7 @@
                     "101100010110000100"
                     "111111111111111111"
                 },
-        /*107*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 27, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 27 Example 1", 0,
+        /*108*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 27, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 27 Example 1", 0,
                     "1010101010101010"
                     "1001001011000001"
                     "1011111111011000"
@@ -3241,7 +3265,7 @@
                     "1001011001110010"
                     "1111111111111111"
                 },
-        /*108*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 28, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 0, "AIM ITS/04-023:2022 ECI 28 Example 1 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example except does not set explicit BASE256 byte count", 0,
+        /*109*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 28, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 0, "AIM ITS/04-023:2022 ECI 28 Example 1 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example except does not set explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101101111"
                     "10111001001100"
@@ -3257,7 +3281,7 @@
                     "10101101000110"
                     "11111111111111"
                 },
-        /*109*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 29, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 29 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*110*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 29, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 29 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101000111"
                     "10111011101100"
@@ -3273,7 +3297,7 @@
                     "11001101000100"
                     "11111111111111"
                 },
-        /*110*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 29, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 29 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*111*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 29, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 29 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101000101"
                     "10111011100110"
@@ -3289,7 +3313,7 @@
                     "10101101000110"
                     "11111111111111"
                 },
-        /*111*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 30, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 30 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*112*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 30, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 30 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010101010101010101010"
                     "10011101010000111110011110001101"
                     "10111011100001101011001100110000"
@@ -3299,7 +3323,7 @@
                     "11011100010101101110100010101010"
                     "11111111111111111111111111111111"
                 },
-        /*112*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 30, -1, -1, -1, "ìì¸", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 30 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*113*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 30, -1, -1, -1, "ìì¸", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 30 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101010111"
                     "10111011100110"
@@ -3315,7 +3339,7 @@
                     "11001101000110"
                     "11111111111111"
                 },
-        /*113*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*114*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101010111"
                     "11001011110100"
@@ -3331,7 +3355,7 @@
                     "11000111000100"
                     "11111111111111"
                 },
-        /*114*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*115*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101010101"
                     "11001011111110"
@@ -3347,7 +3371,7 @@
                     "10100111000110"
                     "11111111111111"
                 },
-        /*115*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 3 **NOT SAME** different encodation (example uses binary)", 0,
+        /*116*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 31, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 31 Example 3 **NOT SAME** different encodation (example uses binary)", 0,
                     "10101010101010"
                     "10001101110001"
                     "11000100010000"
@@ -3363,7 +3387,7 @@
                     "10110111010010"
                     "11111111111111"
                 },
-        /*116*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*117*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 1 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101011111"
                     "11001011111000"
@@ -3379,7 +3403,7 @@
                     "11000001000100"
                     "11111111111111"
                 },
-        /*117*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
+        /*118*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "åäº¬", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 2 **NOT SAME** example sets explicit BASE256 byte count", 0,
                     "10101010101010"
                     "10011101011101"
                     "11001011110010"
@@ -3395,7 +3419,7 @@
                     "10100001000110"
                     "11111111111111"
                 },
-        /*118*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 3 **NOT SAME** different encodation (example uses binary)", 0,
+        /*119*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, -1, "æ¢ç¢¼", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 32 Example 3 **NOT SAME** different encodation (example uses binary)", 0,
                     "10101010101010"
                     "10001101111001"
                     "11000100011100"
@@ -3411,7 +3435,7 @@
                     "10110001010010"
                     "11111111111111"
                 },
-        /*119*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "à½à½ºà¼à½à½²à½à¼", -1, 0, 24, 24, 0, "AIM ITS/04-023:2022 ECI 32 Example 4 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
+        /*120*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "à½à½ºà¼à½à½²à½à¼", -1, 0, 24, 24, 0, "AIM ITS/04-023:2022 ECI 32 Example 4 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
                     "101010101010101010101010"
                     "100111110000011010000101"
                     "110001010011101011111000"
@@ -3437,7 +3461,7 @@
                     "110001000101110010010010"
                     "111111111111111111111111"
                 },
-        /*120*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "ãã¼ã³ã¼ã", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 32 Example 5", 0,
+        /*121*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "ãã¼ã³ã¼ã", -1, 0, 18, 18, 1, "AIM ITS/04-023:2022 ECI 32 Example 5", 0,
                     "101010101010101010"
                     "100111100000000001"
                     "110010001111110010"
@@ -3457,7 +3481,7 @@
                     "101100011101111000"
                     "111111111111111111"
                 },
-        /*121*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 32 Example 6 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
+        /*122*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 32, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 32 Example 6 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
                     "101010101010101010"
                     "100111100000001111"
                     "110001010011000100"
@@ -3477,7 +3501,7 @@
                     "101100010101010110"
                     "111111111111111111"
                 },
-        /*122*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 33 Example 1", 0,
+        /*123*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, -1, "æ¡ç ", -1, 0, 14, 14, 1, "AIM ITS/04-023:2022 ECI 33 Example 1", 0,
                     "10101010101010"
                     "10001010110111"
                     "11000000010100"
@@ -3493,7 +3517,7 @@
                     "10010001000100"
                     "11111111111111"
                 },
-        /*123*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, DM_SQUARE, "ãã¼ã³ã¼ã", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 33 Example 2 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
+        /*124*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, DM_SQUARE, "ãã¼ã³ã¼ã", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 33 Example 2 **NOT SAME** Zint switches to ASCII 1 char before end; BWIPP same as example", 0,
                     "101010101010101010"
                     "100111100010010001"
                     "110010000100110010"
@@ -3513,7 +3537,7 @@
                     "111100010111101010"
                     "111111111111111111"
                 },
-        /*124*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 0, "AIM ITS/04-023:2022 ECI 33 Example 3 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
+        /*125*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 33, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 0, "AIM ITS/04-023:2022 ECI 33 Example 3 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
                     "10101010101010101010101010101010"
                     "10010110001111011011011000110101"
                     "11001111111100101000100000101000"
@@ -3523,7 +3547,7 @@
                     "11110010110110101110001111110110"
                     "11111111111111111111111111111111"
                 },
-        /*125*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 33, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 33 Example 3 **NOT SAME** different encodation", 0,
+        /*126*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 33, -1, -1, -1, "ë°ì½ë", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 33 Example 3 **NOT SAME** different encodation", 0,
                     "10101010101010101010101010101010"
                     "10011101001111011010111110010101"
                     "11000011111111101000110111000100"
@@ -3533,7 +3557,7 @@
                     "11110100011100101110011010101000"
                     "11111111111111111111111111111111"
                 },
-        /*126*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, -1, "æ¡ç ", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 34 Example 1", 0,
+        /*127*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, -1, "æ¡ç ", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 34 Example 1", 0,
                     "10101010101010101010101010101010"
                     "10000100000001011001100100101101"
                     "11000100100001001101100101100100"
@@ -3543,7 +3567,7 @@
                     "11010000001111101100000001100110"
                     "11111111111111111111111111111111"
                 },
-        /*127*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 34 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /*128*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 34 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "1010101010101010101010"
                     "1000010001011111000001"
                     "1100000010110010010000"
@@ -3567,7 +3591,7 @@
                     "1101110000000101011100"
                     "1111111111111111111111"
                 },
-        /*128*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 34 Example 3 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
+        /*129*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 34 Example 3 **NOT SAME** different encodation; BWIPP same as FAST_MODE", 0,
                     "101010101010101010"
                     "100001000101111111"
                     "110011001011000000"
@@ -3587,7 +3611,7 @@
                     "101000000011010110"
                     "111111111111111111"
                 },
-        /*129*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 34, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 34 Example 3 **NOT SAME** different encodation", 0,
+        /*130*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 34, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 34 Example 3 **NOT SAME** different encodation", 0,
                     "101010101010101010"
                     "100111100101111111"
                     "110011011011000000"
@@ -3607,7 +3631,7 @@
                     "101100011111010100"
                     "111111111111111111"
                 },
-        /*130*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, -1, "æ¡ç ", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 35 Example 1", 0,
+        /*131*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, -1, "æ¡ç ", -1, 0, 8, 32, 1, "AIM ITS/04-023:2022 ECI 35 Example 1", 0,
                     "10101010101010101010101010101010"
                     "10001010101001011001011111111101"
                     "11000000011111001011101110100000"
@@ -3617,7 +3641,7 @@
                     "11001100011110001000101111100010"
                     "11111111111111111111111111111111"
                 },
-        /*131*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 35 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /*132*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, -1, "ãã¼ã³ã¼ã", -1, 0, 22, 22, 0, "AIM ITS/04-023:2022 ECI 35 Example 2 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "1010101010101010101010"
                     "1001111010111100010001"
                     "1100100000010110000000"
@@ -3641,7 +3665,7 @@
                     "1000011100010000111100"
                     "1111111111111111111111"
                 },
-        /*132*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 35 Example 3 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /*133*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, -1, -1, DM_SQUARE, "ë°ì½ë", -1, 0, 18, 18, 0, "AIM ITS/04-023:2022 ECI 35 Example 3 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "101010101010101010"
                     "100101100010110001"
                     "110011111110000010"
@@ -3661,7 +3685,7 @@
                     "110010110111000000"
                     "111111111111111111"
                 },
-        /*133*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 170, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 170 Example 1", 0,
+        /*134*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 170, -1, -1, -1, "sn:7QPB4MN", -1, 0, 16, 16, 1, "AIM ITS/04-023:2022 ECI 170 Example 1", 0,
                     "1010101010101010"
                     "1101001101000101"
                     "1000011000100000"
@@ -3679,7 +3703,7 @@
                     "1101110101101010"
                     "1111111111111111"
                 },
-        /*134*/ { BARCODE_DATAMATRIX, DATA_MODE, 899, -1, -1, -1, "\000\001\002\133\134\135\375\376\377", 9, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 899 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
+        /*135*/ { BARCODE_DATAMATRIX, DATA_MODE, 899, -1, -1, -1, "\000\001\002\133\134\135\375\376\377", 9, 0, 12, 26, 0, "AIM ITS/04-023:2022 ECI 899 Example 1 **NOT SAME** different encodation; BWIPP different encodation", 0,
                     "10101010101010101010101010"
                     "11001100001001010101010111"
                     "10000000111000111010100110"
@@ -3693,7 +3717,7 @@
                     "10010010000010011010010100"
                     "11111111111111111111111111"
                 },
-        /*135*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, 3, -1, -1, -1, "\101\300", -1, 0, 12, 12, 1, "AÃ", 0,
+        /*136*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, 3, -1, -1, -1, "\101\300", -1, 0, 12, 12, 1, "AÃ", 0,
                     "101010101010"
                     "100010101111"
                     "100001011110"
@@ -3707,7 +3731,7 @@
                     "100011011010"
                     "111111111111"
                 },
-        /*136*/ { BARCODE_DATAMATRIX, DATA_MODE, 3, -1, -1, -1, "\101\300", -1, 0, 12, 12, 1, "AÃ", 0,
+        /*137*/ { BARCODE_DATAMATRIX, DATA_MODE, 3, -1, -1, -1, "\101\300", -1, 0, 12, 12, 1, "AÃ", 0,
                     "101010101010"
                     "100010101111"
                     "100001011110"
@@ -3721,7 +3745,7 @@
                     "100011011010"
                     "111111111111"
                 },
-        /*137*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 26, -1, -1, -1, "AÃ", -1, 0, 14, 14, 1, "AÃ", 0,
+        /*138*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, 26, -1, -1, -1, "AÃ", -1, 0, 14, 14, 1, "AÃ", 0,
                     "10101010101010"
                     "10001010100001"
                     "10110101100100"
@@ -3737,7 +3761,7 @@
                     "11000110001100"
                     "11111111111111"
                 },
-        /*138*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, -1, "AÃ", -1, 0, 14, 14, 1, "AÃ", 0,
+        /*139*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 26, -1, -1, -1, "AÃ", -1, 0, 14, 14, 1, "AÃ", 0,
                     "10101010101010"
                     "10001010100001"
                     "10110101100100"
@@ -3753,7 +3777,7 @@
                     "11000110001100"
                     "11111111111111"
                 },
-        /*139*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "abcdefgh+", -1, 0, 16, 16, 1, "TEX last_shift 2, symbols_left 1, process_p 1", 0,
+        /*140*/ { BARCODE_DATAMATRIX, UNICODE_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "abcdefgh+", -1, 0, 16, 16, 1, "TEX last_shift 2, symbols_left 1, process_p 1", 0,
                     "1010101010101010"
                     "1010011011101001"
                     "1011001010010010"
@@ -3771,7 +3795,7 @@
                     "1101110101001010"
                     "1111111111111111"
                 },
-        /*140*/ { BARCODE_DATAMATRIX, UNICODE_MODE, -1, -1, -1, DM_SQUARE, "abcdefgh+", -1, 0, 14, 14, 0, "ATTTTTTTT; BWIPP same as FAST_MODE", 1,
+        /*141*/ { BARCODE_DATAMATRIX, UNICODE_MODE, -1, -1, -1, DM_SQUARE, "abcdefgh+", -1, 0, 14, 14, 0, "ATTTTTTTT; BWIPP same as FAST_MODE", 1,
                     "10101010101010"
                     "11100001010101"
                     "11010101001000"
@@ -3787,7 +3811,7 @@
                     "10111011000100"
                     "11111111111111"
                 },
-        /*141*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "7 BASE256s, 1 pad", 0,
+        /*142*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "7 BASE256s, 1 pad", 0,
                     "10101010101010101010101010101010"
                     "10000101000011011000110100100001"
                     "11100111110101001011101110100010"
@@ -3797,7 +3821,7 @@
                     "11010000111100001010011101100100"
                     "11111111111111111111111111111111"
                 },
-        /*142*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "7 BASE256s, 1 pad", 0,
+        /*143*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "7 BASE256s, 1 pad", 0,
                     "10101010101010101010101010101010"
                     "10000101000011011000110100100001"
                     "11100111110101001011101110100010"
@@ -3807,7 +3831,7 @@
                     "11010000111100001010011101100100"
                     "11111111111111111111111111111111"
                 },
-        /*143*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "8 BASE256s, no padding", 0,
+        /*144*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "8 BASE256s, no padding", 0,
                     "10101010101010101010101010101010"
                     "10000101000011011111001101000001"
                     "11010111110101001001011001100010"
@@ -3817,7 +3841,7 @@
                     "11010000110010001001010001111000"
                     "11111111111111111111111111111111"
                 },
-        /*144*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "8 BASE256s, no padding", 0,
+        /*145*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200", -1, 0, 8, 32, 1, "8 BASE256s, no padding", 0,
                     "10101010101010101010101010101010"
                     "10000101000011011111001101000001"
                     "11010111110101001001011001100010"
@@ -3827,7 +3851,7 @@
                     "11010000110010001001010001111000"
                     "11111111111111111111111111111111"
                 },
-        /*145*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "\200\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "8 BASE256s, square, no padding", 0,
+        /*146*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, DM_SQUARE, "\200\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "8 BASE256s, square, no padding", 0,
                     "1010101010101010"
                     "1000010100001101"
                     "1101011111101110"
@@ -3845,7 +3869,7 @@
                     "1111000011111010"
                     "1111111111111111"
                 },
-        /*146*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, DM_SQUARE, "\200\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "8 BASE256s, square, no padding", 0,
+        /*147*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, DM_SQUARE, "\200\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "8 BASE256s, square, no padding", 0,
                     "1010101010101010"
                     "1000010100001101"
                     "1101011111101110"
@@ -3863,7 +3887,7 @@
                     "1111000011111010"
                     "1111111111111111"
                 },
-        /*147*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "9 BASE256s, 1 pad", 0,
+        /*148*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "9 BASE256s, 1 pad", 0,
                     "1010101010101010"
                     "1000010101001101"
                     "1110011111000010"
@@ -3881,7 +3905,7 @@
                     "1100000011011010"
                     "1111111111111111"
                 },
-        /*148*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "9 BASE256s, 1 pad", 0,
+        /*149*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200", -1, 0, 16, 16, 1, "9 BASE256s, 1 pad", 0,
                     "1010101010101010"
                     "1000010101001101"
                     "1110011111000010"
@@ -3899,7 +3923,7 @@
                     "1100000011011010"
                     "1111111111111111"
                 },
-        /*149*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 22, 22, 1, "22 BASE256s, 6 pads", 0,
+        /*150*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 22, 22, 1, "22 BASE256s, 6 pads", 0,
                     "1010101010101010101010"
                     "1010010100011100010101"
                     "1000011110111110001100"
@@ -3923,7 +3947,7 @@
                     "1111101000110111010100"
                     "1111111111111111111111"
                 },
-        /*150*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 22, 22, 1, "22 BASE256s, 6 pads", 0,
+        /*151*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 22, 22, 1, "22 BASE256s, 6 pads", 0,
                     "1010101010101010101010"
                     "1010010100011100010101"
                     "1000011110111110001100"
@@ -3947,7 +3971,7 @@
                     "1111101000110111010100"
                     "1111111111111111111111"
                 },
-        /*151*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, DM_DMRE, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 8, 64, 1, "22 BASE256s, no padding", 0,
+        /*152*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, DM_DMRE, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 8, 64, 1, "22 BASE256s, no padding", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010101100011101010101011101111110100100110011100010011010111"
                     "1101011110001010110000001110001010001011010111001010101101100000"
@@ -3957,7 +3981,7 @@
                     "1101000011001010111101101101110010111100111101001010010011001000"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*152*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, DM_DMRE, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 8, 64, 1, "22 BASE256s, no padding", 0,
+        /*153*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, DM_DMRE, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 8, 64, 1, "22 BASE256s, no padding", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010101100011101010101011101111110100100110011100010011010111"
                     "1101011110001010110000001110001010001011010111001010101101100000"
@@ -3967,7 +3991,7 @@
                     "1101000011001010111101101101110010111100111101001010010011001000"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*153*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "249 BASE256s + 6 ASCII (3 double-digits)", 0,
+        /*154*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "249 BASE256s + 6 ASCII (3 double-digits)", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010100011101100000010111100110100010110111011011111010000001"
                     "1100011110111110100110111101111010101101000010001101001011001100"
@@ -4033,7 +4057,7 @@
                     "1000001101010100110010010110101010000000001010101100100011101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*154*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "249 BASE256s + 6 ASCII (3 double-digits)", 0,
+        /*155*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "249 BASE256s + 6 ASCII (3 double-digits)", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010100011101100000010111100110100010110111011011111010000001"
                     "1100011110111110100110111101111010101101000010001101001011001100"
@@ -4099,7 +4123,7 @@
                     "1000001101010100110010010110101010000000001010101100100011101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*155*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "249 BASE256s + 8 ASCII (Sh A80 + 3 double-digits); BWIPP uses 2nd B256 length byte instead of ASCII shift (same no. of codewords)", 0,
+        /*156*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "249 BASE256s + 8 ASCII (Sh A80 + 3 double-digits); BWIPP uses 2nd B256 length byte instead of ASCII shift (same no. of codewords)", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010100011101100000010111100110100010110111011011111010000001"
                     "1100011110111110100110111101111010101101000010001101001011001100"
@@ -4165,7 +4189,7 @@
                     "1000001101010100110100010100101010001100001000101100101001101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*156*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "249 BASE256s + 8 ASCII (Sh A80 + 3 double-digits); BWIPP uses 2nd B256 length byte instead of ASCII shift (same no. of codewords)", 0,
+        /*157*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "249 BASE256s + 8 ASCII (Sh A80 + 3 double-digits); BWIPP uses 2nd B256 length byte instead of ASCII shift (same no. of codewords)", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1000010100011101100000010111100110100010110111011011111010000001"
                     "1100011110111110100110111101111010101101000010001101001011001100"
@@ -4231,7 +4255,7 @@
                     "1000001101010100110100010100101010001100001000101100101001101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*157*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "10 ASCII + 251 BASE256s + 6 ASCII", 0,
+        /*158*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 1, "10 ASCII + 251 BASE256s + 6 ASCII", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011101100000010111100110100010110111011011111010000001"
                     "1011001010111110100110111101111010101101000010001101001011001100"
@@ -4297,7 +4321,7 @@
                     "1001010101010100111010010100101010000010001011001100101011101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*158*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "10 ASCII + 251 BASE256s + 6 ASCII; BWIPP same as FAST_MODE", 0,
+        /*159*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 64, 64, 0, "10 ASCII + 251 BASE256s + 6 ASCII; BWIPP same as FAST_MODE", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011101100000010111100110100010110111011011111010000001"
                     "1011001010111110100110111101111010101101000010001101001011001100"
@@ -4363,7 +4387,7 @@
                     "1001010101010100111110010100001010001100001000001100100011101010"
                     "1111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*159*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 88, 88, 1, "10 ASCII + 252 BASE256s + 10 ASCII + 253 BASE256 + 6 ASCII", 0,
+        /*160*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066", -1, 0, 88, 88, 1, "10 ASCII + 252 BASE256s + 10 ASCII + 253 BASE256 + 6 ASCII", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011100000001110111100010001011011111001111101000000110011111111000100110101111"
                     "1011001010111110011010111101111010110100001010010100101100110010101011111110101001100000"
@@ -4453,7 +4477,7 @@
                     "1101010100110101110000110100001000100000101010010010101110100111001111100010001001001100"
                     "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*160*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200" "\061\062\063\064\065\066", -1, 0, 88, 88, 0, "10 ASCII + 252 BASE256s + 10 ASCII + 253 BASE256 + 6 ASCII; BWIPP same as FAST_MODE", 0,
+        /*161*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200" "\061\062\063\064\065\066", -1, 0, 88, 88, 0, "10 ASCII + 252 BASE256s + 10 ASCII + 253 BASE256 + 6 ASCII; BWIPP same as FAST_MODE", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011100000001110111100010001011011111001111101000000110011111111000100110101111"
                     "1011001010111110011010111101111010110100001010010100101100110010101011111110101001100000"
@@ -4543,7 +4567,7 @@
                     "1101010100110101110000110100101000010000100010110010111110101011001111100010000101001100"
                     "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*161*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 88, 88, 1, "10 ASCII + 252 BASE256s + 10 ASCII + 304 BASE256, no padding", 0,
+        /*162*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 88, 88, 1, "10 ASCII + 252 BASE256s + 10 ASCII + 304 BASE256, no padding", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011100000001110111100010001011011111001111101000000110011111111000100110101111"
                     "1011001010111110011010111101111010110100001010010100101100110010101011111110101001100000"
@@ -4633,7 +4657,7 @@
                     "1101010100110101100000110110001000001000101011110010001110100101001111000010001111001100"
                     "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*162*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 88, 88, 0, "10 ASCII + 252 BASE256s + 10 ASCII + 304 BASE256, no padding; BWIPP same as FAST_MODE", 0,
+        /*163*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "\101\102\103\104\105\106\107\110\111\112\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\061\062\063\064\065\066\067\070\071\060\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200\200", -1, 0, 88, 88, 0, "10 ASCII + 252 BASE256s + 10 ASCII + 304 BASE256, no padding; BWIPP same as FAST_MODE", 0,
                     "1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "1010011010011100000001110111100010001011011111001111101000000110011111111000100110101111"
                     "1011001010111110011010111101111010110100001010010100101100110010101011111110101001100000"
@@ -4723,7 +4747,7 @@
                     "1101010100110101100000110110101000111000100011010010011110101001001111000010000011001100"
                     "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*163*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@_", -1, 0, 8, 32, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 2 chars, not last 3 like Zint", 0,
+        /*164*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@_", -1, 0, 8, 32, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 2 chars, not last 3 like Zint", 0,
                     "10101010101010101010101010101010"
                     "10000000001001111001101100001101"
                     "10000000000001001001110011001100"
@@ -4733,7 +4757,7 @@
                     "11000000000000001001000001011010"
                     "11111111111111111111111111111111"
                 },
-        /*164*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@_", -1, 0, 8, 32, 0, "EDI **NOT SAME** (see FAST_MODE); BWIPP uses different encodation", 0,
+        /*165*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@_", -1, 0, 8, 32, 0, "EDI **NOT SAME** (see FAST_MODE); BWIPP uses different encodation", 0,
                     "10101010101010101010101010101010"
                     "11100000000000011000100100101001"
                     "11100000000000001010011101001000"
@@ -4743,7 +4767,7 @@
                     "10000000000001001010010000010000"
                     "11111111111111111111111111111111"
                 },
-        /*165*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 3 chars, not last 4 like Zint", 0,
+        /*166*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 3 chars, not last 4 like Zint", 0,
                     "1010101010101010"
                     "1000000001000001"
                     "1000000000111110"
@@ -4761,7 +4785,7 @@
                     "1010100000010010"
                     "1111111111111111"
                 },
-        /*166*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@_", -1, 0, 8, 32, 0, "AAEEEEEEEEA; BWIPP uses different encodation, see above", 1,
+        /*167*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@_", -1, 0, 8, 32, 0, "AAEEEEEEEEA; BWIPP uses different encodation, see above", 1,
                     "10101010101010101010101010101010"
                     "10100000000000111000110101111001"
                     "10000000000001001000100100011000"
@@ -4771,7 +4795,7 @@
                     "10000110001100001001010000001110"
                     "11111111111111111111111111111111"
                 },
-        /*167*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 4 chars, not last 1 like Zint", 0,
+        /*168*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 4 chars, not last 1 like Zint", 0,
                     "1010101010101010"
                     "1000000001000001"
                     "1000000000001100"
@@ -4789,7 +4813,7 @@
                     "1000100000100010"
                     "1111111111111111"
         },
-        /*168*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@_", -1, 0, 16, 16, 0, "AAAEEEEEEEEA; BWIPP uses different encodation, see above", 0,
+        /*169*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@_", -1, 0, 16, 16, 0, "AAAEEEEEEEEA; BWIPP uses different encodation, see above", 0,
                     "1010101010101010"
                     "1010011101000001"
                     "1000000000101000"
@@ -4807,7 +4831,7 @@
                     "1011000011010010"
                     "1111111111111111"
                 },
-        /*169*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 5 chars, not last 2 like Zint", 0,
+        /*170*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 5 chars, not last 2 like Zint", 0,
                     "1010101010101010"
                     "1000000000100001"
                     "1000000000111000"
@@ -4825,7 +4849,7 @@
                     "1011100000010010"
                     "1111111111111111"
                 },
-        /*170*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EEEEEEEEEEEEA; BWIPP uses different encodation, see above", 1,
+        /*171*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "EEEEEEEEEEEEA; BWIPP uses different encodation, see above", 1,
                     "1010101010101010"
                     "1000000001100001"
                     "1000000000110100"
@@ -4843,7 +4867,7 @@
                     "1000000000100010"
                     "1111111111111111"
                 },
-        /*171*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@@@_", -1, 0, 12, 26, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 2 chars, not last 3 like Zint", 0,
+        /*172*/ { BARCODE_DATAMATRIX, FAST_MODE, -1, -1, -1, -1, "@@@@@@@@@@@@@_", -1, 0, 12, 26, 0, "EDI; BWIPP uses different encodation, switching to ASC for last 2 chars, not last 3 like Zint", 0,
                     "10101010101010101010101010"
                     "10000000001001100100101011"
                     "10000000000010000000111000"
@@ -4857,7 +4881,7 @@
                     "10000001000001101011010000"
                     "11111111111111111111111111"
                 },
-        /*172*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "AEEEEEEEEEEEEA; BWIPP uses different encodation, see above", 1,
+        /*173*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, "@@@@@@@@@@@@@_", -1, 0, 16, 16, 0, "AEEEEEEEEEEEEA; BWIPP uses different encodation, see above", 1,
                     "1010101010101010"
                     "1110000001000001"
                     "1110000001000000"
@@ -4875,7 +4899,7 @@
                     "1001100000111010"
                     "1111111111111111"
                 },
-        /*173*/ { BARCODE_DATAMATRIX, FAST_MODE, 26, -1, -1, -1, "abcdefghi1234FGHIJKLMNabc@@@@@@@@@Ã©", -1, 0, 24, 24, 0, "Mix of modes TEX ASC C40 ASC EDI BAS; BWIPP uses different encodation", 0,
+        /*174*/ { BARCODE_DATAMATRIX, FAST_MODE, 26, -1, -1, -1, "abcdefghi1234FGHIJKLMNabc@@@@@@@@@Ã©", -1, 0, 24, 24, 0, "Mix of modes TEX ASC C40 ASC EDI BAS; BWIPP uses different encodation", 0,
                     "101010101010101010101010"
                     "100111011110011101000101"
                     "101111001100101101101000"
@@ -4901,7 +4925,7 @@
                     "111101010110111111111010"
                     "111111111111111111111111"
                 },
-        /*174*/ { BARCODE_DATAMATRIX, -1, 26, -1, -1, -1, "abcdefghi1234FGHIJKLMNabc@@@@@@@@@Ã©", -1, 0, 24, 24, 0, "TTTTTTTTTAAAACCCCCCCCCAAAAAEEEEEEEAA; BWIPP uses different encodation", 0,
+        /*175*/ { BARCODE_DATAMATRIX, -1, 26, -1, -1, -1, "abcdefghi1234FGHIJKLMNabc@@@@@@@@@Ã©", -1, 0, 24, 24, 0, "TTTTTTTTTAAAACCCCCCCCCAAAAAEEEEEEEAA; BWIPP uses different encodation", 0,
                     "101010101010101010101010"
                     "100111011110011100000101"
                     "101111001100101100111100"
@@ -4927,7 +4951,7 @@
                     "111011010111011111010010"
                     "111111111111111111111111"
                 },
-        /*175*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ;<>@[]_`~!||()?{}'123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678912345678912345678912345678900001234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'\001\002\003\004\005\006...............\015\015\015\015\015\015\015\015abcdefghijklmnopqrstuvwxyz\015\015\015\015\015\015\015\015...............\001\002\003\004\005\006ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^...............", -1, 0, 132, 132, 0, "Mixed modes (except B256); BWIPP different encodation", 0,
+        /*176*/ { BARCODE_DATAMATRIX, DATA_MODE | FAST_MODE, -1, -1, -1, -1, "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ;<>@[]_`~!||()?{}'123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678912345678912345678912345678900001234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'\001\002\003\004\005\006...............\015\015\015\015\015\015\015\015abcdefghijklmnopqrstuvwxyz\015\015\015\015\015\015\015\015...............\001\002\003\004\005\006ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^...............", -1, 0, 132, 132, 0, "Mixed modes (except B256); BWIPP different encodation", 0,
                     "101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "101001101001010011000111100011111001011001011010011010010111111101110111100110110110000111110000111000011100111110111010111110010101"
                     "101100101010110110010011000010100000111010101111010100001111001010100011010100110101000010101011010001111011001010111111011000100110"
@@ -5061,7 +5085,7 @@
                     "110101010100010111111010100000000000110011101101010011010100111010111011101111011111110010101110001010101110001010111111010011111110"
                     "111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"
                 },
-        /*176*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ;<>@[]_`~!||()?{}'123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678912345678912345678912345678900001234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'\001\002\003\004\005\006...............\015\015\015\015\015\015\015\015abcdefghijklmnopqrstuvwxyz\015\015\015\015\015\015\015\015...............\001\002\003\004\005\006ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^...............", -1, 0, 120, 120, 0, "Mixed modes (except B256); BWIPP uses different encodation", 13,
+        /*177*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, -1, -1, -1, "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ;<>@[]_`~!||()?{}'123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678912345678912345678912345678900001234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^;<>@[]_`~!||()?{}'\001\002\003\004\005\006...............\015\015\015\015\015\015\015\015abcdefghijklmnopqrstuvwxyz\015\015\015\015\015\015\015\015...............\001\002\003\004\005\006ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&,:#-.$/+%*=^...............", -1, 0, 120, 120, 0, "Mixed modes (except B256); BWIPP uses different encodation", 13,
                     "101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010"
                     "101001101001010011011001100011111001011110010010011011010111111101001110101111111010000001101101101110110111111011101011"
                     "101100101010110110001101000010100000111010101111010101000000110001110101001100101001111100111000101011100101101011001100"
diff -urN zint-2.12.0/backend/tests/test_emf.c zint/backend/tests/test_emf.c
--- zint-2.12.0/backend/tests/test_emf.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_emf.c	2023-05-08 14:39:44.923319712 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -81,6 +81,7 @@
         /* 25*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, 600.f / 25.4f, "E0E0E0", "700070", 0, "THIS IS A 93 CHARACTER CODE SET A MESSAGE THAT FILLS A MODE 4, UNAPPENDED, MAXICODE SYMBOL...", "maxicode_#185_600dpi.emf", "#185 Maxicode scaling" },
         /* 26*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, 0, "", "FFFFFF00", 90, "THIS IS A 93 CHARACTER CODE SET A MESSAGE THAT FILLS A MODE 4, UNAPPENDED, MAXICODE SYMBOL...", "maxicode_rotate_90_nobg.emf", "" },
         /* 27*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, 300.0f, "", "FFFFFF00", 90, "THIS IS A 93 CHARACTER CODE SET A MESSAGE THAT FILLS A MODE 4, UNAPPENDED, MAXICODE SYMBOL...", "maxicode_rotate_90_nobg_300dpi.emf", "" },
+        /* 28*/ { BARCODE_UPU_S10, -1, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, "71,0,40,44", "FFFFFF00", 0, "QA47312482PS", "upu_s10_cmyk_nobg.emf", "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -157,7 +158,8 @@
                 /* Note this will fail (on Ubuntu anyway) if LibreOffice Base/Calc/Impress/Writer running (i.e. anything but LibreOffice Draw)
                    Doesn't seem to be a way to force Draw invocation through the command line */
                 ret = testUtilVerifyLibreOffice(expected_file, debug);
-                assert_zero(ret, "i:%d %s libreoffice %s ret %d != 0\n", i, testUtilBarcodeName(data[i].symbology), expected_file, ret);
+                assert_zero(ret, "i:%d %s libreoffice %s ret %d != 0 - check that LibreOffice is not running!\n",
+                            i, testUtilBarcodeName(data[i].symbology), expected_file, ret);
             }
         } else {
             assert_nonzero(testUtilExists(symbol->outfile), "i:%d testUtilExists(%s) == 0\n", i, symbol->outfile);
diff -urN zint-2.12.0/backend/tests/test_gb18030.c zint/backend/tests/test_gb18030.c
--- zint-2.12.0/backend/tests/test_gb18030.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_gb18030.c	2023-05-08 14:39:44.923319712 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -554,7 +554,10 @@
     int i, length, ret;
 
     struct zint_symbol symbol = {0};
-    int ret_length, ret_length2;
+    int ret_length;
+#ifdef TEST_JUST_SAY_GNO
+    int ret_length2;
+#endif
     unsigned int ddata[8192];
     unsigned char dest[8192];
     int ret2 = 0;
@@ -585,13 +588,14 @@
         diff = diff_gno = diff_eci = 0;
 
         for (j = 0; j < TEST_PERF_ITERATIONS; j++) {
-            ret_length = ret_length2 = length;
+            ret_length = length;
 
             start = clock();
             ret = gb18030_utf8(&symbol, (unsigned char *) data[i].data, &ret_length, ddata);
             diff += clock() - start;
 
 #ifdef TEST_JUST_SAY_GNO
+            ret_length2 = length;
             start = clock();
             ret2 = gb18030_utf8_wctomb(&symbol, (unsigned char *) data[i].data, &ret_length2, ddata2);
             diff_gno += clock() - start;
diff -urN zint-2.12.0/backend/tests/test_gb2312.c zint/backend/tests/test_gb2312.c
--- zint-2.12.0/backend/tests/test_gb2312.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_gb2312.c	2023-05-08 14:39:44.930319753 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -392,7 +392,10 @@
     int i, length, ret;
 
     struct zint_symbol symbol = {0};
-    int ret_length, ret_length2;
+    int ret_length;
+#ifdef TEST_JUST_SAY_GNO
+    int ret_length2;
+#endif
     unsigned int ddata[8192];
     unsigned char dest[8192];
     int ret2 = 0;
@@ -424,25 +427,27 @@
         diff = diff_gno = diff_eci = diff_eci_gno = 0;
 
         for (j = 0; j < TEST_PERF_ITERATIONS; j++) {
-            ret_length = ret_length2 = length;
+            ret_length = length;
 
             start = clock();
             ret = gb2312_utf8(&symbol, (unsigned char *) data[i].data, &ret_length, ddata);
             diff += clock() - start;
 
 #ifdef TEST_JUST_SAY_GNO
+            ret_length2 = length;
             start = clock();
             ret2 = gb2312_utf8_wctomb(&symbol, (unsigned char *) data[i].data, &ret_length2, ddata2);
             diff_gno += clock() - start;
 #endif
 
-            ret_length = ret_length2 = length;
+            ret_length = length;
 
             start = clock();
             (void)utf8_to_eci(29, (unsigned char *) data[i].data, dest, &ret_length);
             diff_eci += clock() - start;
 
 #ifdef TEST_JUST_SAY_GNO
+            ret_length2 = length;
             start = clock();
             (void)utf8_to_eci_wctomb(29, (unsigned char *) data[i].data, dest2, &ret_length2);
             diff_eci_gno += clock() - start;
diff -urN zint-2.12.0/backend/tests/test_gif.c zint/backend/tests/test_gif.c
--- zint-2.12.0/backend/tests/test_gif.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_gif.c	2023-05-08 14:39:44.933319771 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -164,15 +164,18 @@
         /* 19*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, 0, 5, 1.7, { 0, 0, "" }, "", "", "12", "dotcode_5.0_ds1.7.gif", "" },
         /* 20*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "2674C344", "FDFFC2CC", "12", "dotcode_bgfgalpha.gif", "" },
         /* 21*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "00000000", "FFFFFF00", "12", "dotcode_bgfgtrans.gif", "" },
-        /* 22*/ { BARCODE_ULTRA, 1, BARCODE_BOX, 1, 1, -1, -1, 0, 0, 0, { 0, 0, "" }, "0000FF", "FF0000", "12", "ultra_fgbg_hvwsp1_box1.gif", "" },
-        /* 23*/ { BARCODE_ITF14, 4, BARCODE_BIND, 24, -1, -1, -1, 61.8, 3, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height61.8_bind4_wsp24_3.gif", "#204 ARM-Cortex crash" },
-        /* 24*/ { BARCODE_ITF14, 0, BARCODE_BIND, -1, -1, -1, -1, 0.5, 0.5, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height0.5_box0_0.5.gif", "No box, no text" },
-        /* 25*/ { BARCODE_ITF14, -1, -1, -1, -1, -1, -1, 0.5, 1.1, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height0.5_1.1.gif", "" },
-        /* 26*/ { BARCODE_CODE16K, -1, -1, 3, 5, -1, -1, 0.5, 0, 0, { 0, 0, "" }, "", "", "1234567890", "code16k_height0.5_wsp3_vwsp5.gif", "Separator covers bars" },
-        /* 27*/ { BARCODE_CODE16K, -1, -1, 3, 5, -1, -1, 1.5, 0, 0, { 0, 0, "" }, "", "", "1234567890", "code16k_height1.5_wsp3_vwsp5.gif", "" },
-        /* 28*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 2, 9, "001002" }, "", "", "1234567890", "datamatrix_seq2of9.gif", "" },
-        /* 29*/ { BARCODE_ULTRA, -1, -1, 1, -1, -1, 2, 0, 0, 0, { 0, 0, "" }, "", "", "12", "ultra_rev2.gif", "Revision 2" },
-        /* 30*/ { BARCODE_DPD, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "", "", "008182709980000020028101276", "dpd_compliant.gif", "Now with bind top 3X default" },
+        /* 22*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "00000000", "FFFFFF", "12", "dotcode_fgtrans.gif", "" },
+        /* 23*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "000000", "FFFFFF00", "12", "dotcode_bgtrans.gif", "" },
+        /* 24*/ { BARCODE_DOTCODE, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "71,0,40,44", "", "12", "dotcode_cmyk_fg.gif", "" },
+        /* 25*/ { BARCODE_ULTRA, 1, BARCODE_BOX, 1, 1, -1, -1, 0, 0, 0, { 0, 0, "" }, "0000FF", "FF0000", "12", "ultra_fgbg_hvwsp1_box1.gif", "" },
+        /* 26*/ { BARCODE_ITF14, 4, BARCODE_BIND, 24, -1, -1, -1, 61.8, 3, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height61.8_bind4_wsp24_3.gif", "#204 ARM-Cortex crash" },
+        /* 27*/ { BARCODE_ITF14, 0, BARCODE_BIND, -1, -1, -1, -1, 0.5, 0.5, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height0.5_box0_0.5.gif", "No box, no text" },
+        /* 28*/ { BARCODE_ITF14, -1, -1, -1, -1, -1, -1, 0.5, 1.1, 0, { 0, 0, "" }, "", "", "0501054800395", "itf14_height0.5_1.1.gif", "" },
+        /* 29*/ { BARCODE_CODE16K, -1, -1, 3, 5, -1, -1, 0.5, 0, 0, { 0, 0, "" }, "", "", "1234567890", "code16k_height0.5_wsp3_vwsp5.gif", "Separator covers bars" },
+        /* 30*/ { BARCODE_CODE16K, -1, -1, 3, 5, -1, -1, 1.5, 0, 0, { 0, 0, "" }, "", "", "1234567890", "code16k_height1.5_wsp3_vwsp5.gif", "" },
+        /* 31*/ { BARCODE_DATAMATRIX, -1, -1, -1, -1, -1, -1, 0, 0, 0, { 2, 9, "001002" }, "", "", "1234567890", "datamatrix_seq2of9.gif", "" },
+        /* 32*/ { BARCODE_ULTRA, -1, -1, 1, -1, -1, 2, 0, 0, 0, { 0, 0, "" }, "", "", "12", "ultra_rev2.gif", "Revision 2" },
+        /* 33*/ { BARCODE_DPD, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, 0, 0, 0, { 0, 0, "" }, "", "", "008182709980000020028101276", "dpd_compliant.gif", "Now with bind top 3X default" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_library.c zint/backend/tests/test_library.c
--- zint-2.12.0/backend/tests/test_library.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_library.c	2023-05-08 14:39:44.939319806 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -52,6 +52,7 @@
         int border_width;
         float scale;
         float dot_size;
+        float text_gap;
         float guard_descent;
         int warn_level;
         int ret;
@@ -61,155 +62,157 @@
     };
     /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
     struct item data[] = {
-        /*  0*/ { BARCODE_CODE128, -1, "1234", -1, -1, 3, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", -1 },
-        /*  1*/ { BARCODE_CODE128, -1, "1234", -1, -1, 0, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", -1 },
-        /*  2*/ { BARCODE_QRCODE, -1, "1234", -1, -1, 3, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", -1 },
-        /*  3*/ { BARCODE_QRCODE, -1, "1234", -1, -1, 999999 + 1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 218: Invalid ECI code 1000000", -1 },
-        /*  4*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 0.009, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 227: Scale out of range (0.01 to 200)", -1 },
-        /*  5*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 200.01, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 227: Scale out of range (0.01 to 200)", -1 },
-        /*  6*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, -1, 20.1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", -1 },
-        /*  7*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 0.01, 0.009, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", -1 },
-        /*  8*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, -0.1, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 765: Height out of range (0 to 2000)", -1 },
-        /*  9*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 2000.01, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 765: Height out of range (0 to 2000)", -1 },
-        /* 10*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, -1, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 766: Whitespace width out of range (0 to 100)", -1 },
-        /* 11*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 101, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 766: Whitespace width out of range (0 to 100)", -1 },
-        /* 12*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, -1, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 767: Whitespace height out of range (0 to 100)", -1 },
-        /* 13*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 101, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 767: Whitespace height out of range (0 to 100)", -1 },
-        /* 14*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, -1, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 768: Border width out of range (0 to 100)", -1 },
-        /* 15*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 101, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 768: Border width out of range (0 to 100)", -1 },
-        /* 16*/ { BARCODE_CODE128, -1, "1234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 220: Selected symbology does not support GS1 mode", -1 },
-        /* 17*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, -0.5, -1, ZINT_ERROR_INVALID_OPTION, "Error 769: Guard bar descent out of range (0 to 50)", -1 },
-        /* 18*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, 50.1, -1, ZINT_ERROR_INVALID_OPTION, "Error 769: Guard bar descent out of range (0 to 50)", -1 },
-        /* 19*/ { BARCODE_GS1_128, -1, "[21]12\0004", 8, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 262: NUL characters not permitted in GS1 mode", -1 },
-        /* 20*/ { BARCODE_GS1_128, -1, "[21]12Ã©4", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 250: Extended ASCII characters are not supported by GS1", -1 },
-        /* 21*/ { BARCODE_GS1_128, -1, "[21]12\0074", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 251: Control characters are not supported by GS1", -1 },
-        /* 22*/ { BARCODE_GS1_128, -1, "[21]1234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", -1 },
-        /* 23*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 206: Symbology out of range", BARCODE_CODE128 },
-        /* 24*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
-        /* 25*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", BARCODE_CODE128 }, /* Not supporting beats invalid ECI */
-        /* 26*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
-        /* 27*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", BARCODE_CODE128 },
-        /* 28*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
-        /* 29*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, 0.009, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", BARCODE_CODE128 }, /* Invalid dot size no longer beats invalid ECI */
-        /* 30*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
-        /* 31*/ { 5, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_C25STANDARD },
-        /* 32*/ { 5, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_C25STANDARD },
-        /* 33*/ { 10, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_EANX },
-        /* 34*/ { 10, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
-        /* 35*/ { 11, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_EANX },
-        /* 36*/ { 11, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
-        /* 37*/ { 12, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_EANX },
-        /* 38*/ { 12, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
-        /* 39*/ { 15, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_EANX },
-        /* 40*/ { 15, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
-        /* 41*/ { 17, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_UPCA },
-        /* 42*/ { 17, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
-        /* 43*/ { 19, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_TOO_LONG, "Error 362: Input too short (3 character minimum)", BARCODE_CODABAR },
-        /* 44*/ { 19, -1, "A1B", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 207: Codabar 18 not supported", BARCODE_CODABAR },
-        /* 45*/ { 19, -1, "A1B", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 207: Codabar 18 not supported", -1 },
-        /* 46*/ { 26, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_UPCA },
-        /* 47*/ { 26, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
-        /* 48*/ { 27, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 208: UPCD1 not supported", 27 },
-        /* 49*/ { 33, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 252: Data does not start with an AI", BARCODE_GS1_128 },
-        /* 50*/ { 33, -1, "[10]23", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_GS1_128 },
-        /* 51*/ { 33, -1, "[10]23", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_GS1_128 },
-        /* 52*/ { 36, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_UPCA },
-        /* 53*/ { 36, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
-        /* 54*/ { 39, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_UPCE },
-        /* 55*/ { 39, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCE },
-        /* 56*/ { 41, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_NONCOMPLIANT, "Warning 479: Input length is not standard (5, 9 or 11 characters)", BARCODE_POSTNET },
-        /* 57*/ { 41, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_POSTNET },
-        /* 58*/ { 41, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
-        /* 59*/ { 42, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_POSTNET },
-        /* 60*/ { 42, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
-        /* 61*/ { 43, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_POSTNET },
-        /* 62*/ { 43, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
-        /* 63*/ { 44, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_POSTNET },
-        /* 64*/ { 44, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
-        /* 65*/ { 45, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_POSTNET },
-        /* 66*/ { 45, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
-        /* 67*/ { 46, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_PLESSEY },
-        /* 68*/ { 46, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_PLESSEY },
-        /* 69*/ { 48, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_NVE18 },
-        /* 70*/ { 48, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_NVE18 },
-        /* 71*/ { 59, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_CODE128 },
-        /* 72*/ { 59, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE128 },
-        /* 73*/ { 61, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_CODE128 },
-        /* 74*/ { 61, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE128 },
-        /* 75*/ { 62, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_CODE93 },
-        /* 76*/ { 62, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE93 },
-        /* 77*/ { 64, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_AUSPOST },
-        /* 78*/ { 64, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_AUSPOST },
-        /* 79*/ { 65, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_AUSPOST },
-        /* 80*/ { 65, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_AUSPOST },
-        /* 81*/ { 78, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_DBAR_OMN },
-        /* 82*/ { 78, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_DBAR_OMN },
-        /* 83*/ { 83, -1, "12345678901", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_PLANET },
-        /* 84*/ { 83, -1, "12345678901", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_PLANET },
-        /* 85*/ { 88, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 252: Data does not start with an AI", BARCODE_GS1_128 },
-        /* 86*/ { 88, -1, "[10]12", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_GS1_128 },
-        /* 87*/ { 88, -1, "[10]12", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_GS1_128 },
-        /* 88*/ { 91, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 212: Symbology out of range", BARCODE_CODE128 },
-        /* 89*/ { 91, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 212: Symbology out of range", -1 },
-        /* 90*/ { 94, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 213: Symbology out of range", BARCODE_CODE128 },
-        /* 91*/ { 94, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 213: Symbology out of range", -1 },
-        /* 92*/ { 95, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 213: Symbology out of range", BARCODE_CODE128 },
-        /* 93*/ { 95, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 213: Symbology out of range", -1 },
-        /* 94*/ { 100, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_128 },
-        /* 95*/ { 100, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_128 },
-        /* 96*/ { 101, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_39 },
-        /* 97*/ { 101, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_39 },
-        /* 98*/ { 103, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_DM },
-        /* 99*/ { 103, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_DM },
-        /*100*/ { 105, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_QR },
-        /*101*/ { 105, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_QR },
-        /*102*/ { 107, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_PDF },
-        /*103*/ { 107, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_PDF },
-        /*104*/ { 109, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_MICPDF },
-        /*105*/ { 109, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_MICPDF },
-        /*106*/ { 111, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", BARCODE_HIBC_BLOCKF },
-        /*107*/ { 111, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_BLOCKF },
-        /*108*/ { 113, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 214: Symbology out of range", BARCODE_CODE128 },
-        /*109*/ { 113, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 214: Symbology out of range", -1 },
-        /*110*/ { 114, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 214: Symbology out of range", BARCODE_CODE128 },
-        /*111*/ { 114, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 214: Symbology out of range", -1 },
-        /*112*/ { 117, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*113*/ { 117, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*114*/ { 118, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*115*/ { 118, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*116*/ { 122, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*117*/ { 122, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*118*/ { 123, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*119*/ { 123, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*120*/ { 124, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*121*/ { 124, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*122*/ { 125, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*123*/ { 125, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*124*/ { 126, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*125*/ { 126, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*126*/ { 127, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
-        /*127*/ { 127, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
-        /*128*/ { 147, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 216: Symbology out of range", BARCODE_CODE128 },
-        /*129*/ { 147, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 216: Symbology out of range", -1 },
-        /*130*/ { BARCODE_LAST + 1, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 216: Symbology out of range", BARCODE_CODE128 },
-        /*131*/ { BARCODE_LAST + 1, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 216: Symbology out of range", -1 },
-        /*132*/ { BARCODE_CODE128, -1, "\200", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 245: Invalid UTF-8 in input data", -1 },
-        /*133*/ { BARCODE_GS1_128, -1, "[01]12345678901234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_NONCOMPLIANT, "Warning 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 },
-        /*134*/ { BARCODE_GS1_128, -1, "[01]12345678901234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_NONCOMPLIANT, "Error 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 },
-        /*135*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", -1 },
-        /*136*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 },
-        /*137*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_USES_ECI, "Error 222: Encoded data includes ECI 13", -1 },
-        /*138*/ { BARCODE_CODEONE, -1, "[01]12345678901231", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 512: ECI ignored for GS1 mode", -1 },
-        /*139*/ { BARCODE_CODEONE, -1, "[01]12345678901231", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 512: ECI ignored for GS1 mode", -1 },
-        /*140*/ { BARCODE_CODEONE, -1, "[01]12345678901234", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 512: ECI ignored for GS1 mode", -1 }, /* Warning in encoder overrides library warnings */
-        /*141*/ { BARCODE_CODEONE, -1, "[01]12345678901234", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_NONCOMPLIANT, "Error 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 }, /* But not errors */
-        /*142*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, -1, -1, 0, "", -1 },
-        /*143*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 },
-        /*144*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_USES_ECI, "Error 222: Encoded data includes ECI 13", -1 },
-        /*145*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 503: Invalid error correction level - using default instead", -1 },
-        /*146*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 503: Invalid error correction level - using default instead", -1 },
-        /*147*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 }, /* ECI warning trumps all other warnings */
-        /*148*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 503: Invalid error correction level - using default instead", -1 }, /* But not errors */
+        /*  0*/ { BARCODE_CODE128, -1, "1234", -1, -1, 3, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", -1 },
+        /*  1*/ { BARCODE_CODE128, -1, "1234", -1, -1, 0, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", -1 },
+        /*  2*/ { BARCODE_QRCODE, -1, "1234", -1, -1, 3, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", -1 },
+        /*  3*/ { BARCODE_QRCODE, -1, "1234", -1, -1, 999999 + 1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 218: Invalid ECI code 1000000", -1 },
+        /*  4*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 0.009, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 227: Scale out of range (0.01 to 200)", -1 },
+        /*  5*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 200.01, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 227: Scale out of range (0.01 to 200)", -1 },
+        /*  6*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, -1, 20.1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", -1 },
+        /*  7*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 0, 0.01, 0.009, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", -1 },
+        /*  8*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, -0.1, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 765: Height out of range (0 to 2000)", -1 },
+        /*  9*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 2000.01, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 765: Height out of range (0 to 2000)", -1 },
+        /* 10*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, -1, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 766: Whitespace width out of range (0 to 100)", -1 },
+        /* 11*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 101, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 766: Whitespace width out of range (0 to 100)", -1 },
+        /* 12*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, -1, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 767: Whitespace height out of range (0 to 100)", -1 },
+        /* 13*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 101, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 767: Whitespace height out of range (0 to 100)", -1 },
+        /* 14*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, -1, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 768: Border width out of range (0 to 100)", -1 },
+        /* 15*/ { BARCODE_CODE128, -1, "1234", -1, -1, -1, 0, 0, 0, 101, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 768: Border width out of range (0 to 100)", -1 },
+        /* 16*/ { BARCODE_CODE128, -1, "1234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 220: Selected symbology does not support GS1 mode", -1 },
+        /* 17*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, -0.1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 219: Text gap out of range (0 to 5)", -1 },
+        /* 18*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, 5.1, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 219: Text gap out of range (0 to 5)", -1 },
+        /* 19*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, 0, -0.5, -1, ZINT_ERROR_INVALID_OPTION, "Error 769: Guard bar descent out of range (0 to 50)", -1 },
+        /* 20*/ { BARCODE_EANX, -1, "123456789012", -1, -1, -1, 0, 0, 0, 101, -1, -1, 0, 50.1, -1, ZINT_ERROR_INVALID_OPTION, "Error 769: Guard bar descent out of range (0 to 50)", -1 },
+        /* 21*/ { BARCODE_GS1_128, -1, "[21]12\0004", 8, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 262: NUL characters not permitted in GS1 mode", -1 },
+        /* 22*/ { BARCODE_GS1_128, -1, "[21]12Ã©4", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 250: Extended ASCII characters are not supported by GS1", -1 },
+        /* 23*/ { BARCODE_GS1_128, -1, "[21]12\0074", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 251: Control characters are not supported by GS1", -1 },
+        /* 24*/ { BARCODE_GS1_128, -1, "[21]1234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", -1 },
+        /* 25*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 206: Symbology out of range", BARCODE_CODE128 },
+        /* 26*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
+        /* 27*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", BARCODE_CODE128 }, /* Not supporting beats invalid ECI */
+        /* 28*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
+        /* 29*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 221: Dot size out of range (0.01 to 20)", BARCODE_CODE128 },
+        /* 30*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
+        /* 31*/ { 0, -1, "1", -1, -1, 1, 0, 0, 0, 0, -1, 0.009, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 217: Symbology does not support ECI switching", BARCODE_CODE128 }, /* Invalid dot size no longer beats invalid ECI */
+        /* 32*/ { 0, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, 0.009, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 206: Symbology out of range", -1 },
+        /* 33*/ { 5, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_C25STANDARD },
+        /* 34*/ { 5, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_C25STANDARD },
+        /* 35*/ { 10, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_EANX },
+        /* 36*/ { 10, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
+        /* 37*/ { 11, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_EANX },
+        /* 38*/ { 11, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
+        /* 39*/ { 12, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_EANX },
+        /* 40*/ { 12, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
+        /* 41*/ { 15, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_EANX },
+        /* 42*/ { 15, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_EANX },
+        /* 43*/ { 17, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_UPCA },
+        /* 44*/ { 17, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
+        /* 45*/ { 19, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_TOO_LONG, "Error 362: Input too short (3 character minimum)", BARCODE_CODABAR },
+        /* 46*/ { 19, -1, "A1B", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 207: Codabar 18 not supported", BARCODE_CODABAR },
+        /* 47*/ { 19, -1, "A1B", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 207: Codabar 18 not supported", -1 },
+        /* 48*/ { 26, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_UPCA },
+        /* 49*/ { 26, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
+        /* 50*/ { 27, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_OPTION, "Error 208: UPCD1 not supported", 27 },
+        /* 51*/ { 33, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 252: Data does not start with an AI", BARCODE_GS1_128 },
+        /* 52*/ { 33, -1, "[10]23", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_GS1_128 },
+        /* 53*/ { 33, -1, "[10]23", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_GS1_128 },
+        /* 54*/ { 36, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_UPCA },
+        /* 55*/ { 36, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCA },
+        /* 56*/ { 39, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_UPCE },
+        /* 57*/ { 39, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_UPCE },
+        /* 58*/ { 41, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_NONCOMPLIANT, "Warning 479: Input length is not standard (5, 9 or 11 characters)", BARCODE_POSTNET },
+        /* 59*/ { 41, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_POSTNET },
+        /* 60*/ { 41, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
+        /* 61*/ { 42, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_POSTNET },
+        /* 62*/ { 42, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
+        /* 63*/ { 43, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_POSTNET },
+        /* 64*/ { 43, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
+        /* 65*/ { 44, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_POSTNET },
+        /* 66*/ { 44, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
+        /* 67*/ { 45, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_POSTNET },
+        /* 68*/ { 45, -1, "12345", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_POSTNET },
+        /* 69*/ { 46, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_PLESSEY },
+        /* 70*/ { 46, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_PLESSEY },
+        /* 71*/ { 48, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_NVE18 },
+        /* 72*/ { 48, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_NVE18 },
+        /* 73*/ { 59, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_CODE128 },
+        /* 74*/ { 59, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE128 },
+        /* 75*/ { 61, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_CODE128 },
+        /* 76*/ { 61, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE128 },
+        /* 77*/ { 62, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_CODE93 },
+        /* 78*/ { 62, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_CODE93 },
+        /* 79*/ { 64, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_AUSPOST },
+        /* 80*/ { 64, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_AUSPOST },
+        /* 81*/ { 65, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_AUSPOST },
+        /* 82*/ { 65, -1, "12345678", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_AUSPOST },
+        /* 83*/ { 78, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_DBAR_OMN },
+        /* 84*/ { 78, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_DBAR_OMN },
+        /* 85*/ { 83, -1, "12345678901", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_PLANET },
+        /* 86*/ { 83, -1, "12345678901", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_PLANET },
+        /* 87*/ { 88, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 252: Data does not start with an AI", BARCODE_GS1_128 },
+        /* 88*/ { 88, -1, "[10]12", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_GS1_128 },
+        /* 89*/ { 88, -1, "[10]12", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_GS1_128 },
+        /* 90*/ { 91, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 212: Symbology out of range", BARCODE_CODE128 },
+        /* 91*/ { 91, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 212: Symbology out of range", -1 },
+        /* 92*/ { 94, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 213: Symbology out of range", BARCODE_CODE128 },
+        /* 93*/ { 94, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 213: Symbology out of range", -1 },
+        /* 94*/ { 95, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 213: Symbology out of range", BARCODE_CODE128 },
+        /* 95*/ { 95, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 213: Symbology out of range", -1 },
+        /* 96*/ { 100, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_128 },
+        /* 97*/ { 100, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_128 },
+        /* 98*/ { 101, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_39 },
+        /* 99*/ { 101, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_39 },
+        /*100*/ { 103, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_DM },
+        /*101*/ { 103, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_DM },
+        /*102*/ { 105, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_QR },
+        /*103*/ { 105, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_QR },
+        /*104*/ { 107, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_PDF },
+        /*105*/ { 107, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_PDF },
+        /*106*/ { 109, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_MICPDF },
+        /*107*/ { 109, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_MICPDF },
+        /*108*/ { 111, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", BARCODE_HIBC_BLOCKF },
+        /*109*/ { 111, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, 0, "", BARCODE_HIBC_BLOCKF },
+        /*110*/ { 113, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 214: Symbology out of range", BARCODE_CODE128 },
+        /*111*/ { 113, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 214: Symbology out of range", -1 },
+        /*112*/ { 114, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 214: Symbology out of range", BARCODE_CODE128 },
+        /*113*/ { 114, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 214: Symbology out of range", -1 },
+        /*114*/ { 117, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*115*/ { 117, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*116*/ { 118, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*117*/ { 118, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*118*/ { 122, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*119*/ { 122, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*120*/ { 123, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*121*/ { 123, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*122*/ { 124, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*123*/ { 124, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*124*/ { 125, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*125*/ { 125, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*126*/ { 126, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*127*/ { 126, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*128*/ { 127, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 215: Symbology out of range", BARCODE_CODE128 },
+        /*129*/ { 127, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 215: Symbology out of range", -1 },
+        /*130*/ { 147, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 216: Symbology out of range", BARCODE_CODE128 },
+        /*131*/ { 147, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 216: Symbology out of range", -1 },
+        /*132*/ { BARCODE_LAST + 1, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 216: Symbology out of range", BARCODE_CODE128 },
+        /*133*/ { BARCODE_LAST + 1, -1, "1", -1, -1, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 216: Symbology out of range", -1 },
+        /*134*/ { BARCODE_CODE128, -1, "\200", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_ERROR_INVALID_DATA, "Error 245: Invalid UTF-8 in input data", -1 },
+        /*135*/ { BARCODE_GS1_128, -1, "[01]12345678901234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_NONCOMPLIANT, "Warning 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 },
+        /*136*/ { BARCODE_GS1_128, -1, "[01]12345678901234", -1, GS1_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_NONCOMPLIANT, "Error 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 },
+        /*137*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", -1 },
+        /*138*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 },
+        /*139*/ { BARCODE_QRCODE, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_USES_ECI, "Error 222: Encoded data includes ECI 13", -1 },
+        /*140*/ { BARCODE_CODEONE, -1, "[01]12345678901231", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 512: ECI ignored for GS1 mode", -1 },
+        /*141*/ { BARCODE_CODEONE, -1, "[01]12345678901231", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 512: ECI ignored for GS1 mode", -1 },
+        /*142*/ { BARCODE_CODEONE, -1, "[01]12345678901234", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 512: ECI ignored for GS1 mode", -1 }, /* Warning in encoder overrides library warnings */
+        /*143*/ { BARCODE_CODEONE, -1, "[01]12345678901234", -1, GS1_MODE, 3, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_NONCOMPLIANT, "Error 261: AI (01) position 14: Bad checksum '4', expected '1'", -1 }, /* But not errors */
+        /*144*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, 0, -1, -1, 0, "", -1 },
+        /*145*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 },
+        /*146*/ { BARCODE_AZTEC, -1, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_USES_ECI, "Error 222: Encoded data includes ECI 13", -1 },
+        /*147*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_INVALID_OPTION, "Warning 503: Invalid error correction level - using default instead", -1 },
+        /*148*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, 13, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 503: Invalid error correction level - using default instead", -1 },
+        /*149*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, ZINT_WARN_USES_ECI, "Warning 222: Encoded data includes ECI 13", -1 }, /* ECI warning trumps all other warnings */
+        /*150*/ { BARCODE_AZTEC, 6, "à¸", -1, UNICODE_MODE, -1, 0, 0, 0, 0, -1, -1, 0, -1, WARN_FAIL_ALL, ZINT_ERROR_INVALID_OPTION, "Error 503: Invalid error correction level - using default instead", -1 }, /* But not errors */
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -243,6 +246,9 @@
         if (data[i].dot_size != -1) {
             symbol->dot_size = data[i].dot_size;
         }
+        if (data[i].text_gap) {
+            symbol->text_gap = data[i].text_gap;
+        }
         if (data[i].guard_descent != -1) {
             symbol->guard_descent = data[i].guard_descent;
         }
@@ -547,7 +553,11 @@
         /* 73*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 34, "\\U10FFFF", "", 0, 16, "F1 23 01 01 01 01 01 01 EB 80 EB 80 F6 F1 5D 2A D1 0A BF BC B8 22 65 0C", 0, "" },
         /* 74*/ { BARCODE_DATAMATRIX, UNICODE_MODE, 35, "\\U10FFFF", "", 0, 16, "F1 24 01 01 01 01 EB 80 EB 80 01 01 7F 58 28 41 7F 63 0E EB A7 D8 D0 1F", 0, "" },
         /* 75*/ { BARCODE_GS1_128_CC, GS1_MODE, -1, "[20]10", "[10]A", 0, 99, "(7) 105 102 20 10 100 59 106", 0, "" },
-        /* 76*/ { BARCODE_GS1_128_CC, GS1_MODE | ESCAPE_MODE, -1, "[2\\x30]1\\d048", "[\\x310]\\x41", 0, 99, "(7) 105 102 20 10 100 59 106", 1, "" },
+        /* 76*/ { BARCODE_GS1_128_CC, GS1_MODE, -1, "[2\\x30]1\\d048", "[\\x310]\\x41", 0, 99, "(7) 105 102 20 10 100 59 106", 1, "" },
+        /* 77*/ { BARCODE_DATAMATRIX, DATA_MODE, -1, "\\^A1", "", ZINT_ERROR_INVALID_DATA, 0, "Error 798: Escape '\\^' only valid for Code 128 in extra escape mode", 0, "" },
+        /* 78*/ { BARCODE_CODE128, DATA_MODE | EXTRA_ESCAPE_MODE, -1, "\\^A1", "", 0, 46, "(4) 103 17 17 106", 0, "" },
+        /* 79*/ { BARCODE_CODE128, EXTRA_ESCAPE_MODE, -1, "\\^", "", 0, 57, "(5) 104 60 62 82 106", 0, "Partial special escape '\\^' at end allowed" },
+        /* 80*/ { BARCODE_CODE128, EXTRA_ESCAPE_MODE, -1, "\\^D1", "", 0, 79, "(7) 104 60 62 36 17 52 106", 0, "Unknown special escapes passed straight thu" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_maxicode.c zint/backend/tests/test_maxicode.c
--- zint-2.12.0/backend/tests/test_maxicode.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_maxicode.c	2023-05-08 14:39:44.940319812 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -139,53 +139,54 @@
         /*  0*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 01 21 21 21 21 21 21 21 21 08 0E 19 2B 20 0C 24 06 32 1C 21 21 21 21 21 21 21 21", 1, 1, "" },
         /*  1*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "" },
         /*  2*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "A123456", ZINT_ERROR_INVALID_DATA, 0, "Error 555: Non-numeric postcode in Primary Message", 1, 1, "" },
-        /*  3*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 0, 1, "1-digit postcode" },
-        /*  4*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "1 123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 0, 0, "1-digit postcode; ZXing-C++ test can't handle space" },
-        /*  5*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 0, 1, "9-digit postcode" },
+        /*  3*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 1, 1, "1-digit postcode" },
+        /*  4*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "1 123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 1, 0, "1-digit postcode; ZXing-C++ test can't handle space" },
+        /*  5*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 1, 1, "9-digit postcode" },
         /*  6*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "1234567890123456", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "10-digit postcode" },
-        /*  7*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 0, 1, "1-digit postcode" },
-        /*  8*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 0, 1, "9-digit postcode" },
+        /*  7*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 12 00 00 00 00 10 30 1E 20 1C 1A 3D 1C 0D 1B 15 3C 17 3C 08 01 21 21 21 21 21 21 21", 0, 1, "1-digit postcode; BWIPP requires mode" },
+        /*  8*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 0, 1, "9-digit postcode; BWIPP requires mode" },
         /*  9*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "1234567890123456", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "10-digit postcode" },
         /* 10*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "123456", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "0-digit postcode" },
-        /* 11*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "12345678123456", 0, 30, "(144) 22 13 21 31 0B 00 32 1E 20 1C 04 14 07 30 10 07 08 28 1D 09 01 21 21 21 21 21 21 21", 0, 1, "8-digit postcode" },
-        /* 12*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "" },
-        /* 13*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "A123456", 0, 30, "(144) 03 08 08 08 08 18 30 1E 20 1C 22 35 1C 0F 02 1A 26 04 10 31 01 21 21 21 21 21 21 21", 1, 1, "1-alphanumeric postcode" },
-        /* 14*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 03 08 08 08 08 18 3C 1E 20 1C 13 37 07 2C 26 2D 18 29 3F 2C 01 21 21 21 21 21 21 21", 0, 0, "1-digit postcode; ZXing-C++ test can't handle padding" },
-        /* 15*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "A123456", 0, 30, "(144) 03 08 08 08 08 18 30 1E 20 1C 22 35 1C 0F 02 1A 26 04 10 31 01 21 21 21 21 21 21 21", 1, 1, "1-alphanumeric postcode" },
-        /* 16*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDEF123456", 0, 30, "(144) 23 11 01 31 20 10 30 1E 20 1C 3C 1D 22 03 19 15 0F 20 0F 2A 01 21 21 21 21 21 21 21", 1, 1, "6-alphanumeric postcode" },
-        /* 17*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDEFG123456", 0, 30, "(144) 23 11 01 31 20 10 30 1E 20 1C 3C 1D 22 03 19 15 0F 20 0F 2A 01 21 21 21 21 21 21 21", 1, 0, "7-alphanumeric postcode truncated; ZXing-C++ test can't handle truncation" },
-        /* 18*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDE123456", 0, 30, "(144) 03 18 01 31 20 10 30 1E 20 1C 0F 38 38 1A 39 10 2F 37 22 12 01 21 21 21 21 21 21 21", 1, 1, "5-alphanumeric postcode" },
-        /* 19*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AAAAAA   840001", 0, 30, "(144) 13 10 10 10 10 10 00 12 07 00 17 36 2E 38 04 29 16 0D 27 16 01 21 21 21 21 21 21 21", 1, 0, "6-alphanumeric postcode with padding; ZXing-C++ test can't handle padding" },
-        /* 20*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AAAAA A840001", 0, 30, "(144) 03 18 10 10 10 10 00 12 07 00 19 07 29 31 26 01 23 2C 2E 07 01 21 21 21 21 21 21 21", 1, 0, "7-alphanumeric with embedded padding truncated; ZXing-C++ test can't handle truncation" },
-        /* 21*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AA\015AAA840001", ZINT_ERROR_INVALID_DATA, 0, "Error 556: Invalid character in postcode in Primary Message", 1, 1, "Alphanumeric postcode with CR" },
-        /* 22*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "A#%-/A840001", 0, 30, "(144) 13 30 1B 1B 39 18 00 12 07 00 3F 1E 25 07 2A 1E 14 3C 28 2D 01 21 21 21 21 21 21 21", 1, 1, "Alphanumeric postcode with non-control Code A chars" },
-        /* 23*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "1A23456", ZINT_ERROR_INVALID_DATA, 0, "Error 552: Non-numeric country code or service class in Primary Message", 1, 1, "Non-numeric country code" },
-        /* 24*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "12345678912345A", ZINT_ERROR_INVALID_DATA, 0, "Error 552: Non-numeric country code or service class in Primary Message", 1, 1, "Non-numeric service class" },
-        /* 25*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 0, 1, "Auto-determine mode 2" },
-        /* 26*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_DATA, 0, "Error 554: Primary Message empty", 1, 1, "Auto-determine mode 2/3 requires primary message" },
-        /* 27*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "A23456123456", 0, 30, "(144) 23 1D 0D 3D 2C 1C 30 1E 20 1C 24 35 30 31 2A 0D 17 14 16 3D 01 21 21 21 21 21 21 21", 1, 1, "Auto-determine mode 3" },
-        /* 28*/ { UNICODE_MODE, -1, -1, 100, { 0, 0, "" }, "A", -1, "123456123456", 0, 30, "(144) 02 10 22 07 00 20 31 1E 20 1C 0E 29 13 1B 0D 26 36 25 3B 22 3B 2A 29 3B 28 1E 30 31", 0, 1, "SCM prefix version" },
-        /* 29*/ { UNICODE_MODE, -1, -1, 101, { 0, 0, "" }, "A", -1, "123456123456", ZINT_ERROR_INVALID_OPTION, 0, "Error 557: Invalid SCM prefix version", 1, 1, "SCM prefix version" },
-        /* 30*/ { UNICODE_MODE, 3, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 03 01 21 21 21 21 21 21 2F 14 23 21 05 24 27 00 24 0C 21 21 21 21 21 21 21 21", 1, 1, "" },
-        /* 31*/ { UNICODE_MODE, 31, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 1F 01 21 21 21 21 21 21 00 2F 0E 09 39 3B 24 1A 21 05 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x1F" },
-        /* 32*/ { UNICODE_MODE, 32, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 20 20 01 21 21 21 21 21 3D 15 0F 30 0D 22 24 35 22 06 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x20" },
-        /* 33*/ { UNICODE_MODE, 1023, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 2F 3F 01 21 21 21 21 21 2E 27 23 1D 35 19 21 04 3A 26 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x3FF" },
-        /* 34*/ { UNICODE_MODE, 1024, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 30 10 00 01 21 21 21 21 11 2F 15 10 1D 29 06 35 14 2B 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x400" },
-        /* 35*/ { UNICODE_MODE, 32767, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 37 3F 3F 01 21 21 21 21 3E 15 12 01 07 30 39 27 04 2B 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x7FFF" },
-        /* 36*/ { UNICODE_MODE, 32768, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 08 00 00 01 21 21 21 10 30 3A 04 26 23 0E 21 3D 0F 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x8000" },
-        /* 37*/ { UNICODE_MODE, 65535, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 0F 3F 3F 01 21 21 21 1C 0E 1D 39 3B 0D 38 25 00 30 21 21 21 21 21 21 21 21", 1, 1, "ECI 0xFFFF" },
-        /* 38*/ { UNICODE_MODE, 65536, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 10 00 00 01 21 21 21 2B 1F 24 06 38 2E 17 1B 10 2F 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x10000" },
-        /* 39*/ { UNICODE_MODE, 131071, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 1F 3F 3F 01 21 21 21 0F 05 09 04 2F 3A 17 09 36 31 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x1FFFF" },
-        /* 40*/ { UNICODE_MODE, 999999, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 3B 34 08 3F 01 21 21 21 26 3B 2B 23 08 17 32 05 26 35 21 21 21 21 21 21 21 21", 1, 1, "Max ECI" },
-        /* 41*/ { UNICODE_MODE, -1, 1, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 550: Invalid MaxiCode Mode", 1, 1, "" },
-        /* 42*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "\015", -1, "", 0, 30, "(144) 04 00 21 21 21 21 21 21 21 21 37 32 10 01 24 1B 10 11 38 0C 21 21 21 21 21 21 21 21", 1, 0, "ZXing-C++ test can't handle LF" },
-        /* 43*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "\001\034\001\035\001\036\001a:b", -1, "", 0, 30, "(144) 04 3E 3E 01 20 01 21 01 22 01 27 0B 35 01 08 0D 16 02 17 1A 3F 01 33 02 21 21 21 21", 1, 1, "" },
-        /* 44*/ { UNICODE_MODE, -1, -1, -1, { 1, 2, "" }, "A", -1, "", 0, 30, "(144) 04 21 01 01 21 21 21 21 21 21 09 0B 26 03 37 0E 25 27 07 1E 21 21 21 21 21 21 21 21", 1, 1, "" },
-        /* 45*/ { UNICODE_MODE, -1, -1, -1, { 0, 2, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 559: Structured Append index out of range (1-2)", 1, 1, "" },
-        /* 46*/ { UNICODE_MODE, -1, -1, -1, { 1, 1, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 558: Structured Append count out of range (2-8)", 1, 1, "" },
-        /* 47*/ { UNICODE_MODE, -1, -1, -1, { 1, 9, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 558: Structured Append count out of range (2-8)", 1, 1, "" },
-        /* 48*/ { UNICODE_MODE, -1, -1, -1, { 3, 2, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 559: Structured Append index out of range (1-2)", 1, 1, "" },
-        /* 49*/ { UNICODE_MODE, -1, -1, -1, { 1, 2, "A" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 549: Structured Append ID not available for MaxiCode", 1, 1, "" },
+        /* 11*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "12345678123456", 0, 30, "(144) 22 13 21 31 0B 00 32 1E 20 1C 04 14 07 30 10 07 08 28 1D 09 01 21 21 21 21 21 21 21", 0, 1, "8-digit postcode; BWIPP requires mode" },
+        /* 12*/ { UNICODE_MODE, -1, 2, -1, { 0, 0, "" }, "A", -1, "12345678123456", 0, 30, "(144) 22 13 21 31 0B 00 32 1E 20 1C 04 14 07 30 10 07 08 28 1D 09 01 21 21 21 21 21 21 21", 1, 1, "8-digit postcode" },
+        /* 13*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_DATA, 0, "Error 551: Invalid length for Primary Message", 1, 1, "" },
+        /* 14*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "A123456", 0, 30, "(144) 03 08 08 08 08 18 30 1E 20 1C 22 35 1C 0F 02 1A 26 04 10 31 01 21 21 21 21 21 21 21", 1, 1, "1-alphanumeric postcode" },
+        /* 15*/ { UNICODE_MODE, -1, 3, -1, { 0, 0, "" }, "A", -1, "1123456", 0, 30, "(144) 03 08 08 08 08 18 3C 1E 20 1C 13 37 07 2C 26 2D 18 29 3F 2C 01 21 21 21 21 21 21 21", 1, 0, "1-digit postcode; ZXing-C++ test can't handle padding" },
+        /* 16*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "A123456", 0, 30, "(144) 03 08 08 08 08 18 30 1E 20 1C 22 35 1C 0F 02 1A 26 04 10 31 01 21 21 21 21 21 21 21", 1, 1, "1-alphanumeric postcode" },
+        /* 17*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDEF123456", 0, 30, "(144) 23 11 01 31 20 10 30 1E 20 1C 3C 1D 22 03 19 15 0F 20 0F 2A 01 21 21 21 21 21 21 21", 1, 1, "6-alphanumeric postcode" },
+        /* 18*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDEFG123456", 0, 30, "(144) 23 11 01 31 20 10 30 1E 20 1C 3C 1D 22 03 19 15 0F 20 0F 2A 01 21 21 21 21 21 21 21", 1, 0, "7-alphanumeric postcode truncated; ZXing-C++ test can't handle truncation" },
+        /* 19*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "ABCDE123456", 0, 30, "(144) 03 18 01 31 20 10 30 1E 20 1C 0F 38 38 1A 39 10 2F 37 22 12 01 21 21 21 21 21 21 21", 1, 1, "5-alphanumeric postcode" },
+        /* 20*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AAAAAA   840001", 0, 30, "(144) 13 10 10 10 10 10 00 12 07 00 17 36 2E 38 04 29 16 0D 27 16 01 21 21 21 21 21 21 21", 1, 0, "6-alphanumeric postcode with padding; ZXing-C++ test can't handle padding" },
+        /* 21*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AAAAA A840001", 0, 30, "(144) 03 18 10 10 10 10 00 12 07 00 19 07 29 31 26 01 23 2C 2E 07 01 21 21 21 21 21 21 21", 1, 0, "7-alphanumeric with embedded padding truncated; ZXing-C++ test can't handle truncation" },
+        /* 22*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "AA\015AAA840001", ZINT_ERROR_INVALID_DATA, 0, "Error 556: Invalid character in postcode in Primary Message", 1, 1, "Alphanumeric postcode with CR" },
+        /* 23*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "A#%-/A840001", 0, 30, "(144) 13 30 1B 1B 39 18 00 12 07 00 3F 1E 25 07 2A 1E 14 3C 28 2D 01 21 21 21 21 21 21 21", 1, 1, "Alphanumeric postcode with non-control Code A chars" },
+        /* 24*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "1A23456", ZINT_ERROR_INVALID_DATA, 0, "Error 552: Non-numeric country code or service class in Primary Message", 1, 1, "Non-numeric country code" },
+        /* 25*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "A", -1, "12345678912345A", ZINT_ERROR_INVALID_DATA, 0, "Error 552: Non-numeric country code or service class in Primary Message", 1, 1, "Non-numeric service class" },
+        /* 26*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "123456789123456", 0, 30, "(144) 12 05 0D 2F 35 11 32 1E 20 1C 0D 1D 3B 12 22 3F 30 14 23 1A 01 21 21 21 21 21 21 21", 0, 1, "Auto-determine mode 2; BWIPP requires mode for mode 2" },
+        /* 27*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_DATA, 0, "Error 554: Primary Message empty", 1, 1, "Auto-determine mode 2/3 requires primary message" },
+        /* 28*/ { UNICODE_MODE, -1, 0, -1, { 0, 0, "" }, "A", -1, "A23456123456", 0, 30, "(144) 23 1D 0D 3D 2C 1C 30 1E 20 1C 24 35 30 31 2A 0D 17 14 16 3D 01 21 21 21 21 21 21 21", 1, 1, "Auto-determine mode 3" },
+        /* 29*/ { UNICODE_MODE, -1, -1, 100, { 0, 0, "" }, "A", -1, "123456123456", 0, 30, "(144) 02 10 22 07 00 20 31 1E 20 1C 0E 29 13 1B 0D 26 36 25 3B 22 3B 2A 29 3B 28 1E 30 31", 0, 1, "SCM prefix version" },
+        /* 30*/ { UNICODE_MODE, -1, -1, 101, { 0, 0, "" }, "A", -1, "123456123456", ZINT_ERROR_INVALID_OPTION, 0, "Error 557: Invalid SCM prefix version", 1, 1, "SCM prefix version" },
+        /* 31*/ { UNICODE_MODE, 3, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 03 01 21 21 21 21 21 21 2F 14 23 21 05 24 27 00 24 0C 21 21 21 21 21 21 21 21", 1, 1, "" },
+        /* 32*/ { UNICODE_MODE, 31, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 1F 01 21 21 21 21 21 21 00 2F 0E 09 39 3B 24 1A 21 05 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x1F" },
+        /* 33*/ { UNICODE_MODE, 32, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 20 20 01 21 21 21 21 21 3D 15 0F 30 0D 22 24 35 22 06 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x20" },
+        /* 34*/ { UNICODE_MODE, 1023, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 2F 3F 01 21 21 21 21 21 2E 27 23 1D 35 19 21 04 3A 26 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x3FF" },
+        /* 35*/ { UNICODE_MODE, 1024, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 30 10 00 01 21 21 21 21 11 2F 15 10 1D 29 06 35 14 2B 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x400" },
+        /* 36*/ { UNICODE_MODE, 32767, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 37 3F 3F 01 21 21 21 21 3E 15 12 01 07 30 39 27 04 2B 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x7FFF" },
+        /* 37*/ { UNICODE_MODE, 32768, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 08 00 00 01 21 21 21 10 30 3A 04 26 23 0E 21 3D 0F 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x8000" },
+        /* 38*/ { UNICODE_MODE, 65535, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 0F 3F 3F 01 21 21 21 1C 0E 1D 39 3B 0D 38 25 00 30 21 21 21 21 21 21 21 21", 1, 1, "ECI 0xFFFF" },
+        /* 39*/ { UNICODE_MODE, 65536, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 10 00 00 01 21 21 21 2B 1F 24 06 38 2E 17 1B 10 2F 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x10000" },
+        /* 40*/ { UNICODE_MODE, 131071, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 38 1F 3F 3F 01 21 21 21 0F 05 09 04 2F 3A 17 09 36 31 21 21 21 21 21 21 21 21", 1, 1, "ECI 0x1FFFF" },
+        /* 41*/ { UNICODE_MODE, 999999, -1, -1, { 0, 0, "" }, "A", -1, "", 0, 30, "(144) 04 1B 3B 34 08 3F 01 21 21 21 26 3B 2B 23 08 17 32 05 26 35 21 21 21 21 21 21 21 21", 1, 1, "Max ECI" },
+        /* 42*/ { UNICODE_MODE, -1, 1, -1, { 0, 0, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 550: Invalid MaxiCode Mode", 1, 1, "" },
+        /* 43*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "\015", -1, "", 0, 30, "(144) 04 00 21 21 21 21 21 21 21 21 37 32 10 01 24 1B 10 11 38 0C 21 21 21 21 21 21 21 21", 1, 0, "ZXing-C++ test can't handle LF" },
+        /* 44*/ { UNICODE_MODE, -1, -1, -1, { 0, 0, "" }, "\001\034\001\035\001\036\001a:b", -1, "", 0, 30, "(144) 04 3E 3E 01 20 01 21 01 22 01 27 0B 35 01 08 0D 16 02 17 1A 3F 01 33 02 21 21 21 21", 1, 1, "" },
+        /* 45*/ { UNICODE_MODE, -1, -1, -1, { 1, 2, "" }, "A", -1, "", 0, 30, "(144) 04 21 01 01 21 21 21 21 21 21 09 0B 26 03 37 0E 25 27 07 1E 21 21 21 21 21 21 21 21", 1, 1, "" },
+        /* 46*/ { UNICODE_MODE, -1, -1, -1, { 0, 2, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 559: Structured Append index out of range (1-2)", 1, 1, "" },
+        /* 47*/ { UNICODE_MODE, -1, -1, -1, { 1, 1, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 558: Structured Append count out of range (2-8)", 1, 1, "" },
+        /* 48*/ { UNICODE_MODE, -1, -1, -1, { 1, 9, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 558: Structured Append count out of range (2-8)", 1, 1, "" },
+        /* 49*/ { UNICODE_MODE, -1, -1, -1, { 3, 2, "" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 559: Structured Append index out of range (1-2)", 1, 1, "" },
+        /* 50*/ { UNICODE_MODE, -1, -1, -1, { 1, 2, "A" }, "A", -1, "", ZINT_ERROR_INVALID_OPTION, 0, "Error 549: Structured Append ID not available for MaxiCode", 1, 1, "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -231,13 +232,13 @@
             assert_zero(strcmp(symbol->errtxt, data[i].expected), "i:%d strcmp(%s, %s) != 0\n", i, symbol->errtxt, data[i].expected);
 
             if (ret < ZINT_ERROR) {
-                if (do_bwipp && testUtilCanBwipp(i, symbol, -1, data[i].option_2, -1, debug)) {
+                if (do_bwipp && testUtilCanBwipp(i, symbol, data[i].option_1, data[i].option_2, -1, debug)) {
                     if (!data[i].bwipp_cmp) {
                         if (debug & ZINT_DEBUG_TEST_PRINT) printf("i:%d %s not BWIPP compatible (%s)\n", i, testUtilBarcodeName(symbol->symbology), data[i].comment);
                     } else {
                         char modules_dump[33 * 33 + 1];
                         assert_notequal(testUtilModulesDump(symbol, modules_dump, sizeof(modules_dump)), -1, "i:%d testUtilModulesDump == -1\n", i);
-                        ret = testUtilBwipp(i, symbol, -1, data[i].option_2, -1, data[i].data, length, symbol->primary, cmp_buf, sizeof(cmp_buf), NULL);
+                        ret = testUtilBwipp(i, symbol, data[i].option_1, data[i].option_2, -1, data[i].data, length, symbol->primary, cmp_buf, sizeof(cmp_buf), NULL);
                         assert_zero(ret, "i:%d %s testUtilBwipp ret %d != 0\n", i, testUtilBarcodeName(symbol->symbology), ret);
 
                         ret = testUtilBwippCmp(symbol, cmp_msg, cmp_buf, modules_dump);
diff -urN zint-2.12.0/backend/tests/test_output.c zint/backend/tests/test_output.c
--- zint-2.12.0/backend/tests/test_output.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_output.c	2023-05-08 14:39:44.940319812 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2021-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2021-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -36,6 +36,172 @@
 #include <direct.h>
 #endif
 
+static void test_check_colour_options(const testCtx *const p_ctx) {
+    struct item {
+        char *fgcolour;
+        char *bgcolour;
+        int ret;
+        char *expected;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { "FFFFFF", "000000", 0, "" },
+        /*  1*/ { "ffffff", "ffffff", 0, "" },
+        /*  2*/ { "77777777", "33333333", 0, "" },
+        /*  3*/ { "FFFFF", "000000", ZINT_ERROR_INVALID_OPTION, "880: Malformed foreground RGB colour (6 or 8 characters only)" },
+        /*  4*/ { "FFFFFFF", "000000", ZINT_ERROR_INVALID_OPTION, "880: Malformed foreground RGB colour (6 or 8 characters only)" },
+        /*  5*/ { "FFFFFG", "000000", ZINT_ERROR_INVALID_OPTION, "881: Malformed foreground RGB colour 'FFFFFG' (hexadecimal only)" },
+        /*  6*/ { "FFFFFF", "000000000", ZINT_ERROR_INVALID_OPTION, "880: Malformed background RGB colour (6 or 8 characters only)" },
+        /*  7*/ { "FFFFFF", "0000000Z", ZINT_ERROR_INVALID_OPTION, "881: Malformed background RGB colour '0000000Z' (hexadecimal only)" },
+        /*  8*/ { "100,100,100,100", "0,1,2,3", 0, "" },
+        /*  9*/ { "100,,100,100", ",1,2,", 0, "" },
+        /* 10*/ { "100,100,100", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "882: Malformed foreground CMYK colour (4 decimal numbers, comma-separated)" },
+        /* 11*/ { "100,100,99,1001", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "883: Malformed foreground CMYK colour (3 digit maximum per number)" },
+        /* 12*/ { "101,100,100,100", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "884: Malformed foreground CMYK colour C (decimal 0-100 only)" },
+        /* 13*/ { "100,101,100,100", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "885: Malformed foreground CMYK colour M (decimal 0-100 only)" },
+        /* 14*/ { "100,100,101,100", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "886: Malformed foreground CMYK colour Y (decimal 0-100 only)" },
+        /* 15*/ { "100,100,100,101", "0,1,2,3", ZINT_ERROR_INVALID_OPTION, "887: Malformed foreground CMYK colour K (decimal 0-100 only)" },
+        /* 16*/ { "100,100,100,100", "0,1,", ZINT_ERROR_INVALID_OPTION, "882: Malformed background CMYK colour (4 decimal numbers, comma-separated)" },
+        /* 17*/ { "100,100,100,100", "0,0123,3,4", ZINT_ERROR_INVALID_OPTION, "883: Malformed background CMYK colour (3 digit maximum per number)" },
+        /* 18*/ { "100,100,100,100", "0,1,2,101", ZINT_ERROR_INVALID_OPTION, "887: Malformed background CMYK colour K (decimal 0-100 only)" },
+        /* 19*/ { "100,100,100,100", "0,1,2,3,", ZINT_ERROR_INVALID_OPTION, "882: Malformed background CMYK colour (4 decimal numbers, comma-separated)" },
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, ret;
+    struct zint_symbol symbol;
+
+    testStart("test_check_colour_options");
+
+    for (i = 0; i < data_size; i++) {
+
+        if (testContinue(p_ctx, i)) continue;
+
+        strcpy(symbol.fgcolour, data[i].fgcolour);
+        strcpy(symbol.bgcolour, data[i].bgcolour);
+        symbol.errtxt[0] = '\0';
+
+        ret = out_check_colour_options(&symbol);
+        assert_equal(ret, data[i].ret, "i:%d ret %d != %d (%s)\n", i, ret, data[i].ret, symbol.errtxt);
+        assert_zero(strcmp(symbol.errtxt, data[i].expected), "i:%d symbol.errtxt (%s) != expected (%s)\n", i, symbol.errtxt, data[i].expected);
+    }
+
+    testFinish();
+}
+
+static void test_colour_get_rgb(const testCtx *const p_ctx) {
+    struct item {
+        char *colour;
+        int ret;
+        unsigned char red;
+        unsigned char green;
+        unsigned char blue;
+        unsigned char alpha;
+        char *expected_cmyk;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { "FFFFFF", 0, 0xFF, 0xFF, 0xFF, 0xFF, "0,0,0,0" },
+        /*  1*/ { "000000", 0, 0x00, 0x00, 0x00, 0xFF, "0,0,0,100" },
+        /*  2*/ { "FEDCBA", 0, 0xFE, 0xDC, 0xBA, 0xFF, "0,13,27,0" },
+        /*  3*/ { "EEDD9900", 1, 0xEE, 0xDD, 0x99, 0x00, "0,7,36,7" },
+        /*  4*/ { "98765432", 1, 0x98, 0x76, 0x54, 0x32, "0,22,45,40" },
+        /*  5*/ { "147AD0", 0, 0x14, 0x7A, 0xD0, 0xFF, "90,41,0,18" },
+        /*  6*/ { "FC9630", 0, 0xFC, 0x96, 0x30, 0xFF, "0,40,81,1" },
+        /*  7*/ { "112233", 0, 0x11, 0x22, 0x33, 0xFF, "67,33,0,80" },
+        /*  8*/ { "CCDDEE", 0, 0xCC, 0xDD, 0xEE, 0xFF, "14,7,0,7" },
+        /*  9*/ { "0,0,0,0", 0, 0xFF, 0xFF, 0xFF, 0xFF, "0,0,0,0" },
+        /* 10*/ { "80,30,60,0", 0, 0x33, 0xB3, 0x66, 0xFF, "72,0,43,30" },
+        /* 11*/ { "50,50,50,50", 0, 0x40, 0x40, 0x40, 0xFF, "0,0,0,75" },
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, ret;
+
+    testStart("test_colour_get_rgb");
+
+    for (i = 0; i < data_size; i++) {
+        unsigned char red, green, blue, alpha, rgb_alpha;
+        int cyan, magenta, yellow, black;
+        int have_alpha;
+        char rgb[9];
+        char cmyk[16];
+
+        if (testContinue(p_ctx, i)) continue;
+
+        ret = out_colour_get_rgb(data[i].colour, &red, &green, &blue, &alpha);
+        assert_equal(ret, data[i].ret, "i:%d ret %d != %d\n", i, ret, data[i].ret);
+        assert_equal(red, data[i].red, "i:%d red 0x%02X (%d) != 0x%02X (%d) (green 0x%02X, blue 0x%02X)\n", i, red, red, data[i].red, data[i].red, green, blue);
+        assert_equal(green, data[i].green, "i:%d green %d (0x%02X) != %d (0x%02X)\n", i, green, green, data[i].green, data[i].green);
+        assert_equal(blue, data[i].blue, "i:%d blue %d (0x%02X) != %d (0x%02X)\n", i, blue, blue, data[i].blue, data[i].blue);
+        assert_equal(alpha, data[i].alpha, "i:%d alpha %d (0x%02X) != %d (0x%02X)\n", i, alpha, alpha, data[i].alpha, data[i].alpha);
+
+        have_alpha = ret == 1;
+        if (have_alpha) {
+            sprintf(rgb, "%02X%02X%02X%02X", red, green, blue, alpha);
+        } else {
+            sprintf(rgb, "%02X%02X%02X", red, green, blue);
+        }
+        ret = out_colour_get_cmyk(rgb, &cyan, &magenta, &yellow, &black, &rgb_alpha);
+        assert_equal(ret, 1 + have_alpha, "i:%d out_colour_get_cmyk(%s) ret %d != %d\n", i, rgb, ret, 1 + have_alpha);
+        assert_equal(rgb_alpha, alpha, "i:%d rgb_alpha %d (0x%02X) != %d (0x%02X)\n", i, rgb_alpha, rgb_alpha, alpha, alpha);
+
+        sprintf(cmyk, "%d,%d,%d,%d", cyan, magenta, yellow, black);
+        assert_zero(strcmp(cmyk, data[i].expected_cmyk), "i:%d strcmp(%s, %s) != 0\n", i, cmyk, data[i].expected_cmyk);
+    }
+
+    testFinish();
+}
+
+static void test_colour_get_cmyk(const testCtx *const p_ctx) {
+    struct item {
+        char *colour;
+        int ret;
+        int cyan;
+        int magenta;
+        int yellow;
+        int black;
+        unsigned char alpha;
+        char *expected_rgb;
+        int ret_rgb;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { "80,30,60,0", 0, 80, 30, 60, 0, 0xFF, "33B366FF", 0 },
+        /*  1*/ { "50,50,50,50", 0, 50, 50, 50, 50, 0xFF, "404040FF", 0 },
+        /*  2*/ { "0,0,0,100", 0, 0, 0, 0, 100, 0xFF, "000000FF", 0 },
+        /*  3*/ { "71,0,40,44", 0, 71, 0, 40, 44, 0xFF, "298F56FF", 0 },
+        /*  4*/ { "123456", 1, 79, 40, 0, 44, 0xFF, "123456FF", 0 },
+        /*  5*/ { "12345678", 2, 79, 40, 0, 44, 0x78, "12345678", 1 },
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, ret;
+
+    testStart("test_colour_get_cmyk");
+
+    for (i = 0; i < data_size; i++) {
+        int cyan, magenta, yellow, black;
+        unsigned char red, green, blue, alpha, rgb_alpha;
+        char rgb[9];
+
+        if (testContinue(p_ctx, i)) continue;
+
+        ret = out_colour_get_cmyk(data[i].colour, &cyan, &magenta, &yellow, &black, &alpha);
+        assert_equal(ret, data[i].ret, "i:%d ret %d != %d\n", i, ret, data[i].ret);
+        assert_equal(cyan, data[i].cyan, "i:%d cyan %d != %d (magenta %d, yellow %d, black %d)\n", i, cyan, data[i].cyan, magenta, yellow, black);
+        assert_equal(magenta, data[i].magenta, "i:%d magenta %d != %d\n", i, magenta, data[i].magenta);
+        assert_equal(yellow, data[i].yellow, "i:%d yellow %d != %d\n", i, yellow, data[i].yellow);
+        assert_equal(alpha, data[i].alpha, "i:%d alpha %d != %d\n", i, alpha, data[i].alpha);
+
+        ret = out_colour_get_rgb(data[i].colour, &red, &green, &blue, &rgb_alpha);
+        assert_equal(ret, data[i].ret_rgb, "i:%d out_colour_get_rgb(%s) ret %d != %d\n", i, rgb, ret, data[i].ret_rgb);
+        assert_equal(rgb_alpha, alpha, "i:%d rgb_alpha %d != %d\n", i, rgb_alpha, alpha);
+
+        sprintf(rgb, "%02X%02X%02X%02X", red, green, blue, rgb_alpha);
+        assert_zero(strcmp(rgb, data[i].expected_rgb), "i:%d strcmp(%s, %s) != 0\n", i, rgb, data[i].expected_rgb);
+    }
+
+    testFinish();
+}
+
 INTERNAL int out_quiet_zones_test(const struct zint_symbol *symbol, const int hide_text,
                             float *left, float *right, float *top, float *bottom);
 
@@ -161,6 +327,9 @@
 int main(int argc, char *argv[]) {
 
     testFunction funcs[] = { /* name, func */
+        { "test_check_colour_options", test_check_colour_options },
+        { "test_colour_get_rgb", test_colour_get_rgb },
+        { "test_colour_get_cmyk", test_colour_get_cmyk },
         { "test_quiet_zones", test_quiet_zones },
         { "test_fopen", test_fopen },
     };
diff -urN zint-2.12.0/backend/tests/test_pcx.c zint/backend/tests/test_pcx.c
--- zint-2.12.0/backend/tests/test_pcx.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_pcx.c	2023-05-08 14:39:44.940319812 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -54,6 +54,7 @@
         /*  1*/ { BARCODE_CODABLOCKF, -1, -1, -1, -1, -1, 20, "FFFFFF", "000000", 0, "1234567890123456789012345678901234567890", "codeblockf_reverse.pcx" },
         /*  2*/ { BARCODE_QRCODE, -1, -1, -1, -1, 2, 1, "", "D2E3F4", 0, "1234567890", "qr_bg.pcx" },
         /*  3*/ { BARCODE_ULTRA, 1, BARCODE_BOX, 1, 1, -1, -1, "FF0000", "0000FF", 0, "ULTRACODE_123456789!", "ultra_fg_bg_hvwsp1_box1.pcx" },
+        /*  4*/ { BARCODE_CODE11, -1, -1, -1, -1, -1, -1, "12345678", "FEDCBA98", 0, "123", "code11_fgbgtrans.pcx" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_pdf417.c zint/backend/tests/test_pdf417.c
--- zint-2.12.0/backend/tests/test_pdf417.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_pdf417.c	2023-05-08 14:39:44.943319830 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -424,7 +424,7 @@
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
     struct zint_symbol *symbol;
-    int last_fast_num_cwds;
+    int last_fast_num_cwds = 0; /* Keep clang-tidy happy */
 
     char escaped[1024];
     char cmp_buf[32768];
@@ -3925,7 +3925,7 @@
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
     struct zint_symbol *symbol;
-    int last_fast_num_cwds;
+    int last_fast_num_cwds = 0; /* Keep clang-tidy happy */
 
     char escaped[1024];
     char cmp_buf[32768];
@@ -4663,7 +4663,7 @@
     int data_size = ARRAY_SIZE(data);
     int i, j, seg_count, ret;
     struct zint_symbol *symbol;
-    int last_fast_num_cwds;
+    int last_fast_num_cwds = 0; /* Keep clang-tidy happy */
 
     char escaped[1024];
     char cmp_buf[32768];
diff -urN zint-2.12.0/backend/tests/test_png.c zint/backend/tests/test_png.c
--- zint-2.12.0/backend/tests/test_png.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_png.c	2023-05-08 14:39:44.944319835 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -136,6 +136,7 @@
         struct zint_structapp structapp;
         char *fgcolour;
         char *bgcolour;
+        float text_gap;
         char *data;
         char *composite;
         int ret;
@@ -143,65 +144,66 @@
         char *comment;
     };
     struct item data[] = {
-        /*  0*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "Ãgjpqy", "", 0, "code128_egrave_bold.png", "" },
-        /*  1*/ { BARCODE_CODE128, UNICODE_MODE, 3, BOLD_TEXT | BARCODE_BOX, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "Ãgjpqy", "", 0, "code128_egrave_bold_box3.png", "" },
-        /*  2*/ { BARCODE_CODE128, UNICODE_MODE, 2, BOLD_TEXT | BARCODE_BOX, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp2_box2.png", "" },
-        /*  3*/ { BARCODE_GS1_128_CC, -1, -1, -1, -1, -1, -1, 3, -1, 0, 0, { 0, 0, "" }, "", "", "[00]030123456789012340", "[02]13012345678909[37]24[10]1234567ABCDEFG", 0, "gs1_128_cc_fig12.png", "" },
-        /*  4*/ { BARCODE_CODABLOCKF, -1, 3, -1, -1, -1, -1, 3, -1, 0, 0, { 0, 0, "" }, "", "", "AAAAAAAAA", "", 0, "codablockf_3rows.png", "" },
-        /*  5*/ { BARCODE_CODABLOCKF, -1, -1, -1, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "AAAAAAAAA", "", 0, "codablockf_hvwsp2.png", "" },
-        /*  6*/ { BARCODE_CODABLOCKF, -1, 2, BARCODE_BOX, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "AAAAAAAAA", "", 0, "codablockf_hvwsp2_box2.png", "" },
-        /*  7*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "9771384524017+12", "", 0, "ean13_2addon_ggs_5.2.2.5.1-2.png", "" },
-        /*  8*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "9780877799306+54321", "", 0, "ean13_5addon_ggs_5.2.2.5.2-2.png", "" },
-        /*  9*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", "123456789012+12", "[91]123456789012345678901", 0, "ean13_cc_2addon_cca_4x4.png", "" },
-        /* 10*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4.png", "" },
-        /* 11*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4_notext.png", "" },
-        /* 12*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "012345678905+24", "", 0, "upca_2addon_ggs_5.2.6.6-5.png", "" },
-        /* 13*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "614141234417+12345", "", 0, "upca_5addon.png", "" },
-        /* 14*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, 0, -1, -1, 0, 0, { 0, 0, "" }, "", "", "614141234417+12345", "", 0, "upca_5addon_notext.png", "" },
-        /* 15*/ { BARCODE_UPCA, -1, 3, BARCODE_BIND, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "614141234417+12345", "", 0, "upca_5addon_bind3.png", "" },
-        /* 16*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", "12345678901+12", "[91]123456789", 0, "upca_cc_2addon_cca_3x4.png", "" },
-        /* 17*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4.png", "" },
-        /* 18*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_notext.png", "" },
-        /* 19*/ { BARCODE_UPCA_CC, -1, 3, BARCODE_BIND, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_bind3.png", "" },
-        /* 20*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "1234567+12", "", 0, "upce_2addon.png", "" },
-        /* 21*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "1234567+12345", "", 0, "upce_5addon.png", "" },
-        /* 22*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "1234567+12345", "", 0, "upce_5addon_small.png", "" },
-        /* 23*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2.png", "" },
-        /* 24*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2.png", "" },
-        /* 25*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2_notext.png", "" },
-        /* 26*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "1234567+12", "", 0, "ean8_2addon.png", "" },
-        /* 27*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "1234567+12345", "", 0, "ean8_5addon.png", "" },
-        /* 28*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "9876543+65", "[91]1234567", 0, "ean8_cc_2addon_cca_4x3.png", "" },
-        /* 29*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "9876543+74083", "[91]123456789012345678", 0, "ean8_cc_5addon_ccb_8x3.png", "" },
-        /* 30*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "12345", "", 0, "ean5.png", "" },
-        /* 31*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "12", "", 0, "ean2.png", "" },
-        /* 32*/ { BARCODE_CODE39, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "123", "", 0, "code39_small.png", "" },
-        /* 33*/ { BARCODE_POSTNET, -1, -1, -1, -1, -1, -1, -1, -1, 0, 3.5, { 0, 0, "" }, "", "", "12345", "", 0, "postnet_zip.png", "300 dpi, using 1/43in X, 300 / 43 / 2 = ~3.5 scale" },
-        /* 34*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "CFCECDCC", "12345", "", 0, "pdf417_bgalpha.png", "" },
-        /* 35*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "30313233", "", "12345", "", 0, "pdf417_fgalpha.png", "" },
-        /* 36*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "20212244", "CFCECDCC", "12345", "", 0, "pdf417_bgfgalpha.png", "" },
-        /* 37*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "FF000033", "12345", "", 0, "ultra_bgfgalpha.png", "" },
-        /* 38*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "FF000033", "12345", "", 0, "ultra_bgalpha.png", "" },
-        /* 39*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "FF0000", "12345", "", 0, "ultra_fgalpha.png", "" },
-        /* 40*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "", "12345", "", 0, "ultra_fgalpha_nobg.png", "" },
-        /* 41*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "12345", "", 0, "ultra_hvwsp1_box1.png", "" },
-        /* 42*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "00FF007F", "BABDB6", "12345", "", 0, "ultra_fgalpha_hvwsp1_box1.png", "" },
-        /* 43*/ { BARCODE_ULTRA, -1, 1, BARCODE_BIND_TOP, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "00FF007F", "BABDB6", "12345", "", 0, "ultra_fgalpha_hvwsp1_bindtop1.png", "" },
-        /* 44*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5, { 0, 0, "" }, "", "", "1", "", 0, "ultra_odd.png", "" },
-        /* 45*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5, { 0, 0, "" }, "", "", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_0.5.png", "6 dpmm, 150 dpi" },
-        /* 46*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BOX, 3, -1, -1, -1, -1, 0, 0.7, { 0, 0, "" }, "", "", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_0.7_wsp3_box1.png", "8 dpmm, 200 dpi" },
-        /* 47*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 1.4, { 0, 0, "" }, "1111117F", "EEEEEEEE", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_1.4_bgfgalpha.png", "16 dpmm, 400 dpi" },
-        /* 48*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 2.1, { 0, 0, "" }, "", "", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_2.1.png", "24 dpmm, 600 dpi" },
-        /* 49*/ { BARCODE_MAXICODE, -1, 2, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_hvwsp1_box2.png", "" },
-        /* 50*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BIND, -1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_vwsp1_bind1.png", "" },
-        /* 51*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, -1, -1, -1, -1, -1, 0, 2.0f, { 0, 0, "" }, "", "", "1234", "", 0, "datamatrix_2.0_bind1_dotty.png", "" },
-        /* 52*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, 1, 1, -1, -1, -1, 0, 2.0f, { 0, 0, "" }, "", "", "1234", "", 0, "datamatrix_2.0_hvwsp1_bind1_dotty.png", "" },
-        /* 53*/ { BARCODE_DBAR_LTD, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "12345678909", "", 0, "dbar_ltd.png", "" },
-        /* 54*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 5.0, 0, { 0, 0, "" }, "", "", "Your Data Here!", "", ZINT_WARN_NONCOMPLIANT, "pdf417_height5.png", "" },
-        /* 55*/ { BARCODE_USPS_IMAIL, -1, -1, -1, -1, -1, -1, -1, -1, 7.75, 0, { 0, 0, "" }, "", "", "12345678901234567890", "", 0, "imail_height7.75.png", "" },
-        /* 56*/ { BARCODE_AZTEC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 4, 7, "Z1.txt" }, "", "", "3456", "", 0, "aztec_z1_seq4of7.png", "" },
-        /* 57*/ { BARCODE_PDF417, -1, -1, BARCODE_NO_QUIET_ZONES, -1, -1, -1, 5, 8, 16, 1.5, { 0, 0, "" }, "", "", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBB", "", ZINT_WARN_NONCOMPLIANT, "pdf417_#204.png", "Ticket #204 Blank line in PDF417" },
-        /* 58*/ { BARCODE_DPD, -1, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", "008182709980000020028101276", "", 0, "dpd_compliant.png", "Now with bind top 3X default" },
+        /*  0*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold.png", "" },
+        /*  1*/ { BARCODE_CODE128, UNICODE_MODE, 3, BOLD_TEXT | BARCODE_BOX, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_box3.png", "" },
+        /*  2*/ { BARCODE_CODE128, UNICODE_MODE, 2, BOLD_TEXT | BARCODE_BOX, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp2_box2.png", "" },
+        /*  3*/ { BARCODE_GS1_128_CC, -1, -1, -1, -1, -1, -1, 3, -1, 0, 0, { 0, 0, "" }, "", "", 0, "[00]030123456789012340", "[02]13012345678909[37]24[10]1234567ABCDEFG", 0, "gs1_128_cc_fig12.png", "" },
+        /*  4*/ { BARCODE_CODABLOCKF, -1, 3, -1, -1, -1, -1, 3, -1, 0, 0, { 0, 0, "" }, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_3rows.png", "" },
+        /*  5*/ { BARCODE_CODABLOCKF, -1, -1, -1, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2.png", "" },
+        /*  6*/ { BARCODE_CODABLOCKF, -1, 2, BARCODE_BOX, 2, 2, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2_box2.png", "" },
+        /*  7*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "9771384524017+12", "", 0, "ean13_2addon_ggs_5.2.2.5.1-2.png", "" },
+        /*  8*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "9780877799306+54321", "", 0, "ean13_5addon_ggs_5.2.2.5.2-2.png", "" },
+        /*  9*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "123456789012+12", "[91]123456789012345678901", 0, "ean13_cc_2addon_cca_4x4.png", "" },
+        /* 10*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4.png", "" },
+        /* 11*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4_notext.png", "" },
+        /* 12*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "012345678905+24", "", 0, "upca_2addon_ggs_5.2.6.6-5.png", "" },
+        /* 13*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "614141234417+12345", "", 0, "upca_5addon.png", "" },
+        /* 14*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, 0, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_notext.png", "" },
+        /* 15*/ { BARCODE_UPCA, -1, 3, BARCODE_BIND, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_bind3.png", "" },
+        /* 16*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345678901+12", "[91]123456789", 0, "upca_cc_2addon_cca_3x4.png", "" },
+        /* 17*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4.png", "" },
+        /* 18*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_notext.png", "" },
+        /* 19*/ { BARCODE_UPCA_CC, -1, 3, BARCODE_BIND, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_bind3.png", "" },
+        /* 20*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1234567+12", "", 0, "upce_2addon.png", "" },
+        /* 21*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1234567+12345", "", 0, "upce_5addon.png", "" },
+        /* 22*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1234567+12345", "", 0, "upce_5addon_small.png", "" },
+        /* 23*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2.png", "" },
+        /* 24*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2.png", "" },
+        /* 25*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, 0, 2, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2_notext.png", "" },
+        /* 26*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1234567+12", "", 0, "ean8_2addon.png", "" },
+        /* 27*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "1234567+12345", "", 0, "ean8_5addon.png", "" },
+        /* 28*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "9876543+65", "[91]1234567", 0, "ean8_cc_2addon_cca_4x3.png", "" },
+        /* 29*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "9876543+74083", "[91]123456789012345678", 0, "ean8_cc_5addon_ccb_8x3.png", "" },
+        /* 30*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345", "", 0, "ean5.png", "" },
+        /* 31*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12", "", 0, "ean2.png", "" },
+        /* 32*/ { BARCODE_CODE39, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "123", "", 0, "code39_small.png", "" },
+        /* 33*/ { BARCODE_POSTNET, -1, -1, -1, -1, -1, -1, -1, -1, 0, 3.5, { 0, 0, "" }, "", "", 0, "12345", "", 0, "postnet_zip.png", "300 dpi, using 1/43in X, 300 / 43 / 2 = ~3.5 scale" },
+        /* 34*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "CFCECDCC", 0, "12345", "", 0, "pdf417_bgalpha.png", "" },
+        /* 35*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "30313233", "", 0, "12345", "", 0, "pdf417_fgalpha.png", "" },
+        /* 36*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "20212244", "CFCECDCC", 0, "12345", "", 0, "pdf417_bgfgalpha.png", "" },
+        /* 37*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "FF000033", 0, "12345", "", 0, "ultra_bgfgalpha.png", "" },
+        /* 38*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "FF000033", 0, "12345", "", 0, "ultra_bgalpha.png", "" },
+        /* 39*/ { BARCODE_ULTRA, -1, -1, -1, 2, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "FF0000", 0, "12345", "", 0, "ultra_fgalpha.png", "" },
+        /* 40*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "0000007F", "", 0, "12345", "", 0, "ultra_fgalpha_nobg.png", "" },
+        /* 41*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345", "", 0, "ultra_hvwsp1_box1.png", "" },
+        /* 42*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "00FF007F", "BABDB6", 0, "12345", "", 0, "ultra_fgalpha_hvwsp1_box1.png", "" },
+        /* 43*/ { BARCODE_ULTRA, -1, 1, BARCODE_BIND_TOP, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "00FF007F", "BABDB6", 0, "12345", "", 0, "ultra_fgalpha_hvwsp1_bindtop1.png", "" },
+        /* 44*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5, { 0, 0, "" }, "", "", 0, "1", "", 0, "ultra_odd.png", "" },
+        /* 45*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5, { 0, 0, "" }, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_0.5.png", "6 dpmm, 150 dpi" },
+        /* 46*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BOX, 3, -1, -1, -1, -1, 0, 0.7, { 0, 0, "" }, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_0.7_wsp3_box1.png", "8 dpmm, 200 dpi" },
+        /* 47*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 1.4, { 0, 0, "" }, "1111117F", "EEEEEEEE", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_1.4_bgfgalpha.png", "16 dpmm, 400 dpi" },
+        /* 48*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, 0, 2.1, { 0, 0, "" }, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_2.1.png", "24 dpmm, 600 dpi" },
+        /* 49*/ { BARCODE_MAXICODE, -1, 2, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_hvwsp1_box2.png", "" },
+        /* 50*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BIND, -1, 1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_vwsp1_bind1.png", "" },
+        /* 51*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, -1, -1, -1, -1, -1, 0, 2.0f, { 0, 0, "" }, "", "", 0, "1234", "", 0, "datamatrix_2.0_bind1_dotty.png", "" },
+        /* 52*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, 1, 1, -1, -1, -1, 0, 2.0f, { 0, 0, "" }, "", "", 0, "1234", "", 0, "datamatrix_2.0_hvwsp1_bind1_dotty.png", "" },
+        /* 53*/ { BARCODE_DBAR_LTD, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "12345678909", "", 0, "dbar_ltd.png", "" },
+        /* 54*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, 5.0, 0, { 0, 0, "" }, "", "", 0, "Your Data Here!", "", ZINT_WARN_NONCOMPLIANT, "pdf417_height5.png", "" },
+        /* 55*/ { BARCODE_USPS_IMAIL, -1, -1, -1, -1, -1, -1, -1, -1, 7.75, 0, { 0, 0, "" }, "", "", 0, "12345678901234567890", "", 0, "imail_height7.75.png", "" },
+        /* 56*/ { BARCODE_AZTEC, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, { 4, 7, "Z1.txt" }, "", "", 0, "3456", "", 0, "aztec_z1_seq4of7.png", "" },
+        /* 57*/ { BARCODE_PDF417, -1, -1, BARCODE_NO_QUIET_ZONES, -1, -1, -1, 5, 8, 16, 1.5, { 0, 0, "" }, "", "", 0, "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBB", "", ZINT_WARN_NONCOMPLIANT, "pdf417_#204.png", "Ticket #204 Blank line in PDF417" },
+        /* 58*/ { BARCODE_DPD, -1, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "", "", 0, "008182709980000020028101276", "", 0, "dpd_compliant.png", "Now with bind top 3X default" },
+        /* 59*/ { BARCODE_CHANNEL, -1, -1, CMYK_COLOUR | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, 0, 0, { 0, 0, "" }, "100,85,0,20", "FFFFFF00", 0, "123", "", 0, "channel_cmyk_nobg.png", "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -263,6 +265,8 @@
         if (*data[i].bgcolour) {
             strcpy(symbol->bgcolour, data[i].bgcolour);
         }
+        symbol->text_gap = data[i].text_gap;
+
         if (strlen(data[i].composite)) {
             text = data[i].composite;
             strcpy(symbol->primary, data[i].data);
diff -urN zint-2.12.0/backend/tests/test_postal.c zint/backend/tests/test_postal.c
--- zint-2.12.0/backend/tests/test_postal.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_postal.c	2023-05-08 14:39:44.944319835 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -74,8 +74,8 @@
         /* 23*/ { BARCODE_PLANET, "1", 39, ZINT_ERROR_TOO_LONG, -1, -1 },
         /* 24*/ { BARCODE_KIX, "1", 18, 0, 3, 143 },
         /* 25*/ { BARCODE_KIX, "1", 19, ZINT_ERROR_TOO_LONG, -1, -1 },
-        /* 26*/ { BARCODE_DAFT, "D", 100, 0, 3, 199 },
-        /* 27*/ { BARCODE_DAFT, "D", 101, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /* 26*/ { BARCODE_DAFT, "D", 250, 0, 3, 499 },
+        /* 27*/ { BARCODE_DAFT, "D", 251, ZINT_ERROR_TOO_LONG, -1, -1 },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_ps.c zint/backend/tests/test_ps.c
--- zint-2.12.0/backend/tests/test_ps.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_ps.c	2023-05-08 14:39:44.944319835 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -57,40 +57,41 @@
         /*  1*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, -1, -1, -1, -1, 0, 0, "", "", 90, "Ãgjpqy", "code128_egrave_bold_rotate_90.eps" },
         /*  2*/ { BARCODE_CODE39, -1, -1, -1, -1, -1, -1, -1, 0, 0, "147AD0", "FC9630", 0, "123", "code39_fg_bg.eps" },
         /*  3*/ { BARCODE_CODE39, -1, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, 0, "147AD0EE", "FC9630", 0, "123", "code39_fgalpha_bg_cmyk.eps" },
-        /*  4*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, 0, 0, "147AD0", "FC9630", 0, "123", "ultra_fg_bg.eps" },
-        /*  5*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 2, -1, -1, -1, 0, 0, "0000FF", "FF0000", 0, "123", "ultra_fg_bg_box.eps" },
-        /*  6*/ { BARCODE_ULTRA, -1, 2, BARCODE_BOX | CMYK_COLOUR, 1, 1, -1, -1, 0, 0, "0000FF", "FF0000", 0, "123", "ultra_fg_bg_box_cmyk.eps" },
-        /*  7*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "9771384524017+12", "ean13_2addon_ggs_5.2.2.5.1-2.eps" },
-        /*  8*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "012345678905+24", "upca_2addon_ggs_5.2.6.6-5.eps" },
-        /*  9*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "0123456+12345", "upce_5addon.eps" },
-        /* 10*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT | BOLD_TEXT, -1, -1, -1, -1, 0, 0, "", "", 0, "0123456+12345", "upce_5addon_small_bold.eps" },
-        /* 11*/ { BARCODE_CODE128, UNICODE_MODE, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "A\\B)Ã§(D", "code128_escape_latin1.eps" },
-        /* 12*/ { BARCODE_DBAR_LTD, -1, -1, BOLD_TEXT, -1, -1, -1, -1, 0, 0, "", "", 0, "1501234567890", "dbar_ltd_24724_fig7_bold.eps" },
-        /* 13*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0.1, 0, "", "", 0, "12", "dotcode_0.1.eps" },
-        /* 14*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0.08, 0, "", "", 0, "12", "dotcode_0.1.eps" },
-        /* 15*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "12", "dotcode_1.0.eps" },
-        /* 16*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0.1, "", "", 0, "12", "dotcode_1.0_ds0.1.eps" },
-        /* 17*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 1.1, "", "", 0, "12", "dotcode_1.0_ds1.1.eps" },
-        /* 18*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 0, "", "", 0, "12", "dotcode_1.5.eps" },
-        /* 19*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 0.4, "", "", 0, "12", "dotcode_1.5_ds0.4.eps" },
-        /* 20*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 1.1, "", "", 0, "12", "dotcode_1.5_ds1.1.eps" },
-        /* 21*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 2.1, "", "", 0, "12", "dotcode_1.5_ds2.1.eps" },
-        /* 22*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 0, "", "", 0, "12", "dotcode_2.0.eps" },
-        /* 23*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 0.9, "", "", 0, "12", "dotcode_2.0_ds0.9.eps" },
-        /* 24*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 1.1, "", "", 0, "12", "dotcode_2.0_ds1.1.eps" },
-        /* 25*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 0, "", "", 0, "12", "dotcode_3.0.eps" },
-        /* 26*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 0.4, "", "", 0, "12", "dotcode_3.0_ds0.4.eps" },
-        /* 27*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 1.1, "", "", 0, "12", "dotcode_3.0_ds1.1.eps" },
-        /* 28*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 0, "", "", 0, "12", "dotcode_3.5.eps" },
-        /* 29*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 0.4, "", "", 0, "12", "dotcode_3.5_ds0.4.eps" },
-        /* 30*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 1.1, "", "", 0, "12", "dotcode_3.5_ds1.1.eps" },
-        /* 31*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 0, "", "", 0, "12", "dotcode_5.0.eps" },
-        /* 32*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 0.2, "", "", 0, "12", "dotcode_5.0_ds0.2.eps" },
-        /* 33*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 1.1, "", "", 0, "12", "dotcode_5.0_ds1.1.eps" },
-        /* 34*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 1.7, "", "", 0, "12", "dotcode_5.0_ds1.7.eps" },
-        /* 35*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "FF0000", "0000FF00", 0, "12", "dotcode_no_bg.eps" },
-        /* 36*/ { BARCODE_MAXICODE, -1, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, 0, "", "", 270, "12", "maxicode_rotate_270_cmyk.eps" },
-        /* 37*/ { BARCODE_MAXICODE, -1, -1, -1, 3, -1, -1, -1, 0, 0, "", "0000FF00", 180, "12", "maxicode_no_bg_hwsp3_rotate_180.eps" },
+        /*  4*/ { BARCODE_CODE39, -1, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, 0, "90,40,0,9", "FC963000", 0, "123", "code39_nobg_cmyk.eps" },
+        /*  5*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, 0, 0, "147AD0", "FC9630", 0, "123", "ultra_fg_bg.eps" },
+        /*  6*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 2, -1, -1, -1, 0, 0, "0000FF", "FF0000", 0, "123", "ultra_fg_bg_box.eps" },
+        /*  7*/ { BARCODE_ULTRA, -1, 2, BARCODE_BOX | CMYK_COLOUR, 1, 1, -1, -1, 0, 0, "0000FF", "FF0000", 0, "123", "ultra_fg_bg_box_cmyk.eps" },
+        /*  8*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "9771384524017+12", "ean13_2addon_ggs_5.2.2.5.1-2.eps" },
+        /*  9*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "012345678905+24", "upca_2addon_ggs_5.2.6.6-5.eps" },
+        /* 10*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "0123456+12345", "upce_5addon.eps" },
+        /* 11*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT | BOLD_TEXT, -1, -1, -1, -1, 0, 0, "", "", 0, "0123456+12345", "upce_5addon_small_bold.eps" },
+        /* 12*/ { BARCODE_CODE128, UNICODE_MODE, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "A\\B)Ã§(D", "code128_escape_latin1.eps" },
+        /* 13*/ { BARCODE_DBAR_LTD, -1, -1, BOLD_TEXT, -1, -1, -1, -1, 0, 0, "", "", 0, "1501234567890", "dbar_ltd_24724_fig7_bold.eps" },
+        /* 14*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0.1, 0, "", "", 0, "12", "dotcode_0.1.eps" },
+        /* 15*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0.08, 0, "", "", 0, "12", "dotcode_0.1.eps" },
+        /* 16*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "", "", 0, "12", "dotcode_1.0.eps" },
+        /* 17*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0.1, "", "", 0, "12", "dotcode_1.0_ds0.1.eps" },
+        /* 18*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 1.1, "", "", 0, "12", "dotcode_1.0_ds1.1.eps" },
+        /* 19*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 0, "", "", 0, "12", "dotcode_1.5.eps" },
+        /* 20*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 0.4, "", "", 0, "12", "dotcode_1.5_ds0.4.eps" },
+        /* 21*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 1.1, "", "", 0, "12", "dotcode_1.5_ds1.1.eps" },
+        /* 22*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 1.5, 2.1, "", "", 0, "12", "dotcode_1.5_ds2.1.eps" },
+        /* 23*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 0, "", "", 0, "12", "dotcode_2.0.eps" },
+        /* 24*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 0.9, "", "", 0, "12", "dotcode_2.0_ds0.9.eps" },
+        /* 25*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 2, 1.1, "", "", 0, "12", "dotcode_2.0_ds1.1.eps" },
+        /* 26*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 0, "", "", 0, "12", "dotcode_3.0.eps" },
+        /* 27*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 0.4, "", "", 0, "12", "dotcode_3.0_ds0.4.eps" },
+        /* 28*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3, 1.1, "", "", 0, "12", "dotcode_3.0_ds1.1.eps" },
+        /* 29*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 0, "", "", 0, "12", "dotcode_3.5.eps" },
+        /* 30*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 0.4, "", "", 0, "12", "dotcode_3.5_ds0.4.eps" },
+        /* 31*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 3.5, 1.1, "", "", 0, "12", "dotcode_3.5_ds1.1.eps" },
+        /* 32*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 0, "", "", 0, "12", "dotcode_5.0.eps" },
+        /* 33*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 0.2, "", "", 0, "12", "dotcode_5.0_ds0.2.eps" },
+        /* 34*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 1.1, "", "", 0, "12", "dotcode_5.0_ds1.1.eps" },
+        /* 35*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 5, 1.7, "", "", 0, "12", "dotcode_5.0_ds1.7.eps" },
+        /* 36*/ { BARCODE_DOTCODE, -1, -1, -1, -1, -1, -1, -1, 0, 0, "FF0000", "0000FF00", 0, "12", "dotcode_no_bg.eps" },
+        /* 37*/ { BARCODE_MAXICODE, -1, -1, CMYK_COLOUR, -1, -1, -1, -1, 0, 0, "", "", 270, "12", "maxicode_rotate_270_cmyk.eps" },
+        /* 38*/ { BARCODE_MAXICODE, -1, -1, -1, 3, -1, -1, -1, 0, 0, "", "0000FF00", 180, "12", "maxicode_no_bg_hwsp3_rotate_180.eps" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_qr.c zint/backend/tests/test_qr.c
--- zint-2.12.0/backend/tests/test_qr.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_qr.c	2023-05-08 14:39:44.947319853 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -31,6 +31,112 @@
 
 #include "testcommon.h"
 
+static void test_qr_large(const testCtx *const p_ctx) {
+    int debug = p_ctx->debug;
+
+    struct item {
+        int option_1;
+        int option_2;
+        int option_3;
+        char *pattern;
+        int length;
+        int ret;
+        int expected_rows;
+        int expected_width;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { 1, 32, -1, "A", 2840, 0, 145, 145 },
+        /*  1*/ { 1, 32, -1, "A", 2841, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /*  2*/ { 1, 33, -1, "A", 3009, 0, 149, 149 },
+        /*  3*/ { 1, 33, -1, "A", 3010, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /*  4*/ { 1, 34, -1, "A", 3183, 0, 153, 153 },
+        /*  5*/ { 1, 34, -1, "A", 3184, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /*  6*/ { 1, 35, -1, "A", 3351, 0, 157, 157 },
+        /*  7*/ { 1, 35, -1, "A", 3352, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /*  8*/ { 1, 36, -1, "A", 3537, 0, 161, 161 },
+        /*  9*/ { 1, 36, -1, "A", 3538, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /* 10*/ { 1, 37, -1, "A", 3729, 0, 165, 165 },
+        /* 11*/ { 1, 37, -1, "A", 3730, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /* 12*/ { 1, 38, -1, "A", 3927, 0, 169, 169 },
+        /* 13*/ { 1, 38, -1, "A", 3928, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /* 14*/ { 1, 39, -1, "A", 4087, 0, 173, 173 },
+        /* 15*/ { 1, 39, -1, "A", 4088, ZINT_ERROR_TOO_LONG, -1, -1 },
+        /* 16*/ { 1, 40, -1, "A", 4296, 0, 177, 177 }, /* ISO/IEC 18004:2015 Section 6.1 (e) (1) */
+        /* 17*/ { 1, 40, -1, "A", 4297, ZINT_ERROR_TOO_LONG, -1, -1 },
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, length, ret;
+    struct zint_symbol *symbol;
+
+    char data_buf[ZINT_MAX_DATA_LEN];
+
+    char escaped[ZINT_MAX_DATA_LEN];
+    char cmp_buf[177 * 177 + 1];
+    char cmp_msg[1024];
+
+    int do_bwipp = (debug & ZINT_DEBUG_TEST_BWIPP) && testUtilHaveGhostscript(); /* Only do BWIPP test if asked, too slow otherwise */
+    int do_zxingcpp = (debug & ZINT_DEBUG_TEST_ZXINGCPP) && testUtilHaveZXingCPPDecoder(); /* Only do ZXing-C++ test if asked, too slow otherwise */
+
+    testStart("test_qr_large");
+
+    for (i = 0; i < data_size; i++) {
+
+        if (testContinue(p_ctx, i)) continue;
+
+        symbol = ZBarcode_Create();
+        assert_nonnull(symbol, "Symbol not created\n");
+
+        testUtilStrCpyRepeat(data_buf, data[i].pattern, data[i].length);
+        assert_equal(data[i].length, (int) strlen(data_buf), "i:%d length %d != strlen(data_buf) %d\n", i, data[i].length, (int) strlen(data_buf));
+
+        length = testUtilSetSymbol(symbol, BARCODE_QRCODE, -1 /*input_mode*/, -1 /*eci*/, data[i].option_1, data[i].option_2, data[i].option_3 | FAST_MODE, -1 /*output_options*/, data_buf, data[i].length, debug);
+
+        ret = ZBarcode_Encode(symbol, (unsigned char *) data_buf, length);
+        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Encode ret %d != %d (%s)\n", i, ret, data[i].ret, symbol->errtxt);
+
+        if (ret < ZINT_ERROR) {
+            assert_equal(symbol->rows, data[i].expected_rows, "i:%d symbol->rows %d != %d\n", i, symbol->rows, data[i].expected_rows);
+            assert_equal(symbol->width, data[i].expected_width, "i:%d symbol->width %d != %d\n", i, symbol->width, data[i].expected_width);
+        }
+
+        symbol->input_mode |= FAST_MODE;
+        ret = ZBarcode_Encode(symbol, (unsigned char *) data_buf, length);
+        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Encode ret %d != %d (%s)\n", i, ret, data[i].ret, symbol->errtxt);
+
+        if (ret < ZINT_ERROR) {
+            assert_equal(symbol->rows, data[i].expected_rows, "i:%d symbol->rows %d != %d\n", i, symbol->rows, data[i].expected_rows);
+            assert_equal(symbol->width, data[i].expected_width, "i:%d symbol->width %d != %d\n", i, symbol->width, data[i].expected_width);
+
+            if (do_bwipp && testUtilCanBwipp(i, symbol, data[i].option_1, data[i].option_2, data[i].option_3, debug)) {
+                char modules_dump[177 * 177 + 1];
+                assert_notequal(testUtilModulesDump(symbol, modules_dump, sizeof(modules_dump)), -1, "i:%d testUtilModulesDump == -1\n", i);
+                ret = testUtilBwipp(i, symbol, data[i].option_1, data[i].option_2, data[i].option_3, data_buf, length, NULL, cmp_buf, sizeof(cmp_buf), NULL);
+                assert_zero(ret, "i:%d %s testUtilBwipp ret %d != 0\n", i, testUtilBarcodeName(symbol->symbology), ret);
+
+                ret = testUtilBwippCmp(symbol, cmp_msg, cmp_buf, modules_dump);
+                assert_zero(ret, "i:%d %s testUtilBwippCmp %d != 0 %s\n  actual: %s\nexpected: %s\n",
+                               i, testUtilBarcodeName(symbol->symbology), ret, cmp_msg, cmp_buf, modules_dump);
+            }
+            if (do_zxingcpp && testUtilCanZXingCPP(i, symbol, data_buf, length, debug)) {
+                int cmp_len, ret_len;
+                char modules_dump[177 * 177 + 1];
+                assert_notequal(testUtilModulesDump(symbol, modules_dump, sizeof(modules_dump)), -1, "i:%d testUtilModulesDump == -1\n", i);
+                ret = testUtilZXingCPP(i, symbol, data_buf, length, modules_dump, cmp_buf, sizeof(cmp_buf), &cmp_len);
+                assert_zero(ret, "i:%d %s testUtilZXingCPP ret %d != 0\n", i, testUtilBarcodeName(symbol->symbology), ret);
+
+                ret = testUtilZXingCPPCmp(symbol, cmp_msg, cmp_buf, cmp_len, data_buf, length, NULL /*primary*/, escaped, &ret_len);
+                assert_zero(ret, "i:%d %s testUtilZXingCPPCmp %d != 0 %s\n  actual: %.*s\nexpected: %.*s\n",
+                               i, testUtilBarcodeName(symbol->symbology), ret, cmp_msg, cmp_len, cmp_buf, ret_len, escaped);
+            }
+        }
+
+        ZBarcode_Delete(symbol);
+    }
+
+    testFinish();
+}
+
 static void test_qr_options(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
@@ -8528,6 +8634,7 @@
 int main(int argc, char *argv[]) {
 
     testFunction funcs[] = { /* name, func */
+        { "test_qr_large", test_qr_large },
         { "test_qr_options", test_qr_options },
         { "test_qr_input", test_qr_input },
         { "test_qr_gs1", test_qr_gs1 },
diff -urN zint-2.12.0/backend/tests/test_raster.c zint/backend/tests/test_raster.c
--- zint-2.12.0/backend/tests/test_raster.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_raster.c	2023-05-08 14:39:44.949319865 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -1237,7 +1237,6 @@
         symbol = ZBarcode_Create();
         assert_nonnull(symbol, "Symbol not created\n");
 
-        testUtilSetSymbol(symbol, data[i].symbology, UNICODE_MODE, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, data[i].output_options, data[i].data, -1, debug);
         if (data[i].border_width != -1) {
             symbol->border_width = data[i].border_width;
         }
@@ -1253,7 +1252,7 @@
         } else {
             text = data[i].data;
         }
-        length = (int) strlen(text);
+        length = testUtilSetSymbol(symbol, data[i].symbology, UNICODE_MODE, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, data[i].output_options, text, -1, debug);
 
         ret = ZBarcode_Encode(symbol, (unsigned char *) text, length);
         assert_nonzero(ret < ZINT_ERROR, "i:%d ZBarcode_Encode(%d) ret %d >= ZINT_ERROR (%s)\n", i, data[i].symbology, ret, symbol->errtxt);
@@ -1788,6 +1787,161 @@
     testFinish();
 }
 
+static void test_text_gap(const testCtx *const p_ctx) {
+    int debug = p_ctx->debug;
+
+    struct item {
+        int symbology;
+        int output_options;
+        int option_2;
+        int show_hrt;
+        float text_gap;
+        float scale;
+        char *data;
+        char *composite;
+
+        int ret;
+        float expected_height;
+        int expected_rows;
+        int expected_width;
+        int expected_bitmap_width;
+        int expected_bitmap_height;
+
+        int expected_set;
+        int expected_set_row;
+        int expected_set_rows; /* Last row no. + 1 */
+        int expected_set_col;
+        int expected_set_len;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { BARCODE_CODE11, -1, -1, -1, 0, 0, "1234", "", 0, 50, 1, 62, 124, 116, 1 /*set*/, 104, 105, 55, 6 }, /* Default */
+        /*  1*/ { BARCODE_CODE11, -1, -1, -1, 0, 0, "1234", "", 0, 50, 1, 62, 124, 116, 0 /*set*/, 103, 104, 0, 124 }, /* Default */
+        /*  2*/ { BARCODE_CODE11, -1, -1, -1, 0.1, 0, "1234", "", 0, 50, 1, 62, 124, 114, 1 /*set*/, 102, 103, 55, 6 },
+        /*  3*/ { BARCODE_CODE11, -1, -1, -1, 0.4, 0, "1234", "", 0, 50, 1, 62, 124, 114, 1 /*set*/, 102, 103, 55, 6 },
+        /*  4*/ { BARCODE_CODE11, -1, -1, -1, 0.5, 0, "1234", "", 0, 50, 1, 62, 124, 115, 1 /*set*/, 103, 104, 55, 6 },
+        /*  5*/ { BARCODE_CODE11, -1, -1, -1, 0.5, 0, "1234", "", 0, 50, 1, 62, 124, 115, 0 /*set*/, 102, 103, 0, 124 },
+        /*  6*/ { BARCODE_CODE11, -1, -1, -1, 0.6, 0, "1234", "", 0, 50, 1, 62, 124, 115, 1 /*set*/, 103, 104, 55, 6 },
+        /*  7*/ { BARCODE_CODE11, -1, -1, -1, 1.0, 0, "1234", "", 0, 50, 1, 62, 124, 116, 1 /*set*/, 104, 105, 55, 6 }, /* Same as default */
+        /*  8*/ { BARCODE_CODE11, -1, -1, -1, 1.0, 0, "1234", "", 0, 50, 1, 62, 124, 116, 0 /*set*/, 103, 104, 0, 124 }, /* Same as default */
+        /*  9*/ { BARCODE_CODE11, -1, -1, -1, 1.5, 0, "1234", "", 0, 50, 1, 62, 124, 117, 1 /*set*/, 105, 106, 55, 6 },
+        /* 10*/ { BARCODE_CODE11, -1, -1, -1, 1.5, 0, "1234", "", 0, 50, 1, 62, 124, 117, 0 /*set*/, 104, 105, 0, 124 },
+        /* 11*/ { BARCODE_CODE11, -1, -1, -1, 2.0, 0, "1234", "", 0, 50, 1, 62, 124, 118, 1 /*set*/, 106, 107, 55, 6 },
+        /* 12*/ { BARCODE_CODE11, -1, -1, -1, 2.0, 0, "1234", "", 0, 50, 1, 62, 124, 118, 0 /*set*/, 105, 106, 0, 124 },
+        /* 13*/ { BARCODE_CODE11, -1, -1, -1, 3.0, 0, "1234", "", 0, 50, 1, 62, 124, 120, 1 /*set*/, 108, 109, 55, 6 },
+        /* 14*/ { BARCODE_CODE11, -1, -1, -1, 3.0, 0, "1234", "", 0, 50, 1, 62, 124, 120, 0 /*set*/, 107, 108, 0, 124 },
+        /* 15*/ { BARCODE_CODE11, -1, -1, -1, 4.0, 0, "1234", "", 0, 50, 1, 62, 124, 122, 1 /*set*/, 110, 111, 55, 6 },
+        /* 16*/ { BARCODE_CODE11, -1, -1, -1, 4.0, 0, "1234", "", 0, 50, 1, 62, 124, 122, 0 /*set*/, 109, 110, 0, 124 },
+        /* 17*/ { BARCODE_CODE11, -1, -1, -1, 5.0, 0, "1234", "", 0, 50, 1, 62, 124, 124, 1 /*set*/, 112, 113, 55, 6 },
+        /* 18*/ { BARCODE_CODE11, -1, -1, -1, 5.0, 0, "1234", "", 0, 50, 1, 62, 124, 124, 0 /*set*/, 111, 112, 0, 124 },
+        /* 19*/ { BARCODE_CODE11, -1, -1, -1, 0, 3.0, "1234", "", 0, 50, 1, 62, 372, 348, 1 /*set*/, 312, 315, 165, 18 }, /* Scale default */
+        /* 20*/ { BARCODE_CODE11, -1, -1, -1, 0, 3.0, "1234", "", 0, 50, 1, 62, 372, 348, 0 /*set*/, 311, 312, 0, 372 }, /* Scale default */
+        /* 21*/ { BARCODE_CODE11, -1, -1, -1, 1.5, 3.0, "1234", "", 0, 50, 1, 62, 372, 351, 1 /*set*/, 315, 318, 165, 18 }, /* Scale */
+        /* 22*/ { BARCODE_CODE11, -1, -1, -1, 1.5, 3.0, "1234", "", 0, 50, 1, 62, 372, 351, 0 /*set*/, 314, 315, 0, 372 }, /* Scale */
+        /* 23*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763", "", 0, 50, 1, 95, 226, 116, 1 /*set*/, 102, 104, 81, 9 }, /* Default */
+        /* 24*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763", "", 0, 50, 1, 95, 226, 116, 0 /*set*/, 101, 102, 38, 72 }, /* Default */
+        /* 25*/ { BARCODE_UPCA, -1, -1, -1, 0.5, 0, "01457130763", "", 0, 50, 1, 95, 226, 115, 1 /*set*/, 101, 103, 81, 9 },
+        /* 26*/ { BARCODE_UPCA, -1, -1, -1, 0.75, 0, "01457130763", "", 0, 50, 1, 95, 226, 115, 1 /*set*/, 101, 103, 81, 9 },
+        /* 27*/ { BARCODE_UPCA, -1, -1, -1, 1.0, 0, "01457130763", "", 0, 50, 1, 95, 226, 116, 1 /*set*/, 102, 104, 81, 9 }, /* Same as default */
+        /* 28*/ { BARCODE_UPCA, -1, -1, -1, 1.0, 0, "01457130763", "", 0, 50, 1, 95, 226, 116, 0 /*set*/, 101, 102, 38, 72 }, /* Same as default */
+        /* 29*/ { BARCODE_UPCA, -1, -1, -1, 2.0, 0, "01457130763", "", 0, 50, 1, 95, 226, 118, 1 /*set*/, 104, 106, 81, 9 },
+        /* 30*/ { BARCODE_UPCA, -1, -1, -1, 2.0, 2.5, "01457130763", "", 0, 50, 1, 95, 565, 295, 1 /*set*/, 260, 265, 201, 22 }, /* Scale */
+        /* 31*/ { BARCODE_UPCA, -1, -1, -1, 2.0, 2.5, "01457130763", "", 0, 50, 1, 95, 565, 295, 0 /*set*/, 259, 260, 95, 180 }, /* Scale */
+        /* 32*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116, 0 /*set*/, 14, 16, 208, 68 }, /* Default */
+        /* 33*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116, 1 /*set*/, 16, 100, 244, 4 }, /* Default */
+        /* 34*/ { BARCODE_UPCA, -1, -1, -1, 0.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 115, 0 /*set*/, 14, 15, 208, 68 },
+        /* 35*/ { BARCODE_UPCA, -1, -1, -1, 0.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 115, 1 /*set*/, 16, 100, 244, 4 },
+        /* 36*/ { BARCODE_UPCA, -1, -1, -1, 1.0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116, 0 /*set*/, 14, 16, 208, 68 }, /* Same as default */
+        /* 37*/ { BARCODE_UPCA, -1, -1, -1, 1.0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116, 1 /*set*/, 16, 100, 244, 4 }, /* Same as default */
+        /* 38*/ { BARCODE_UPCA, -1, -1, -1, 1.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 117, 0 /*set*/, 14, 17, 208, 68 },
+        /* 39*/ { BARCODE_UPCA, -1, -1, -1, 1.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 117, 1 /*set*/, 17, 100, 244, 4 },
+        /* 40*/ { BARCODE_UPCA, -1, -1, -1, 2.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 119, 0 /*set*/, 14, 19, 208, 68 },
+        /* 41*/ { BARCODE_UPCA, -1, -1, -1, 2.5, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 119, 1 /*set*/, 19, 100, 244, 4 },
+        /* 42*/ { BARCODE_UPCA_CC, -1, -1, -1, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116, 0 /*set*/, 38, 40, 214, 70 }, /* Default */
+        /* 43*/ { BARCODE_UPCA_CC, -1, -1, -1, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116, 1 /*set*/, 40, 100, 250, 4 }, /* Default */
+        /* 44*/ { BARCODE_UPCA_CC, -1, -1, -1, 1.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116, 0 /*set*/, 38, 40, 214, 70 }, /* Same as default */
+        /* 45*/ { BARCODE_UPCA_CC, -1, -1, -1, 1.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116, 1 /*set*/, 40, 100, 250, 4 },
+        /* 46*/ { BARCODE_UPCA_CC, -1, -1, -1, 3.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 120, 0 /*set*/, 38, 44, 214, 70 },
+        /* 47*/ { BARCODE_UPCA_CC, -1, -1, -1, 3.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 120, 1 /*set*/, 44, 100, 250, 4 },
+        /* 48*/ { BARCODE_UPCA_CC, -1, -1, 0, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 0 /*set*/, 38, 40, 214, 70 }, /* Hide text default */
+        /* 49*/ { BARCODE_UPCA_CC, -1, -1, 0, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 1 /*set*/, 40, 100, 250, 4 }, /* Hide text default */
+        /* 50*/ { BARCODE_UPCA_CC, -1, -1, 0, 3.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 0 /*set*/, 38, 44, 214, 70 }, /* Hide text */
+        /* 51*/ { BARCODE_UPCA_CC, -1, -1, 0, 3.0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 1 /*set*/, 44, 100, 250, 4 }, /* Hide text */
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, length, ret;
+    struct zint_symbol *symbol;
+
+    const char *text;
+
+    testStart("test_text_gap");
+
+    for (i = 0; i < data_size; i++) {
+        int row, column;
+
+        if (testContinue(p_ctx, i)) continue;
+
+        symbol = ZBarcode_Create();
+        assert_nonnull(symbol, "Symbol not created\n");
+
+        if (data[i].show_hrt != -1) {
+            symbol->show_hrt = data[i].show_hrt;
+        }
+        symbol->text_gap = data[i].text_gap;
+        if (data[i].scale != 0.0f) {
+            symbol->scale = data[i].scale;
+        }
+
+        if (strlen(data[i].composite)) {
+            text = data[i].composite;
+            strcpy(symbol->primary, data[i].data);
+        } else {
+            text = data[i].data;
+        }
+        length = testUtilSetSymbol(symbol, data[i].symbology, UNICODE_MODE, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, data[i].output_options, text, -1, debug);
+
+        ret = ZBarcode_Encode(symbol, (unsigned char *) text, length);
+        assert_zero(ret, "i:%d ZBarcode_Encode(%d) ret %d != 0 (%s)\n", i, data[i].symbology, ret, symbol->errtxt);
+
+        ret = ZBarcode_Buffer(symbol, 0);
+        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Buffer(%d) ret %d != %d (%s)\n", i, data[i].symbology, ret, data[i].ret, symbol->errtxt);
+        assert_nonnull(symbol->bitmap, "i:%d (%d) symbol->bitmap NULL\n", i, data[i].symbology);
+
+        if (p_ctx->index != -1 && (debug & ZINT_DEBUG_TEST_PRINT)) testUtilBitmapPrint(symbol, NULL, NULL); /* ZINT_DEBUG_TEST_PRINT 16 */
+
+        assert_equal(symbol->height, data[i].expected_height, "i:%d (%d) symbol->height %.8g != %.8g\n", i, data[i].symbology, symbol->height, data[i].expected_height);
+        assert_equal(symbol->rows, data[i].expected_rows, "i:%d (%d) symbol->rows %d != %d\n", i, data[i].symbology, symbol->rows, data[i].expected_rows);
+        assert_equal(symbol->width, data[i].expected_width, "i:%d (%d) symbol->width %d != %d\n", i, data[i].symbology, symbol->width, data[i].expected_width);
+        assert_equal(symbol->bitmap_width, data[i].expected_bitmap_width, "i:%d (%d) symbol->bitmap_width %d != %d\n", i, data[i].symbology, symbol->bitmap_width, data[i].expected_bitmap_width);
+        assert_equal(symbol->bitmap_height, data[i].expected_bitmap_height, "i:%d (%d) symbol->bitmap_height %d != %d\n", i, data[i].symbology, symbol->bitmap_height, data[i].expected_bitmap_height);
+
+        ret = ZBarcode_Print(symbol, 0);
+        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Print(%d) ret %d != %d (%s)\n", i, data[i].symbology, ret, data[i].ret, symbol->errtxt);
+        assert_zero(remove(symbol->outfile), "i:%d remove(%s) != 0\n", i, symbol->outfile);
+
+        assert_nonzero(symbol->bitmap_height >= data[i].expected_set_rows, "i:%d (%d) symbol->bitmap_height %d < expected_set_rows %d\n",
+                i, data[i].symbology, symbol->bitmap_height, data[i].expected_set_rows);
+        assert_nonzero(data[i].expected_set_rows > data[i].expected_set_row, "i:%d (%d) expected_set_rows %d < expected_set_row %d\n",
+                i, data[i].symbology, data[i].expected_set_rows, data[i].expected_set_row);
+        for (row = data[i].expected_set_row; row < data[i].expected_set_rows; row++) {
+            int bits_set = 0;
+            for (column = data[i].expected_set_col; column < data[i].expected_set_col + data[i].expected_set_len; column++) {
+                if (is_row_column_black(symbol, row, column)) {
+                    bits_set++;
+                }
+            }
+            if (data[i].expected_set) {
+                assert_equal(bits_set, data[i].expected_set_len, "i:%d (%d) row %d bits_set %d != expected_set_len %d\n", i, data[i].symbology, row, bits_set, data[i].expected_set_len);
+            } else {
+                assert_zero(bits_set, "i:%d (%d) row %d bits_set %d != 0\n", i, data[i].symbology, row, bits_set);
+            }
+        }
+        ZBarcode_Delete(symbol);
+    }
+
+    testFinish();
+}
+
 static void test_buffer_plot(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
@@ -1812,96 +1966,96 @@
     };
     struct item data[] = {
         /*  0*/ { BARCODE_PDF417, 0, 1, -1, -1, 15, "", "", "1", 0, 16, 4, 86, 86, 16,
-                    "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
-                    "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
-                    "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
-                    "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
-                    "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
-                    "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
-                    "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
-                    "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
-                    "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
-                    "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
-                    "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
-                    "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
-                    "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
-                    "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
-                    "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
-                    "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
-                },
+            "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
+                "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
+                "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
+                "11111111010101000111101010111100001111101010111110011101010111000000111111101000101001"
+                "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
+                "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
+                "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
+                "11111111010101000111110101011000001111000001000101011111101010111000111111101000101001"
+                "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
+                "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
+                "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
+                "11111111010101000110101011111000001111011111101011011010101111100000111111101000101001"
+                "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
+                "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
+                "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
+                "11111111010101000101011110011110001010000010001000011010111101111100111111101000101001"
+        },
         /*  1*/ { BARCODE_PDF417, 0, 1, -1, -1, 15, "FF0000", "00FF0099", "1", 0, 16, 4, 86, 86, 16,
-                    "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
-                    "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
-                },
+            "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRGRGRGRRRRGGGGRRRRRGRGRGRRRRRGGRRRGRGRGRRRGGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRRRRGRGRGRRGGGGGRRRRGGGGGRGGGRGRGRRRRRRGRGRGRRRGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRRGRGRGRRRRRGGGGGRRRRGRRRRRRGRGRRGRRGRGRGRRRRRGGGGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
+                "RRRRRRRRGRGRGRGGGRGRGRRRRGGRRRRGGGRGRGGGGGRGGGRGGGGRRGRGRRRRGRRRRRGGRRRRRRRGRGGGRGRGGR"
+        },
         /*  2*/ { BARCODE_PDF417, 0, 1, 1, -1, 15, "FFFF0033", "00FF00", "1", 0, 16, 4, 86, 88, 16,
-                    "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
-                    "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
-                },
+            "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYGYGYGYYYYGGGGYYYYYGYGYGYYYYYGGYYYGYGYGYYYGGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYYYYGYGYGYYGGGGGYYYYGGGGGYGGGYGYGYYYYYYGYGYGYYYGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYYGYGYGYYYYYGGGGGYYYYGYYYYYYGYGYYGYYGYGYGYYYYYGGGGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
+                "GYYYYYYYYGYGYGYGGGYGYGYYYYGGYYYYGGGYGYGGGGGYGGGYGGGGYYGYGYYYYGYYYYYGGYYYYYYYGYGGGYGYGGYG"
+        },
         /*  3*/ { BARCODE_ULTRA, -1, -1, -1, -1, 13, "FF00007F", "00FF0000", "1", 0, 13, 13, 13, 13, 13,
-                    "1111111111111"
-                    "10Y10GYCGYYC1"
-                    "11C10MGYCGGG1"
-                    "10G10GYCMCYC1"
-                    "11Y10YMMGYGY1"
-                    "10M10CGGCMYM1"
-                    "1101010101011"
-                    "10G10CYMGCCC1"
-                    "11C10MCGCMMM1"
-                    "10Y10CGCGYCY1"
-                    "11M10GMMMMGC1"
-                    "10C10MYYYGMY1"
-                    "1111111111111"
-                },
+            "1111111111111"
+                "10Y10GYCGYYC1"
+                "11C10MGYCGGG1"
+                "10G10GYCMCYC1"
+                "11Y10YMMGYGY1"
+                "10M10CGGCMYM1"
+                "1101010101011"
+                "10G10CYMGCCC1"
+                "11C10MCGCMMM1"
+                "10Y10CGCGYCY1"
+                "11M10GMMMMGC1"
+                "10C10MYYYGMY1"
+                "1111111111111"
+        },
         /*  4*/ { BARCODE_ULTRA, -1, -1, 1, -1, 13, "", "00FF0000", "1", 0, 13, 13, 13, 15, 13,
-                    "G1111111111111G"
-                    "G10Y10GYCGYYC1G"
-                    "G11C10MGYCGGG1G"
-                    "G10G10GYCMCYC1G"
-                    "G11Y10YMMGYGY1G"
-                    "G10M10CGGCMYM1G"
-                    "G1101010101011G"
-                    "G10G10CYMGCCC1G"
-                    "G11C10MCGCMMM1G"
-                    "G10Y10CGCGYCY1G"
-                    "G11M10GMMMMGC1G"
-                    "G10C10MYYYGMY1G"
-                    "G1111111111111G"
-                },
+            "G1111111111111G"
+                "G10Y10GYCGYYC1G"
+                "G11C10MGYCGGG1G"
+                "G10G10GYCMCYC1G"
+                "G11Y10YMMGYGY1G"
+                "G10M10CGGCMYM1G"
+                "G1101010101011G"
+                "G10G10CYMGCCC1G"
+                "G11C10MCGCMMM1G"
+                "G10Y10CGCGYCY1G"
+                "G11M10GMMMMGC1G"
+                "G10C10MYYYGMY1G"
+                "G1111111111111G"
+        },
         /*  5*/ { BARCODE_CHANNEL, -1, -1, 1, -1, 5, "30313233", "CFCECDCC", "1", 0, 5, 1, 19, 21, 5,
-                    "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
-                    "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
-                    "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
-                    "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
-                    "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
-                },
+            "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
+                "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
+                "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
+                "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
+                "CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132CFCECD303132303132CFCECD303132303132CFCECDCFCECDCFCECD303132CFCECD"
+        },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -1957,9 +2111,9 @@
             assert_equal(symbol->rows, data[i].expected_rows, "i:%d (%s) symbol->rows %d != %d\n", i, testUtilBarcodeName(data[i].symbology), symbol->rows, data[i].expected_rows);
             assert_equal(symbol->width, data[i].expected_width, "i:%d (%s) symbol->width %d != %d\n", i, testUtilBarcodeName(data[i].symbology), symbol->width, data[i].expected_width);
             assert_equal(symbol->bitmap_width, data[i].expected_bitmap_width, "i:%d (%s) symbol->bitmap_width %d != %d\n",
-                i, testUtilBarcodeName(data[i].symbology), symbol->bitmap_width, data[i].expected_bitmap_width);
+                    i, testUtilBarcodeName(data[i].symbology), symbol->bitmap_width, data[i].expected_bitmap_width);
             assert_equal(symbol->bitmap_height, data[i].expected_bitmap_height, "i:%d (%s) symbol->bitmap_height %d != %d\n",
-                i, testUtilBarcodeName(data[i].symbology), symbol->bitmap_height, data[i].expected_bitmap_height);
+                    i, testUtilBarcodeName(data[i].symbology), symbol->bitmap_height, data[i].expected_bitmap_height);
 
             ret = testUtilBitmapCmp(symbol, data[i].expected_bitmap, &row, &column);
             assert_zero(ret, "i:%d (%s) testUtilBitmapCmp ret %d != 0 column %d row %d (%s)\n", i, testUtilBarcodeName(data[i].symbology), ret, column, row, data[i].data);
@@ -2979,6 +3133,7 @@
         { "test_scale", test_scale, },
         { "test_guard_descent", test_guard_descent, },
         { "test_quiet_zones", test_quiet_zones, },
+        { "test_text_gap", test_text_gap, },
         { "test_buffer_plot", test_buffer_plot, },
         { "test_height", test_height, },
         { "test_height_per_row", test_height_per_row, },
diff -urN zint-2.12.0/backend/tests/test_sjis.c zint/backend/tests/test_sjis.c
--- zint-2.12.0/backend/tests/test_sjis.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_sjis.c	2023-05-08 14:39:44.950319871 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -401,7 +401,10 @@
     int i, length, ret;
 
     struct zint_symbol symbol = {0};
-    int ret_length, ret_length2;
+    int ret_length;
+#ifdef TEST_JUST_SAY_GNO
+    int ret_length2;
+#endif
     unsigned int ddata[8192];
     int ret2 = 0;
 #ifdef TEST_JUST_SAY_GNO
@@ -431,13 +434,14 @@
         diff = diff_gno = 0;
 
         for (j = 0; j < TEST_PERF_ITERATIONS; j++) {
-            ret_length = ret_length2 = length;
+            ret_length = length;
 
             start = clock();
             ret = sjis_utf8(&symbol, (unsigned char *) data[i].data, &ret_length, ddata);
             diff += clock() - start;
 
 #ifdef TEST_JUST_SAY_GNO
+            ret_length2 = length;
             start = clock();
             ret2 = sjis_utf8_wctomb(&symbol, (unsigned char *) data[i].data, &ret_length2, ddata2);
             diff_gno += clock() - start;
diff -urN zint-2.12.0/backend/tests/test_svg.c zint/backend/tests/test_svg.c
--- zint-2.12.0/backend/tests/test_svg.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_svg.c	2023-05-08 14:39:44.951319877 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -54,61 +54,63 @@
         char *composite;
         int ret;
         char *expected_file;
+        char *comment;
     };
     struct item data[] = {
-        /*  0*/ { BARCODE_CODE128, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "<>\"&'", "", 0, "code128_amperands.svg" },
-        /*  1*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold.svg" },
-        /*  2*/ { BARCODE_CODE128, UNICODE_MODE, 3, BOLD_TEXT | BARCODE_BOX, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_box3.svg" },
-        /*  3*/ { BARCODE_CODE128, UNICODE_MODE, 2, BOLD_TEXT | BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp2_box2.svg" },
-        /*  4*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, 3, 3, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp3.svg" },
-        /*  5*/ { BARCODE_GS1_128_CC, -1, -1, -1, -1, -1, -1, 3, -1, -1, 0, "", "", 0, "[00]030123456789012340", "[02]13012345678909[37]24[10]1234567ABCDEFG", 0, "gs1_128_cc_fig12.svg" },
-        /*  6*/ { BARCODE_CODABLOCKF, -1, -1, -1, -1, -1, -1, 3, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_3rows.svg" },
-        /*  7*/ { BARCODE_CODABLOCKF, -1, -1, -1, 2, 2, -1, 3, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2.svg" },
-        /*  8*/ { BARCODE_CODABLOCKF, -1, 2, BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2_box2.svg" },
-        /*  9*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "9771384524017+12", "", 0, "ean13_2addon_ggs_5.2.2.5.1-2.svg" },
-        /* 10*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "9780877799306+54321", "", 0, "ean13_5addon_ggs_5.2.2.5.2-2.svg" },
-        /* 11*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "123456789012+12", "[91]123456789012345678901", 0, "ean13_cc_2addon_cca_4x4.svg" },
-        /* 12*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4.svg" },
-        /* 13*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4_notext.svg" },
-        /* 14*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "012345678905+24", "", 0, "upca_2addon_ggs_5.2.6.6-5.svg" },
-        /* 15*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon.svg" },
-        /* 16*/ { BARCODE_UPCA, -1, 3, BARCODE_BIND, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_bind3.svg" },
-        /* 17*/ { BARCODE_UPCA, -1, -1, SMALL_TEXT | BOLD_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_small_bold.svg" },
-        /* 18*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "12345678901+12", "[91]123456789", 0, "upca_cc_2addon_cca_3x4.svg" },
-        /* 19*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4.svg" },
-        /* 20*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_notext.svg" },
-        /* 21*/ { BARCODE_UPCA_CC, -1, 3, BARCODE_BIND, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_bind3.svg" },
-        /* 22*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12", "", 0, "upce_2addon.svg" },
-        /* 23*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon.svg" },
-        /* 24*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon_small.svg" },
-        /* 25*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, 0, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon_notext.svg" },
-        /* 26*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2.svg" },
-        /* 27*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "FF0000EE", "0000FF11", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_fgbgalpha.svg" },
-        /* 28*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "FFFFFF00", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_nobg.svg" },
-        /* 29*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 270, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_rotate_270.svg" },
-        /* 30*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2.svg" },
-        /* 31*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2_notext.svg" },
-        /* 32*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12", "", 0, "ean8_2addon.svg" },
-        /* 33*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "ean8_5addon.svg" },
-        /* 34*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "9876543+65", "[91]1234567", 0, "ean8_cc_2addon_cca_4x3.svg" },
-        /* 35*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "9876543+74083", "[91]123456789012345678", 0, "ean8_cc_5addon_ccb_8x3.svg" },
-        /* 36*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345", "", 0, "ean5.svg" },
-        /* 37*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12", "", 0, "ean2.svg" },
-        /* 38*/ { BARCODE_CODE39, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "123", "", 0, "code39_small.svg" },
-        /* 39*/ { BARCODE_POSTNET, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345", "", 0, "postnet_zip.svg" },
-        /* 40*/ { BARCODE_MAXICODE, -1, 2, BARCODE_BOX, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_box2.svg" },
-        /* 41*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BIND, -1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_vwsp1_bind1.svg" },
-        /* 42*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "121212DD", "EEEEEE22", 90, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_fgbg_rotate_90.svg" },
-        /* 43*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, -1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "datamatrix_vwsp1_bind1_dotty.svg" },
-        /* 44*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, 1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "datamatrix_hvwsp1_bind1_dotty.svg" },
-        /* 45*/ { BARCODE_DBAR_LTD, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345678909", "", 0, "dbar_ltd.svg" },
-        /* 46*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, "", "", 0, "Your Data Here!", "", ZINT_WARN_NONCOMPLIANT, "pdf417_height5.svg" },
-        /* 47*/ { BARCODE_USPS_IMAIL, -1, -1, -1, -1, -1, -1, -1, -1, -1, 7.75, "", "", 0, "12345678901234567890", "", 0, "imail_height7.75.svg" },
-        /* 48*/ { BARCODE_ULTRA, -1, 3, BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "FF0000", "0000FF", 0, "12345678901234567890", "", 0, "ultra_fgbg_hvwsp2_box3.svg" },
-        /* 49*/ { BARCODE_TELEPEN, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0.4, "", "", 180, "A", "", 0, "telepen_height0.4_rotate_180.svg" },
-        /* 50*/ { BARCODE_CODE49, -1, -1, COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, -1, 0, "FF11157F", "", 0, "A", "", 0, "code49_comph_fgalpha.svg" },
-        /* 51*/ { BARCODE_CODABLOCKF, -1, -1, COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, 2, 0, "00000033", "FFFFFF66", 0, "1234567890123456789012345678901234", "", 0, "codablockf_comph_sep2_fgbgalpha.svg" },
-        /* 52*/ { BARCODE_DPD, -1, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "008182709980000020028101276", "", 0, "dpd_compliant.svg" },
+        /*  0*/ { BARCODE_CODE128, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "<>\"&'", "", 0, "code128_amperands.svg", "" },
+        /*  1*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold.svg", "" },
+        /*  2*/ { BARCODE_CODE128, UNICODE_MODE, 3, BOLD_TEXT | BARCODE_BOX, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_box3.svg", "" },
+        /*  3*/ { BARCODE_CODE128, UNICODE_MODE, 2, BOLD_TEXT | BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp2_box2.svg", "" },
+        /*  4*/ { BARCODE_CODE128, UNICODE_MODE, -1, BOLD_TEXT, 3, 3, -1, -1, -1, -1, 0, "", "", 0, "Ãgjpqy", "", 0, "code128_egrave_bold_hvwsp3.svg", "" },
+        /*  5*/ { BARCODE_GS1_128_CC, -1, -1, -1, -1, -1, -1, 3, -1, -1, 0, "", "", 0, "[00]030123456789012340", "[02]13012345678909[37]24[10]1234567ABCDEFG", 0, "gs1_128_cc_fig12.svg", "" },
+        /*  6*/ { BARCODE_CODABLOCKF, -1, -1, -1, -1, -1, -1, 3, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_3rows.svg", "" },
+        /*  7*/ { BARCODE_CODABLOCKF, -1, -1, -1, 2, 2, -1, 3, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2.svg", "" },
+        /*  8*/ { BARCODE_CODABLOCKF, -1, 2, BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "", "", 0, "AAAAAAAAA", "", 0, "codablockf_hvwsp2_box2.svg", "" },
+        /*  9*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "9771384524017+12", "", 0, "ean13_2addon_ggs_5.2.2.5.1-2.svg", "" },
+        /* 10*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "9780877799306+54321", "", 0, "ean13_5addon_ggs_5.2.2.5.2-2.svg", "" },
+        /* 11*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "123456789012+12", "[91]123456789012345678901", 0, "ean13_cc_2addon_cca_4x4.svg", "" },
+        /* 12*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4.svg", "" },
+        /* 13*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "123456789012+54321", "[91]1234567890", 0, "ean13_cc_5addon_ccb_3x4_notext.svg", "" },
+        /* 14*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "012345678905+24", "", 0, "upca_2addon_ggs_5.2.6.6-5.svg", "" },
+        /* 15*/ { BARCODE_UPCA, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon.svg", "" },
+        /* 16*/ { BARCODE_UPCA, -1, 3, BARCODE_BIND, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_bind3.svg", "" },
+        /* 17*/ { BARCODE_UPCA, -1, -1, SMALL_TEXT | BOLD_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "614141234417+12345", "", 0, "upca_5addon_small_bold.svg", "Note BOLD_TEXT ignored for UPC/EAN" },
+        /* 18*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "12345678901+12", "[91]123456789", 0, "upca_cc_2addon_cca_3x4.svg", "" },
+        /* 19*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4.svg", "" },
+        /* 20*/ { BARCODE_UPCA_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_notext.svg", "" },
+        /* 21*/ { BARCODE_UPCA_CC, -1, 3, BARCODE_BIND, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "12345678901+12121", "[91]1234567890123", 0, "upca_cc_5addon_ccb_4x4_bind3.svg", "" },
+        /* 22*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12", "", 0, "upce_2addon.svg", "" },
+        /* 23*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon.svg", "" },
+        /* 24*/ { BARCODE_UPCE, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon_small.svg", "" },
+        /* 25*/ { BARCODE_UPCE, -1, -1, -1, -1, -1, 0, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "upce_5addon_notext.svg", "" },
+        /* 26*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2.svg", "" },
+        /* 27*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "FF0000EE", "0000FF11", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_fgbgalpha.svg", "" },
+        /* 28*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "FFFFFF00", 0, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_nobg.svg", "" },
+        /* 29*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 270, "0654321+89", "[91]1", 0, "upce_cc_2addon_cca_5x2_rotate_270.svg", "" },
+        /* 30*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2.svg", "" },
+        /* 31*/ { BARCODE_UPCE_CC, -1, -1, -1, -1, -1, 0, 2, -1, -1, 0, "", "", 0, "1876543+56789", "[91]12345", 0, "upce_cc_5addon_ccb_8x2_notext.svg", "" },
+        /* 32*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12", "", 0, "ean8_2addon.svg", "" },
+        /* 33*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "1234567+12345", "", 0, "ean8_5addon.svg", "" },
+        /* 34*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 1, -1, -1, 0, "", "", 0, "9876543+65", "[91]1234567", 0, "ean8_cc_2addon_cca_4x3.svg", "" },
+        /* 35*/ { BARCODE_EANX_CC, -1, -1, -1, -1, -1, -1, 2, -1, -1, 0, "", "", 0, "9876543+74083", "[91]123456789012345678", 0, "ean8_cc_5addon_ccb_8x3.svg", "" },
+        /* 36*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345", "", 0, "ean5.svg", "" },
+        /* 37*/ { BARCODE_EANX, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12", "", 0, "ean2.svg", "" },
+        /* 38*/ { BARCODE_CODE39, -1, -1, SMALL_TEXT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "123", "", 0, "code39_small.svg", "" },
+        /* 39*/ { BARCODE_POSTNET, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345", "", 0, "postnet_zip.svg", "" },
+        /* 40*/ { BARCODE_MAXICODE, -1, 2, BARCODE_BOX, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_box2.svg", "" },
+        /* 41*/ { BARCODE_MAXICODE, -1, 1, BARCODE_BIND, -1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_vwsp1_bind1.svg", "" },
+        /* 42*/ { BARCODE_MAXICODE, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "121212DD", "EEEEEE22", 90, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "maxicode_fgbg_rotate_90.svg", "" },
+        /* 43*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, -1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "datamatrix_vwsp1_bind1_dotty.svg", "" },
+        /* 44*/ { BARCODE_DATAMATRIX, -1, 1, BARCODE_BIND | BARCODE_DOTTY_MODE, 1, 1, -1, -1, -1, -1, 0, "", "", 0, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "", 0, "datamatrix_hvwsp1_bind1_dotty.svg", "" },
+        /* 45*/ { BARCODE_DBAR_LTD, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "12345678909", "", 0, "dbar_ltd.svg", "" },
+        /* 46*/ { BARCODE_PDF417, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, "", "", 0, "Your Data Here!", "", ZINT_WARN_NONCOMPLIANT, "pdf417_height5.svg", "" },
+        /* 47*/ { BARCODE_USPS_IMAIL, -1, -1, -1, -1, -1, -1, -1, -1, -1, 7.75, "", "", 0, "12345678901234567890", "", 0, "imail_height7.75.svg", "" },
+        /* 48*/ { BARCODE_ULTRA, -1, 3, BARCODE_BOX, 2, 2, -1, -1, -1, -1, 0, "FF0000", "0000FF", 0, "12345678901234567890", "", 0, "ultra_fgbg_hvwsp2_box3.svg", "" },
+        /* 49*/ { BARCODE_TELEPEN, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0.4, "", "", 180, "A", "", 0, "telepen_height0.4_rotate_180.svg", "" },
+        /* 50*/ { BARCODE_CODE49, -1, -1, COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, -1, 0, "FF11157F", "", 0, "A", "", 0, "code49_comph_fgalpha.svg", "" },
+        /* 51*/ { BARCODE_CODABLOCKF, -1, -1, COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, 2, 0, "00000033", "FFFFFF66", 0, "1234567890123456789012345678901234", "", 0, "codablockf_comph_sep2_fgbgalpha.svg", "" },
+        /* 52*/ { BARCODE_DPD, -1, -1, BARCODE_QUIET_ZONES | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, -1, 0, "", "", 0, "008182709980000020028101276", "", 0, "dpd_compliant.svg", "" },
+        /* 53*/ { BARCODE_CHANNEL, -1, -1, CMYK_COLOUR | COMPLIANT_HEIGHT, -1, -1, -1, -1, -1, -1, 0, "100,85,0,20", "FFFFFF00", 0, "123", "", 0, "channel_cmyk_nobg.svg", "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -188,11 +190,11 @@
         assert_nonzero(testUtilDataPath(expected_file, sizeof(expected_file), data_dir, data[i].expected_file), "i:%d testUtilDataPath == 0\n", i);
 
         if (p_ctx->generate) {
-            printf("        /*%3d*/ { %s, %s, %d, %s, %d, %d, %d, %d, %d, %d, %.8g, \"%s\", \"%s\", %d, \"%s\", \"%s\", \"%s\" },\n",
+            printf("        /*%3d*/ { %s, %s, %d, %s, %d, %d, %d, %d, %d, %d, %.8g, \"%s\", \"%s\", %d, \"%s\", \"%s\", \"%s\", \"%s\" },\n",
                     i, testUtilBarcodeName(data[i].symbology), testUtilInputModeName(data[i].input_mode), data[i].border_width,
                     testUtilOutputOptionsName(data[i].output_options), data[i].whitespace_width, data[i].whitespace_height, data[i].show_hrt,
                     data[i].option_1, data[i].option_2, data[i].option_3, data[i].height, data[i].fgcolour, data[i].bgcolour, data[i].rotate_angle,
-                    testUtilEscape(data[i].data, length, escaped, escaped_size), data[i].composite, data[i].expected_file);
+                    testUtilEscape(data[i].data, length, escaped, escaped_size), data[i].composite, data[i].expected_file, data[i].comment);
             ret = testUtilRename(symbol->outfile, expected_file);
             assert_zero(ret, "i:%d testUtilRename(%s, %s) ret %d != 0\n", i, symbol->outfile, expected_file, ret);
             if (have_libreoffice) {
diff -urN zint-2.12.0/backend/tests/test_tif.c zint/backend/tests/test_tif.c
--- zint-2.12.0/backend/tests/test_tif.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_tif.c	2023-05-08 14:39:44.951319877 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -188,19 +188,20 @@
         /*  5*/ { BARCODE_CODE128, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "00000099", "FEDCBACC", "A", "", "code128_fgbgalpha.tif", "" },
         /*  6*/ { BARCODE_CODE128, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "C00000", "FEDCBA", "A", "", "code128_cmyk.tif", "" },
         /*  7*/ { BARCODE_CODE128, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "C0000099", "FEDCBACC", "A", "", "code128_cmyk_fgbgalpha.tif", "" },
-        /*  8*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "C00000", "FEDCBACC", "1234", "", "ultra_bgalpha.tif", "" },
-        /*  9*/ { BARCODE_ULTRA, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "C00000", "FEDCBACC", "1234", "", "ultra_cmyk_bgalpha.tif", "" },
-        /* 10*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "FEDCBA", "1234", "", "ultra_fgalpha.tif", "" },
-        /* 11*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "FEDCBACC", "1234", "", "ultra_fgbgalpha.tif", "" },
-        /* 12*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "", "1234", "", "ultra_fgalpha_nobg.tif", "" },
-        /* 13*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "", "FEDCBACC", "1234", "", "ultra_bgalpha_nofg.tif", "" },
-        /* 14*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5f, "", "", "1", "", "ultra_odd.tif", "" },
-        /* 15*/ { BARCODE_ULTRA, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "", "", "1234", "", "ultra_cmyk.tif", "" },
-        /* 16*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, "FF0000", "0000FF", "1234", "", "ultra_fgbg_hvwsp1_box1.tif", "" },
-        /* 17*/ { BARCODE_HANXIN, UNICODE_MODE, -1, -1, -1, -1, -1, 4, 84, 0, 2, "", "", "1", "", "hanxin_v84_l4_scale2.tif", "" },
-        /* 18*/ { BARCODE_AZTEC, -1, -1, -1, -1, -1, -1, -1, 32, 0, 0, "4BE055", "", "1", "", "aztec_v32_fg.tif", "" },
-        /* 19*/ { BARCODE_DAFT, -1, -1, -1, -1, -1, -1, -1, -1, 8, 0.5f, "", "", "F", "", "daft_height8_scale0.5.tif", "" },
-        /* 20*/ { BARCODE_DAFT, -1, -1, -1, -1, -1, -1, -1, -1, 1, 0.5f, "", "", "DAFT", "", "daft_height1_scale0.5.tif", "" },
+        /*  8*/ { BARCODE_CODE128, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "71,0,40,44", "10,0,20,5", "A", "", "code128_cmyk_fgbgcmyk.tif", "" },
+        /*  9*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "C00000", "FEDCBACC", "1234", "", "ultra_bgalpha.tif", "" },
+        /* 10*/ { BARCODE_ULTRA, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "C00000", "FEDCBACC", "1234", "", "ultra_cmyk_bgalpha.tif", "" },
+        /* 11*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "FEDCBA", "1234", "", "ultra_fgalpha.tif", "" },
+        /* 12*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "FEDCBACC", "1234", "", "ultra_fgbgalpha.tif", "" },
+        /* 13*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "000000BB", "", "1234", "", "ultra_fgalpha_nobg.tif", "" },
+        /* 14*/ { BARCODE_ULTRA, -1, -1, -1, 1, -1, -1, -1, -1, 0, 0, "", "FEDCBACC", "1234", "", "ultra_bgalpha_nofg.tif", "" },
+        /* 15*/ { BARCODE_ULTRA, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0.5f, "", "", "1", "", "ultra_odd.tif", "" },
+        /* 16*/ { BARCODE_ULTRA, -1, -1, CMYK_COLOUR, 1, -1, -1, -1, -1, 0, 0, "", "", "1234", "", "ultra_cmyk.tif", "" },
+        /* 17*/ { BARCODE_ULTRA, -1, 1, BARCODE_BOX, 1, 1, -1, -1, -1, 0, 0, "FF0000", "0000FF", "1234", "", "ultra_fgbg_hvwsp1_box1.tif", "" },
+        /* 18*/ { BARCODE_HANXIN, UNICODE_MODE, -1, -1, -1, -1, -1, 4, 84, 0, 2, "", "", "1", "", "hanxin_v84_l4_scale2.tif", "" },
+        /* 19*/ { BARCODE_AZTEC, -1, -1, -1, -1, -1, -1, -1, 32, 0, 0, "4BE055", "", "1", "", "aztec_v32_fg.tif", "" },
+        /* 20*/ { BARCODE_DAFT, -1, -1, -1, -1, -1, -1, -1, -1, 8, 0.5f, "", "", "F", "", "daft_height8_scale0.5.tif", "" },
+        /* 21*/ { BARCODE_DAFT, -1, -1, -1, -1, -1, -1, -1, -1, 1, 0.5f, "", "", "DAFT", "", "daft_height1_scale0.5.tif", "" },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
diff -urN zint-2.12.0/backend/tests/test_vector.c zint/backend/tests/test_vector.c
--- zint-2.12.0/backend/tests/test_vector.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/test_vector.c	2023-05-08 14:39:44.952319883 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2019-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2019-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -29,27 +29,35 @@
  */
 /* SPDX-License-Identifier: BSD-3-Clause */
 
+#include <math.h>
 #include "testcommon.h"
 
+/* Round to 3 decimal places (avoids rounding differences on various platforms) */
+#define rnd3dpf(m) stripf(roundf((m) * 1000) / 1000)
+
 static struct zint_vector_rect *find_rect(struct zint_symbol *symbol, float x, float y, float width, float height) {
     struct zint_vector_rect *rect;
 
     if (symbol->vector == NULL) {
         return NULL;
     }
+    x = rnd3dpf(x);
+    y = rnd3dpf(y);
+    width = rnd3dpf(width);
+    height = rnd3dpf(height);
     for (rect = symbol->vector->rectangles; rect != NULL; rect = rect->next) {
-        /* printf("x %.8g, y %.8g, width %.8g, height %.8g\n", rect->x, rect->y, rect->width, rect->height); */
-        if (rect->x == stripf(x) && rect->y == stripf(y)) {
+        /* printf("x %.9g, y %.9g, width %.9g, height %.9g\n", rect->x, rect->y, rect->width, rect->height); */
+        if (rnd3dpf(rect->x) == x && rnd3dpf(rect->y) == y) {
             if (height && width) {
-                if (rect->height == stripf(height) && rect->width == stripf(width)) {
+                if (rnd3dpf(rect->height) == height && rnd3dpf(rect->width) == width) {
                     break;
                 }
             } else if (height) {
-                if (rect->height == stripf(height)) {
+                if (rnd3dpf(rect->height) == height) {
                     break;
                 }
             } else if (width) {
-                if (rect->width == stripf(width)) {
+                if (rnd3dpf(rect->width) == width) {
                     break;
                 }
             } else {
@@ -67,11 +75,14 @@
     if (symbol->vector == NULL) {
         return NULL;
     }
+    x = rnd3dpf(x);
+    y = rnd3dpf(y);
+    diameter = rnd3dpf(diameter);
     for (circle = symbol->vector->circles; circle != NULL; circle = circle->next) {
         /* printf("x %.8g, y %.8g, diamter %.8g\n", circle->x, circle->y, circle->diameter); */
-        if (circle->x == stripf(x) && circle->y == stripf(y)) {
+        if (rnd3dpf(circle->x) == x && rnd3dpf(circle->y) == y) {
             if (diameter) {
-                if (circle->diameter == stripf(diameter)) {
+                if (rnd3dpf(circle->diameter) == diameter) {
                     break;
                 }
             } else {
@@ -83,6 +94,374 @@
     return circle;
 }
 
+static struct zint_vector_string *find_string(struct zint_symbol *symbol, float x, float y) {
+    struct zint_vector_string *string;
+
+    if (symbol->vector == NULL) {
+        return NULL;
+    }
+    x = rnd3dpf(x);
+    y = rnd3dpf(y);
+    for (string = symbol->vector->strings; string != NULL; string = string->next) {
+        /* printf("string->x %.9g, string->y %.9g\n", string->x, string->y); */
+        if (rnd3dpf(string->x) == x && rnd3dpf(string->y) == y) {
+            break;
+        }
+    }
+
+    return string;
+}
+
+/* Helper to check string vectors */
+static int check_vector_strings(const struct zint_symbol *symbol, char errmsg[128]) {
+    const int has_hrt = ZBarcode_Cap(symbol->symbology, ZINT_CAP_HRT) == ZINT_CAP_HRT;
+    const struct zint_vector *vector = symbol->vector;
+    const struct zint_vector_string *string;
+    int i, length;
+
+    if (!vector) {
+        strcpy(errmsg, "vector NULL");
+        return 0;
+    }
+    if (symbol->show_hrt && has_hrt) {
+        if (!symbol->vector->strings) {
+            strcpy(errmsg, "vector->strings NULL");
+            return 0;
+        }
+        for (string = symbol->vector->strings, i = 0; string; string = string->next, i++) {
+            if (string->x < 0.0f) {
+                sprintf(errmsg, "string[%d]->x %g negative", i, string->x);
+                return 0;
+            }
+            if (string->x >= vector->width) {
+                sprintf(errmsg, "string[%d]->x %g >= vector->width %g", i, string->x, vector->width);
+                return 0;
+            }
+            if (string->y < 0.0f) {
+                sprintf(errmsg, "string[%d]->y %g negative", i, string->y);
+                return 0;
+            }
+            if (string->y >= vector->height) {
+                sprintf(errmsg, "string[%d]->y %g >= vector->height %g", i, string->y, vector->height);
+                return 0;
+            }
+            if (string->fsize < 1.0f) {
+                sprintf(errmsg, "string[%d]->fsize %g < 1", i, string->fsize);
+                return 0;
+            }
+            if (string->width <= 0.0f) {
+                sprintf(errmsg, "string[%d]->width %g zero or negative", i, string->width);
+                return 0;
+            }
+            if (string->rotation != 0 && string->rotation != 90 && string->rotation != 180 && string->rotation != 270) {
+                sprintf(errmsg, "string[%d]->rotation %d not 0, 90, 180, 270", i, string->rotation);
+                return 0;
+            }
+            if (!string->text) {
+                sprintf(errmsg, "string[%d]->text NULL", i);
+                return 0;
+            }
+            length = (int) ustrlen(string->text);
+            if (string->length != length) {
+                sprintf(errmsg, "string[%d]->length != %d", string->length, length);
+                return 0;
+            }
+        }
+        if (is_extendable(symbol->symbology)) {
+            const unsigned char *addon = (const unsigned char *) strchr((const char *) symbol->text, '+');
+            const int has_addon = addon != NULL;
+            const int text_len = has_addon ? (int) (addon - symbol->text) : (int) ustrlen(symbol->text);
+            int num = -1;
+            switch (symbol->symbology) {
+                case BARCODE_EANX:
+                case BARCODE_EANX_CHK:
+                case BARCODE_ISBNX:
+                case BARCODE_EANX_CC:
+                    num = text_len <= 8 ? text_len <= 5 ? 1 : 2 : 3;
+                    break;
+                case BARCODE_UPCA:
+                case BARCODE_UPCA_CHK:
+                case BARCODE_UPCA_CC:
+                    num = 4;
+                    break;
+                case BARCODE_UPCE:
+                case BARCODE_UPCE_CHK:
+                case BARCODE_UPCE_CC:
+                    num = 3;
+                    break;
+                default:
+                    strcpy(errmsg, "unhandled EAN/UPC");
+                    return 0;
+                    break;
+            }
+            if (i != num + has_addon) {
+                printf("num %d, text_len %d, has_addon %d\n", num, text_len, has_addon);
+                sprintf(errmsg, "no. of strings %d != %d", i, num + has_addon);
+                return 0;
+            }
+        } else {
+            if (i > 1) {
+                sprintf(errmsg, "no. of strings %d > 1", i);
+                return 0;
+            }
+        }
+    } else {
+        if (symbol->vector->strings) {
+            strcpy(errmsg, "vector->strings not NULL");
+            return 0;
+        }
+    }
+    return 1;
+}
+
+/* Helper to check rectangle vectors */
+static int check_vector_rectangles(const struct zint_symbol *symbol, char errmsg[128]) {
+    const struct zint_vector *vector = symbol->vector;
+    const struct zint_vector_rect *rect;
+    const int have_border = symbol->border_width && (symbol->output_options & (BARCODE_BIND | BARCODE_BOX | BARCODE_BIND_TOP));
+    const int dotty = is_dotty(symbol->symbology) && (symbol->output_options & BARCODE_DOTTY_MODE);
+    int i;
+
+    if (!vector) {
+        strcpy(errmsg, "vector NULL");
+        return 0;
+    }
+    if (have_border) {
+        if (!vector->rectangles) {
+            strcpy(errmsg, "rectangles NULL");
+            return 0;
+        }
+    } else {
+        if (symbol->symbology == BARCODE_DOTCODE || symbol->symbology == BARCODE_MAXICODE) {
+            if (vector->rectangles) {
+                strcpy(errmsg, "rectangles not NULL");
+                return 0;
+            }
+        } else {
+            if (!dotty) {
+                if (!vector->rectangles) {
+                    strcpy(errmsg, "rectangles NULL");
+                    return 0;
+                }
+            }
+        }
+    }
+    for (rect = vector->rectangles, i = 0; rect; rect = rect->next, i++) {
+        if (rect->x < 0.0f) {
+            sprintf(errmsg, "rect[%d]->x %g negative", i, rect->x);
+            return 0;
+        }
+        if (rect->x >= vector->width) {
+            sprintf(errmsg, "rect[%d]->x %g >= vector->width %g", i, rect->x, vector->width);
+            return 0;
+        }
+        if (rect->y < 0.0f) {
+            sprintf(errmsg, "rect[%d]->y %g negative", i, rect->y);
+            return 0;
+        }
+        if (rect->y >= vector->height) {
+            sprintf(errmsg, "rect[%d]->y %g >= vector->height %g", i, rect->y, vector->height);
+            return 0;
+        }
+        if (rect->width <= 0.0f) {
+            sprintf(errmsg, "rect[%d]->width %g <= 0", i, rect->width);
+            return 0;
+        }
+        if (rect->width > vector->width) {
+            sprintf(errmsg, "rect[%d]->width %g > vector->width %g", i, rect->width, vector->width);
+            return 0;
+        }
+        if (stripf(rect->x + rect->width) > vector->width) {
+            sprintf(errmsg, "rect[%d]->x + width %g > vector->width %g", i, rect->x + rect->width, vector->width);
+            return 0;
+        }
+        if (rect->height <= 0.0f) {
+            sprintf(errmsg, "rect[%d]->height %g <= 0", i, rect->height);
+            return 0;
+        }
+        if (rect->height > vector->height) {
+            sprintf(errmsg, "rect[%d]->height %g > vector->height %g", i, rect->height, vector->height);
+            return 0;
+        }
+        if (stripf(rect->y + rect->height) > vector->height) {
+            sprintf(errmsg, "rect[%d]->y + height %g > vector->height %g", i, rect->y + rect->height, vector->height);
+            return 0;
+        }
+
+        if (symbol->symbology == BARCODE_ULTRA) {
+            if (rect->colour != -1 && (rect->colour < 1 || rect->colour > 8)) {
+                sprintf(errmsg, "rect[%d]->colour %d != -1 and not 1-8", i, rect->colour);
+                return 0;
+            }
+        } else {
+            if (rect->colour != -1) {
+                sprintf(errmsg, "rect[%d]->colour %d != -1", i, rect->colour);
+                return 0;
+            }
+        }
+    }
+    return 1;
+}
+
+/* Helper to check circle vectors */
+static int check_vector_circles(const struct zint_symbol *symbol, char errmsg[128]) {
+    const struct zint_vector *vector = symbol->vector;
+    const struct zint_vector_circle *circle;
+    const int dotty = is_dotty(symbol->symbology) && (symbol->output_options & BARCODE_DOTTY_MODE);
+    int i;
+
+    if (!vector) {
+        strcpy(errmsg, "vector NULL");
+        return 0;
+    }
+    if (symbol->symbology == BARCODE_DOTCODE || symbol->symbology == BARCODE_MAXICODE) {
+        if (!vector->circles) {
+            strcpy(errmsg, "circles NULL");
+            return 0;
+        }
+    } else {
+        if (vector->circles) {
+            if (!dotty) {
+                strcpy(errmsg, "circles not NULL");
+                return 0;
+            }
+        } else {
+            if (dotty) {
+                strcpy(errmsg, "circles NULL");
+                return 0;
+            }
+        }
+    }
+    for (circle = vector->circles, i = 0; circle; circle = circle->next, i++) {
+        if (circle->x < 0.0f) {
+            sprintf(errmsg, "circle[%d]->x %g negative", i, circle->x);
+            return 0;
+        }
+        if (circle->x >= vector->width) {
+            sprintf(errmsg, "circle[%d]->x %g >= vector->width %g", i, circle->x, vector->width);
+            return 0;
+        }
+        if (circle->y < 0.0f) {
+            sprintf(errmsg, "circle[%d]->y %g negative", i, circle->y);
+            return 0;
+        }
+        if (circle->y >= vector->height) {
+            sprintf(errmsg, "circle[%d]->y %g >= vector->height %g", i, circle->y, vector->height);
+            return 0;
+        }
+        if (circle->diameter <= 0.0f) {
+            sprintf(errmsg, "circle[%d]->diameter %g <= 0", i, circle->diameter);
+            return 0;
+        }
+        if (circle->diameter > vector->width) {
+            sprintf(errmsg, "circle[%d]->diameter %g > vector->diameter %g", i, circle->diameter, vector->width);
+            return 0;
+        }
+        if (circle->diameter > vector->height) {
+            sprintf(errmsg, "circle[%d]->diameter %g > vector->height %g", i, circle->diameter, vector->height);
+            return 0;
+        }
+        if (stripf(circle->x + circle->diameter / 2) > vector->width) {
+            sprintf(errmsg, "circle[%d]->x + diameter / 2 %g > vector->width %g", i, circle->x + circle->diameter / 2, vector->width);
+            return 0;
+        }
+        if (stripf(circle->y + circle->diameter / 2) > vector->height) {
+            sprintf(errmsg, "circle[%d]->y + diameter / 2 %g > vector->height %g", i, circle->y + circle->diameter / 2, vector->height);
+            return 0;
+        }
+
+        if (circle->colour != 0) {
+            sprintf(errmsg, "circle[%d]->colour %d != 0", i, circle->colour);
+            return 0;
+        }
+    }
+    return 1;
+}
+
+/* Helper to check hexagon vectors */
+static int check_vector_hexagons(const struct zint_symbol *symbol, char errmsg[128]) {
+    const struct zint_vector *vector = symbol->vector;
+    const struct zint_vector_hexagon *hex;
+    int i;
+
+    if (!vector) {
+        strcpy(errmsg, "vector NULL");
+        return 0;
+    }
+    if (symbol->symbology == BARCODE_MAXICODE) {
+        if (!vector->hexagons) {
+            strcpy(errmsg, "hexagons NULL");
+            return 0;
+        }
+    } else {
+        if (vector->hexagons) {
+            strcpy(errmsg, "hexagons not NULL");
+            return 0;
+        }
+    }
+    for (hex = vector->hexagons, i = 0; hex; hex = hex->next, i++) {
+        if (hex->x < 0.0f) {
+            sprintf(errmsg, "hex[%d]->x %g negative", i, hex->x);
+            return 0;
+        }
+        if (hex->x >= vector->width) {
+            sprintf(errmsg, "hex[%d]->x %g >= vector->width %g", i, hex->x, vector->width);
+            return 0;
+        }
+        if (hex->y < 0.0f) {
+            sprintf(errmsg, "hex[%d]->y %g negative", i, hex->y);
+            return 0;
+        }
+        if (hex->y >= vector->height) {
+            sprintf(errmsg, "hex[%d]->y %g >= vector->height %g", i, hex->y, vector->height);
+            return 0;
+        }
+        if (hex->diameter <= 0.0f) {
+            sprintf(errmsg, "hex[%d]->diameter %g <= 0", i, hex->diameter);
+            return 0;
+        }
+        if (hex->diameter > vector->width) {
+            sprintf(errmsg, "hex[%d]->diameter %g > vector->diameter %g", i, hex->diameter, vector->width);
+            return 0;
+        }
+        if (hex->diameter > vector->height) {
+            sprintf(errmsg, "hex[%d]->diameter %g > vector->height %g", i, hex->diameter, vector->height);
+            return 0;
+        }
+        if (stripf(hex->x + hex->diameter / 2) > vector->width) {
+            sprintf(errmsg, "hex[%d]->x + diameter / 2 %g > vector->width %g", i, hex->x + hex->diameter / 2, vector->width);
+            return 0;
+        }
+        if (stripf(hex->y + hex->diameter / 2) > vector->height) {
+            sprintf(errmsg, "hex[%d]->y + diameter / 2 %g > vector->height %g", i, hex->y + hex->diameter / 2, vector->height);
+            return 0;
+        }
+
+        if (hex->rotation != 0 && hex->rotation != 90 && hex->rotation != 180 && hex->rotation != 270) {
+            sprintf(errmsg, "hex[%d]->rotation %d not 0, 90, 180, 270", i, hex->rotation);
+            return 0;
+        }
+    }
+    return 1;
+}
+
+/* Helper to check vectors */
+static int check_vectors(const struct zint_symbol *symbol, char errmsg[128]) {
+    if (!check_vector_strings(symbol, errmsg)) {
+        return 0;
+    }
+    if (!check_vector_rectangles(symbol, errmsg)) {
+        return 0;
+    }
+    if (!check_vector_circles(symbol, errmsg)) {
+        return 0;
+    }
+    if (!check_vector_hexagons(symbol, errmsg)) {
+        return 0;
+    }
+    return 1;
+}
+
 static void test_options(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
@@ -169,22 +548,22 @@
         /*  5*/ { BARCODE_C25IND, "1234567890", "", 50, 1, 159, 318, 118.900002 },
         /*  6*/ { BARCODE_CODE39, "1234567890", "", 50, 1, 155, 310, 118.900002 },
         /*  7*/ { BARCODE_EXCODE39, "1234567890", "", 50, 1, 155, 310, 118.900002 },
-        /*  8*/ { BARCODE_EANX, "123456789012", "", 50, 1, 95, 226, 116.400002 },
-        /*  9*/ { BARCODE_EANX_CHK, "1234567890128", "", 50, 1, 95, 226, 116.400002 },
-        /* 10*/ { BARCODE_EANX, "123456789012+12", "", 50, 1, 122, 276, 116.400002 },
-        /* 11*/ { BARCODE_EANX_CHK, "1234567890128+12", "", 50, 1, 122, 276, 116.400002 },
-        /* 12*/ { BARCODE_EANX, "123456789012+12345", "", 50, 1, 149, 330, 116.400002 },
-        /* 13*/ { BARCODE_EANX_CHK, "1234567890128+12345", "", 50, 1, 149, 330, 116.400002 },
-        /* 14*/ { BARCODE_EANX, "1234567", "", 50, 1, 67, 162, 116.400002 },
-        /* 15*/ { BARCODE_EANX_CHK, "12345670", "", 50, 1, 67, 162, 116.400002 },
-        /* 16*/ { BARCODE_EANX, "1234567+12", "", 50, 1, 94, 216, 116.400002 },
-        /* 17*/ { BARCODE_EANX_CHK, "12345670+12", "", 50, 1, 94, 216, 116.400002 },
-        /* 18*/ { BARCODE_EANX, "1234567+12345", "", 50, 1, 121, 270, 116.400002 },
-        /* 19*/ { BARCODE_EANX_CHK, "12345670+12345", "", 50, 1, 121, 270, 116.400002 },
-        /* 20*/ { BARCODE_EANX, "1234", "", 50, 1, 47, 118, 116.400002 },
-        /* 21*/ { BARCODE_EANX_CHK, "1234", "", 50, 1, 47, 118, 116.400002 },
-        /* 22*/ { BARCODE_EANX, "12", "", 50, 1, 20, 64, 116.400002 },
-        /* 23*/ { BARCODE_EANX_CHK, "12", "", 50, 1, 20, 64, 116.400002 },
+        /*  8*/ { BARCODE_EANX, "123456789012", "", 50, 1, 95, 226, 116.9 },
+        /*  9*/ { BARCODE_EANX_CHK, "1234567890128", "", 50, 1, 95, 226, 116.9 },
+        /* 10*/ { BARCODE_EANX, "123456789012+12", "", 50, 1, 122, 276, 116.9 },
+        /* 11*/ { BARCODE_EANX_CHK, "1234567890128+12", "", 50, 1, 122, 276, 116.9 },
+        /* 12*/ { BARCODE_EANX, "123456789012+12345", "", 50, 1, 149, 330, 116.9 },
+        /* 13*/ { BARCODE_EANX_CHK, "1234567890128+12345", "", 50, 1, 149, 330, 116.9 },
+        /* 14*/ { BARCODE_EANX, "1234567", "", 50, 1, 67, 162, 116.9 },
+        /* 15*/ { BARCODE_EANX_CHK, "12345670", "", 50, 1, 67, 162, 116.9 },
+        /* 16*/ { BARCODE_EANX, "1234567+12", "", 50, 1, 94, 216, 116.9 },
+        /* 17*/ { BARCODE_EANX_CHK, "12345670+12", "", 50, 1, 94, 216, 116.9 },
+        /* 18*/ { BARCODE_EANX, "1234567+12345", "", 50, 1, 121, 270, 116.9 },
+        /* 19*/ { BARCODE_EANX_CHK, "12345670+12345", "", 50, 1, 121, 270, 116.9 },
+        /* 20*/ { BARCODE_EANX, "1234", "", 50, 1, 47, 118, 116.9 },
+        /* 21*/ { BARCODE_EANX_CHK, "1234", "", 50, 1, 47, 118, 116.9 },
+        /* 22*/ { BARCODE_EANX, "12", "", 50, 1, 20, 64, 116.9 },
+        /* 23*/ { BARCODE_EANX_CHK, "12", "", 50, 1, 20, 64, 116.9 },
         /* 24*/ { BARCODE_GS1_128, "[01]12345678901231", "", 50, 1, 134, 268, 118.900002 },
         /* 25*/ { BARCODE_CODABAR, "A00000000B", "", 50, 1, 102, 204, 118.900002 },
         /* 26*/ { BARCODE_CODE128, "1234567890", "", 50, 1, 90, 180, 118.900002 },
@@ -198,18 +577,18 @@
         /* 34*/ { BARCODE_DBAR_LTD, "1234567890123", "", 50, 1, 79, 158, 118.900002 },
         /* 35*/ { BARCODE_DBAR_EXP, "[01]12345678901231", "", 34, 1, 134, 268, 86.9000015 },
         /* 36*/ { BARCODE_TELEPEN, "1234567890", "", 50, 1, 208, 416, 118.900002 },
-        /* 37*/ { BARCODE_UPCA, "12345678901", "", 50, 1, 95, 226, 116.400002 },
-        /* 38*/ { BARCODE_UPCA_CHK, "123456789012", "", 50, 1, 95, 226, 116.400002 },
-        /* 39*/ { BARCODE_UPCA, "12345678901+12", "", 50, 1, 124, 276, 116.400002 },
-        /* 40*/ { BARCODE_UPCA_CHK, "123456789012+12", "", 50, 1, 124, 276, 116.400002 },
-        /* 41*/ { BARCODE_UPCA, "12345678901+12345", "", 50, 1, 151, 330, 116.400002 },
-        /* 42*/ { BARCODE_UPCA_CHK, "123456789012+12345", "", 50, 1, 151, 330, 116.400002 },
-        /* 43*/ { BARCODE_UPCE, "1234567", "", 50, 1, 51, 134, 116.400002 },
-        /* 44*/ { BARCODE_UPCE_CHK, "12345670", "", 50, 1, 51, 134, 116.400002 },
-        /* 45*/ { BARCODE_UPCE, "1234567+12", "", 50, 1, 78, 184, 116.400002 },
-        /* 46*/ { BARCODE_UPCE_CHK, "12345670+12", "", 50, 1, 78, 184, 116.400002 },
-        /* 47*/ { BARCODE_UPCE, "1234567+12345", "", 50, 1, 105, 238, 116.400002 },
-        /* 48*/ { BARCODE_UPCE_CHK, "12345670+12345", "", 50, 1, 105, 238, 116.400002 },
+        /* 37*/ { BARCODE_UPCA, "12345678901", "", 50, 1, 95, 226, 116.9 },
+        /* 38*/ { BARCODE_UPCA_CHK, "123456789012", "", 50, 1, 95, 226, 116.9 },
+        /* 39*/ { BARCODE_UPCA, "12345678901+12", "", 50, 1, 124, 276, 116.9 },
+        /* 40*/ { BARCODE_UPCA_CHK, "123456789012+12", "", 50, 1, 124, 276, 116.9 },
+        /* 41*/ { BARCODE_UPCA, "12345678901+12345", "", 50, 1, 151, 330, 116.9 },
+        /* 42*/ { BARCODE_UPCA_CHK, "123456789012+12345", "", 50, 1, 151, 330, 116.9 },
+        /* 43*/ { BARCODE_UPCE, "1234567", "", 50, 1, 51, 134, 116.9 },
+        /* 44*/ { BARCODE_UPCE_CHK, "12345670", "", 50, 1, 51, 134, 116.9 },
+        /* 45*/ { BARCODE_UPCE, "1234567+12", "", 50, 1, 78, 184, 116.9 },
+        /* 46*/ { BARCODE_UPCE_CHK, "12345670+12", "", 50, 1, 78, 184, 116.9 },
+        /* 47*/ { BARCODE_UPCE, "1234567+12345", "", 50, 1, 105, 238, 116.9 },
+        /* 48*/ { BARCODE_UPCE_CHK, "12345670+12345", "", 50, 1, 105, 238, 116.9 },
         /* 49*/ { BARCODE_POSTNET, "12345678901", "", 12, 2, 123, 246, 24 },
         /* 50*/ { BARCODE_MSI_PLESSEY, "1234567890", "", 50, 1, 127, 254, 118.900002 },
         /* 51*/ { BARCODE_FIM, "A", "", 50, 1, 17, 34, 100 },
@@ -227,9 +606,9 @@
         /* 63*/ { BARCODE_AUSREPLY, "12345678", "", 8, 3, 73, 146, 16 },
         /* 64*/ { BARCODE_AUSROUTE, "12345678", "", 8, 3, 73, 146, 16 },
         /* 65*/ { BARCODE_AUSREDIRECT, "12345678", "", 8, 3, 73, 146, 16 },
-        /* 66*/ { BARCODE_ISBNX, "123456789", "", 50, 1, 95, 226, 116.400002 },
-        /* 67*/ { BARCODE_ISBNX, "123456789+12", "", 50, 1, 122, 276, 116.400002 },
-        /* 68*/ { BARCODE_ISBNX, "123456789+12345", "", 50, 1, 149, 330, 116.400002 },
+        /* 66*/ { BARCODE_ISBNX, "123456789", "", 50, 1, 95, 226, 116.9 },
+        /* 67*/ { BARCODE_ISBNX, "123456789+12", "", 50, 1, 122, 276, 116.9 },
+        /* 68*/ { BARCODE_ISBNX, "123456789+12345", "", 50, 1, 149, 330, 116.9 },
         /* 69*/ { BARCODE_RM4SCC, "1234567890", "", 8, 3, 91, 182, 16 },
         /* 70*/ { BARCODE_DATAMATRIX, "ABC", "", 10, 10, 10, 20, 20 },
         /* 71*/ { BARCODE_EAN14, "1234567890123", "", 50, 1, 134, 268, 118.900002 },
@@ -267,22 +646,22 @@
         /*103*/ { BARCODE_MAILMARK_4S, "01000000000000000AA00AA0A", "", 10, 3, 155, 310, 20 },
         /*104*/ { BARCODE_AZRUNE, "255", "", 11, 11, 11, 22, 22 },
         /*105*/ { BARCODE_CODE32, "12345678", "", 50, 1, 103, 206, 118.900002 },
-        /*106*/ { BARCODE_EANX_CC, "123456789012", "[20]01", 50, 7, 99, 234, 116.400002 },
-        /*107*/ { BARCODE_EANX_CC, "123456789012+12", "[20]01", 50, 7, 126, 284, 116.400002 },
-        /*108*/ { BARCODE_EANX_CC, "123456789012+12345", "[20]01", 50, 7, 153, 338, 116.400002 },
-        /*109*/ { BARCODE_EANX_CC, "1234567", "[20]01", 50, 8, 72, 172, 116.400002 },
-        /*110*/ { BARCODE_EANX_CC, "1234567+12", "[20]01", 50, 8, 99, 226, 116.400002 },
-        /*111*/ { BARCODE_EANX_CC, "1234567+12345", "[20]01", 50, 8, 126, 280, 116.400002 },
+        /*106*/ { BARCODE_EANX_CC, "123456789012", "[20]01", 50, 7, 99, 234, 116.9 },
+        /*107*/ { BARCODE_EANX_CC, "123456789012+12", "[20]01", 50, 7, 126, 284, 116.9 },
+        /*108*/ { BARCODE_EANX_CC, "123456789012+12345", "[20]01", 50, 7, 153, 338, 116.9 },
+        /*109*/ { BARCODE_EANX_CC, "1234567", "[20]01", 50, 8, 72, 172, 116.9 },
+        /*110*/ { BARCODE_EANX_CC, "1234567+12", "[20]01", 50, 8, 99, 226, 116.9 },
+        /*111*/ { BARCODE_EANX_CC, "1234567+12345", "[20]01", 50, 8, 126, 280, 116.9 },
         /*112*/ { BARCODE_GS1_128_CC, "[01]12345678901231", "[20]01", 50, 5, 145, 290, 118.900002 },
         /*113*/ { BARCODE_DBAR_OMN_CC, "1234567890123", "[20]01", 21, 5, 100, 200, 60.9000015 },
         /*114*/ { BARCODE_DBAR_LTD_CC, "1234567890123", "[20]01", 19, 6, 79, 158, 56.9000015 },
         /*115*/ { BARCODE_DBAR_EXP_CC, "[01]12345678901231", "[20]01", 41, 5, 134, 268, 100.900002 },
-        /*116*/ { BARCODE_UPCA_CC, "12345678901", "[20]01", 50, 7, 99, 234, 116.400002 },
-        /*117*/ { BARCODE_UPCA_CC, "12345678901+12", "[20]01", 50, 7, 128, 284, 116.400002 },
-        /*118*/ { BARCODE_UPCA_CC, "12345678901+12345", "[20]01", 50, 7, 155, 338, 116.400002 },
-        /*119*/ { BARCODE_UPCE_CC, "1234567", "[20]01", 50, 9, 55, 142, 116.400002 },
-        /*120*/ { BARCODE_UPCE_CC, "1234567+12", "[20]01", 50, 9, 82, 192, 116.400002 },
-        /*121*/ { BARCODE_UPCE_CC, "1234567+12345", "[20]01", 50, 9, 109, 246, 116.400002 },
+        /*116*/ { BARCODE_UPCA_CC, "12345678901", "[20]01", 50, 7, 99, 234, 116.9 },
+        /*117*/ { BARCODE_UPCA_CC, "12345678901+12", "[20]01", 50, 7, 128, 284, 116.9 },
+        /*118*/ { BARCODE_UPCA_CC, "12345678901+12345", "[20]01", 50, 7, 155, 338, 116.9 },
+        /*119*/ { BARCODE_UPCE_CC, "1234567", "[20]01", 50, 9, 55, 142, 116.9 },
+        /*120*/ { BARCODE_UPCE_CC, "1234567+12", "[20]01", 50, 9, 82, 192, 116.9 },
+        /*121*/ { BARCODE_UPCE_CC, "1234567+12345", "[20]01", 50, 9, 109, 246, 116.9 },
         /*122*/ { BARCODE_DBAR_STK_CC, "1234567890123", "[20]01", 24, 9, 56, 112, 48 },
         /*123*/ { BARCODE_DBAR_OMNSTK_CC, "1234567890123", "[20]01", 80, 11, 56, 112, 160 },
         /*124*/ { BARCODE_DBAR_EXPSTK_CC, "[01]12345678901231", "[20]01", 78, 9, 102, 204, 156 },
@@ -299,6 +678,7 @@
     struct zint_symbol *symbol;
 
     char *text;
+    char errmsg[128];
 
     testStart("test_buffer_vector");
 
@@ -333,13 +713,19 @@
                     i, testUtilBarcodeName(data[i].symbology), data[i].data, data[i].composite,
                     symbol->height, symbol->rows, symbol->width, symbol->vector->width, symbol->vector->height);
         } else {
-            assert_equal(symbol->height, data[i].expected_height, "i:%d (%s) symbol->height %.8g != %.8g\n", i, testUtilBarcodeName(data[i].symbology), symbol->height, data[i].expected_height);
-            assert_equal(symbol->rows, data[i].expected_rows, "i:%d (%s) symbol->rows %d != %d\n", i, testUtilBarcodeName(data[i].symbology), symbol->rows, data[i].expected_rows);
-            assert_equal(symbol->width, data[i].expected_width, "i:%d (%s) symbol->width %d != %d\n", i, testUtilBarcodeName(data[i].symbology), symbol->width, data[i].expected_width);
+            assert_equal(symbol->height, data[i].expected_height, "i:%d (%s) symbol->height %.8g != %.8g\n",
+                i, testUtilBarcodeName(data[i].symbology), symbol->height, data[i].expected_height);
+            assert_equal(symbol->rows, data[i].expected_rows, "i:%d (%s) symbol->rows %d != %d\n",
+                i, testUtilBarcodeName(data[i].symbology), symbol->rows, data[i].expected_rows);
+            assert_equal(symbol->width, data[i].expected_width, "i:%d (%s) symbol->width %d != %d\n",
+                i, testUtilBarcodeName(data[i].symbology), symbol->width, data[i].expected_width);
             assert_equal(symbol->vector->width, data[i].expected_vector_width, "i:%d (%s) symbol->vector->width %.8g != %.8g\n",
                 i, testUtilBarcodeName(data[i].symbology), symbol->vector->width, data[i].expected_vector_width);
             assert_equal(symbol->vector->height, data[i].expected_vector_height, "i:%d (%s) symbol->vector->height %.8g != %.8g\n",
                 i, testUtilBarcodeName(data[i].symbology), symbol->vector->height, data[i].expected_vector_height);
+
+            assert_nonzero(check_vectors(symbol, errmsg), "i:%d (%s) %s\n",
+                i, testUtilBarcodeName(data[i].symbology), errmsg);
         }
 
         ZBarcode_Delete(symbol);
@@ -348,6 +734,155 @@
     testFinish();
 }
 
+static void test_has_hrt(const testCtx *const p_ctx) {
+    int debug = p_ctx->debug;
+
+    struct item {
+        int symbology;
+        char *data;
+        char *composite;
+    };
+    struct item data[] = {
+        /*  0*/ { BARCODE_CODE11, "1234567890", "" },
+        /*  1*/ { BARCODE_C25STANDARD, "1234567890", "" },
+        /*  2*/ { BARCODE_C25INTER, "1234567890", "" },
+        /*  3*/ { BARCODE_C25IATA, "1234567890", "" },
+        /*  4*/ { BARCODE_C25LOGIC, "1234567890", "" },
+        /*  5*/ { BARCODE_C25IND, "1234567890", "" },
+        /*  6*/ { BARCODE_CODE39, "1234567890", "" },
+        /*  7*/ { BARCODE_EXCODE39, "1234567890", "" },
+        /*  8*/ { BARCODE_EANX, "123456789012", "" },
+        /*  9*/ { BARCODE_EANX_CHK, "1234567890128", "" },
+        /* 10*/ { BARCODE_GS1_128, "[01]12345678901231", "" },
+        /* 11*/ { BARCODE_CODABAR, "A00000000B", "" },
+        /* 12*/ { BARCODE_CODE128, "1234567890", "" },
+        /* 13*/ { BARCODE_DPLEIT, "1234567890123", "" },
+        /* 14*/ { BARCODE_DPIDENT, "12345678901", "" },
+        /* 15*/ { BARCODE_CODE16K, "1234567890", "" },
+        /* 16*/ { BARCODE_CODE49, "1234567890", "" },
+        /* 17*/ { BARCODE_CODE93, "1234567890", "" },
+        /* 18*/ { BARCODE_FLAT, "1234567890", "" },
+        /* 19*/ { BARCODE_DBAR_OMN, "1234567890123", "" },
+        /* 20*/ { BARCODE_DBAR_LTD, "1234567890123", "" },
+        /* 21*/ { BARCODE_DBAR_EXP, "[01]12345678901231", "" },
+        /* 22*/ { BARCODE_TELEPEN, "1234567890", "" },
+        /* 23*/ { BARCODE_UPCA, "12345678901", "" },
+        /* 24*/ { BARCODE_UPCA_CHK, "123456789012", "" },
+        /* 25*/ { BARCODE_UPCE, "1234567", "" },
+        /* 26*/ { BARCODE_UPCE_CHK, "12345670", "" },
+        /* 27*/ { BARCODE_POSTNET, "12345678901", "" },
+        /* 28*/ { BARCODE_MSI_PLESSEY, "1234567890", "" },
+        /* 29*/ { BARCODE_FIM, "A", "" },
+        /* 30*/ { BARCODE_LOGMARS, "1234567890", "" },
+        /* 31*/ { BARCODE_PHARMA, "123456", "" },
+        /* 32*/ { BARCODE_PZN, "123456", "" },
+        /* 33*/ { BARCODE_PHARMA_TWO, "12345678", "" },
+        /* 34*/ { BARCODE_CEPNET, "12345678", "" },
+        /* 35*/ { BARCODE_PDF417, "1234567890", "" },
+        /* 36*/ { BARCODE_PDF417COMP, "1234567890", "" },
+        /* 37*/ { BARCODE_MAXICODE, "1234567890", "" },
+        /* 38*/ { BARCODE_QRCODE, "1234567890AB", "" },
+        /* 39*/ { BARCODE_CODE128AB, "1234567890", "" },
+        /* 40*/ { BARCODE_AUSPOST, "12345678901234567890123", "" },
+        /* 41*/ { BARCODE_AUSREPLY, "12345678", "" },
+        /* 42*/ { BARCODE_AUSROUTE, "12345678", "" },
+        /* 43*/ { BARCODE_AUSREDIRECT, "12345678", "" },
+        /* 44*/ { BARCODE_ISBNX, "123456789", "" },
+        /* 45*/ { BARCODE_RM4SCC, "1234567890", "" },
+        /* 46*/ { BARCODE_DATAMATRIX, "ABC", "" },
+        /* 47*/ { BARCODE_EAN14, "1234567890123", "" },
+        /* 48*/ { BARCODE_VIN, "12345678701234567", "" },
+        /* 49*/ { BARCODE_CODABLOCKF, "1234567890", "" },
+        /* 50*/ { BARCODE_NVE18, "12345678901234567", "" },
+        /* 51*/ { BARCODE_JAPANPOST, "1234567890", "" },
+        /* 52*/ { BARCODE_KOREAPOST, "123456", "" },
+        /* 53*/ { BARCODE_DBAR_STK, "1234567890123", "" },
+        /* 54*/ { BARCODE_DBAR_OMNSTK, "1234567890123", "" },
+        /* 55*/ { BARCODE_DBAR_EXPSTK, "[01]12345678901231", "" },
+        /* 56*/ { BARCODE_PLANET, "12345678901", "" },
+        /* 57*/ { BARCODE_MICROPDF417, "1234567890", "" },
+        /* 58*/ { BARCODE_USPS_IMAIL, "12345678901234567890", "" },
+        /* 59*/ { BARCODE_PLESSEY, "1234567890", "" },
+        /* 60*/ { BARCODE_TELEPEN_NUM, "1234567890", "" },
+        /* 61*/ { BARCODE_ITF14, "1234567890", "" },
+        /* 62*/ { BARCODE_KIX, "123456ABCDE", "" },
+        /* 63*/ { BARCODE_AZTEC, "1234567890AB", "" },
+        /* 64*/ { BARCODE_DAFT, "DAFTDAFTDAFTDAFT", "" },
+        /* 65*/ { BARCODE_DPD, "0123456789012345678901234567", "" },
+        /* 66*/ { BARCODE_MICROQR, "12345", "" },
+        /* 67*/ { BARCODE_HIBC_128, "1234567890", "" },
+        /* 68*/ { BARCODE_HIBC_39, "1234567890", "" },
+        /* 69*/ { BARCODE_HIBC_DM, "ABC", "" },
+        /* 70*/ { BARCODE_HIBC_QR, "1234567890AB", "" },
+        /* 71*/ { BARCODE_HIBC_PDF, "1234567890", "" },
+        /* 72*/ { BARCODE_HIBC_MICPDF, "1234567890", "" },
+        /* 73*/ { BARCODE_HIBC_BLOCKF, "1234567890", "" },
+        /* 74*/ { BARCODE_HIBC_AZTEC, "1234567890AB", "" },
+        /* 75*/ { BARCODE_DOTCODE, "ABC", "" },
+        /* 76*/ { BARCODE_HANXIN, "1234567890AB", "" },
+        /* 77*/ { BARCODE_MAILMARK_2D, "012100123412345678AB19XY1A 0", "" },
+        /* 78*/ { BARCODE_UPU_S10, "EE876543216CA", "" },
+        /* 79*/ { BARCODE_MAILMARK_4S, "01000000000000000AA00AA0A", "" },
+        /* 80*/ { BARCODE_AZRUNE, "255", "" },
+        /* 81*/ { BARCODE_CODE32, "12345678", "" },
+        /* 82*/ { BARCODE_EANX_CC, "123456789012", "[20]01" },
+        /* 83*/ { BARCODE_GS1_128_CC, "[01]12345678901231", "[20]01" },
+        /* 84*/ { BARCODE_DBAR_OMN_CC, "1234567890123", "[20]01" },
+        /* 85*/ { BARCODE_DBAR_LTD_CC, "1234567890123", "[20]01" },
+        /* 86*/ { BARCODE_DBAR_EXP_CC, "[01]12345678901231", "[20]01" },
+        /* 87*/ { BARCODE_UPCA_CC, "12345678901", "[20]01" },
+        /* 88*/ { BARCODE_DBAR_STK_CC, "1234567890123", "[20]01" },
+        /* 89*/ { BARCODE_DBAR_OMNSTK_CC, "1234567890123", "[20]01" },
+        /* 90*/ { BARCODE_DBAR_EXPSTK_CC, "[01]12345678901231", "[20]01" },
+        /* 91*/ { BARCODE_CHANNEL, "01", "" },
+        /* 92*/ { BARCODE_CODEONE, "12345678901234567890", "" },
+        /* 93*/ { BARCODE_GRIDMATRIX, "ABC", "" },
+        /* 94*/ { BARCODE_UPNQR, "1234567890AB", "" },
+        /* 95*/ { BARCODE_ULTRA, "1234567890", "" },
+        /* 96*/ { BARCODE_RMQR, "12345", "" },
+        /* 97*/ { BARCODE_BC412, "1234567", "" },
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, length, ret;
+    struct zint_symbol *symbol;
+
+    char *text;
+    char errmsg[128];
+
+    testStart("test_has_hrt");
+
+    for (i = 0; i < data_size; i++) {
+
+        if (testContinue(p_ctx, i)) continue;
+
+        symbol = ZBarcode_Create();
+        assert_nonnull(symbol, "Symbol not created\n");
+
+        symbol->symbology = data[i].symbology;
+        symbol->input_mode = UNICODE_MODE;
+        symbol->debug |= debug;
+
+        if (strlen(data[i].composite)) {
+            text = data[i].composite;
+            strcpy(symbol->primary, data[i].data);
+        } else {
+            text = data[i].data;
+        }
+        length = (int) strlen(text);
+
+        ret = ZBarcode_Encode_and_Buffer_Vector(symbol, (unsigned char *) text, length, 0);
+        assert_zero(ret, "i:%d ZBarcode_Encode_and_Buffer_Vector(%d) ret %d != 0 %s\n", i, data[i].symbology, ret, symbol->errtxt);
+        assert_nonnull(symbol->vector, "i:%d ZBarcode_Encode_and_Buffer_Vector(%d) vector NULL\n", i, data[i].symbology);
+
+        assert_nonzero(check_vectors(symbol, errmsg), "i:%d ZBarcode_Encode_and_Buffer_Vector(%d) %s\n",
+            i, data[i].symbology, errmsg);
+
+        ZBarcode_Delete(symbol);
+    }
+
+    testFinish();
+}
+
 static void test_upcean_hrt(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
@@ -367,45 +902,45 @@
     };
     /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
     struct item data[] = {
-        /*  0*/ { BARCODE_EANX, -1, "123456789012", 0, 50, 1, 95, 226, 116.4, 12, -1 }, /* EAN-13 */
+        /*  0*/ { BARCODE_EANX, -1, "123456789012", 0, 50, 1, 95, 226, 116.9, 12.2, -1 }, /* EAN-13 */
         /*  1*/ { BARCODE_EANX, 0, "123456789012", 0, 50, 1, 95, 226, 110, -1, -1 }, /* EAN-13 */
-        /*  2*/ { BARCODE_EANX_CHK, -1, "1234567890128", 0, 50, 1, 95, 226, 116.4, 12, -1 }, /* EAN-13 */
+        /*  2*/ { BARCODE_EANX_CHK, -1, "1234567890128", 0, 50, 1, 95, 226, 116.9, 12.2, -1 }, /* EAN-13 */
         /*  3*/ { BARCODE_EANX_CHK, 0, "1234567890128", 0, 50, 1, 95, 226, 110, -1, -1 }, /* EAN-13 */
-        /*  4*/ { BARCODE_ISBNX, -1, "9784567890120", 0, 50, 1, 95, 226, 116.4, 12, -1 },
+        /*  4*/ { BARCODE_ISBNX, -1, "9784567890120", 0, 50, 1, 95, 226, 116.9, 12.2, -1 },
         /*  5*/ { BARCODE_ISBNX, 0, "9784567890120", 0, 50, 1, 95, 226, 110, -1, -1 },
-        /*  6*/ { BARCODE_EANX, -1, "1234567", 0, 50, 1, 67, 162, 116.4, 48, -1 }, /* EAN-8 */
+        /*  6*/ { BARCODE_EANX, -1, "1234567", 0, 50, 1, 67, 162, 116.9, 49, -1 }, /* EAN-8 */
         /*  7*/ { BARCODE_EANX, 0, "1234567", 0, 50, 1, 67, 162, 110, -1, -1 }, /* EAN-8 */
-        /*  8*/ { BARCODE_EANX, -1, "1234", 0, 50, 1, 47, 118, 116.4, 61, -1 }, /* EAN-5 */
+        /*  8*/ { BARCODE_EANX, -1, "1234", 0, 50, 1, 47, 118, 116.9, 61, -1 }, /* EAN-5 */
         /*  9*/ { BARCODE_EANX, 0, "1234", 0, 50, 1, 47, 118, 100, -1, -1 }, /* EAN-5 */
-        /* 10*/ { BARCODE_EANX, -1, "12", 0, 50, 1, 20, 64, 116.4, 34, -1 }, /* EAN-2 */
+        /* 10*/ { BARCODE_EANX, -1, "12", 0, 50, 1, 20, 64, 116.9, 34, -1 }, /* EAN-2 */
         /* 11*/ { BARCODE_EANX, 0, "12", 0, 50, 1, 20, 64, 100, -1, -1 }, /* EAN-2 */
-        /* 12*/ { BARCODE_UPCA, -1, "12345678901", 0, 50, 1, 95, 226, 116.4, 8, -1 },
+        /* 12*/ { BARCODE_UPCA, -1, "12345678901", 0, 50, 1, 95, 226, 116.9, 8.7, -1 },
         /* 13*/ { BARCODE_UPCA, 0, "12345678901", 0, 50, 1, 95, 226, 110, -1, -1 },
-        /* 14*/ { BARCODE_UPCA_CHK, -1, "123456789012", 0, 50, 1, 95, 226, 116.4, 8, -1 },
+        /* 14*/ { BARCODE_UPCA_CHK, -1, "123456789012", 0, 50, 1, 95, 226, 116.9, 8.7, -1 },
         /* 15*/ { BARCODE_UPCA_CHK, 0, "123456789012", 0, 50, 1, 95, 226, 110, -1, -1 },
-        /* 16*/ { BARCODE_UPCE, -1, "1234567", 0, 50, 1, 51, 134, 116.4, 8, -1 },
+        /* 16*/ { BARCODE_UPCE, -1, "1234567", 0, 50, 1, 51, 134, 116.9, 8.7, -1 },
         /* 17*/ { BARCODE_UPCE, 0, "1234567", 0, 50, 1, 51, 134, 110, -1, -1 },
-        /* 18*/ { BARCODE_UPCE_CHK, -1, "12345670", 0, 50, 1, 51, 134, 116.4, 8, -1 },
+        /* 18*/ { BARCODE_UPCE_CHK, -1, "12345670", 0, 50, 1, 51, 134, 116.9, 8.7, -1 },
         /* 19*/ { BARCODE_UPCE_CHK, 0, "12345670", 0, 50, 1, 51, 134, 110, -1, -1 },
-        /* 20*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276.0, 116.4, 12, 70 }, /* EAN-13 + EAN-2 */
+        /* 20*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276.0, 116.9, 12.2, 71 }, /* EAN-13 + EAN-2 */
         /* 21*/ { BARCODE_EANX, 0, "123456789012+12", 0, 50, 1, 122, 276.0, 110, -1, -1 }, /* EAN-13 + EAN-2 */
-        /* 22*/ { BARCODE_ISBNX, -1, "9784567890120+12", 0, 50, 1, 122, 276.0, 116.4, 12, 70 }, /* ISBN + EAN-2 */
+        /* 22*/ { BARCODE_ISBNX, -1, "9784567890120+12", 0, 50, 1, 122, 276.0, 116.9, 12.2, 71 }, /* ISBN + EAN-2 */
         /* 23*/ { BARCODE_ISBNX, 0, "9784567890120+12", 0, 50, 1, 122, 276.0, 110, -1, -1 }, /* ISBN + EAN-2 */
-        /* 24*/ { BARCODE_EANX, -1, "123456789012+12345", 0, 50, 1, 149, 330.0, 116.4, 12, 70 }, /* EAN-13 + EAN-5 */
+        /* 24*/ { BARCODE_EANX, -1, "123456789012+12345", 0, 50, 1, 149, 330.0, 116.9, 12.2, 71 }, /* EAN-13 + EAN-5 */
         /* 25*/ { BARCODE_EANX, 0, "123456789012+12345", 0, 50, 1, 149, 330.0, 110, -1, -1 }, /* EAN-13 + EAN-5 */
-        /* 26*/ { BARCODE_ISBNX, -1, "9784567890120+12345", 0, 50, 1, 149, 330.0, 116.4, 12, 70 }, /* ISBN + EAN-5 */
+        /* 26*/ { BARCODE_ISBNX, -1, "9784567890120+12345", 0, 50, 1, 149, 330.0, 116.9, 12.2, 71 }, /* ISBN + EAN-5 */
         /* 27*/ { BARCODE_ISBNX, 0, "9784567890120+12345", 0, 50, 1, 149, 330.0, 110, -1, -1 }, /* ISBN + EAN-5 */
-        /* 28*/ { BARCODE_EANX, -1, "1234567+12", 0, 50, 1, 94, 216.0, 116.4, 48, 114 }, /* EAN-8 + EAN-2 */
+        /* 28*/ { BARCODE_EANX, -1, "1234567+12", 0, 50, 1, 94, 216.0, 116.9, 49, 113 }, /* EAN-8 + EAN-2 */
         /* 29*/ { BARCODE_EANX, 0, "1234567+12", 0, 50, 1, 94, 216.0, 110, -1, -1 }, /* EAN-8 + EAN-2 */
-        /* 30*/ { BARCODE_EANX, -1, "1234567+12345", 0, 50, 1, 121, 270.0, 116.4, 48, 114 }, /* EAN-8 + EAN-5 */
+        /* 30*/ { BARCODE_EANX, -1, "1234567+12345", 0, 50, 1, 121, 270.0, 116.9, 49, 113 }, /* EAN-8 + EAN-5 */
         /* 31*/ { BARCODE_EANX, 0, "1234567+12345", 0, 50, 1, 121, 270.0, 110, -1, -1 }, /* EAN-8 + EAN-5 */
-        /* 32*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.4, 8, 72 },
+        /* 32*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.9, 8.7, 74 },
         /* 33*/ { BARCODE_UPCA, 0, "12345678901+12", 0, 50, 1, 124, 276, 110, -1, -1 },
-        /* 34*/ { BARCODE_UPCA, -1, "12345678901+12345", 0, 50, 1, 151, 330, 116.4, 8, 72 },
+        /* 34*/ { BARCODE_UPCA, -1, "12345678901+12345", 0, 50, 1, 151, 330, 116.9, 8.7, 74 },
         /* 35*/ { BARCODE_UPCA, 0, "12345678901+12345", 0, 50, 1, 151, 330, 110, -1, -1 },
-        /* 36*/ { BARCODE_UPCE, -1, "1234567+12", 0, 50, 1, 78, 184.0, 116.4, 8, 66 },
+        /* 36*/ { BARCODE_UPCE, -1, "1234567+12", 0, 50, 1, 78, 184.0, 116.9, 8.7, 67 },
         /* 37*/ { BARCODE_UPCE, 0, "1234567+12", 0, 50, 1, 78, 184.0, 110, -1, -1 },
-        /* 38*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238.0, 116.4, 8, 66 },
+        /* 38*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238.0, 116.9, 8.7, 67 },
         /* 39*/ { BARCODE_UPCE, 0, "1234567+12345", 0, 50, 1, 105, 238.0, 110, -1, -1 },
     };
     int data_size = ARRAY_SIZE(data);
@@ -921,9 +1456,9 @@
         /*  1*/ { BARCODE_PDF417, -1, -1, -1, 0, 0.1, "1", "", 0, 15, 5, 103, 206 * 0.1, 3, 1, 5.2000003, 0, 8 * 0.1, 6 * 0.1 },
         /*  2*/ { BARCODE_PDF417, -1, -1, -1, 0, 0.3, "1", "", 0, 15, 5, 103, 61.8000031, 30 * 0.3, 1, 52 * 0.3, 0, 2.4000001, 1.8000001 },
         /*  3*/ { BARCODE_PDF417, -1, -1, -1, 0, 0.6, "1", "", 0, 15, 5, 103, 123.600006, 30 * 0.6, 1, 52 * 0.6, 0, 4.8000002, 3.6000001 },
-        /*  4*/ { BARCODE_UPCE_CC, -1, -1, -1, 0, 0, "1234567", "[17]010615[10]A123456\"", 0, 50, 10, 55, 142, 116.400002, 1, 34, 36, 2, 64 }, /* With no scaling */
-        /*  5*/ { BARCODE_UPCE_CC, -1, -1, -1, 0, 0.1, "1234567", "[17]010615[10]A123456\"", 0, 50, 10, 55, 142 * 0.1, 11.6400003, 1, 34 * 0.1, 3.6000001, 2 * 0.1, 64 * 0.1 },
-        /*  6*/ { BARCODE_UPCE_CC, -1, -1, -1, 0.1, 0.1, "1234567", "[17]010615[10]A123456\"", 0, 18.5, 10, 55, 142 * 0.1, 5.34000015, 1, 34 * 0.1, 3.6000001, 2 * 0.1, 0.1 }, /* Height specified */
+        /*  4*/ { BARCODE_UPCE_CC, -1, -1, -1, 0, 0, "1234567", "[17]010615[10]A123456\"", 0, 50, 10, 55, 142, 116.9, 1, 34, 36, 2, 64 }, /* With no scaling */
+        /*  5*/ { BARCODE_UPCE_CC, -1, -1, -1, 0, 0.1, "1234567", "[17]010615[10]A123456\"", 0, 50, 10, 55, 142 * 0.1, 11.6900005, 1, 34 * 0.1, 3.6000001, 2 * 0.1, 64 * 0.1 },
+        /*  6*/ { BARCODE_UPCE_CC, -1, -1, -1, 0.1, 0.1, "1234567", "[17]010615[10]A123456\"", 0, 18.5, 10, 55, 142 * 0.1, 5.39000034, 1, 34 * 0.1, 3.6000001, 2 * 0.1, 0.1 }, /* Height specified */
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -1018,40 +1553,40 @@
     };
     /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
     struct item data[] = {
-        /*  0*/ { BARCODE_UPCE, -1, "1234567", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 110 },
-        /*  1*/ { BARCODE_UPCE, 0, "1234567", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 100 },
-        /*  2*/ { BARCODE_UPCE, 3, "1234567", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 106 },
-        /*  3*/ { BARCODE_UPCE, 8, "1234567", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 116 },
-        /*  4*/ { BARCODE_UPCE, 8.2, "1234567", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 116.4 },
-        /*  5*/ { BARCODE_UPCE, 8.25, "1234567", 0, 50, 1, 51, 134, 116.5, 18, 0, 2, 116.5 },
-        /*  6*/ { BARCODE_UPCE, 8.3, "1234567", 0, 50, 1, 51, 134, 116.6, 18, 0, 2, 116.6 },
+        /*  0*/ { BARCODE_UPCE, -1, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 110 },
+        /*  1*/ { BARCODE_UPCE, 0, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 100 },
+        /*  2*/ { BARCODE_UPCE, 3, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 106 },
+        /*  3*/ { BARCODE_UPCE, 8, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 116 },
+        /*  4*/ { BARCODE_UPCE, 8.2, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 116.4 },
+        /*  5*/ { BARCODE_UPCE, 8.25, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 116.5 },
+        /*  6*/ { BARCODE_UPCE, 8.3, "1234567", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 116.6 },
         /*  7*/ { BARCODE_UPCE, 19.6, "1234567", 0, 50, 1, 51, 134, 139.2, 18, 0, 2, 139.2 },
-        /*  8*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 118, 0, 2, 110 },
-        /*  9*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 134, 19, 2, 81 },
-        /* 10*/ { BARCODE_UPCE, 0, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 118, 0, 2, 100 },
-        /* 11*/ { BARCODE_UPCE, 0, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 134, 19, 2, 81 },
-        /* 12*/ { BARCODE_UPCE, 4, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 118, 0, 2, 108 },
-        /* 13*/ { BARCODE_UPCE, 4, "1234567+12345", 0, 50, 1, 105, 238, 116.4, 134, 19, 2, 81 },
-        /* 14*/ { BARCODE_UPCA, -1, "12345678901", 0, 50, 1, 95, 226, 116.4, 188, 0, 4, 110 },
-        /* 15*/ { BARCODE_UPCA, 0, "12345678901", 0, 50, 1, 95, 226, 116.4, 188, 0, 4, 100 },
-        /* 16*/ { BARCODE_UPCA, 6, "12345678901", 0, 50, 1, 95, 226, 116.4, 188, 0, 4, 112 },
-        /* 17*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.4, 188, 0, 4, 110 },
-        /* 18*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.4, 262, 19, 4, 81 },
-        /* 19*/ { BARCODE_UPCA, 0, "12345678901+12", 0, 50, 1, 124, 276, 116.4, 188, 0, 4, 100 },
-        /* 20*/ { BARCODE_UPCA, 0, "12345678901+12", 0, 50, 1, 124, 276, 116.4, 262, 19, 4, 81 },
+        /*  8*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 118, 0, 2, 110 },
+        /*  9*/ { BARCODE_UPCE, -1, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 134, 16.9, 2, 83.1 },
+        /* 10*/ { BARCODE_UPCE, 0, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 118, 0, 2, 100 },
+        /* 11*/ { BARCODE_UPCE, 0, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 134, 16.9, 2, 83.1 },
+        /* 12*/ { BARCODE_UPCE, 4, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 118, 0, 2, 108 },
+        /* 13*/ { BARCODE_UPCE, 4, "1234567+12345", 0, 50, 1, 105, 238, 116.9, 134, 16.9, 2, 83.1 },
+        /* 14*/ { BARCODE_UPCA, -1, "12345678901", 0, 50, 1, 95, 226, 116.9, 188, 0, 4, 110 },
+        /* 15*/ { BARCODE_UPCA, 0, "12345678901", 0, 50, 1, 95, 226, 116.9, 188, 0, 4, 100 },
+        /* 16*/ { BARCODE_UPCA, 6, "12345678901", 0, 50, 1, 95, 226, 116.9, 188, 0, 4, 112 },
+        /* 17*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.9, 188, 0, 4, 110 },
+        /* 18*/ { BARCODE_UPCA, -1, "12345678901+12", 0, 50, 1, 124, 276, 116.9, 262, 16.9, 4, 83.1 },
+        /* 19*/ { BARCODE_UPCA, 0, "12345678901+12", 0, 50, 1, 124, 276, 116.9, 188, 0, 4, 100 },
+        /* 20*/ { BARCODE_UPCA, 0, "12345678901+12", 0, 50, 1, 124, 276, 116.9, 262, 16.9, 4, 83.1 },
         /* 21*/ { BARCODE_UPCA, 9, "12345678901+12", 0, 50, 1, 124, 276, 118, 188, 0, 4, 118 },
-        /* 22*/ { BARCODE_UPCA, 9, "12345678901+12", 0, 50, 1, 124, 276, 118, 262, 19, 4, 81 },
-        /* 23*/ { BARCODE_EANX, -1, "123456789012", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /* 24*/ { BARCODE_EANX, 0, "123456789012", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 100 },
-        /* 25*/ { BARCODE_EANX, 7, "123456789012", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 114 },
-        /* 26*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276, 116.4, 22, 0, 2, 110 },
-        /* 27*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276, 116.4, 262, 19, 4, 91 },
-        /* 28*/ { BARCODE_EANX, 0, "123456789012+12", 0, 50, 1, 122, 276, 116.4, 22, 0, 2, 100 },
-        /* 29*/ { BARCODE_EANX, 0, "123456789012+12", 0, 50, 1, 122, 276, 116.4, 262, 19, 4, 81 },
-        /* 30*/ { BARCODE_EANX, 8.21, "123456789012+12", 0, 50, 1, 122, 276, 116.42, 22, 0, 2, 116.42 },
-        /* 31*/ { BARCODE_EANX, 8.21, "123456789012+12", 0, 50, 1, 122, 276, 116.42, 262, 19, 4, 97.42 },
-        /* 32*/ { BARCODE_ISBNX, -1, "123456789", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /* 33*/ { BARCODE_ISBNX, 0, "123456789", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 100 },
+        /* 22*/ { BARCODE_UPCA, 9, "12345678901+12", 0, 50, 1, 124, 276, 118, 262, 16.9, 4, 83.1 },
+        /* 23*/ { BARCODE_EANX, -1, "123456789012", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /* 24*/ { BARCODE_EANX, 0, "123456789012", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 100 },
+        /* 25*/ { BARCODE_EANX, 7, "123456789012", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 114 },
+        /* 26*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 22, 0, 2, 110 },
+        /* 27*/ { BARCODE_EANX, -1, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 262, 16.9, 4, 93.1 },
+        /* 28*/ { BARCODE_EANX, 0, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 22, 0, 2, 100 },
+        /* 29*/ { BARCODE_EANX, 0, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 262, 16.9, 4, 83.1 },
+        /* 30*/ { BARCODE_EANX, 8.21, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 22, 0, 2, 116.42 },
+        /* 31*/ { BARCODE_EANX, 8.21, "123456789012+12", 0, 50, 1, 122, 276, 116.9, 262, 16.9, 4, 99.52 },
+        /* 32*/ { BARCODE_ISBNX, -1, "123456789", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /* 33*/ { BARCODE_ISBNX, 0, "123456789", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 100 },
     };
     int data_size = ARRAY_SIZE(data);
     int i, length, ret;
@@ -1147,30 +1682,30 @@
         /* 14*/ { BARCODE_CODE39, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 50, 1, 77, 194, 118.9, 20, 0, 2, 100 },
         /* 15*/ { BARCODE_EXCODE39, -1, -1, -1, "1234", 0, 50, 1, 77, 154, 118.9, 0, 0, 2, 100 },
         /* 16*/ { BARCODE_EXCODE39, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 50, 1, 77, 194, 118.9, 20, 0, 2, 100 },
-        /* 17*/ { BARCODE_EANX, -1, -1, -1, "023456789012", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /* 18*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /* 19*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 1, 95, 212, 116.4, 22, 0, 2, 110 },
+        /* 17*/ { BARCODE_EANX, -1, -1, -1, "023456789012", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /* 18*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /* 19*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 1, 95, 212, 116.9, 22, 0, 2, 110 },
         /* 20*/ { BARCODE_EANX, -1, -1, 0, "023456789012", 0, 50, 1, 95, 226, 110, 22, 0, 2, 110 }, /* Hide text */
         /* 21*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, 0, "023456789012", 0, 50, 1, 95, 226, 110, 22, 0, 2, 110 }, /* Hide text */
         /* 22*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, 0, "023456789012", 0, 50, 1, 95, 190, 110, 0, 0, 2, 110 }, /* Hide text */
-        /* 23*/ { BARCODE_EANX, -1, -1, -1, "023456789012+12", 0, 50, 1, 122, 276, 116.4, 262, 19, 4, 91 },
-        /* 24*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "023456789012+12", 0, 50, 1, 122, 276, 116.4, 262, 19, 4, 91 },
-        /* 25*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012+12", 0, 50, 1, 122, 266, 116.4, 262, 19, 4, 91 },
-        /* 26*/ { BARCODE_EANX, -1, -1, 0, "023456789012+12", 0, 50, 1, 122, 276, 110, 262, 19, 4, 91 }, /* Hide text */
-        /* 27*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, 0, "023456789012+12", 0, 50, 1, 122, 276, 110, 262, 19, 4, 91 }, /* Hide text */
-        /* 28*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, 0, "023456789012+12", 0, 50, 1, 122, 244, 110, 240, 19, 4, 91 }, /* Hide text */
-        /* 29*/ { BARCODE_EANX_CHK, -1, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 330, 116.4, 318, 19, 2, 91 },
-        /* 30*/ { BARCODE_EANX_CHK, BARCODE_QUIET_ZONES, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 330, 116.4, 318, 19, 2, 91 },
-        /* 31*/ { BARCODE_EANX_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 320, 116.4, 318, 19, 2, 91 },
-        /* 32*/ { BARCODE_EANX, -1, -1, -1, "0234567", 0, 50, 1, 67, 162, 116.4, 14, 0, 2, 110 }, /* EAN-8 */
-        /* 33*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "0234567", 0, 50, 1, 67, 162, 116.4, 14, 0, 2, 110 }, /* EAN-8 */
-        /* 34*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "0234567", 0, 50, 1, 67, 134, 116.4, 0, 0, 2, 110 }, /* EAN-8 */
-        /* 35*/ { BARCODE_EANX, -1, -1, -1, "02345", 0, 50, 1, 47, 118, 116.4, 14, 0, 2, 100 }, /* EAN-5 */
-        /* 36*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "02345", 0, 50, 1, 47, 118, 116.4, 14, 0, 2, 100 }, /* EAN-5 */
-        /* 37*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "02345", 0, 50, 1, 47, 94, 116.4, 0, 0, 2, 100 }, /* EAN-5 */
-        /* 38*/ { BARCODE_EANX, -1, -1, -1, "02", 0, 50, 1, 20, 64, 116.4, 14, 0, 2, 100 }, /* EAN-2 */
-        /* 39*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "02", 0, 50, 1, 20, 64, 116.4, 14, 0, 2, 100 }, /* EAN-2 */
-        /* 40*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "02", 0, 50, 1, 20, 40, 116.4, 0, 0, 2, 100 }, /* EAN-2 */
+        /* 23*/ { BARCODE_EANX, -1, -1, -1, "023456789012+12", 0, 50, 1, 122, 276, 116.9, 262, 16.9, 4, 93.1 },
+        /* 24*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "023456789012+12", 0, 50, 1, 122, 276, 116.9, 262, 16.9, 4, 93.1 },
+        /* 25*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012+12", 0, 50, 1, 122, 266, 116.9, 262, 16.9, 4, 93.1 },
+        /* 26*/ { BARCODE_EANX, -1, -1, 0, "023456789012+12", 0, 50, 1, 122, 276, 110, 262, 16.9, 4, 93.1 }, /* Hide text */
+        /* 27*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, 0, "023456789012+12", 0, 50, 1, 122, 276, 110, 262, 16.9, 4, 93.1 }, /* Hide text */
+        /* 28*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, 0, "023456789012+12", 0, 50, 1, 122, 244, 110, 240, 16.9, 4, 93.1 }, /* Hide text */
+        /* 29*/ { BARCODE_EANX_CHK, -1, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 330, 116.9, 318, 16.9, 2, 93.1 },
+        /* 30*/ { BARCODE_EANX_CHK, BARCODE_QUIET_ZONES, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 330, 116.9, 318, 16.9, 2, 93.1 },
+        /* 31*/ { BARCODE_EANX_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "0234567890129+12345", 0, 50, 1, 149, 320, 116.9, 318, 16.9, 2, 93.1 },
+        /* 32*/ { BARCODE_EANX, -1, -1, -1, "0234567", 0, 50, 1, 67, 162, 116.9, 14, 0, 2, 110 }, /* EAN-8 */
+        /* 33*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "0234567", 0, 50, 1, 67, 162, 116.9, 14, 0, 2, 110 }, /* EAN-8 */
+        /* 34*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "0234567", 0, 50, 1, 67, 134, 116.9, 0, 0, 2, 110 }, /* EAN-8 */
+        /* 35*/ { BARCODE_EANX, -1, -1, -1, "02345", 0, 50, 1, 47, 118, 116.9, 14, 0, 2, 100 }, /* EAN-5 */
+        /* 36*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "02345", 0, 50, 1, 47, 118, 116.9, 14, 0, 2, 100 }, /* EAN-5 */
+        /* 37*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "02345", 0, 50, 1, 47, 94, 116.9, 0, 0, 2, 100 }, /* EAN-5 */
+        /* 38*/ { BARCODE_EANX, -1, -1, -1, "02", 0, 50, 1, 20, 64, 116.9, 14, 0, 2, 100 }, /* EAN-2 */
+        /* 39*/ { BARCODE_EANX, BARCODE_QUIET_ZONES, -1, -1, "02", 0, 50, 1, 20, 64, 116.9, 14, 0, 2, 100 }, /* EAN-2 */
+        /* 40*/ { BARCODE_EANX, BARCODE_NO_QUIET_ZONES, -1, -1, "02", 0, 50, 1, 20, 40, 116.9, 0, 0, 2, 100 }, /* EAN-2 */
         /* 41*/ { BARCODE_GS1_128, -1, -1, -1, "[20]02", 0, 50, 1, 68, 136, 118.9, 0, 0, 4, 100 },
         /* 42*/ { BARCODE_GS1_128, BARCODE_QUIET_ZONES, -1, -1, "[20]02", 0, 50, 1, 68, 176, 118.9, 20, 0, 4, 100 },
         /* 43*/ { BARCODE_CODABAR, -1, -1, -1, "A0B", 0, 50, 1, 32, 64, 118.9, 0, 0, 2, 100 },
@@ -1203,42 +1738,42 @@
         /* 70*/ { BARCODE_DBAR_EXP, BARCODE_NO_QUIET_ZONES, -1, -1, "[20]02", 0, 34, 1, 102, 204, 86.900002, 2, 0, 2, 68 },
         /* 71*/ { BARCODE_TELEPEN, -1, -1, -1, "1234", 0, 50, 1, 112, 224, 118.9, 0, 0, 2, 100 },
         /* 72*/ { BARCODE_TELEPEN, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 50, 1, 112, 264, 118.9, 20, 0, 2, 100 },
-        /* 73*/ { BARCODE_UPCA, -1, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.4, 18, 0, 2, 110 },
-        /* 74*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.4, 18, 0, 2, 110 },
-        /* 75*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.4, 18, 0, 2, 110 },
+        /* 73*/ { BARCODE_UPCA, -1, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.9, 18, 0, 2, 110 },
+        /* 74*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.9, 18, 0, 2, 110 },
+        /* 75*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 1, 95, 226, 116.9, 18, 0, 2, 110 },
         /* 76*/ { BARCODE_UPCA, -1, -1, 0, "01457137763", 0, 50, 1, 95, 226, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 77*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, 0, "01457137763", 0, 50, 1, 95, 226, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 78*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, 0, "01457137763", 0, 50, 1, 95, 190, 110, 0, 0, 2, 110 }, /* Hide text */
-        /* 79*/ { BARCODE_UPCA, -1, -1, -1, "01457137763+12", 0, 50, 1, 124, 276, 116.4, 18, 0, 2, 110 },
-        /* 80*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, -1, "01457137763+12", 0, 50, 1, 124, 276, 116.4, 18, 0, 2, 110 },
-        /* 81*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763+12", 0, 50, 1, 124, 266, 116.4, 18, 0, 2, 110 },
+        /* 79*/ { BARCODE_UPCA, -1, -1, -1, "01457137763+12", 0, 50, 1, 124, 276, 116.9, 18, 0, 2, 110 },
+        /* 80*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, -1, "01457137763+12", 0, 50, 1, 124, 276, 116.9, 18, 0, 2, 110 },
+        /* 81*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763+12", 0, 50, 1, 124, 266, 116.9, 18, 0, 2, 110 },
         /* 82*/ { BARCODE_UPCA, -1, -1, 0, "01457137763+12", 0, 50, 1, 124, 276, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 83*/ { BARCODE_UPCA, BARCODE_QUIET_ZONES, -1, 0, "01457137763+12", 0, 50, 1, 124, 276, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 84*/ { BARCODE_UPCA, BARCODE_NO_QUIET_ZONES, -1, 0, "01457137763+12", 0, 50, 1, 124, 248, 110, 0, 0, 2, 110 }, /* Hide text */
-        /* 85*/ { BARCODE_UPCA_CHK, -1, -1, -1, "014571377638+12345", 0, 50, 1, 151, 330, 116.4, 18, 0, 2, 110 },
-        /* 86*/ { BARCODE_UPCA_CHK, BARCODE_QUIET_ZONES, -1, -1, "014571377638+12345", 0, 50, 1, 151, 330, 116.4, 18, 0, 2, 110 },
-        /* 87*/ { BARCODE_UPCA_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "014571377638+12345", 0, 50, 1, 151, 320, 116.4, 18, 0, 2, 110 },
+        /* 85*/ { BARCODE_UPCA_CHK, -1, -1, -1, "014571377638+12345", 0, 50, 1, 151, 330, 116.9, 18, 0, 2, 110 },
+        /* 86*/ { BARCODE_UPCA_CHK, BARCODE_QUIET_ZONES, -1, -1, "014571377638+12345", 0, 50, 1, 151, 330, 116.9, 18, 0, 2, 110 },
+        /* 87*/ { BARCODE_UPCA_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "014571377638+12345", 0, 50, 1, 151, 320, 116.9, 18, 0, 2, 110 },
         /* 88*/ { BARCODE_UPCA_CHK, -1, -1, 0, "014571377638+12345", 0, 50, 1, 151, 330, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 89*/ { BARCODE_UPCA_CHK, BARCODE_QUIET_ZONES, -1, 0, "014571377638+12345", 0, 50, 1, 151, 330, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 90*/ { BARCODE_UPCA_CHK, BARCODE_NO_QUIET_ZONES, -1, 0, "014571377638+12345", 0, 50, 1, 151, 302, 110, 0, 0, 2, 110 }, /* Hide text */
-        /* 91*/ { BARCODE_UPCE, -1, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 110 },
-        /* 92*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 110 },
-        /* 93*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.4, 18, 0, 2, 110 },
+        /* 91*/ { BARCODE_UPCE, -1, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 110 },
+        /* 92*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 110 },
+        /* 93*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713", 0, 50, 1, 51, 134, 116.9, 18, 0, 2, 110 },
         /* 94*/ { BARCODE_UPCE, -1, -1, 0, "8145713", 0, 50, 1, 51, 134, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 95*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, 0, "8145713", 0, 50, 1, 51, 134, 110, 18, 0, 2, 110 }, /* Hide text */
         /* 96*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, 0, "8145713", 0, 50, 1, 51, 102, 110, 0, 0, 2, 110 }, /* Hide text */
-        /* 97*/ { BARCODE_UPCE_CHK, -1, -1, -1, "81457132+12", 0, 50, 1, 78, 184, 116.4, 170, 19, 4, 81 },
-        /* 98*/ { BARCODE_UPCE_CHK, BARCODE_QUIET_ZONES, -1, -1, "81457132+12", 0, 50, 1, 78, 184, 116.4, 170, 19, 4, 81 },
-        /* 99*/ { BARCODE_UPCE_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "81457132+12", 0, 50, 1, 78, 174, 116.4, 170, 19, 4, 81 },
-        /*100*/ { BARCODE_UPCE_CHK, -1, -1, 0, "81457132+12", 0, 50, 1, 78, 184, 110, 170, 19, 4, 81 }, /* Hide text */
-        /*101*/ { BARCODE_UPCE_CHK, BARCODE_QUIET_ZONES, -1, 0, "81457132+12", 0, 50, 1, 78, 184, 110, 170, 19, 4, 81 }, /* Hide text */
-        /*102*/ { BARCODE_UPCE_CHK, BARCODE_NO_QUIET_ZONES, -1, 0, "81457132+12", 0, 50, 1, 78, 156, 110, 152, 19, 4, 81 }, /* Hide text */
-        /*103*/ { BARCODE_UPCE, -1, -1, -1, "8145713+12345", 0, 50, 1, 105, 238, 116.4, 226, 19, 2, 81 },
-        /*104*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, -1, "8145713+12345", 0, 50, 1, 105, 238, 116.4, 226, 19, 2, 81 },
-        /*105*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713+12345", 0, 50, 1, 105, 228, 116.4, 226, 19, 2, 81 },
-        /*106*/ { BARCODE_UPCE, -1, -1, 0, "8145713+12345", 0, 50, 1, 105, 238, 110, 226, 19, 2, 81 }, /* Hide text */
-        /*107*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, 0, "8145713+12345", 0, 50, 1, 105, 238, 110, 226, 19, 2, 81 }, /* Hide text */
-        /*108*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, 0, "8145713+12345", 0, 50, 1, 105, 210, 110, 208, 19, 2, 81 }, /* Hide text */
+        /* 97*/ { BARCODE_UPCE_CHK, -1, -1, -1, "81457132+12", 0, 50, 1, 78, 184, 116.9, 170, 16.9, 4, 83.1 },
+        /* 98*/ { BARCODE_UPCE_CHK, BARCODE_QUIET_ZONES, -1, -1, "81457132+12", 0, 50, 1, 78, 184, 116.9, 170, 16.9, 4, 83.1 },
+        /* 99*/ { BARCODE_UPCE_CHK, BARCODE_NO_QUIET_ZONES, -1, -1, "81457132+12", 0, 50, 1, 78, 174, 116.9, 170, 16.9, 4, 83.1 },
+        /*100*/ { BARCODE_UPCE_CHK, -1, -1, 0, "81457132+12", 0, 50, 1, 78, 184, 110, 170, 16.9, 4, 83.1 }, /* Hide text */
+        /*101*/ { BARCODE_UPCE_CHK, BARCODE_QUIET_ZONES, -1, 0, "81457132+12", 0, 50, 1, 78, 184, 110, 170, 16.9, 4, 83.1 }, /* Hide text */
+        /*102*/ { BARCODE_UPCE_CHK, BARCODE_NO_QUIET_ZONES, -1, 0, "81457132+12", 0, 50, 1, 78, 156, 110, 152, 16.9, 4, 83.1 }, /* Hide text */
+        /*103*/ { BARCODE_UPCE, -1, -1, -1, "8145713+12345", 0, 50, 1, 105, 238, 116.9, 226, 16.9, 2, 83.1 },
+        /*104*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, -1, "8145713+12345", 0, 50, 1, 105, 238, 116.9, 226, 16.9, 2, 83.1 },
+        /*105*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713+12345", 0, 50, 1, 105, 228, 116.9, 226, 16.9, 2, 83.1 },
+        /*106*/ { BARCODE_UPCE, -1, -1, 0, "8145713+12345", 0, 50, 1, 105, 238, 110, 226, 16.9, 2, 83.1 }, /* Hide text */
+        /*107*/ { BARCODE_UPCE, BARCODE_QUIET_ZONES, -1, 0, "8145713+12345", 0, 50, 1, 105, 238, 110, 226, 16.9, 2, 83.1 }, /* Hide text */
+        /*108*/ { BARCODE_UPCE, BARCODE_NO_QUIET_ZONES, -1, 0, "8145713+12345", 0, 50, 1, 105, 210, 110, 208, 16.9, 2, 83.1 }, /* Hide text */
         /*109*/ { BARCODE_POSTNET, -1, -1, -1, "12345", 0, 12, 2, 63, 126, 24, 0, 0, 2, 24 },
         /*110*/ { BARCODE_POSTNET, BARCODE_QUIET_ZONES, -1, -1, "12345", 0, 12, 2, 63, 146, 30.4, 10, 3.2, 2, 24 },
         /*111*/ { BARCODE_MSI_PLESSEY, -1, -1, -1, "1234", 0, 50, 1, 55, 110, 118.9, 0, 0, 4, 100 },
@@ -1273,9 +1808,9 @@
         /*140*/ { BARCODE_AUSROUTE, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 8, 3, 73, 186, 29.333332, 20, 6.6666665, 2, 10 },
         /*141*/ { BARCODE_AUSREDIRECT, -1, -1, -1, "1234", 0, 8, 3, 73, 146, 16, 0, 0, 2, 10 },
         /*142*/ { BARCODE_AUSREDIRECT, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 8, 3, 73, 186, 29.333332, 20, 6.6666665, 2, 10 },
-        /*143*/ { BARCODE_ISBNX, -1, -1, -1, "123456789X", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /*144*/ { BARCODE_ISBNX, BARCODE_QUIET_ZONES, -1, -1, "123456789X", 0, 50, 1, 95, 226, 116.4, 22, 0, 2, 110 },
-        /*145*/ { BARCODE_ISBNX, BARCODE_NO_QUIET_ZONES, -1, -1, "123456789X", 0, 50, 1, 95, 212, 116.4, 22, 0, 2, 110 },
+        /*143*/ { BARCODE_ISBNX, -1, -1, -1, "123456789X", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /*144*/ { BARCODE_ISBNX, BARCODE_QUIET_ZONES, -1, -1, "123456789X", 0, 50, 1, 95, 226, 116.9, 22, 0, 2, 110 },
+        /*145*/ { BARCODE_ISBNX, BARCODE_NO_QUIET_ZONES, -1, -1, "123456789X", 0, 50, 1, 95, 212, 116.9, 22, 0, 2, 110 },
         /*146*/ { BARCODE_RM4SCC, -1, -1, -1, "1234", 0, 8, 3, 43, 86, 16, 0, 0, 2, 10 },
         /*147*/ { BARCODE_RM4SCC, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 8, 3, 43, 98.283463, 28.283464, 6.1417322, 6.1417322, 2, 10 },
         /*148*/ { BARCODE_DATAMATRIX, -1, -1, -1, "1234", 0, 10, 10, 10, 20, 20, 0, 0, 2, 2 },
@@ -1360,9 +1895,9 @@
         /*227*/ { BARCODE_AZRUNE, BARCODE_NO_QUIET_ZONES, -1, -1, "123", 0, 11, 11, 11, 22, 22, 0, 0, 8, 2 },
         /*228*/ { BARCODE_CODE32, -1, -1, -1, "1234", 0, 50, 1, 103, 206, 118.9, 0, 0, 2, 100 },
         /*229*/ { BARCODE_CODE32, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 50, 1, 103, 246, 118.9, 20, 0, 2, 100 },
-        /*230*/ { BARCODE_EANX_CC, -1, -1, -1, "023456789012", 0, 50, 7, 99, 234, 116.4, 32, 24, 2, 86 },
-        /*231*/ { BARCODE_EANX_CC, BARCODE_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 7, 99, 234, 116.4, 32, 24, 2, 86 },
-        /*232*/ { BARCODE_EANX_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 7, 99, 220, 116.4, 32, 24, 2, 86 },
+        /*230*/ { BARCODE_EANX_CC, -1, -1, -1, "023456789012", 0, 50, 7, 99, 234, 116.9, 32, 24, 2, 86 },
+        /*231*/ { BARCODE_EANX_CC, BARCODE_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 7, 99, 234, 116.9, 32, 24, 2, 86 },
+        /*232*/ { BARCODE_EANX_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "023456789012", 0, 50, 7, 99, 220, 116.9, 32, 24, 2, 86 },
         /*233*/ { BARCODE_EANX_CC, -1, -1, 0, "023456789012", 0, 50, 7, 99, 234, 110, 32, 24, 2, 86 }, /* Hide text */
         /*234*/ { BARCODE_EANX_CC, BARCODE_QUIET_ZONES, -1, 0, "023456789012", 0, 50, 7, 99, 234, 110, 32, 24, 2, 86 }, /* Hide text */
         /*235*/ { BARCODE_EANX_CC, BARCODE_NO_QUIET_ZONES, -1, 0, "023456789012", 0, 50, 7, 99, 198, 110, 10, 24, 2, 86 }, /* Hide text */
@@ -1374,15 +1909,15 @@
         /*241*/ { BARCODE_DBAR_LTD_CC, BARCODE_QUIET_ZONES, -1, -1, "1234", 0, 19, 6, 79, 162, 56.900002, 4, 18, 2, 20 },
         /*242*/ { BARCODE_DBAR_EXP_CC, -1, -1, -1, "[20]12", 0, 41, 5, 102, 204, 100.9, 2, 14, 2, 68 },
         /*243*/ { BARCODE_DBAR_EXP_CC, BARCODE_QUIET_ZONES, -1, -1, "[20]12", 0, 41, 5, 102, 208, 100.9, 4, 14, 2, 68 },
-        /*244*/ { BARCODE_UPCA_CC, -1, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.4, 24, 20, 2, 90 },
-        /*245*/ { BARCODE_UPCA_CC, BARCODE_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.4, 24, 20, 2, 90 },
-        /*246*/ { BARCODE_UPCA_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.4, 24, 20, 2, 90 },
+        /*244*/ { BARCODE_UPCA_CC, -1, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.9, 24, 20, 2, 90 },
+        /*245*/ { BARCODE_UPCA_CC, BARCODE_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.9, 24, 20, 2, 90 },
+        /*246*/ { BARCODE_UPCA_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "01457137763", 0, 50, 7, 99, 234, 116.9, 24, 20, 2, 90 },
         /*247*/ { BARCODE_UPCA_CC, -1, -1, 0, "01457137763", 0, 50, 7, 99, 234, 110, 24, 20, 2, 90 }, /* Hide text */
         /*248*/ { BARCODE_UPCA_CC, BARCODE_QUIET_ZONES, -1, 0, "01457137763", 0, 50, 7, 99, 234, 110, 24, 20, 2, 90 }, /* Hide text */
         /*249*/ { BARCODE_UPCA_CC, BARCODE_NO_QUIET_ZONES, -1, 0, "01457137763", 0, 50, 7, 99, 198, 110, 6, 20, 2, 90 }, /* Hide text */
-        /*250*/ { BARCODE_UPCE_CC, -1, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.4, 24, 28, 2, 82 },
-        /*251*/ { BARCODE_UPCE_CC, BARCODE_QUIET_ZONES, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.4, 24, 28, 2, 82 },
-        /*252*/ { BARCODE_UPCE_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.4, 24, 28, 2, 82 },
+        /*250*/ { BARCODE_UPCE_CC, -1, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.9, 24, 28, 2, 82 },
+        /*251*/ { BARCODE_UPCE_CC, BARCODE_QUIET_ZONES, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.9, 24, 28, 2, 82 },
+        /*252*/ { BARCODE_UPCE_CC, BARCODE_NO_QUIET_ZONES, -1, -1, "8145713", 0, 50, 9, 55, 142, 116.9, 24, 28, 2, 82 },
         /*253*/ { BARCODE_UPCE_CC, -1, -1, 0, "8145713", 0, 50, 9, 55, 142, 110, 24, 28, 2, 82 }, /* Hide text */
         /*254*/ { BARCODE_UPCE_CC, BARCODE_QUIET_ZONES, -1, 0, "8145713", 0, 50, 9, 55, 142, 110, 24, 28, 2, 82 }, /* Hide text */
         /*255*/ { BARCODE_UPCE_CC, BARCODE_NO_QUIET_ZONES, -1, 0, "8145713", 0, 50, 9, 55, 110, 110, 6, 28, 2, 82 }, /* Hide text */
@@ -1483,6 +2018,149 @@
     testFinish();
 }
 
+static void test_text_gap(const testCtx *const p_ctx) {
+    int debug = p_ctx->debug;
+
+    struct item {
+        int symbology;
+        int output_options;
+        int option_2;
+        int show_hrt;
+        float text_gap;
+        float scale;
+        char *data;
+        char *composite;
+        int ret;
+
+        float expected_height;
+        int expected_rows;
+        int expected_width;
+        float expected_vector_width;
+        float expected_vector_height;
+        float expected_set_x;
+        float expected_set_y;
+        float expected_set_width;
+        float expected_set_height;
+    };
+    /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
+    struct item data[] = {
+        /*  0*/ { BARCODE_CODE11, -1, -1, -1, 0, 0, "1234", "", 0, 50, 1, 62, 124, 118.9, 62.0, 114.0, -1, -1 }, /* Default */
+        /*  1*/ { BARCODE_CODE11, -1, -1, -1, 0.1, 0, "1234", "", 0, 50, 1, 62, 124, 117.7, 62.0, 112.8, -1, -1 },
+        /*  2*/ { BARCODE_CODE11, -1, -1, -1, 0.2, 0, "1234", "", 0, 50, 1, 62, 124, 117.9, 62.0, 113, -1, -1 },
+        /*  3*/ { BARCODE_CODE11, -1, -1, -1, 0.3, 0, "1234", "", 0, 50, 1, 62, 124, 118.1, 62.0, 113.2, -1, -1 },
+        /*  4*/ { BARCODE_CODE11, -1, -1, -1, 0.4, 0, "1234", "", 0, 50, 1, 62, 124, 118.3, 62.0, 113.4, -1, -1 },
+        /*  5*/ { BARCODE_CODE11, -1, -1, -1, 0.5, 0, "1234", "", 0, 50, 1, 62, 124, 118.5, 62.0, 113.6, -1, -1 },
+        /*  6*/ { BARCODE_CODE11, -1, -1, -1, 0.6, 0, "1234", "", 0, 50, 1, 62, 124, 118.7, 62.0, 113.799995, -1, -1 },
+        /*  7*/ { BARCODE_CODE11, -1, -1, -1, 0.7, 0, "1234", "", 0, 50, 1, 62, 124, 118.9, 62.0, 114, -1, -1 },
+        /*  8*/ { BARCODE_CODE11, -1, -1, -1, 0.75, 0, "1234", "", 0, 50, 1, 62, 124, 119, 62.0, 114.1, -1, -1 }, /* Same as default */
+        /*  9*/ { BARCODE_CODE11, -1, -1, -1, 0.8, 0, "1234", "", 0, 50, 1, 62, 124, 119.1, 62.0, 114.2, -1, -1 },
+        /* 10*/ { BARCODE_CODE11, -1, -1, -1, 0.9, 0, "1234", "", 0, 50, 1, 62, 124, 119.3, 62.0, 114.4, -1, -1 },
+        /* 11*/ { BARCODE_CODE11, -1, -1, -1, 1.0, 0, "1234", "", 0, 50, 1, 62, 124, 119.5, 62.0, 114.6, -1, -1 },
+        /* 12*/ { BARCODE_CODE11, -1, -1, -1, 1.1, 0, "1234", "", 0, 50, 1, 62, 124, 119.7, 62.0, 114.799995, -1, -1 },
+        /* 13*/ { BARCODE_CODE11, -1, -1, -1, 1.5, 0, "1234", "", 0, 50, 1, 62, 124, 120.5, 62.0, 115.6, -1, -1 },
+        /* 14*/ { BARCODE_CODE11, -1, -1, -1, 2.0, 0, "1234", "", 0, 50, 1, 62, 124, 121.5, 62.0, 116.6, -1, -1 },
+        /* 15*/ { BARCODE_CODE11, -1, -1, -1, 3.0, 0, "1234", "", 0, 50, 1, 62, 124, 123.5, 62.0, 118.6, -1, -1 },
+        /* 16*/ { BARCODE_CODE11, -1, -1, -1, 4.0, 0, "1234", "", 0, 50, 1, 62, 124, 125.5, 62.0, 120.6, -1, -1 },
+        /* 17*/ { BARCODE_CODE11, -1, -1, -1, 5.0, 0, "1234", "", 0, 50, 1, 62, 124, 127.5, 62.0, 122.6, -1, -1 },
+        /* 18*/ { BARCODE_CODE11, -1, -1, -1, 0, 3.0, "1234", "", 0, 50, 1, 62, 372, 356.7, 186.0, 342.0, -1, -1 }, /* Scale default */
+        /* 19*/ { BARCODE_CODE11, -1, -1, -1, 0.1, 3.0, "1234", "", 0, 50, 1, 62, 372, 353.09998, 186.0, 338.4, -1, -1 }, /* Scale */
+        /* 20*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763", "", 0, 50, 1, 95, 226, 116.9, 74.0, 116.1, -1, -1 }, /* Default */
+        /* 21*/ { BARCODE_UPCA, -1, -1, -1, 0.1, 0, "01457130763", "", 0, 50, 1, 95, 226, 115.6, 74.0, 114.799995, -1, -1 },
+        /* 22*/ { BARCODE_UPCA, -1, -1, -1, 0.6, 0, "01457130763", "", 0, 50, 1, 95, 226, 116.6, 74.0, 115.799995, -1, -1 },
+        /* 23*/ { BARCODE_UPCA, -1, -1, -1, 0.7, 0, "01457130763", "", 0, 50, 1, 95, 226, 116.8, 74.0, 116, -1, -1 },
+        /* 24*/ { BARCODE_UPCA, -1, -1, -1, 0.75, 0, "01457130763", "", 0, 50, 1, 95, 226, 116.9, 74.0, 116.1, -1, -1 }, /* Same as default */
+        /* 25*/ { BARCODE_UPCA, -1, -1, -1, 0.8, 0, "01457130763", "", 0, 50, 1, 95, 226, 117, 74.0, 116.2, -1, -1 },
+        /* 26*/ { BARCODE_UPCA, -1, -1, -1, 1.6, 0, "01457130763", "", 0, 50, 1, 95, 226, 118.6, 74.0, 117.799995, -1, -1 },
+        /* 27*/ { BARCODE_UPCA, -1, -1, -1, 1.6, 2.5, "01457130763", "", 0, 50, 1, 95, 565, 296.5, 185.0, 294.5, -1, -1 }, /* Scale */
+        /* 28*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116.9, 74.0, 116.1, -1, -1 }, /* Default */
+        /* 29*/ { BARCODE_UPCA, -1, -1, -1, 0, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116.9, 230.0, 16.9, 4.0, 83.1 }, /* Default */
+        /* 30*/ { BARCODE_UPCA, -1, -1, -1, 0.1, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 115.6, 230.0, 15.5999994, 4.0, 84.4 },
+        /* 31*/ { BARCODE_UPCA, -1, -1, -1, 0.75, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 116.9, 230.0, 16.9, 4.0, 83.1 }, /* Same as default */
+        /* 32*/ { BARCODE_UPCA, -1, -1, -1, 0.9, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 117.2, 230.0, 17.1999989, 4.0, 82.8 },
+        /* 33*/ { BARCODE_UPCA, -1, -1, -1, 4.2, 0, "01457130763+10", "", 0, 50, 1, 124, 276, 123.8, 230.0, 23.8, 4.0, 76.2 },
+        /* 34*/ { BARCODE_UPCA_CC, -1, -1, -1, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116.9, 80.0, 116.1, -1, -1 }, /* Default */
+        /* 35*/ { BARCODE_UPCA_CC, -1, -1, -1, 0.1, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 115.6, 80.0, 114.799995, -1, -1 },
+        /* 36*/ { BARCODE_UPCA_CC, -1, -1, -1, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116.9, 236.0, 40.9, 4.0, 59.1 }, /* Default */
+        /* 37*/ { BARCODE_UPCA_CC, -1, -1, -1, 0.1, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 115.6, 236.0, 39.6000023, 4.0, 60.3999977 },
+        /* 38*/ { BARCODE_UPCA_CC, -1, -1, -1, 0.75, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 116.9, 236.0, 40.9, 4.0, 59.1 }, /* Same as default */
+        /* 39*/ { BARCODE_UPCA_CC, -1, -1, -1, 1.5, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 118.4, 236.0, 42.4, 4.0, 57.6 },
+        /* 40*/ { BARCODE_UPCA_CC, -1, -1, 0, 0, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 236.0, 40.9, 4.0, 59.1 }, /* Hide text default */
+        /* 41*/ { BARCODE_UPCA_CC, -1, -1, 0, 1.5, 0, "01457130763+10", "[91]12", 0, 50, 7, 128, 284, 110, 236.0, 42.4, 4.0, 57.6 }, /* Hide text */
+    };
+    int data_size = ARRAY_SIZE(data);
+    int i, length, ret;
+    struct zint_symbol *symbol;
+
+    const char *text;
+
+    struct zint_vector_string *string;
+    struct zint_vector_rect *rect;
+
+    testStart("test_text_gap");
+
+    for (i = 0; i < data_size; i++) {
+
+        if (testContinue(p_ctx, i)) continue;
+
+        symbol = ZBarcode_Create();
+        assert_nonnull(symbol, "Symbol not created\n");
+
+        if (data[i].show_hrt != -1) {
+            symbol->show_hrt = data[i].show_hrt;
+        }
+        symbol->text_gap = data[i].text_gap;
+        if (data[i].scale != 0.0f) {
+            symbol->scale = data[i].scale;
+        }
+
+        if (strlen(data[i].composite)) {
+            text = data[i].composite;
+            strcpy(symbol->primary, data[i].data);
+        } else {
+            text = data[i].data;
+        }
+        length = testUtilSetSymbol(symbol, data[i].symbology, -1 /*input_mode*/, -1 /*eci*/, -1 /*option_1*/, data[i].option_2, -1, data[i].output_options, text, -1, debug);
+
+        ret = ZBarcode_Encode(symbol, (unsigned char *) text, length);
+        assert_zero(ret, "i:%d ZBarcode_Encode(%d) ret %d != 0 %s\n", i, data[i].symbology, ret, symbol->errtxt);
+
+        ret = ZBarcode_Buffer_Vector(symbol, 0);
+        assert_equal(ret, data[i].ret, "i:%d ZBarcode_Buffer_Vector(%d) ret %d != %d\n", i, data[i].symbology, ret, data[i].ret);
+
+        if (ret < ZINT_ERROR) {
+            assert_nonnull(symbol->vector, "i:%d ZBarcode_Buffer_Vector(%d) vector NULL\n", i, data[i].symbology);
+
+            if (p_ctx->index != -1 && (debug & ZINT_DEBUG_TEST_PRINT)) { /* ZINT_DEBUG_TEST_PRINT 16 */
+                sprintf(symbol->outfile, "test_text_gap_%d.svg", i);
+                ZBarcode_Print(symbol, 0);
+            }
+
+            assert_equal(symbol->height, data[i].expected_height, "i:%d (%d) symbol->height %.8g != %.8g\n", i, data[i].symbology, symbol->height, data[i].expected_height);
+            assert_equal(symbol->rows, data[i].expected_rows, "i:%d (%d) symbol->rows %d != %d\n", i, data[i].symbology, symbol->rows, data[i].expected_rows);
+            assert_equal(symbol->width, data[i].expected_width, "i:%d (%d) symbol->width %d != %d\n", i, data[i].symbology, symbol->width, data[i].expected_width);
+
+            assert_equal(symbol->vector->width, data[i].expected_vector_width, "i:%d (%s) symbol->vector->width %.8g != %.8g\n",
+                i, testUtilBarcodeName(data[i].symbology), symbol->vector->width, data[i].expected_vector_width);
+            assert_equal(symbol->vector->height, data[i].expected_vector_height, "i:%d (%s) symbol->vector->height %.8g != %.8g\n",
+                i, testUtilBarcodeName(data[i].symbology), symbol->vector->height, data[i].expected_vector_height);
+
+            if (data[i].expected_set_width == -1.0f) {
+                string = find_string(symbol, data[i].expected_set_x, data[i].expected_set_y);
+                assert_nonnull(string, "i:%d (%d) find_string(%g, %g) NULL\n",
+                    i, data[i].symbology, data[i].expected_set_x, data[i].expected_set_y);
+            } else {
+                rect = find_rect(symbol, data[i].expected_set_x, data[i].expected_set_y, data[i].expected_set_width, data[i].expected_set_height);
+                assert_nonnull(rect, "i:%d (%d) find_rect(%g, %g, %g, %g) NULL\n",
+                                        i, data[i].symbology, data[i].expected_set_x, data[i].expected_set_y, data[i].expected_set_width, data[i].expected_set_height);
+            }
+        }
+
+        ZBarcode_Delete(symbol);
+    }
+
+    testFinish();
+}
+
 static void test_height(const testCtx *const p_ctx) {
     int debug = p_ctx->debug;
 
@@ -2348,6 +3026,7 @@
     testFunction funcs[] = { /* name, func */
         { "test_options", test_options },
         { "test_buffer_vector", test_buffer_vector },
+        { "test_has_hrt", test_has_hrt },
         { "test_upcean_hrt", test_upcean_hrt },
         { "test_row_separator", test_row_separator },
         { "test_stacking", test_stacking },
@@ -2357,6 +3036,7 @@
         { "test_scale", test_scale },
         { "test_guard_descent", test_guard_descent },
         { "test_quiet_zones", test_quiet_zones },
+        { "test_text_gap", test_text_gap, },
         { "test_height", test_height },
         { "test_height_per_row", test_height_per_row },
     };
diff -urN zint-2.12.0/backend/tests/tools/bwipp_dump-barcode.ps.cat zint/backend/tests/tools/bwipp_dump-barcode.ps.cat
--- zint-2.12.0/backend/tests/tools/bwipp_dump-barcode.ps.cat	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tests/tools/bwipp_dump-barcode.ps.cat	2023-05-08 14:39:44.953319888 +0200
@@ -1,5 +1,9 @@
 %!PS
 
+% libzint - the open source barcode library
+% Copyright (C) 2022-2023 Robin Stuart <rstuart114@gmail.com>
+% SPDX-License-Identifier: BSD-3-Clause
+
 % Append to BWIPP barcode.ps: cat <bwipp-dir>/build/monolithic/barcode.ps bwipp_dump-barcode.ps.cat > bwipp_dump.ps
 %
 % To compress: tar cv bwipp_dump.ps | xz -e9 > bwipp_dump.ps.tar.xz
@@ -9,7 +13,7 @@
 % To run e.g. gs -dNOPAUSE -dBATCH -dNODISPLAY -q -sb=databarexpanded -sd='(01)98898765432106' -so='includetext segments=6' bwipp_dump.ps
 % where
 % `-sb=` is the BWIPP barcode routine name
-% `-sd=` is the data (`sd2=` is also available for overspill data > 2K to get around Ghostscript arg_str_max)
+% `-sd=` is the data (`sd2=`, `sd3=`, `sd4=` are also available for overspill data > ~2K to get around Ghostscript's arg_str_max)
 % `-so=` are options (as space separated key=val pairs (or just key if boolean true))
 
 % For debugging the barcode can be rendered by leaving out `-dBATCH -dNODISPLAY`. Scaling can be specified by `-ss=` (default 2).
@@ -20,6 +24,14 @@
 % Append d2 to d if given
 systemdict /d2 known {
     /d d length d2 length add string dup dup 0 d putinterval d length d2 putinterval def
+    % Append d3 to d if given
+    systemdict /d3 known {
+        /d d length d3 length add string dup dup 0 d putinterval d length d3 putinterval def
+        % Append d4 to d if given
+        systemdict /d4 known {
+            /d d length d4 length add string dup dup 0 d putinterval d length d4 putinterval def
+        } if
+    } if
 } if
 
 % Strip start/end parens from data if any
@@ -67,10 +79,28 @@
         /pixs ret /pixs get def
     } ifelse
 
+    /pixx ret /pixx known { ret /pixx get } { 0 } ifelse def
+
+    b (codablockf) eq b (hibccodablockf) eq or b (code16k) eq or b (code49) eq or {
+        % Strip separators and boundary bars
+        /testi b (code16k) eq { 16 } { b (code49) eq { 11 } { 21 } ifelse } ifelse def
+        /tmppixs pixs length array def
+        /j 0 def
+        0 pixx pixs length 1 sub {
+            /i exch def
+            pixs i testi add get 1 ne {
+                tmppixs j pixs i pixx getinterval putinterval
+                /j j pixx add def
+            } if
+        } for
+        /pixs j array def
+        pixs 0 tmppixs 0 j getinterval putinterval
+    } if
+
     /xs systemdict /xs known { systemdict /xs get cvi } { 0 } ifelse def
     /xe systemdict /xe known { systemdict /xe get cvi } { 0 } ifelse def
 
-    n xs 0 ne or xe 0 ne or ret /pixx known and {  % If newlines or start/end indexes requested and have row width
+    n xs 0 ne or xe 0 ne or pixx 0 ne and {  % If newlines or start/end indexes requested and have row width
         /pixx ret /pixx get def
         xs pixx pixs length 1 sub xe sub {  % For i = xs; i < pixs length - xe; i += pixx
             pixs exch pixx xs sub xe sub getinterval {  % For j = i; j < i + pixx - xs -xe; j++
Binary files zint-2.12.0/backend/tests/tools/bwipp_dump.ps.tar.xz and zint/backend/tests/tools/bwipp_dump.ps.tar.xz differ
diff -urN zint-2.12.0/backend/tif.c zint/backend/tif.c
--- zint-2.12.0/backend/tif.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/tif.c	2023-05-08 14:39:44.954319894 +0200
@@ -1,7 +1,7 @@
 /* tif.c - Aldus Tagged Image File Format support */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2016-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2016-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -32,6 +32,7 @@
 
 #include <assert.h>
 #include <errno.h>
+#include <math.h>
 #include <stdio.h>
 #ifdef _MSC_VER
 #include <io.h>
@@ -59,20 +60,16 @@
     color_map_entry->blue = (rgb[2] << 8) | rgb[2];
 }
 
-static void to_cmyk(const unsigned char rgb[3], const unsigned char alpha, unsigned char *cmyk) {
-    unsigned char max = rgb[0];
-    if (rgb[1] > max) {
-        max = rgb[1];
-    }
-    if (rgb[2] > max) {
-        max = rgb[2];
-    }
-    cmyk[0] = max - rgb[0];
-    cmyk[1] = max - rgb[1];
-    cmyk[2] = max - rgb[2];
-    cmyk[3] = 0xff - max;
+static void to_cmyk(const char *colour, unsigned char *cmyk) {
+    int cyan, magenta, yellow, black;
+    unsigned char alpha;
+
+    (void) out_colour_get_cmyk(colour, &cyan, &magenta, &yellow, &black, &alpha);
+    cmyk[0] = (unsigned char) roundf(cyan * 0xFF / 100.0f);
+    cmyk[1] = (unsigned char) roundf(magenta * 0xFF / 100.0f);
+    cmyk[2] = (unsigned char) roundf(yellow * 0xFF / 100.0f);
+    cmyk[3] = (unsigned char) roundf(black * 0xFF / 100.0f);
     cmyk[4] = alpha;
-
 }
 
 static int is_big_endian(void) {
@@ -80,7 +77,7 @@
 }
 
 /* TIFF Revision 6.0 https://www.adobe.io/content/dam/udp/en/open/standards/tiff/TIFF6.pdf */
-INTERNAL int tif_pixel_plot(struct zint_symbol *symbol, unsigned char *pixelbuf) {
+INTERNAL int tif_pixel_plot(struct zint_symbol *symbol, const unsigned char *pixelbuf) {
     unsigned char fg[4], bg[4];
     int i;
     int pmi; /* PhotometricInterpretation */
@@ -101,7 +98,7 @@
     unsigned int bytes_put;
     long total_bytes_put;
     FILE *tif_file;
-    unsigned char *pb;
+    const unsigned char *pb;
     int compression = TIF_NO_COMPRESSION;
     tif_lzw_state lzw_state;
     long file_pos;
@@ -119,47 +116,32 @@
     int ifd_size;
     uint32_t temp32;
 
-    fg[0] = (16 * ctoi(symbol->fgcolour[0])) + ctoi(symbol->fgcolour[1]);
-    fg[1] = (16 * ctoi(symbol->fgcolour[2])) + ctoi(symbol->fgcolour[3]);
-    fg[2] = (16 * ctoi(symbol->fgcolour[4])) + ctoi(symbol->fgcolour[5]);
-    bg[0] = (16 * ctoi(symbol->bgcolour[0])) + ctoi(symbol->bgcolour[1]);
-    bg[1] = (16 * ctoi(symbol->bgcolour[2])) + ctoi(symbol->bgcolour[3]);
-    bg[2] = (16 * ctoi(symbol->bgcolour[4])) + ctoi(symbol->bgcolour[5]);
-
-    if (strlen(symbol->fgcolour) > 6) {
-        fg[3] = (16 * ctoi(symbol->fgcolour[6])) + ctoi(symbol->fgcolour[7]);
-    } else {
-        fg[3] = 0xff;
-    }
-
-    if (strlen(symbol->bgcolour) > 6) {
-        bg[3] = (16 * ctoi(symbol->bgcolour[6])) + ctoi(symbol->bgcolour[7]);
-    } else {
-        bg[3] = 0xff;
-    }
+    (void) out_colour_get_rgb(symbol->fgcolour, &fg[0], &fg[1], &fg[2], &fg[3]);
+    (void) out_colour_get_rgb(symbol->bgcolour, &bg[0], &bg[1], &bg[2], &bg[3]);
 
     if (symbol->symbology == BARCODE_ULTRA) {
         static const int ultra_chars[8] = { 'W', 'C', 'B', 'M', 'R', 'Y', 'G', 'K' };
-        static const unsigned char ultra_rgbs[8][3] = {
-            { 0xff, 0xff, 0xff, }, /* White */
-            {    0, 0xff, 0xff, }, /* Cyan */
-            {    0,    0, 0xff, }, /* Blue */
-            { 0xff,    0, 0xff, }, /* Magenta */
-            { 0xff,    0,    0, }, /* Red */
-            { 0xff, 0xff,    0, }, /* Yellow */
-            {    0, 0xff,    0, }, /* Green */
-            {    0,    0,    0, }, /* Black */
-        };
 
         if (symbol->output_options & CMYK_COLOUR) {
+            static const unsigned char ultra_cmyks[8][4] = {
+                {    0,    0,    0,    0 }, /* White */
+                { 0xFF,    0,    0,    0 }, /* Cyan */
+                { 0xFF, 0xFF,    0,    0 }, /* Blue */
+                {    0, 0xFF,    0,    0 }, /* Magenta */
+                {    0, 0xFF, 0xFF,    0 }, /* Red */
+                {    0,    0, 0xFF,    0 }, /* Yellow */
+                { 0xFF,    0, 0xFF,    0 }, /* Green */
+                {    0,    0,    0, 0xFF }, /* Black */
+            };
             for (i = 0; i < 8; i++) {
                 map[ultra_chars[i]] = i;
-                to_cmyk(ultra_rgbs[i], fg[3], palette[i]);
+                memcpy(palette[i], ultra_cmyks[i], 4);
+                palette[i][4] = fg[3];
             }
             map['0'] = 8;
-            to_cmyk(bg, bg[3], palette[8]);
+            to_cmyk(symbol->bgcolour, palette[8]);
             map['1'] = 9;
-            to_cmyk(fg, fg[3], palette[9]);
+            to_cmyk(symbol->fgcolour, palette[9]);
 
             pmi = TIF_PMI_SEPARATED;
             bits_per_sample = 8;
@@ -171,6 +153,16 @@
             }
             pixels_per_sample = 1;
         } else {
+            static const unsigned char ultra_rgbs[8][3] = {
+                { 0xff, 0xff, 0xff, }, /* White */
+                {    0, 0xff, 0xff, }, /* Cyan */
+                {    0,    0, 0xff, }, /* Blue */
+                { 0xff,    0, 0xff, }, /* Magenta */
+                { 0xff,    0,    0, }, /* Red */
+                { 0xff, 0xff,    0, }, /* Yellow */
+                {    0, 0xff,    0, }, /* Green */
+                {    0,    0,    0, }, /* Black */
+            };
             for (i = 0; i < 8; i++) {
                 map[ultra_chars[i]] = i;
                 memcpy(palette[i], ultra_rgbs[i], 3);
@@ -201,9 +193,9 @@
     } else { /* fg/bg only */
         if (symbol->output_options & CMYK_COLOUR) {
             map['0'] = 0;
-            to_cmyk(bg, bg[3], palette[0]);
+            to_cmyk(symbol->bgcolour, palette[0]);
             map['1'] = 1;
-            to_cmyk(fg, fg[3], palette[1]);
+            to_cmyk(symbol->fgcolour, palette[1]);
 
             pmi = TIF_PMI_SEPARATED;
             bits_per_sample = 8;
@@ -398,7 +390,7 @@
                 file_pos = ftell(tif_file);
                 if (!tif_lzw_encode(&lzw_state, tif_file, strip_buf, bytes_put)) { /* Only fails if can't malloc */
                     tif_lzw_cleanup(&lzw_state);
-                    fclose(tif_file); /* Only use LZW if not STDOUT, so ok to close */
+                    (void) fclose(tif_file); /* Only use LZW if not STDOUT, so ok to close */
                     strcpy(symbol->errtxt, "673: Failed to malloc LZW hash table");
                     return ZINT_ERROR_MEMORY;
                 }
@@ -603,15 +595,29 @@
         total_bytes_put += 6 * color_map_size;
     }
 
+    if (ferror(tif_file)) {
+        sprintf(symbol->errtxt, "679: Incomplete write to output (%d: %.30s)", errno, strerror(errno));
+        if (!output_to_stdout) {
+            (void) fclose(tif_file);
+        }
+        return ZINT_ERROR_FILE_WRITE;
+    }
+
     if (output_to_stdout) {
-        fflush(tif_file);
+        if (fflush(tif_file) != 0) {
+            sprintf(symbol->errtxt, "980: Incomplete flush to output (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     } else {
         if (ftell(tif_file) != total_bytes_put) {
-            fclose(tif_file);
+            (void) fclose(tif_file);
             strcpy(symbol->errtxt, "674: Failed to write all output");
             return ZINT_ERROR_FILE_WRITE;
         }
-        fclose(tif_file);
+        if (fclose(tif_file) != 0) {
+            sprintf(symbol->errtxt, "981: Failure on closing output file (%d: %.30s)", errno, strerror(errno));
+            return ZINT_ERROR_FILE_WRITE;
+        }
     }
 
     return 0;
diff -urN zint-2.12.0/backend/vector.c zint/backend/vector.c
--- zint-2.12.0/backend/vector.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/vector.c	2023-05-08 14:39:44.964319953 +0200
@@ -1,7 +1,7 @@
 /*  vector.c - Creates vector image objects */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2018-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2018-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -126,7 +126,7 @@
     *last_circle = circle;
 }
 
-static int vector_plot_add_string(struct zint_symbol *symbol, const unsigned char *text,
+static int vector_plot_add_string(struct zint_symbol *symbol, const unsigned char *text, const int length,
             const float x, const float y, const float fsize, const float width, const int halign,
             struct zint_vector_string **last_string) {
     struct zint_vector_string *string;
@@ -141,7 +141,7 @@
     string->y = y;
     string->width = width;
     string->fsize = fsize;
-    string->length = (int) ustrlen(text);
+    string->length = length == -1 ? (int) ustrlen(text) : length;
     string->rotation = 0;
     string->halign = halign;
     string->text = (unsigned char *) malloc(string->length + 1);
@@ -150,7 +150,8 @@
         strcpy(symbol->errtxt, "695: Insufficient memory for vector string text");
         return 0;
     }
-    ustrcpy(string->text, text);
+    memcpy(string->text, text, string->length);
+    string->text[string->length] = '\0';
 
     if (*last_string)
         (*last_string)->next = string;
@@ -398,7 +399,7 @@
     float textoffset;
     int upceanflag = 0;
     int addon_latch = 0;
-    unsigned char textpart1[5], textpart2[7], textpart3[7], textpart4[2];
+    unsigned char textparts[4][7];
     int hide_text;
     int i, r;
     int block_width = 0;
@@ -408,13 +409,22 @@
     const int is_codablockf = symbol->symbology == BARCODE_CODABLOCKF || symbol->symbology == BARCODE_HIBC_BLOCKF;
     const int no_extend = is_codablockf || symbol->symbology == BARCODE_DPD;
 
-    float addon_row_height;
     float large_bar_height;
+    const float descent_factor = 0.1f; /* Assuming descent roughly 10% of font size */
+
+    /* For UPC/EAN only */
+    float addon_row_yposn;
+    float addon_row_height;
     int upcae_outside_text_height = 0; /* UPC-A/E outside digits font size */
-    float digit_ascent_factor = 0.25f; /* Assuming digit ascent roughly 25% less than font size */
+    /* Note using "ascender" to mean height above digits as "ascent" usually measured from baseline */
+    const float digit_ascender_factor = 0.25f; /* Assuming digit ascender height roughly 25% of font size */
+    float digit_ascender = 0.0f; /* Avoid gcc -Wmaybe-uninitialized */
+    const float antialias_fudge_factor = 0.02f;
+    float antialias_fudge = 0.0f; /* Avoid gcc -Wmaybe-uninitialized */
+    int rect_count = 0, last_row_start = 0; /* For UPC/EAN guard bars */
+
     float dot_overspill = 0.0f;
     float dot_offset = 0.0f;
-    int rect_count = 0, last_row_start = 0; /* For UPC/EAN guard bars */
     float yposn;
 
     struct zint_vector *vector;
@@ -461,18 +471,21 @@
     out_set_whitespace_offsets(symbol, hide_text, &xoffset, &yoffset, &roffset, &boffset, 0 /*scaler*/,
         NULL, NULL, NULL, NULL);
 
+
     /* Note font sizes scaled by 2 so really twice these values */
     if (upceanflag) {
         /* Note BOLD_TEXT ignored for UPCEAN by svg/emf/ps/qzint */
         text_height = symbol->output_options & SMALL_TEXT ? 7 : 10;
+        digit_ascender = text_height * digit_ascender_factor; /* Digit ascender is unused (empty) */
+        antialias_fudge = text_height * antialias_fudge_factor;
         upcae_outside_text_height = symbol->output_options & SMALL_TEXT ? 6 : 7;
-        /* Negative to move close to barcode (less digit ascent, then add 0.5X) */
-        text_gap = -text_height * digit_ascent_factor + 0.5f;
+        /* Note default 0.75 was 0.5 (minimum per standard) but that looks too close */
+        text_gap = (symbol->text_gap ? symbol->text_gap : 0.75f) - digit_ascender;
         /* Guard bar height (none for EAN-2 and EAN-5) */
         guard_descent = upceanflag != 2 && upceanflag != 5 ? symbol->guard_descent : 0.0f;
     } else {
         text_height = symbol->output_options & SMALL_TEXT ? 6 : 7;
-        text_gap = text_height * 0.1f;
+        text_gap = symbol->text_gap ? symbol->text_gap : text_height * 0.1f;
         guard_descent = 0.0f;
     }
 
@@ -480,10 +493,9 @@
         textoffset = guard_descent;
     } else {
         if (upceanflag) {
-            /* Add fudge for anti-aliasing of digits */
-            if (text_height + 0.2f + text_gap > guard_descent) {
-                textoffset = text_height + 0.2f + text_gap;
-            } else {
+            /* Add fudge for anti-aliasing of digit bottoms */
+            textoffset = text_height + text_gap + antialias_fudge;
+            if (textoffset < guard_descent) {
                 textoffset = guard_descent;
             }
         } else {
@@ -601,11 +613,12 @@
                                         && module_is_set(symbol, r, i + block_width) == fill; block_width++);
 
                 if ((r == (symbol->rows - 1)) && (i > main_width) && (addon_latch == 0)) {
-                    addon_text_yposn = yposn + text_height - text_height * digit_ascent_factor;
+                    addon_text_yposn = yposn + text_height - digit_ascender;
                     if (addon_text_yposn < 0.0f) {
                         addon_text_yposn = 0.0f;
                     }
-                    addon_row_height = row_height - (addon_text_yposn - yposn) + text_gap;
+                    addon_row_yposn = yposn + text_height + text_gap + antialias_fudge;
+                    addon_row_height = row_height - (addon_row_yposn - yposn);
                     if (upceanflag != 12 && upceanflag != 6) { /* UPC-A/E add-ons don't descend */
                         addon_row_height += guard_descent;
                     }
@@ -617,8 +630,8 @@
                 if (fill) {
                     /* a bar */
                     if (addon_latch) {
-                        rect = vector_plot_create_rect(symbol, i + xoffset, addon_text_yposn - text_gap,
-                                                        block_width, addon_row_height);
+                        rect = vector_plot_create_rect(symbol, i + xoffset, addon_row_yposn, block_width,
+                                                        addon_row_height);
                     } else {
                         rect = vector_plot_create_rect(symbol, i + xoffset, yposn, block_width, row_height);
                     }
@@ -730,129 +743,107 @@
         xoffset += comp_xoffset;
 
         text_yposn = yoffset + symbol->height + text_height + text_gap; /* Calculated to bottom of text */
+        if (upceanflag) { /* Allow for anti-aliasing if UPC/EAN */
+            text_yposn -= antialias_fudge;
+        } else { /* Else adjust to baseline */
+            text_yposn -= text_height * descent_factor;
+        }
         if (symbol->border_width > 0 && (symbol->output_options & (BARCODE_BOX | BARCODE_BIND))) {
             text_yposn += symbol->border_width; /* Note not needed for BARCODE_BIND_TOP */
         }
 
         if (upceanflag >= 6) { /* UPC-E, EAN-8, UPC-A, EAN-13 */
+            const int addon_len = (int) ustrlen(addon);
             float textwidth;
 
-            out_upcean_split_text(upceanflag, symbol->text, textpart1, textpart2, textpart3, textpart4);
+            out_upcean_split_text(upceanflag, symbol->text, textparts);
 
             if (upceanflag == 6) { /* UPC-E */
-                text_xposn = -5.0f + xoffset;
+                text_xposn = -(5.0f - 0.35f) + xoffset;
                 textwidth = 6.2f;
-                if (!vector_plot_add_string(symbol, textpart1, text_xposn, text_yposn, upcae_outside_text_height,
-                        textwidth, 2 /*right align*/, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 24.0f + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[0], 1, text_xposn, text_yposn,
+                        upcae_outside_text_height, textwidth, 2 /*right align*/,
+                        &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (24.0f + 0.5f) + xoffset;
                 textwidth = 6.0f * 8.5f;
-                if (!vector_plot_add_string(symbol, textpart2, text_xposn, text_yposn, text_height,
-                        textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 51.0f + 3.0f + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[1], 6, text_xposn, text_yposn, text_height,
+                        textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (51.0f - 0.35f) + 3.0f + xoffset;
                 textwidth = 6.2f;
-                if (!vector_plot_add_string(symbol, textpart3, text_xposn, text_yposn, upcae_outside_text_height,
-                        textwidth, 1 /*left align*/, &last_string)) return ZINT_ERROR_MEMORY;
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = 61.0f + xoffset + addon_gap;
-                        textwidth = 2.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
-                    case 5:
-                        text_xposn = 75.0f + xoffset + addon_gap;
-                        textwidth = 5.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
+                if (!vector_plot_add_string(symbol, textparts[2], 1, text_xposn, text_yposn,
+                        upcae_outside_text_height, textwidth, 1 /*left align*/,
+                        &last_string)) return ZINT_ERROR_MEMORY;
+                if (addon_len) {
+                    text_xposn = (addon_len == 2 ? 61.0f : 75.0f) + xoffset + addon_gap;
+                    textwidth = addon_len * 8.5f;
+                    if (!vector_plot_add_string(symbol, addon, addon_len, text_xposn, addon_text_yposn,
+                            text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
                 }
 
             } else if (upceanflag == 8) { /* EAN-8 */
-                text_xposn = 17.0f + xoffset;
+                text_xposn = (17.0f + 0.5f) + xoffset;
                 textwidth = 4.0f * 8.5f;
-                if (!vector_plot_add_string(symbol, textpart1, text_xposn, text_yposn,
-                        text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 50.0f + xoffset;
-                if (!vector_plot_add_string(symbol, textpart2, text_xposn, text_yposn,
-                        text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = 77.0f + xoffset + addon_gap;
-                        textwidth = 2.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
-                    case 5:
-                        text_xposn = 91.0f + xoffset + addon_gap;
-                        textwidth = 5.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
+                if (!vector_plot_add_string(symbol, textparts[0], 4, text_xposn, text_yposn,
+                        text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (50.0f - 0.5f) + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[1], 4, text_xposn, text_yposn,
+                        text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                if (addon_len) {
+                    text_xposn = (addon_len == 2 ? 77.0f : 91.0f) + xoffset + addon_gap;
+                    textwidth = addon_len * 8.5f;
+                    if (!vector_plot_add_string(symbol, addon, addon_len, text_xposn, addon_text_yposn,
+                            text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
                 }
 
             } else if (upceanflag == 12) { /* UPC-A */
-                text_xposn = -5.0f + xoffset;
+                text_xposn = -(5.0f - 0.35f) + xoffset;
                 textwidth = 6.2f;
-                if (!vector_plot_add_string(symbol, textpart1, text_xposn, text_yposn, upcae_outside_text_height,
-                        textwidth, 2 /*right align*/, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 27.0f + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[0], 1, text_xposn, text_yposn,
+                        upcae_outside_text_height, textwidth, 2 /*right align*/,
+                        &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (27.0f + 1.0f) + xoffset;
                 textwidth = 5.0f * 8.5f;
-                if (!vector_plot_add_string(symbol, textpart2, text_xposn, text_yposn, text_height,
-                        textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
+                if (!vector_plot_add_string(symbol, textparts[1], 5, text_xposn, text_yposn, text_height,
+                        textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
                 text_xposn = 67.0f + xoffset;
-                if (!vector_plot_add_string(symbol, textpart3, text_xposn, text_yposn, text_height,
-                        textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 95.0f + 5.0f + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[2], 5, text_xposn, text_yposn, text_height,
+                        textwidth, 0 /*left align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (95.0f - 0.35f) + 5.0f + xoffset;
                 textwidth = 6.2f;
-                if (!vector_plot_add_string(symbol, textpart4, text_xposn, text_yposn, upcae_outside_text_height,
-                        textwidth, 1 /*left align*/, &last_string)) return ZINT_ERROR_MEMORY;
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = 105.0f + xoffset + addon_gap;
-                        textwidth = 2.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
-                    case 5:
-                        text_xposn = 119.0f + xoffset + addon_gap;
-                        textwidth = 5.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
+                if (!vector_plot_add_string(symbol, textparts[3], 1, text_xposn, text_yposn,
+                        upcae_outside_text_height, textwidth, 1 /*left align*/,
+                        &last_string)) return ZINT_ERROR_MEMORY;
+                if (addon_len) {
+                    text_xposn = (addon_len == 2 ? 105.0f : 119.0f) + xoffset + addon_gap;
+                    textwidth = addon_len * 8.5f;
+                    if (!vector_plot_add_string(symbol, addon, addon_len, text_xposn, addon_text_yposn,
+                            text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
                 }
 
             } else { /* EAN-13 */
-                text_xposn = -5.0f + xoffset;
+                text_xposn = -(5.0f - 0.1f) + xoffset;
                 textwidth = 8.5f;
-                if (!vector_plot_add_string(symbol, textpart1, text_xposn, text_yposn,
+                if (!vector_plot_add_string(symbol, textparts[0], 1, text_xposn, text_yposn,
                         text_height, textwidth, 2 /*right align*/, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 24.0f + xoffset;
+                text_xposn = (24.0f + 0.5f) + xoffset;
                 textwidth = 6.0f * 8.5f;
-                if (!vector_plot_add_string(symbol, textpart2, text_xposn, text_yposn,
-                        text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                text_xposn = 71.0f + xoffset;
-                if (!vector_plot_add_string(symbol, textpart3, text_xposn, text_yposn,
-                        text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                switch (ustrlen(addon)) {
-                    case 2:
-                        text_xposn = 105.0f + xoffset + addon_gap;
-                        textwidth = 2.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
-                    case 5:
-                        text_xposn = 119.0f + xoffset + addon_gap;
-                        textwidth = 5.0f * 8.5f;
-                        if (!vector_plot_add_string(symbol, addon, text_xposn, addon_text_yposn,
-                                text_height, textwidth, 0, &last_string)) return ZINT_ERROR_MEMORY;
-                        break;
+                if (!vector_plot_add_string(symbol, textparts[1], 6, text_xposn, text_yposn,
+                        text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                text_xposn = (71.0f - 0.5f) + xoffset;
+                if (!vector_plot_add_string(symbol, textparts[2], 6, text_xposn, text_yposn,
+                        text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
+                if (addon_len) {
+                    text_xposn = (addon_len == 2 ? 105.0f : 119.0f) + xoffset + addon_gap;
+                    textwidth = addon_len * 8.5f;
+                    if (!vector_plot_add_string(symbol, addon, addon_len, text_xposn, addon_text_yposn,
+                            text_height, textwidth, 0 /*centre align*/, &last_string)) return ZINT_ERROR_MEMORY;
                 }
             }
         } else {
             /* Put normal human readable text at the bottom (and centered) */
             /* calculate start xoffset to center text */
             text_xposn = main_width / 2.0f + xoffset;
-            if (!vector_plot_add_string(symbol, symbol->text, text_xposn, text_yposn,
+            if (!vector_plot_add_string(symbol, symbol->text, -1, text_xposn, text_yposn,
                     text_height, symbol->width, 0, &last_string)) return ZINT_ERROR_MEMORY;
         }
 
diff -urN zint-2.12.0/backend/zintconfig.h zint/backend/zintconfig.h
--- zint-2.12.0/backend/zintconfig.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/zintconfig.h	2023-05-08 14:39:44.964319953 +0200
@@ -37,7 +37,7 @@
 #define ZINT_VERSION_MAJOR      2
 #define ZINT_VERSION_MINOR      12
 #define ZINT_VERSION_RELEASE    0
-#define ZINT_VERSION_BUILD      0
+#define ZINT_VERSION_BUILD      9
 
 /* vim: set ts=4 sw=4 et : */
 #endif /* ZINTCONFIG_H */
diff -urN zint-2.12.0/backend/zint.h zint/backend/zint.h
--- zint-2.12.0/backend/zint.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend/zint.h	2023-05-08 14:39:44.964319953 +0200
@@ -1,7 +1,7 @@
 /*  zint.h - definitions for libzint */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -42,34 +42,37 @@
 extern "C" {
 #endif /* __cplusplus */
 
+    /* Vector elements - see vector header `zint_vector` below */
     struct zint_vector_rect {
-        float x, y, height, width;
+        float x, y;         /* Top left */
+        float height, width;
         int colour;         /* -1 for foreground, 1-8 for Cyan, Blue, Magenta, Red, Yellow, Green, Black, White */
         struct zint_vector_rect *next; /* Pointer to next rectangle */
     };
 
     struct zint_vector_hexagon {
-        float x, y, diameter;
-        int rotation;       /* 0, 90, 180, 270 degrees */
+        float x, y;         /* Centre */
+        float diameter;     /* Short (minimal) diameter (i.e. diameter of inscribed circle) */
+        int rotation;       /* 0, 90, 180, 270 degrees, where 0 has apex at top, i.e. short diameter is horizontal */
         struct zint_vector_hexagon *next; /* Pointer to next hexagon */
     };
 
     struct zint_vector_string {
-        float x, y;         /* x, y position relative to halign */
+        float x, y;         /* x is relative to halign (i.e. centre, left, right), y is relative to baseline */
         float fsize;        /* Font size */
         float width;        /* Suggested string width, may be 0 if none recommended */
-        int length;         /* Number of characters */
+        int length;         /* Number of characters (bytes) */
         int rotation;       /* 0, 90, 180, 270 degrees */
         int halign;         /* Horizontal alignment: 0 for centre, 1 for left, 2 for right (end) */
-        unsigned char *text;
+        unsigned char *text; /* UTF-8, NUL-terminated */
         struct zint_vector_string *next; /* Pointer to next string */
     };
 
     struct zint_vector_circle {
-        float x, y;
+        float x, y;         /* Centre */
         float diameter;     /* Circle diameter. Does not include width (if any) */
         float width;        /* Width of circle perimeter (circumference). 0 for fill (disc) */
-        int colour;         /* Non-zero for draw with background colour (else draw with foreground colour) */
+        int colour;         /* Zero for draw with foreground colour (else draw with background colour (legacy)) */
         struct zint_vector_circle *next; /* Pointer to next circle */
     };
 
@@ -98,8 +101,8 @@
         int whitespace_height; /* Height in X-dimensions of whitespace above & below the barcode */
         int border_width;   /* Size of border in X-dimensions */
         int output_options; /* Various output parameters (bind, box etc, see below) */
-        char fgcolour[10];  /* Foreground as RGB/RGBA hexadecimal string, 6 or 8 characters, NUL-terminated */
-        char bgcolour[10];  /* Background as RGB/RGBA hexadecimal string, 6 or 8 characters, NUL-terminated */
+        char fgcolour[16];  /* Foreground as hexadecimal RGB/RGBA or decimal "C,M,Y,K" string, NUL-terminated */
+        char bgcolour[16];  /* Background as hexadecimal RGB/RGBA or decimal "C,M,Y,K" string, NUL-terminated */
         char *fgcolor;      /* Pointer to fgcolour (alternate spelling) */
         char *bgcolor;      /* Pointer to bgcolour (alternate spelling) */
         char outfile[256];  /* Name of file to output to, NUL-terminated. Default "out.png" ("out.gif" if no PNG) */
@@ -113,6 +116,7 @@
         int eci;            /* Extended Channel Interpretation. Default 0 (none) */
         float dpmm;         /* Resolution of output in dots per mm (BMP/EMF/PCX/PNG/TIF only). Default 0 (none) */
         float dot_size;     /* Size of dots used in BARCODE_DOTTY_MODE. Default 0.8 */
+        float text_gap;     /* Gap between barcode and text (HRT). 0 means use default (font-specific) */
         float guard_descent; /* Height in X-dimensions that EAN/UPC guard bars descend. Default 5 */
         struct zint_structapp structapp; /* Structured Append info. Default structapp.count 0 (none) */
         int warn_level;     /* Affects error/warning value returned by Zint API (see WARN_XXX below) */
@@ -185,7 +189,7 @@
 #define BARCODE_PDF417TRUNC     56  /* Legacy */
 #define BARCODE_MAXICODE        57  /* MaxiCode */
 #define BARCODE_QRCODE          58  /* QR Code */
-#define BARCODE_CODE128AB       60  /* Code 128 (Suppress subset C) */
+#define BARCODE_CODE128AB       60  /* Code 128 (Suppress Code Set C) */
 #define BARCODE_CODE128B        60  /* Legacy */
 #define BARCODE_AUSPOST         63  /* Australia Post Standard Customer */
 #define BARCODE_AUSREPLY        66  /* Australia Post Reply Paid */
@@ -300,6 +304,8 @@
 #define HEIGHTPERROW_MODE       0x0040  /* Interpret `height` as per-row rather than as overall height */
 #define FAST_MODE               0x0080  /* Use faster if less optimal encodation or other shortcuts if available */
                                         /* Note: affects DATAMATRIX, MICROPDF417, PDF417, QRCODE & UPNQR only */
+#define EXTRA_ESCAPE_MODE       0x0100  /* Process special symbology-specific escape sequences */
+                                        /* Note: currently Code 128 only */
 
 /* Data Matrix specific options (`symbol->option_3`) */
 #define DM_SQUARE               100     /* Only consider square versions on automatic symbol size selection */
diff -urN zint-2.12.0/backend_qt/backend_qt.pro zint/backend_qt/backend_qt.pro
--- zint-2.12.0/backend_qt/backend_qt.pro	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/backend_qt.pro	2023-05-08 14:39:44.965319959 +0200
@@ -17,7 +17,7 @@
 INCLUDEPATH += ../backend
 
 #EDIT THIS !!!!
-DEFINES += ZINT_VERSION="\\\"2.12.0\\\""
+DEFINES += ZINT_VERSION="\\\"2.12.0.9\\\""
 
 !contains(DEFINES, ZINT_NO_PNG) {
     INCLUDEPATH += ../../lpng
@@ -117,7 +117,7 @@
            ../backend/dllversion.c \
            qzint.cpp
 
-VERSION = 2.12.0
+VERSION = 2.12.0.9
 
 #DESTDIR = .
 
diff -urN zint-2.12.0/backend_qt/backend_vc8.pro zint/backend_qt/backend_vc8.pro
--- zint-2.12.0/backend_qt/backend_vc8.pro	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/backend_vc8.pro	2023-05-08 14:39:44.965319959 +0200
@@ -4,7 +4,7 @@
 }
 
 TARGET = QtZint2
-VERSION = 2.12.0
+VERSION = 2.12.0.9
 
 QMAKE_CFLAGS += /TP /wd4018 /wd4244 /wd4305
 QMAKE_CXXFLAGS += /TP /wd4018 /wd4244 /wd4305
diff -urN zint-2.12.0/backend_qt/qzint.cpp zint/backend_qt/qzint.cpp
--- zint-2.12.0/backend_qt/qzint.cpp	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/qzint.cpp	2023-05-08 14:39:44.965319959 +0200
@@ -1,7 +1,7 @@
 /***************************************************************************
  *   Copyright (C) 2008 by BogDan Vatra                                    *
  *   bogdan@licentia.eu                                                    *
- *   Copyright (C) 2010-2022 Robin Stuart                                  *
+ *   Copyright (C) 2010-2023 Robin Stuart                                  *
  *                                                                         *
  *   This program is free software: you can redistribute it and/or modify  *
  *   it under the terms of the GNU General Public License as published by  *
@@ -29,18 +29,54 @@
 #include <QFontMetrics>
 /* The following include is necessary to compile with Qt 5.15 on Windows; Qt 5.7 did not require it */
 #include <QPainterPath>
+#include <QRegularExpression>
 
 // Shorthand
 #define QSL QStringLiteral
 
 namespace Zint {
-    static const char fontStyle[] = "Helvetica";
-    static const char fontStyleError[] = "Helvetica";
+    static const QString fontFamily = QSL("Helvetica");
+    static const QString fontFamilyError = QSL("Helvetica");
     static const int fontSizeError = 14; /* Point size */
 
     static const int maxSegs = 256;
     static const int maxCLISegs = 10; /* CLI restricted to 10 segments (including main data) */
 
+    static const QRegularExpression colorRE(
+                                QSL("^([0-9A-Fa-f]{6}([0-9A-Fa-f]{2})?)|(((100|[0-9]{0,2}),){3}(100|[0-9]{0,2}))$"));
+
+    static QString qcolor_to_str(const QColor &color) {
+        if (color.alpha() == 0xFF) {
+            return QString::asprintf("%02X%02X%02X", color.red(), color.green(), color.blue());
+        }
+        return QString::asprintf("%02X%02X%02X%02X", color.red(), color.green(), color.blue(), color.alpha());
+    }
+
+    static QColor str_to_qcolor(const QString &text) {
+        QColor color;
+        int r, g, b, a;
+        if (text.contains(',')) {
+            int comma1 = text.indexOf(',');
+            int comma2 = text.indexOf(',', comma1 + 1);
+            int comma3 = text.indexOf(',', comma2 + 1);
+            int black = 100 - text.mid(comma3 + 1).toInt();
+            int val = 100 - text.mid(0, comma1).toInt();
+            r = (int) roundf((0xFF * val * black) / 10000.0f);
+            val = 100 - text.mid(comma1 + 1, comma2 - comma1 - 1).toInt();
+            g = (int) roundf((0xFF * val * black) / 10000.0f);
+            val = 100 - text.mid(comma2 + 1, comma3 - comma2 - 1).toInt();
+            b = (int) roundf((0xFF * val * black) / 10000.0f);
+            a = 0xFF;
+        } else {
+            r = text.mid(0, 2).toInt(nullptr, 16);
+            g = text.mid(2, 2).toInt(nullptr, 16);
+            b = text.mid(4, 2).toInt(nullptr, 16);
+            a = text.length() == 8 ? text.mid(6, 2).toInt(nullptr, 16) : 0xFF;
+        }
+        color.setRgb(r, g, b, a);
+        return color;
+    }
+
     /* Helper to convert ECI combo index to ECI value */
     static int ECIIndexToECI(const int ECIIndex) {
         int ret;
@@ -94,6 +130,7 @@
                 maxBottom = circle->y + circle->diameter + circle->width;
             }
         }
+
         // TODO: Strings?
     }
 
@@ -109,7 +146,8 @@
             m_scale(1.0f),
             m_dotty(false), m_dot_size(4.0f / 5.0f),
             m_guardDescent(5.0f),
-            m_fgColor(Qt::black), m_bgColor(Qt::white), m_cmyk(false),
+            m_textGap(0.0f),
+            m_fgStr(QSL("000000")), m_bgStr(QSL("FFFFFF")), m_cmyk(false),
             m_borderType(0), m_borderWidth(0),
             m_whitespace(0), m_vwhitespace(0),
             m_fontSetting(0),
@@ -175,14 +213,8 @@
         if (m_reader_init) {
             m_zintSymbol->output_options |= READER_INIT;
         }
-        strcpy(m_zintSymbol->fgcolour, m_fgColor.name().toLatin1().right(6));
-        if (m_fgColor.alpha() != 0xFF) {
-            strcat(m_zintSymbol->fgcolour, m_fgColor.name(QColor::HexArgb).toLatin1().mid(1,2));
-        }
-        strcpy(m_zintSymbol->bgcolour, m_bgColor.name().toLatin1().right(6));
-        if (m_bgColor.alpha() != 0xFF) {
-            strcat(m_zintSymbol->bgcolour, m_bgColor.name(QColor::HexArgb).toLatin1().mid(1,2));
-        }
+        strcpy(m_zintSymbol->fgcolour, m_fgStr.toLatin1().left(15));
+        strcpy(m_zintSymbol->bgcolour, m_bgStr.toLatin1().left(15));
         strcpy(m_zintSymbol->primary, m_primaryMessage.toLatin1().left(127));
         m_zintSymbol->option_1 = m_option_1;
         m_zintSymbol->option_2 = m_option_2;
@@ -199,6 +231,7 @@
         m_zintSymbol->dpmm = m_dpmm;
         m_zintSymbol->dot_size = m_dot_size;
         m_zintSymbol->guard_descent = m_guardDescent;
+        m_zintSymbol->text_gap = m_textGap;
         m_zintSymbol->structapp = m_structapp;
         m_zintSymbol->warn_level = m_warn_level;
         m_zintSymbol->debug = m_debug ? ZINT_DEBUG_PRINT : 0;
@@ -412,22 +445,48 @@
         memset(&m_structapp, 0, sizeof(m_structapp));
     }
 
-    /* Foreground colour */
+    /* Foreground colour (may be RGB(A) hex string or CMYK decimal "C,M,Y,K" percentage string) */
+    QString QZint::fgStr() const {
+        return m_fgStr;
+    }
+
+    bool QZint::setFgStr(const QString& fgStr) {
+        if (fgStr.indexOf(colorRE) == 0) {
+            m_fgStr = fgStr;
+            return true;
+        }
+        return false;
+    }
+
+    /* Foreground colour as QColor */
     QColor QZint::fgColor() const {
-        return m_fgColor;
+        return str_to_qcolor(m_fgStr);
     }
 
     void QZint::setFgColor(const QColor& fgColor) {
-        m_fgColor = fgColor;
+        m_fgStr = qcolor_to_str(fgColor);
+    }
+
+    /* Background colour (may be RGB(A) hex string or CMYK decimal "C,M,Y,K" percentage string) */
+    QString QZint::bgStr() const {
+        return m_bgStr;
     }
 
-    /* Background colour */
+    bool QZint::setBgStr(const QString& bgStr) {
+        if (bgStr.indexOf(colorRE) == 0) {
+            m_bgStr = bgStr;
+            return true;
+        }
+        return false;
+    }
+
+    /* Background colour as QColor */
     QColor QZint::bgColor() const {
-        return m_bgColor;
+        return str_to_qcolor(m_bgStr);
     }
 
     void QZint::setBgColor(const QColor& bgColor) {
-        m_bgColor = bgColor;
+        m_bgStr = qcolor_to_str(bgColor);
     }
 
     /* Use CMYK colour space (Encapsulated PostScript and TIF) */
@@ -510,6 +569,15 @@
         }
     }
 
+    /* Text gap */
+    float QZint::textGap() const {
+        return m_textGap;
+    }
+
+    void QZint::setTextGap(float textGap) {
+        m_textGap = textGap;
+    }
+
     /* Show (true) or hide (false) Human Readable Text */
     bool QZint::showText() const {
         return m_show_hrt;
@@ -848,6 +916,8 @@
         struct zint_vector_hexagon *hex;
         struct zint_vector_circle *circle;
         struct zint_vector_string *string;
+        QColor fgColor = str_to_qcolor(m_fgStr);
+        QColor bgColor = str_to_qcolor(m_bgStr);
 
         encode();
 
@@ -855,7 +925,7 @@
 
         if (m_error >= ZINT_ERROR) {
             painter.setRenderHint(QPainter::Antialiasing);
-            QFont font(fontStyleError, fontSizeError);
+            QFont font(fontFamilyError, fontSizeError);
             painter.setFont(font);
             painter.drawText(paintRect, Qt::AlignCenter | Qt::TextWordWrap, m_lastError);
             painter.restore();
@@ -897,8 +967,10 @@
         painter.translate(xtr, ytr);
         painter.scale(scale, scale);
 
-        QBrush bgBrush(m_bgColor);
-        painter.fillRect(QRectF(0, 0, gwidth, gheight), bgBrush);
+        QBrush bgBrush(bgColor);
+        if (bgColor.alpha() != 0) {
+            painter.fillRect(QRectF(0, 0, gwidth, gheight), bgBrush);
+        }
 
         // Plot rectangles
         rect = m_zintSymbol->vector->rectangles;
@@ -908,7 +980,7 @@
             QBrush brush(Qt::SolidPattern);
             while (rect) {
                 if (rect->colour == -1) {
-                    brush.setColor(m_fgColor);
+                    brush.setColor(fgColor);
                 } else {
                     brush.setColor(colourToQtColor(rect->colour));
                 }
@@ -924,7 +996,7 @@
         hex = m_zintSymbol->vector->hexagons;
         if (hex) {
             painter.setRenderHint(QPainter::Antialiasing);
-            QBrush fgBrush(m_fgColor);
+            QBrush fgBrush(fgColor);
             qreal previous_diameter = 0.0, radius = 0.0, half_radius = 0.0, half_sqrt3_radius = 0.0;
             while (hex) {
                 if (previous_diameter != hex->diameter) {
@@ -953,20 +1025,20 @@
         if (circle) {
             painter.setRenderHint(QPainter::Antialiasing);
             QPen p;
-            QBrush fgBrush(m_fgColor);
+            QBrush fgBrush(fgColor);
             qreal previous_diameter = 0.0, radius = 0.0;
             while (circle) {
                 if (previous_diameter != circle->diameter) {
                     previous_diameter = circle->diameter;
                     radius = 0.5 * previous_diameter;
                 }
-                if (circle->colour) { // Set means use background colour
-                    p.setColor(m_bgColor);
+                if (circle->colour) { // Set means use background colour (legacy, no longer used)
+                    p.setColor(bgColor);
                     p.setWidthF(circle->width);
                     painter.setPen(p);
                     painter.setBrush(circle->width ? Qt::NoBrush : bgBrush);
                 } else {
-                    p.setColor(m_fgColor);
+                    p.setColor(fgColor);
                     p.setWidthF(circle->width);
                     painter.setPen(p);
                     painter.setBrush(circle->width ? Qt::NoBrush : fgBrush);
@@ -981,11 +1053,10 @@
         if (string) {
             painter.setRenderHint(QPainter::Antialiasing);
             QPen p;
-            p.setColor(m_fgColor);
+            p.setColor(fgColor);
             painter.setPen(p);
-            bool bold = (m_zintSymbol->output_options & BOLD_TEXT)
-                            && (!isExtendable() || (m_zintSymbol->output_options & SMALL_TEXT));
-            QFont font(fontStyle, -1 /*pointSize*/, bold ? QFont::Bold : -1);
+            bool bold = (m_zintSymbol->output_options & BOLD_TEXT) && !isExtendable();
+            QFont font(fontFamily, -1 /*pointSize*/, bold ? QFont::Bold : -1);
             while (string) {
                 font.setPixelSize(string->fsize);
                 painter.setFont(font);
@@ -995,7 +1066,7 @@
                     painter.drawText(QPointF(string->x, string->y), content);
                 } else {
                     QFontMetrics fm(painter.fontMetrics());
-                    int width = fm.boundingRect(content).width();
+                    int width = fm.horizontalAdvance(content);
                     if (string->halign == 2) { /* Right align */
                         painter.drawText(QPointF(string->x - width, string->y), content);
                     } else { /* Centre align */
@@ -1080,6 +1151,8 @@
                     const bool autoHeight, const float heightPerRow, const QString& outfile,
                     const QZintXdimDpVars *xdimdpVars) const {
         QString cmd(win && !noEXE ? QSL("zint.exe") : QSL("zint"));
+        const bool nobackground = bgColor().alpha() == 0;
+        const bool notext = hasHRT() && !showText();
 
         char name_buf[32];
         if (barcodeNames && ZBarcode_BarcodeName(m_symbol, name_buf) == 0) {
@@ -1093,8 +1166,8 @@
             arg_int(cmd, "--addongap=", option2());
         }
 
-        if (bgColor() != Qt::white && bgColor() != QColor(0xFF, 0xFF, 0xFF, 0)) {
-            arg_color(cmd, "--bg=", bgColor());
+        if (bgStr() != QSL("FFFFFF") && !nobackground) {
+            arg_str(cmd, "--bg=", bgStr());
         }
 
         bool default_bind = false, default_bind_top = false, default_box = false, default_border = false;
@@ -1120,7 +1193,7 @@
         if (!default_bind_top) {
             arg_bool(cmd, "--bindtop", borderType() & BARCODE_BIND_TOP);
         }
-        arg_bool(cmd, "--bold", fontSetting() & BOLD_TEXT);
+        arg_bool(cmd, "--bold", !notext && (fontSetting() & BOLD_TEXT) && !isExtendable());
         if (!default_border) {
             arg_int(cmd, "--border=", borderWidth());
         }
@@ -1163,10 +1236,11 @@
         }
 
         arg_bool(cmd, "--esc", inputMode() & ESCAPE_MODE);
+        arg_bool(cmd, "--extraesc", inputMode() & EXTRA_ESCAPE_MODE);
         arg_bool(cmd, "--fast", inputMode() & FAST_MODE);
 
-        if (fgColor() != Qt::black) {
-            arg_color(cmd, "--fg=", fgColor());
+        if (fgStr() != QSL("000000") && fgStr() != QSL("000000FF")) {
+            arg_str(cmd, "--fg=", fgStr());
         }
 
         arg_bool(cmd, "--fullmultibyte", supportsFullMultibyte() && (option3() & 0xFF) == ZINT_FULL_MULTIBYTE);
@@ -1201,9 +1275,9 @@
             arg_int(cmd, "--mode=", option1());
         }
 
-        arg_bool(cmd, "--nobackground", bgColor() == QColor(0xFF, 0xFF, 0xFF, 0));
+        arg_bool(cmd, "--nobackground", nobackground);
         arg_bool(cmd, "--noquietzones", hasDefaultQuietZones() && noQuietZones());
-        arg_bool(cmd, "--notext", hasHRT() && !showText());
+        arg_bool(cmd, "--notext", notext);
         arg_data(cmd, longOptOnly ? "--output=" : "-o ", outfile, win);
 
         if (m_symbol == BARCODE_MAXICODE || isComposite()) {
@@ -1244,7 +1318,7 @@
             arg_int(cmd, "--separator=", option3());
         }
 
-        arg_bool(cmd, "--small", fontSetting() & SMALL_TEXT);
+        arg_bool(cmd, "--small", !notext && (fontSetting() & SMALL_TEXT));
 
         if (m_symbol == BARCODE_DATAMATRIX || m_symbol == BARCODE_HIBC_DM) {
             arg_bool(cmd, "--square", option3() == DM_SQUARE);
@@ -1254,6 +1328,10 @@
             arg_structapp(cmd, "--structapp=", structAppCount(), structAppIndex(), structAppID(), win);
         }
 
+        if (!notext && textGap() != 0.0f) {
+            arg_float(cmd, "--textgap=", textGap(), true /*allowZero*/);
+        }
+
         arg_bool(cmd, "--verbose", debug());
 
         if (m_symbol == BARCODE_AZTEC || m_symbol == BARCODE_HIBC_AZTEC
@@ -1299,14 +1377,6 @@
         }
     }
 
-    void QZint::arg_color(QString& cmd, const char *const opt, const QColor val) {
-        if (val.alpha() != 0xFF) {
-            cmd += QString::asprintf(" %s%02X%02X%02X%02X", opt, val.red(), val.green(), val.blue(), val.alpha());
-        } else {
-            cmd += QString::asprintf(" %s%02X%02X%02X", opt, val.red(), val.green(), val.blue());
-        }
-    }
-
     void QZint::arg_data(QString& cmd, const char *const opt, const QString& val, const bool win) {
         if (!val.isEmpty()) {
             QString text(val);
diff -urN zint-2.12.0/backend_qt/qzint.h zint/backend_qt/qzint.h
--- zint-2.12.0/backend_qt/qzint.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/qzint.h	2023-05-08 14:39:44.965319959 +0200
@@ -1,7 +1,7 @@
 /***************************************************************************
  *   Copyright (C) 2008 by BogDan Vatra                                    *
  *   bogdan@licentia.eu                                                    *
- *   Copyright (C) 2010-2022 Robin Stuart                                  *
+ *   Copyright (C) 2010-2023 Robin Stuart                                  *
  *                                                                         *
  *   This program is free software: you can redistribute it and/or modify  *
  *   it under the terms of the GNU General Public License as published by  *
@@ -124,11 +124,19 @@
     void setStructApp(const int count, const int index, const QString& id);
     void clearStructApp();
 
-    /* Foreground colour */
+    /* Foreground colour (may be RGB(A) hex string or CMYK decimal "C,M,Y,K" percentage string) */
+    QString fgStr() const; // `symbol->fgcolour`
+    bool setFgStr(const QString& fgStr); // Returns false if not valid colour string
+
+    /* Foreground colour as QColor */
     QColor fgColor() const; // `symbol->fgcolour`
     void setFgColor(const QColor& fgColor);
 
-    /* Background colour */
+    /* Background colour (may be RGB(A) hex string or CMYK decimal "C,M,Y,K" percentage string) */
+    QString bgStr() const; // `symbol->bgcolour`
+    bool setBgStr(const QString& bgStr); // Returns false if not valid colour string
+
+    /* Background colour as QColor */
     QColor bgColor() const; // `symbol->bgcolour`
     void setBgColor(const QColor& bgColor);
 
@@ -157,6 +165,10 @@
     void setFontSetting(int fontSettingIndex); // Sets from comboBox index
     void setFontSettingValue(int fontSetting); // Sets literal value
 
+    /* Text gap */
+    float textGap() const; // `symbol->text_gap`
+    void setTextGap(float textGap);
+
     /* Show (true) or hide (false) Human Readable Text */
     bool showText() const; // `symbol->show_hrt`
     void setShowText(bool showText);
@@ -322,7 +334,6 @@
     static void arg_str(QString& cmd, const char *const opt, const QString& val);
     static void arg_int(QString& cmd, const char *const opt, const int val, const bool allowZero = false);
     static void arg_bool(QString& cmd, const char *const opt, const bool val);
-    static void arg_color(QString& cmd, const char *const opt, const QColor val);
     static void arg_data(QString& cmd, const char *const opt, const QString& val, const bool win);
     static void arg_seg(QString& cmd, const int seg_no, const QZintSeg& val, const bool win);
     static void arg_data_esc(QString& cmd, const char *const opt, QString& text, const bool win);
@@ -348,9 +359,10 @@
     bool m_dotty;
     float m_dot_size;
     float m_guardDescent;
+    float m_textGap;
     struct zint_structapp m_structapp;
-    QColor m_fgColor;
-    QColor m_bgColor;
+    QString m_fgStr;
+    QString m_bgStr;
     bool m_cmyk;
     int m_borderType;
     int m_borderWidth;
diff -urN zint-2.12.0/backend_qt/tests/CMakeLists.txt zint/backend_qt/tests/CMakeLists.txt
--- zint-2.12.0/backend_qt/tests/CMakeLists.txt	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/tests/CMakeLists.txt	2023-05-08 14:39:44.965319959 +0200
@@ -1,4 +1,4 @@
-# Copyright (C) 2021 Robin Stuart <rstuart114@gmail.com>
+# Copyright (C) 2021-23 Robin Stuart <rstuart114@gmail.com>
 # vim: set ts=4 sw=4 et :
 
 cmake_minimum_required(VERSION 3.5)
@@ -17,6 +17,12 @@
 set(CMAKE_AUTOMOC ON)
 
 add_executable(test_qzint test_qzint.cpp)
-add_test(NAME qzint COMMAND test_qzint)
-
 target_link_libraries(test_qzint PRIVATE QZint Qt${QT_VERSION_MAJOR}::Test)
+add_test(NAME qzint COMMAND test_qzint)
+if(MSVC)
+    set_tests_properties(qzint PROPERTIES ENVIRONMENT
+        "PATH=${CMAKE_BINARY_DIR}/backend/${CMAKE_BUILD_TYPE}\;${CMAKE_BINARY_DIR}/frontend/${CMAKE_BUILD_TYPE}\;$ENV{PATH}")
+else()
+    set_tests_properties(qzint PROPERTIES ENVIRONMENT
+        "LD_LIBRARY_PATH=${CMAKE_BINARY_DIR}/backend;PATH=${CMAKE_BINARY_DIR}/frontend:$ENV{PATH}")
+endif()
diff -urN zint-2.12.0/backend_qt/tests/test_qzint.cpp zint/backend_qt/tests/test_qzint.cpp
--- zint-2.12.0/backend_qt/tests/test_qzint.cpp	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_qt/tests/test_qzint.cpp	2023-05-08 14:39:44.966319965 +0200
@@ -1,5 +1,5 @@
 /***************************************************************************
- *   Copyright (C) 2021-2022 by Robin Stuart <rstuart114@gmail.com>        *
+ *   Copyright (C) 2021-2023 by Robin Stuart <rstuart114@gmail.com>        *
  *                                                                         *
  *   This program is free software: you can redistribute it and/or modify  *
  *   it under the terms of the GNU General Public License as published by  *
@@ -127,6 +127,10 @@
         bc.setDotSize(dotSize);
         QCOMPARE(bc.dotSize(), dotSize);
 
+        float textGap = 4.321f;
+        bc.setTextGap(textGap);
+        QCOMPARE(bc.textGap(), textGap);
+
         float guardDescent = 0.678f;
         bc.setGuardDescent(guardDescent);
         QCOMPARE(bc.guardDescent(), guardDescent);
@@ -137,13 +141,27 @@
         QCOMPARE(bc.structAppIndex(), structapp.index);
         QCOMPARE(bc.structAppID(), QString(structapp.id));
 
+        QString fgStr("12344567");
+        bc.setFgStr(fgStr);
+        QCOMPARE(bc.fgStr(), fgStr);
+
         QColor fgColor(0x12, 0x34, 0x45, 0x67);
         bc.setFgColor(fgColor);
         QCOMPARE(bc.fgColor(), fgColor);
+        QCOMPARE(bc.fgStr(), fgStr);
+
+        QString bgStr("89ABCDEF");
+        bc.setBgStr(bgStr);
+        QCOMPARE(bc.bgStr(), bgStr);
 
         QColor bgColor(0x89, 0xAB, 0xCD, 0xEF);
         bc.setBgColor(bgColor);
         QCOMPARE(bc.bgColor(), bgColor);
+        QCOMPARE(bc.bgStr(), bgStr);
+
+        QString bgStr2("71,0,40,44");
+        bc.setBgStr(bgStr2);
+        QCOMPARE(bc.bgStr(), bgStr2);
 
         bool cmyk = true;
         bc.setCMYK(cmyk);
@@ -500,8 +518,10 @@
 
         QTest::addColumn<int>("symbology");
         QTest::addColumn<int>("inputMode");
+
         QTest::addColumn<QString>("text");
         QTest::addColumn<QString>("primary");
+
         QTest::addColumn<float>("height");
         QTest::addColumn<int>("option1");
         QTest::addColumn<int>("option2");
@@ -510,24 +530,32 @@
         QTest::addColumn<float>("dpmm");
         QTest::addColumn<bool>("dotty");
         QTest::addColumn<float>("dotSize");
+        QTest::addColumn<float>("textGap");
+
         QTest::addColumn<float>("guardDescent");
         QTest::addColumn<int>("structAppCount");
         QTest::addColumn<int>("structAppIndex");
         QTest::addColumn<QString>("structAppID");
+
+        QTest::addColumn<QString>("fgStr");
+        QTest::addColumn<QString>("bgStr");
         QTest::addColumn<QColor>("fgColor");
         QTest::addColumn<QColor>("bgColor");
         QTest::addColumn<bool>("cmyk");
+
         QTest::addColumn<int>("borderTypeIndex");
         QTest::addColumn<int>("borderWidth");
         QTest::addColumn<int>("whitespace");
         QTest::addColumn<int>("vWhitespace");
         QTest::addColumn<int>("fontSetting");
+
         QTest::addColumn<bool>("showText");
         QTest::addColumn<bool>("gsSep");
         QTest::addColumn<bool>("quietZones");
         QTest::addColumn<bool>("noQuietZones");
         QTest::addColumn<bool>("compliantHeight");
         QTest::addColumn<int>("rotateAngle");
+
         QTest::addColumn<int>("eci");
         QTest::addColumn<bool>("gs1Parens");
         QTest::addColumn<bool>("gs1NoCheck");
@@ -535,8 +563,8 @@
         QTest::addColumn<int>("warnLevel");
         QTest::addColumn<bool>("debug");
 
-        QTest::addColumn<double>("xdimdp_xdim");
-        QTest::addColumn<int>("xdimdp_xdim_units");
+        QTest::addColumn<double>("xdimdp_x_dim");
+        QTest::addColumn<int>("xdimdp_x_dim_units");
         QTest::addColumn<int>("xdimdp_resolution");
         QTest::addColumn<int>("xdimdp_resolution_units");
         QTest::addColumn<int>("xdimdp_filetype");
@@ -552,9 +580,10 @@
         QTest::newRow("BARCODE_AUSPOST") << true << 0.0f << ""
             << BARCODE_AUSPOST << DATA_MODE // symbology-inputMode
             << "12345678" << "" // text-primary
-            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -568,9 +597,10 @@
         QTest::newRow("BARCODE_AZTEC") << false << 0.0f << ""
             << BARCODE_AZTEC << UNICODE_MODE // symbology-inputMode
             << "12345678Ð0%var%" << "" // text-primary
-            << 0.0f << 1 << 0 << 0 << 4.0f << 0.0f << true << 0.9f // height-dotSize
-            << 5.0f << 2 << 1 << "as\"dfa'sdf" << QColor(Qt::blue) << QColor(Qt::white) // guardDescent-bgColor
-            << true << 0 << 0 << 2 << 3 << 0 // cmyk-fontSetting
+            << 0.0f << 1 << 0 << 0 << 4.0f << 0.0f << true << 0.9f << 0.0f // height-textGap
+            << 5.0f << 2 << 1 << "as\"dfa'sdf" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::blue) << QColor(Qt::white) << true // fgStr-cmyk
+            << 0 << 0 << 2 << 3 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << false << 0 // showText-rotateAngle
             << 7 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -580,12 +610,29 @@
                 " --secure=1 --structapp=\"1,2,as\\\"dfa'sdf\" --vwhitesp=3 -w 2"
             << "" << "" << "" << "";
 
+        QTest::newRow("BARCODE_AZTEC") << false << 0.0f << ""
+            << BARCODE_AZTEC << UNICODE_MODE // symbology-inputMode
+            << "12345678Ð0%var%" << "" // text-primary
+            << 0.0f << 1 << 0 << 0 << 4.0f << 0.0f << true << 0.9f << 0.0f // height-textGap
+            << 5.0f << 2 << 1 << "as\"dfa'sdf" // guardDescent-structAppID
+            << "71,0,40,44" << "0,0,0,0" << QColor(Qt::black) << QColor(Qt::white) << true // fgStr-cmyk
+            << 0 << 0 << 2 << 3 << 0 // borderTypeIndex-fontSetting
+            << true << false << false << false << false << 0 // showText-rotateAngle
+            << 7 << false << false << false << WARN_DEFAULT << false // eci-debug
+            << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
+            << "zint -b 92 --bg=0,0,0,0 --cmyk --eci=7 -d '12345678Ð0%var%' --dotsize=0.9 --dotty --fg=71,0,40,44 --scale=4"
+                " --secure=1 --structapp='1,2,as\"dfa'\\''sdf' --vwhitesp=3 -w 2"
+            << "zint.exe -b 92 --bg=0,0,0,0 --cmyk --eci=7 -d \"12345678Ð0%var%\" --dotsize=0.9 --dotty --fg=71,0,40,44 --scale=4"
+                " --secure=1 --structapp=\"1,2,as\\\"dfa'sdf\" --vwhitesp=3 -w 2"
+            << "" << "" << "" << "";
+
         QTest::newRow("BARCODE_C25INTER") << true << 0.0f << ""
             << BARCODE_C25INTER << UNICODE_MODE // symbology-inputMode
             << "12345" << "" // text-primary
-            << 0.0f << -1 << 2 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << SMALL_TEXT // cmyk-fontSetting
+            << 0.0f << -1 << 2 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << SMALL_TEXT // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -596,9 +643,10 @@
         QTest::newRow("BARCODE_CHANNEL") << false << 0.0f << ""
             << BARCODE_CHANNEL << UNICODE_MODE // symbology-inputMode
             << "453678" << "" // text-primary
-            << 19.7f << -1 << 7 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(255, 255, 255, 0) // guardDescent-bgColor
-            << false << 1 << 2 << 0 << 0 << BOLD_TEXT // cmyk-fontSetting
+            << 19.7f << -1 << 7 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(255, 255, 255, 0) << false // fgStr-cmyk
+            << 1 << 2 << 0 << 0 << BOLD_TEXT // borderTypeIndex-fontSetting
             << true << false << true << false << false << 90 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << true // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -608,12 +656,59 @@
                 " --rotate=90 --verbose --vers=7"
             << "" << "" << "" << "";
 
+        QTest::newRow("BARCODE_CHANNEL") << false << 0.0f << ""
+            << BARCODE_CHANNEL << UNICODE_MODE // symbology-inputMode
+            << "453678" << "" // text-primary
+            << 19.7f << -1 << 7 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "FFFFFF00" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 1 << 2 << 0 << 0 << BOLD_TEXT // borderTypeIndex-fontSetting
+            << true << false << true << false << false << 90 // showText-rotateAngle
+            << 0 << false << false << false << WARN_DEFAULT << true // eci-debug
+            << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
+            << "zint -b 140 --bind --bold --border=2 -d '453678' --height=19.7 --nobackground --quietzones"
+                " --rotate=90 --verbose --vers=7"
+            << "zint.exe -b 140 --bind --bold --border=2 -d \"453678\" --height=19.7 --nobackground --quietzones"
+                " --rotate=90 --verbose --vers=7"
+            << "" << "" << "" << "";
+
+        QTest::newRow("BARCODE_CHANNEL") << false << 0.0f << ""
+            << BARCODE_CHANNEL << UNICODE_MODE // symbology-inputMode
+            << "453678" << "" // text-primary
+            << 19.7f << -1 << 7 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "12345600" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 1 << 2 << 0 << 0 << BOLD_TEXT // borderTypeIndex-fontSetting
+            << true << false << true << false << false << 90 // showText-rotateAngle
+            << 0 << false << false << false << WARN_DEFAULT << true // eci-debug
+            << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
+            << "zint -b 140 --bind --bold --border=2 -d '453678' --height=19.7 --nobackground --quietzones"
+                " --rotate=90 --verbose --vers=7"
+            << "zint.exe -b 140 --bind --bold --border=2 -d \"453678\" --height=19.7 --nobackground --quietzones"
+                " --rotate=90 --verbose --vers=7"
+            << "" << "" << "" << "";
+
+        QTest::newRow("BARCODE_CODE128") << false << 0.0f << ""
+            << BARCODE_CODE128 << (UNICODE_MODE | EXTRA_ESCAPE_MODE) // symbology-inputMode
+            << "1234\\^A56" << "" // text-primary
+            << 0.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
+            << false << false << true << false << true << 0 // showText-rotateAngle
+            << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
+            << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
+            << "zint -b 20 -d '1234\\^A56' --extraesc --notext --quietzones"
+            << "zint.exe -b 20 -d \"1234\\^A56\" --extraesc --notext --quietzones"
+            << "" << "" << "" << "";
+
         QTest::newRow("BARCODE_GS1_128_CC") << false << 0.0f << ""
             << BARCODE_GS1_128_CC << UNICODE_MODE // symbology-inputMode
             << "[01]12345678901231[15]121212" << "[11]901222[99]ABCDE" // text-primary
-            << 71.142f << 3 << 0 << 0 << 3.5f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 71.142f << 3 << 0 << 0 << 3.5f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << false << false << true << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -626,9 +721,10 @@
         QTest::newRow("BARCODE_CODE16K") << false << 11.7f << ""
             << BARCODE_CODE16K << (UNICODE_MODE | HEIGHTPERROW_MODE) // symbology-inputMode
             << "12345678901234567890123456789012" << "" // text-primary
-            << 0.0f << 4 << 0 << 2 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 1 << 1 << 0 << 0 << SMALL_TEXT // cmyk-fontSetting
+            << 0.0f << 4 << 0 << 2 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 1 << 1 << 0 << 0 << SMALL_TEXT // borderTypeIndex-fontSetting
             << true << false << false << true << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -641,9 +737,10 @@
         QTest::newRow("BARCODE_CODE49") << true << 0.0f << ""
             << BARCODE_CODE49 << UNICODE_MODE // symbology-inputMode
             << "12345678901234567890" << "" // text-primary
-            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -654,9 +751,10 @@
         QTest::newRow("BARCODE_CODABLOCKF") << true << 0.0f << ""
             << BARCODE_CODABLOCKF << (DATA_MODE | ESCAPE_MODE) // symbology-inputMode
             << "T\\n\\xA0t\\\"" << "" // text-primary
-            << 0.0f << 2 << 5 << 3 << 3.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 2 << 4 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << 2 << 5 << 3 << 3.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 2 << 4 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << true << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -669,9 +767,10 @@
         QTest::newRow("BARCODE_DAFT") << false << 0.0f << ""
             << BARCODE_DAFT << UNICODE_MODE // symbology-inputMode
             << "daft" << "" // text-primary
-            << 9.2f << -1 << 251 << 0 << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(0x30, 0x31, 0x32, 0x33) << QColor(0xBF, 0xBE, 0xBD, 0xBC) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 9.2f << -1 << 251 << 0 << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(0x30, 0x31, 0x32, 0x33) << QColor(0xBF, 0xBE, 0xBD, 0xBC) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -682,9 +781,10 @@
         QTest::newRow("BARCODE_DATAMATRIX") << true << 0.0f << ""
             << BARCODE_DATAMATRIX << GS1_MODE // symbology-inputMode
             << "[20]12" << "" // text-primary
-            << 0.0f << -1 << 0 << DM_SQUARE << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 0 << DM_SQUARE << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << true << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -695,9 +795,10 @@
         QTest::newRow("BARCODE_DATAMATRIX") << false << 0.0f << ""
             << BARCODE_DATAMATRIX << (DATA_MODE | ESCAPE_MODE | FAST_MODE) // symbology-inputMode
             << "ABCDEFGH\\x01I" << "" // text-primary
-            << 0.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -708,9 +809,10 @@
         QTest::newRow("BARCODE_DBAR_EXPSTK_CC") << false << 40.8f << ""
             << BARCODE_DBAR_EXPSTK_CC << (DATA_MODE | HEIGHTPERROW_MODE) // symbology-inputMode
             << "[91]ABCDEFGHIJKL" << "[11]901222[99]ABCDE" // text-primary
-            << 0.0f << -1 << 0 << 2 << 1.0f << 0.0f << true << 0.9f // height-dotSize
-            << 3.0f << 2 << 1 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 0 << 2 << 1.0f << 0.0f << true << 0.9f << 0.0f // height-textGap
+            << 3.0f << 2 << 1 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -723,9 +825,10 @@
         QTest::newRow("BARCODE_DOTCODE") << false << 1.0f << ""
             << BARCODE_DOTCODE << GS1_MODE // symbology-inputMode
             << "[20]01" << "" // text-primary
-            << 30.0f << -1 << 8 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 0.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 8 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 0.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -736,9 +839,10 @@
         QTest::newRow("BARCODE_DOTCODE") << false << 1.0f << ""
             << BARCODE_DOTCODE << GS1_MODE // symbology-inputMode
             << "[20]01" << "" // text-primary
-            << 30.0f << -1 << 8 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 0.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 8 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 0.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -749,9 +853,10 @@
         QTest::newRow("BARCODE_DPD") << true << 0.0f << ""
             << BARCODE_DPD << UNICODE_MODE // symbology-inputMode
             << "1234567890123456789012345678" << "" // text-primary
-            << 0.0f << -1 << 0 << 0 << 4.5f << 24.0f << true << 0.8f // height-dotSize
-            << 0.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 0 << 0 << 4.5f << 24.0f << true << 0.8f << 0.0f // height-textGap
+            << 0.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.375 << 0 << 600 << 1 << 0 << 0 // xdimdp
@@ -763,9 +868,10 @@
         QTest::newRow("BARCODE_EANX") << true << 0.0f << ""
             << BARCODE_EANX << UNICODE_MODE // symbology-inputMode
             << "123456789012+12" << "" // text-primary
-            << 0.0f << -1 << 8 << 0 << 1.0f << 0.0f << true << 0.8f // height-dotSize
-            << 0.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 8 << 0 << 1.0f << 0.0f << true << 0.8f << 0.0f // height-textGap
+            << 0.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -776,9 +882,10 @@
         QTest::newRow("BARCODE_GRIDMATRIX") << false << 0.0f << ""
             << BARCODE_GRIDMATRIX << UNICODE_MODE // symbology-inputMode
             << "Your Data Here!" << "" // text-primary
-            << 0.0f << 1 << 5 << 0 << 0.5f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << 1 << 5 << 0 << 0.5f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << true << false << true << 270 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -789,9 +896,10 @@
         QTest::newRow("BARCODE_HANXIN") << false << 0.0f << ""
             << BARCODE_HANXIN << (UNICODE_MODE | ESCAPE_MODE) // symbology-inputMode
             << "Ã©Î²Ã¿å\\e\"'" << "" // text-primary
-            << 30.0f << 2 << 5 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << 2 << 5 << ((0 + 1) << 8) << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 29 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -802,9 +910,10 @@
         QTest::newRow("BARCODE_HIBC_DM") << false << 10.0f << ""
             << BARCODE_HIBC_DM << UNICODE_MODE // symbology-inputMode
             << "1234" << "" // text-primary
-            << 0.0f << -1 << 8 << DM_DMRE << 1.0f << 0.0f << false << 0.7f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << 8 << DM_DMRE << 1.0f << 0.0f << false << 0.7f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << true << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -815,9 +924,10 @@
         QTest::newRow("BARCODE_HIBC_PDF") << false << 0.0f << ""
             << BARCODE_HIBC_PDF << (DATA_MODE | HEIGHTPERROW_MODE) // symbology-inputMode
             << "TEXT" << "" // text-primary
-            << 3.5f << 3 << 4 << 10 << 10.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 2 << 1 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 3.5f << 3 << 4 << 10 << 10.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 2 << 1 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << true << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -830,9 +940,10 @@
         QTest::newRow("BARCODE_ITF14") << true << 0.0f << ""
             << BARCODE_ITF14 << UNICODE_MODE // symbology-inputMode
             << "9212320967145" << "" // text-primary
-            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -843,9 +954,10 @@
         QTest::newRow("BARCODE_ITF14") << true << 0.0f << ""
             << BARCODE_ITF14 << UNICODE_MODE // symbology-inputMode
             << "9212320967145" << "" // text-primary
-            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 1 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 1 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -857,9 +969,10 @@
             << BARCODE_MAXICODE << (UNICODE_MODE | ESCAPE_MODE) // symbology-inputMode
             << "152382802840001"
             << "1Z00004951\\GUPSN\\G06X610\\G159\\G1234567\\G1/1\\G\\GY\\G1 MAIN ST\\GTOWN\\GNY\\R\\E" // text-primary
-            << 0.0f << -1 << (96 + 1) << 0 << 2.5f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << -1 << (96 + 1) << 0 << 2.5f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << true << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -872,9 +985,10 @@
         QTest::newRow("BARCODE_MICROQR") << false << 0.0f << ""
             << BARCODE_MICROQR << UNICODE_MODE // symbology-inputMode
             << "1234" << "" // text-primary
-            << 30.0f << 2 << 3 << (ZINT_FULL_MULTIBYTE | (3 + 1) << 8) << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << 2 << 3 << (ZINT_FULL_MULTIBYTE | (3 + 1) << 8) << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -885,9 +999,10 @@
         QTest::newRow("BARCODE_QRCODE") << true << 0.0f << ""
             << BARCODE_QRCODE << GS1_MODE // symbology-inputMode
             << "(01)12" << "" // text-primary
-            << 0.0f << 1 << 5 << (ZINT_FULL_MULTIBYTE | (0 + 1) << 8) << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << 1 << 5 << (ZINT_FULL_MULTIBYTE | (0 + 1) << 8) << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << true << false << true << 0 // showText-rotateAngle
             << 0 << true << true << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -900,9 +1015,10 @@
         QTest::newRow("BARCODE_RMQR") << true << 0.0f << ""
             << BARCODE_RMQR << UNICODE_MODE // symbology-inputMode
             << "ã" << "" // text-primary
-            << 30.0f << -1 << 8 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 30.0f << -1 << 8 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 180 // showText-rotateAngle
             << 20 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -913,9 +1029,10 @@
         QTest::newRow("BARCODE_ULTRA") << false << 0.0f << ""
             << BARCODE_ULTRA << (GS1_MODE | GS1PARENS_MODE | GS1NOCHECK_MODE) // symbology-inputMode
             << "(01)1" << "" // text-primary
-            << 0.0f << 6 << 2 << 0 << 1.0f << 0.0f << true << 0.8f // height-dotSize
-            << 5.0f << 2 << 1 << "4" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 0.0f << 6 << 2 << 0 << 1.0f << 0.0f << true << 0.8f << 0.0f // height-textGap
+            << 5.0f << 2 << 1 << "4" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << 0 // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
@@ -926,35 +1043,51 @@
         QTest::newRow("BARCODE_UPCE_CC") << true << 0.0f << "out.svg"
             << BARCODE_UPCE_CC << UNICODE_MODE // symbology-inputMode
             << "12345670+1234" << "[11]901222[99]ABCDE" // text-primary
-            << 0.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 6.5f << 0 << 0 << "" << QColor(0xEF, 0x29, 0x29) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << (BOLD_TEXT | SMALL_TEXT) // cmyk-fontSetting
+            << 0.0f << -1 << 0 << 0 << 1.0f << 0.0f << false << 0.8f << 0.0f // height-textGap
+            << 6.5f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(0xEF, 0x29, 0x29) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << (BOLD_TEXT | SMALL_TEXT) // borderTypeIndex-fontSetting
             << true << false << false << true << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_FAIL_ALL << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
-            << "zint -b 136 --bold --compliantheight -d '[11]901222[99]ABCDE' --fg=EF2929 --guarddescent=6.5"
+            << "zint -b 136 --compliantheight -d '[11]901222[99]ABCDE' --fg=EF2929 --guarddescent=6.5"
                 " --noquietzones -o 'out.svg' --primary='12345670+1234' --small --werror"
-            << "zint.exe -b 136 --bold --compliantheight -d \"[11]901222[99]ABCDE\" --fg=EF2929 --guarddescent=6.5"
+            << "zint.exe -b 136 --compliantheight -d \"[11]901222[99]ABCDE\" --fg=EF2929 --guarddescent=6.5"
                 " --noquietzones -o \"out.svg\" --primary=\"12345670+1234\" --small --werror"
-            << "zint --barcode=136 --bold --compliantheight --data='[11]901222[99]ABCDE' --fg=EF2929"
+            << "zint --barcode=136 --compliantheight --data='[11]901222[99]ABCDE' --fg=EF2929"
                 " --guarddescent=6.5 --noquietzones --output='out.svg' --primary='12345670+1234' --small --werror"
-            << "zint -b UPCE_CC --bold --compliantheight -d '[11]901222[99]ABCDE' --fg=EF2929 --guarddescent=6.5"
+            << "zint -b UPCE_CC --compliantheight -d '[11]901222[99]ABCDE' --fg=EF2929 --guarddescent=6.5"
                 " --noquietzones -o 'out.svg' --primary='12345670+1234' --small --werror"
-            << "zint -b 136 --bold --compliantheight -d \"[11]901222[99]ABCDE\" --fg=EF2929 --guarddescent=6.5"
+            << "zint -b 136 --compliantheight -d \"[11]901222[99]ABCDE\" --fg=EF2929 --guarddescent=6.5"
                 " --noquietzones -o \"out.svg\" --primary=\"12345670+1234\" --small --werror"
             << "";
 
         QTest::newRow("BARCODE_VIN") << false << 2.0f << ""
             << BARCODE_VIN << UNICODE_MODE // symbology-inputMode
             << "12345678701234567" << "" // text-primary
-            << 20.0f << -1 << 1 << 0 << 1.0f << 0.0f << false << 0.8f // height-dotSize
-            << 5.0f << 0 << 0 << "" << QColor(Qt::black) << QColor(Qt::white) // guardDescent-bgColor
-            << false << 0 << 0 << 0 << 0 << 0 // cmyk-fontSetting
+            << 20.0f << -1 << 1 << 0 << 1.0f << 0.0f << false << 0.8f << 1.2f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << (BOLD_TEXT | SMALL_TEXT) // borderTypeIndex-fontSetting
             << true << false << false << false << true << 0 // showText-rotateAngle
             << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
             << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
-            << "zint -b 73 -d '12345678701234567' --height=20 --vers=1"
-            << "zint.exe -b 73 -d \"12345678701234567\" --height=20 --vers=1"
+            << "zint -b 73 --bold -d '12345678701234567' --height=20 --small --textgap=1.2 --vers=1"
+            << "zint.exe -b 73 --bold -d \"12345678701234567\" --height=20 --small --textgap=1.2 --vers=1"
+            << "" << "" << "" << "";
+
+        QTest::newRow("BARCODE_VIN") << false << 2.0f << ""
+            << BARCODE_VIN << UNICODE_MODE // symbology-inputMode
+            << "12345678701234567" << "" // text-primary
+            << 20.0f << -1 << 1 << 0 << 1.0f << 0.0f << false << 0.8f << 1.2f // height-textGap
+            << 5.0f << 0 << 0 << "" // guardDescent-structAppID
+            << "" << "" << QColor(Qt::black) << QColor(Qt::white) << false // fgStr-cmyk
+            << 0 << 0 << 0 << 0 << (BOLD_TEXT | SMALL_TEXT) // borderTypeIndex-fontSetting
+            << false << false << false << false << true << 0 // showText-rotateAngle
+            << 0 << false << false << false << WARN_DEFAULT << false // eci-debug
+            << 0.0 << 0 << 0 << 0 << 0 << 0 // xdimdp
+            << "zint -b 73 -d '12345678701234567' --height=20 --notext --vers=1"
+            << "zint.exe -b 73 -d \"12345678701234567\" --height=20 --notext --vers=1"
             << "" << "" << "" << "";
     }
 
@@ -980,10 +1113,13 @@
         QFETCH(float, dpmm);
         QFETCH(bool, dotty);
         QFETCH(float, dotSize);
+        QFETCH(float, textGap);
         QFETCH(float, guardDescent);
         QFETCH(int, structAppCount);
         QFETCH(int, structAppIndex);
         QFETCH(QString, structAppID);
+        QFETCH(QString, fgStr);
+        QFETCH(QString, bgStr);
         QFETCH(QColor, fgColor);
         QFETCH(QColor, bgColor);
         QFETCH(bool, cmyk);
@@ -1005,8 +1141,8 @@
         QFETCH(int, warnLevel);
         QFETCH(bool, debug);
 
-        QFETCH(double, xdimdp_xdim);
-        QFETCH(int, xdimdp_xdim_units);
+        QFETCH(double, xdimdp_x_dim);
+        QFETCH(int, xdimdp_x_dim_units);
         QFETCH(int, xdimdp_resolution);
         QFETCH(int, xdimdp_resolution_units);
         QFETCH(int, xdimdp_filetype);
@@ -1035,10 +1171,19 @@
         bc.setDPMM(dpmm);
         bc.setDotty(dotty);
         bc.setDotSize(dotSize);
+        bc.setTextGap(textGap);
         bc.setGuardDescent(guardDescent);
         bc.setStructApp(structAppCount, structAppIndex, structAppID);
-        bc.setFgColor(fgColor);
-        bc.setBgColor(bgColor);
+        if (fgStr.isEmpty()) {
+            bc.setFgColor(fgColor);
+        } else {
+            bc.setFgStr(fgStr);
+        }
+        if (bgStr.isEmpty()) {
+            bc.setBgColor(bgColor);
+        } else {
+            bc.setBgStr(bgStr);
+        }
         bc.setCMYK(cmyk);
         bc.setBorderType(borderTypeIndex);
         bc.setBorderWidth(borderWidth);
@@ -1084,11 +1229,16 @@
             QCOMPARE(cmd, expected_noexe);
         }
 
-        if (xdimdp_xdim) {
-            struct Zint::QZintXdimDpVars vars = {
-                xdimdp_xdim, xdimdp_xdim_units, xdimdp_resolution, xdimdp_resolution_units, xdimdp_filetype,
-                xdimdp_filetype_maxicode, 1 /*set*/
-            };
+        if (xdimdp_x_dim) {
+            /* Avoid clang 14 error "no matching constructor for initialization" by initializing field-wise */
+            struct Zint::QZintXdimDpVars vars;
+            vars.x_dim = xdimdp_x_dim;
+            vars.x_dim_units = xdimdp_x_dim_units;
+            vars.resolution = xdimdp_resolution;
+            vars.resolution_units = xdimdp_resolution_units;
+            vars.filetype = xdimdp_filetype;
+            vars.filetype_maxicode = xdimdp_filetype_maxicode;
+            vars.set = 1;
             cmd = bc.getAsCLI(false /*win*/, false /*longOptOnly*/, false /*barcodeNames*/, false /*noEXE*/,
                         autoHeight, heightPerRow, outfile, &vars);
             QCOMPARE(cmd, expected_xdimdp);
diff -urN zint-2.12.0/backend_tcl/zint.c zint/backend_tcl/zint.c
--- zint-2.12.0/backend_tcl/zint.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_tcl/zint.c	2023-05-08 14:39:44.969319983 +0200
@@ -1,7 +1,7 @@
 /* zint_tcl.c TCL binding for zint */
 /*
     zint - the open source tcl binding to the zint barcode library
-    Copyright (C) 2014-2022 Harald Oehlmann <oehhar@users.sourceforge.net>
+    Copyright (C) 2014-2023 Harald Oehlmann <oehhar@users.sourceforge.net>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -164,6 +164,10 @@
     *** Potential incompatibility ***
 2022-12-09 GL
 - Added UPU_S10
+2023-01-15 GL
+- Added -esc and -extraesc options
+2023-02-10 GL
+- Added -textgap option
 */
 
 #if defined(__WIN32__) || defined(_WIN32) || defined(WIN32)
@@ -500,7 +504,7 @@
     "   -bindtop bool: bar above the code, size set by -border\n"
     "   -bold bool: use bold text\n"
     "   -border integer: width of a border around the symbol. Use with -bind/-box/-bindtop 1\n"
-    "   -box bool: box around bar code, size set be -border\n"
+    "   -box bool: box around bar code, size set by -border\n"
     /* cli option --cmyk not supported as no corresponding output */
     "   -cols integer: Codablock F, DotCode, PDF417: number of columns\n"
     "   -compliantheight bool: warn if height not compliant, and use standard default\n"
@@ -511,7 +515,8 @@
     /* cli option --dump not supported */
     /* cli option --ecinos not supported */
     "   -eci choice: ECI to use\n"
-    /* cli option --esc not supported */
+    "   -esc bool: Process escape sequences in input data\n"
+    "   -extraesc bool: Process symbology-specific escape sequences (Code 128 only)\n"
     "   -fast bool: use fast encodation (Data Matrix)\n"
     "   -fg color: set foreground color as 6 or 8 hex rrggbbaa\n"
     /* replaces cli options --binary and --gs1 */
@@ -548,6 +553,7 @@
     "   -smalltext bool: tiny interpretation line font\n"
     "   -square bool: force Data Matrix symbols to be square\n"
     "   -structapp {index count ?id?}: set Structured Append info\n"
+    "   -textgap double: gap between barcode and text\n"
     /* cli option --types not supported */
     "   -vers integer: Symbology option\n"
     /* cli option --version not supported */
@@ -781,26 +787,26 @@
         static const char *optionList[] = {
             "-addongap", "-barcode", "-bg", "-bind", "-bindtop", "-bold", "-border", "-box",
             "-cols", "-compliantheight", "-dmre", "-dotsize", "-dotty",
-            "-eci", "-fast", "-fg", "-format", "-fullmultibyte",
+            "-eci", "-esc", "-extraesc", "-fast", "-fg", "-format", "-fullmultibyte",
             "-gs1nocheck", "-gs1parens", "-gssep", "-guarddescent",
             "-height", "-heightperrow", "-init", "-mask", "-mode",
             "-nobackground", "-noquietzones", "-notext", "-primary", "-quietzones",
             "-reverse", "-rotate", "-rows", "-scale", "-scalexdimdp", "-scmvv", "-secure",
             "-seg1", "-seg2", "-seg3", "-seg4", "-seg5", "-seg6", "-seg7", "-seg8", "-seg9",
             "-separator", "-smalltext", "-square", "-structapp",
-            "-to", "-vers", "-vwhitesp", "-werror", "-whitesp",
+            "-textgap", "-to", "-vers", "-vwhitesp", "-werror", "-whitesp",
             NULL};
         enum iOption {
             iAddonGap, iBarcode, iBG, iBind, iBindTop, iBold, iBorder, iBox,
             iCols, iCompliantHeight, iDMRE, iDotSize, iDotty,
-            iECI, iFast, iFG, iFormat, iFullMultiByte,
+            iECI, iEsc, iExtraEsc, iFast, iFG, iFormat, iFullMultiByte,
             iGS1NoCheck, iGS1Parens, iGSSep, iGuardDescent,
             iHeight, iHeightPerRow, iInit, iMask, iMode,
             iNoBackground, iNoQuietZones, iNoText, iPrimary, iQuietZones,
             iReverse, iRotate, iRows, iScale, iScaleXdimDp, iSCMvv, iSecure,
             iSeg1, iSeg2, iSeg3, iSeg4, iSeg5, iSeg6, iSeg7, iSeg8, iSeg9,
             iSeparator, iSmallText, iSquare, iStructApp,
-            iTo, iVers, iVWhiteSp, iWError, iWhiteSp
+            iTextGap, iTo, iVers, iVWhiteSp, iWError, iWhiteSp
             };
         int optionIndex;
         int intValue;
@@ -824,6 +830,8 @@
         case iCompliantHeight:
         case iDMRE:
         case iDotty:
+        case iEsc:
+        case iExtraEsc:
         case iFast:
         case iGS1NoCheck:
         case iGS1Parens:
@@ -860,6 +868,7 @@
         case iGuardDescent:
         case iDotSize:
         case iScale:
+        case iTextGap:
             /* >> Float */
             if (TCL_OK != Tcl_GetDoubleFromObj(interp, objv[optionPos+1],
                 &doubleValue))
@@ -997,6 +1006,20 @@
                 my_symbol->output_options &= ~BARCODE_DOTTY_MODE;
             }
             break;
+        case iEsc:
+            if (intValue) {
+                my_symbol->input_mode |= ESCAPE_MODE;
+            } else {
+                my_symbol->input_mode &= ~ESCAPE_MODE;
+            }
+            break;
+        case iExtraEsc:
+            if (intValue) {
+                my_symbol->input_mode |= EXTRA_ESCAPE_MODE;
+            } else {
+                my_symbol->input_mode &= ~EXTRA_ESCAPE_MODE;
+            }
+            break;
         case iFast:
             if (intValue) {
                 my_symbol->input_mode |= FAST_MODE;
@@ -1119,6 +1142,15 @@
                 my_symbol->scale = (float)doubleValue;
             }
             break;
+        case iTextGap:
+            if (doubleValue < 0.0 || doubleValue > 5.0) {
+                Tcl_SetObjResult(interp,
+                    Tcl_NewStringObj("Text Gap out of range", -1));
+                fError = 1;
+            } else {
+                my_symbol->text_gap = (float)doubleValue;
+            }
+            break;
         case iScaleXdimDp:
             /* >> Decode the -scalexdimdp parameter as list of xdim ?resolution? */
             {
diff -urN zint-2.12.0/backend_tcl/zint_tcl.dsp zint/backend_tcl/zint_tcl.dsp
--- zint-2.12.0/backend_tcl/zint_tcl.dsp	2022-12-12 22:06:08.000000000 +0100
+++ zint/backend_tcl/zint_tcl.dsp	2023-05-08 14:39:44.969319983 +0200
@@ -43,7 +43,7 @@
 # PROP Ignore_Export_Lib 0
 # PROP Target_Dir ""
 # ADD BASE CPP /nologo /MT /W3 /GX /O2 /D "WIN32" /D "NDEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /YX /FD /c
-# ADD CPP /nologo /MD /W3 /GX /O2 /I "..\backend" /I "C:\Tcl\include" /D "WIN32" /D "NDEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /D "ZINT_NO_PNG" /FR /YX /FD /D ZINT_VERSION="\"2.12.0\"" /c
+# ADD CPP /nologo /MD /W3 /GX /O2 /I "..\backend" /I "C:\Tcl\include" /D "WIN32" /D "NDEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /D "ZINT_NO_PNG" /FR /YX /FD /D ZINT_VERSION="\"2.12.0.9\"" /c
 # ADD BASE MTL /nologo /D "NDEBUG" /mktyplib203 /win32
 # ADD MTL /nologo /D "NDEBUG" /mktyplib203 /win32
 # ADD BASE RSC /l 0x407 /d "NDEBUG"
@@ -70,7 +70,7 @@
 # PROP Ignore_Export_Lib 0
 # PROP Target_Dir ""
 # ADD BASE CPP /nologo /MTd /W3 /Gm /GX /ZI /Od /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /YX /FD /GZ /c
-# ADD CPP /nologo /MD /W3 /Gm /GX /ZI /Od /I "..\backend" /I "C:\Tcl\include" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /D "ZINT_NO_PNG" /FR /YX /FD /GZ /D ZINT_VERSION="\"2.12.0\"" /c
+# ADD CPP /nologo /MD /W3 /Gm /GX /ZI /Od /I "..\backend" /I "C:\Tcl\include" /D "WIN32" /D "_DEBUG" /D "_WINDOWS" /D "_MBCS" /D "_USRDLL" /D "ZINT_TCL_EXPORTS" /D "ZINT_NO_PNG" /FR /YX /FD /GZ /D ZINT_VERSION="\"2.12.0.9\"" /c
 # ADD BASE MTL /nologo /D "_DEBUG" /mktyplib203 /win32
 # ADD MTL /nologo /D "_DEBUG" /mktyplib203 /win32
 # ADD BASE RSC /l 0x407 /d "_DEBUG"
diff -urN zint-2.12.0/ChangeLog zint/ChangeLog
--- zint-2.12.0/ChangeLog	2022-12-12 22:06:08.000000000 +0100
+++ zint/ChangeLog	2023-05-08 14:39:44.833319182 +0200
@@ -1,3 +1,50 @@
+Version 2.12.0.9 (dev) not released yet
+=======================================
+
+**Incompatible changes**
+------------------------
+- zint_symbol fgcolour and bgcolour buffer lengths extended 10 -> 16 to allow
+  for "C,M,Y,K" comma-separated decimal percentage strings
+- CMYK values for EPS (slightly) and TIF (significantly) have changed - now use
+  the same RGB -> CMYK formula
+- Text (HRT) placement for vector (EMF/EPS/SVG) output changed - for EAN/UPC
+  slightly further away from barcode, for all others slightly nearer. Some
+  horizontal alignments of EAN/UPC vector text also tweaked
+
+Changes
+-------
+- BMP/EMF/EPS/GIF/PCX/PNG/SVG/TIF/TXT: check for errors on writing to output
+  file (ticket #275)
+- manual/man page: document octal escape; Code 128 subset/mode -> Code Set
+- Add special symbology-specific escape sequences (Code 128 only) for manual
+  Code Set switching via `input_mode` flag `EXTRA_ESCAPE_MODE` (CLI --extraesc)
+  (ticket #204)
+- GUI: disable "Reset" colour if default; add "Unset" to Printing Scale dialog
+  (allows unsetting of X-dim/resolution settings without having to zap)
+- API/CLI/GUI: allow foreground/background colours to be specified as
+  comma-separated decimal percentage strings "C,M,Y,K" where "C", "M" etc. are
+  0-100 (ticket #281, 3rd point)
+- PCX: add alpha support
+- GUI: Rearrange some Appearance tab inputs (Border Type <-> Width, Show Text
+  <-> Font, Text/Font <-> Printing Scale/Size) to flow more naturally;
+  save button "Save As..." -> "Save..." and add icon
+- Add `text_gap` option to allow adjustment of vertical gap between barcode and
+  text (HRT)
+- DAFT: up max to 250 chars
+
+Bugs
+----
+- CEPNET: fix no HRT (library: `has_hrt()`)
+- man page: fix Code 11 check digit info
+- CMake: allow ctest to be run without having to install zint or manually set
+  LD_LIBRARY_PATH and PATH (ticket #279, props Alexey Dokuchaev)
+- GUI: fg/bgcolor text edit: fix right-click context menu not working properly
+  by checking for it on FocusOut
+- GUI: fix fg/gbcolor icon background not being reset on zap
+- EMF/EPS/SVG/GUI: ignore BOLD_TEXT for EAN/UPC
+- EMF/EPS/SVG: fix addon bars placement/length when text hidden
+
+
 Version 2.12.0 (2022-12-12)
 ===========================
 
diff -urN zint-2.12.0/cmake/zint_add_test.cmake zint/cmake/zint_add_test.cmake
--- zint-2.12.0/cmake/zint_add_test.cmake	2022-12-12 22:06:08.000000000 +0100
+++ zint/cmake/zint_add_test.cmake	2023-05-08 14:39:44.969319983 +0200
@@ -1,4 +1,4 @@
-# Copyright (C) 2021 Robin Stuart <rstuart114@gmail.com>
+# Copyright (C) 2021-23 Robin Stuart <rstuart114@gmail.com>
 # Adapted from qrencode/tests/CMakeLists.txt
 # Copyright (C) 2006-2017 Kentaro Fukuchi <kentaro@fukuchi.org>
 # vim: set ts=4 sw=4 et :
@@ -9,12 +9,24 @@
         add_executable(${test_command} ${test_command}.c)
         target_link_libraries(${test_command} testcommon ${ADDITIONAL_LIBS})
         add_test(${test_name} ${test_command})
-        set_tests_properties(${test_name} PROPERTIES ENVIRONMENT "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR}")
+        if(MSVC)
+            set_tests_properties(${test_name} PROPERTIES ENVIRONMENT
+                "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR};PATH=${CMAKE_BINARY_DIR}/backend/${CMAKE_BUILD_TYPE}\;${CMAKE_BINARY_DIR}/frontend/${CMAKE_BUILD_TYPE}\;$ENV{PATH}")
+        else()
+            set_tests_properties(${test_name} PROPERTIES ENVIRONMENT
+                "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR};LD_LIBRARY_PATH=${CMAKE_BINARY_DIR}/backend;PATH=${CMAKE_BINARY_DIR}/frontend:$ENV{PATH}")
+        endif()
     endif()
     if(ZINT_STATIC)
         add_executable(${test_command}-static ${test_command}.c)
         target_link_libraries(${test_command}-static testcommon-static ${ADDITIONAL_LIBS})
         add_test(${test_name}-static ${test_command}-static)
-        set_tests_properties(${test_name}-static PROPERTIES ENVIRONMENT "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR}")
+        if(MSVC)
+            set_tests_properties(${test_name}-static PROPERTIES ENVIRONMENT
+                "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR};PATH=${CMAKE_BINARY_DIR}/backend/${CMAKE_BUILD_TYPE}\;${CMAKE_BINARY_DIR}/frontend/${CMAKE_BUILD_TYPE}\;$ENV{PATH}")
+        else()
+            set_tests_properties(${test_name}-static PROPERTIES ENVIRONMENT
+                "CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR};LD_LIBRARY_PATH=${CMAKE_BINARY_DIR}/backend;PATH=${CMAKE_BINARY_DIR}/frontend:$ENV{PATH}")
+        endif()
     endif()
 endmacro()
diff -urN zint-2.12.0/CMakeLists.txt zint/CMakeLists.txt
--- zint-2.12.0/CMakeLists.txt	2022-12-12 22:06:08.000000000 +0100
+++ zint/CMakeLists.txt	2023-05-08 14:39:44.832319176 +0200
@@ -1,5 +1,5 @@
 # Copyright (C) 2008 by BogDan Vatra < bogdan@licentia.eu >
-# Copyright (C) 2009-2022 Robin Stuart <rstuart114@gmail.com>
+# Copyright (C) 2009-2023 Robin Stuart <rstuart114@gmail.com>
 # vim: set ts=4 sw=4 et :
 
 cmake_minimum_required(VERSION 3.5)
@@ -10,7 +10,7 @@
 set(ZINT_VERSION_MAJOR 2)
 set(ZINT_VERSION_MINOR 12)
 set(ZINT_VERSION_RELEASE 0)
-set(ZINT_VERSION_BUILD 0) # Set to 0 before release, set to 9 after release
+set(ZINT_VERSION_BUILD 9) # Set to 0 before release, set to 9 after release
 set(ZINT_VERSION "${ZINT_VERSION_MAJOR}.${ZINT_VERSION_MINOR}.${ZINT_VERSION_RELEASE}.${ZINT_VERSION_BUILD}")
 
 add_definitions(-DZINT_VERSION=\"${ZINT_VERSION}\")
@@ -28,6 +28,10 @@
 option(ZINT_USE_QT   "Build with Qt support"           ON)
 option(ZINT_QT6      "If ZINT_USE_QT, use Qt6"         OFF)
 
+if(NOT ZINT_SHARED AND NOT ZINT_STATIC)
+    message(SEND_ERROR "Either ZINT_SHARED or ZINT_STATIC or both must be set")
+endif()
+
 include(SetPaths.cmake)
 
 include(CheckCXXCompilerFlag)
diff -urN zint-2.12.0/docs/images/bc412.svg zint/docs/images/bc412.svg
--- zint-2.12.0/docs/images/bc412.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/bc412.svg	2023-05-08 14:39:44.970319989 +0200
@@ -43,7 +43,7 @@
       <rect x="446.40" y="0.00" width="4.80" height="80.00" />
       <rect x="475.20" y="0.00" width="4.80" height="80.00" />
       <rect x="484.80" y="0.00" width="4.80" height="80.00" />
-      <text x="244.80" y="116.96" text-anchor="middle"
+      <text x="244.80" y="113.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          AQQ45670
       </text>
diff -urN zint-2.12.0/docs/images/c25iata.svg zint/docs/images/c25iata.svg
--- zint-2.12.0/docs/images/c25iata.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/c25iata.svg	2023-05-08 14:39:44.970319989 +0200
@@ -62,7 +62,7 @@
       <rect x="672.00" y="0.00" width="14.40" height="240.00" />
       <rect x="691.20" y="0.00" width="14.40" height="240.00" />
       <rect x="710.40" y="0.00" width="4.80" height="240.00" />
-      <text x="357.60" y="276.96" text-anchor="middle"
+      <text x="357.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9212320967
       </text>
diff -urN zint-2.12.0/docs/images/c25ind.svg zint/docs/images/c25ind.svg
--- zint-2.12.0/docs/images/c25ind.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/c25ind.svg	2023-05-08 14:39:44.970319989 +0200
@@ -64,7 +64,7 @@
       <rect x="720.00" y="0.00" width="14.40" height="240.00" />
       <rect x="739.20" y="0.00" width="4.80" height="240.00" />
       <rect x="748.80" y="0.00" width="14.40" height="240.00" />
-      <text x="381.60" y="276.96" text-anchor="middle"
+      <text x="381.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9212320967
       </text>
diff -urN zint-2.12.0/docs/images/c25inter.svg zint/docs/images/c25inter.svg
--- zint-2.12.0/docs/images/c25inter.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/c25inter.svg	2023-05-08 14:39:44.971319994 +0200
@@ -37,7 +37,7 @@
       <rect x="432.00" y="0.00" width="4.80" height="240.00" />
       <rect x="451.20" y="0.00" width="14.40" height="240.00" />
       <rect x="470.40" y="0.00" width="4.80" height="240.00" />
-      <text x="237.60" y="276.96" text-anchor="middle"
+      <text x="237.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9212320967
       </text>
diff -urN zint-2.12.0/docs/images/c25logic.svg zint/docs/images/c25logic.svg
--- zint-2.12.0/docs/images/c25logic.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/c25logic.svg	2023-05-08 14:39:44.971319994 +0200
@@ -42,7 +42,7 @@
       <rect x="480.00" y="0.00" width="14.40" height="240.00" />
       <rect x="499.20" y="0.00" width="14.40" height="240.00" />
       <rect x="518.40" y="0.00" width="4.80" height="240.00" />
-      <text x="261.60" y="276.96" text-anchor="middle"
+      <text x="261.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9212320967
       </text>
diff -urN zint-2.12.0/docs/images/c25standard.svg zint/docs/images/c25standard.svg
--- zint-2.12.0/docs/images/c25standard.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/c25standard.svg	2023-05-08 14:39:44.971319994 +0200
@@ -44,7 +44,7 @@
       <rect x="523.20" y="0.00" width="19.20" height="240.00" />
       <rect x="547.20" y="0.00" width="4.80" height="240.00" />
       <rect x="556.80" y="0.00" width="4.80" height="240.00" />
-      <text x="280.80" y="276.96" text-anchor="middle"
+      <text x="280.80" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9212320967
       </text>
diff -urN zint-2.12.0/docs/images/channel.svg zint/docs/images/channel.svg
--- zint-2.12.0/docs/images/channel.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/channel.svg	2023-05-08 14:39:44.971319994 +0200
@@ -20,7 +20,7 @@
       <rect x="129.60" y="0.00" width="9.60" height="96.00" />
       <rect x="144.00" y="0.00" width="4.80" height="96.00" />
       <rect x="153.60" y="0.00" width="14.40" height="96.00" />
-      <text x="84.00" y="132.96" text-anchor="middle"
+      <text x="84.00" y="129.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          453678
       </text>
diff -urN zint-2.12.0/docs/images/codabar.svg zint/docs/images/codabar.svg
--- zint-2.12.0/docs/images/codabar.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/codabar.svg	2023-05-08 14:39:44.971319994 +0200
@@ -36,7 +36,7 @@
       <rect x="307.20" y="0.00" width="4.80" height="240.00" />
       <rect x="321.60" y="0.00" width="4.80" height="240.00" />
       <rect x="331.20" y="0.00" width="9.60" height="240.00" />
-      <text x="172.80" y="276.96" text-anchor="middle"
+      <text x="172.80" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          A37859B
       </text>
diff -urN zint-2.12.0/docs/images/code11.svg zint/docs/images/code11.svg
--- zint-2.12.0/docs/images/code11.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code11.svg	2023-05-08 14:39:44.971319994 +0200
@@ -50,7 +50,7 @@
       <rect x="480.00" y="0.00" width="4.80" height="240.00" />
       <rect x="489.60" y="0.00" width="9.60" height="240.00" />
       <rect x="508.80" y="0.00" width="4.80" height="240.00" />
-      <text x="256.80" y="276.96" text-anchor="middle"
+      <text x="256.80" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          921232096769
       </text>
diff -urN zint-2.12.0/docs/images/code128ab.svg zint/docs/images/code128ab.svg
--- zint-2.12.0/docs/images/code128ab.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128ab.svg	2023-05-08 14:39:44.972320000 +0200
@@ -48,7 +48,7 @@
       <rect x="657.60" y="0.00" width="14.40" height="240.00" />
       <rect x="676.80" y="0.00" width="4.80" height="240.00" />
       <rect x="686.40" y="0.00" width="9.60" height="240.00" />
-      <text x="348.00" y="276.96" text-anchor="middle"
+      <text x="348.00" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          130170X178
       </text>
diff -urN zint-2.12.0/docs/images/code128_box.svg zint/docs/images/code128_box.svg
--- zint-2.12.0/docs/images/code128_box.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_box.svg	2023-05-08 14:39:44.971319994 +0200
@@ -49,7 +49,7 @@
       <rect x="0.00" y="288.00" width="835.20" height="48.00" />
       <rect x="0.00" y="48.00" width="48.00" height="240.00" />
       <rect x="787.20" y="48.00" width="48.00" height="240.00" />
-      <text x="417.60" y="372.96" text-anchor="middle"
+      <text x="417.60" y="369.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          This Text
       </text>
diff -urN zint-2.12.0/docs/images/code128_green_alpha.svg zint/docs/images/code128_green_alpha.svg
--- zint-2.12.0/docs/images/code128_green_alpha.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_green_alpha.svg	2023-05-08 14:39:44.972320000 +0200
@@ -45,7 +45,7 @@
       <rect x="604.80" y="0.00" width="14.40" height="240.00" opacity="0.333" />
       <rect x="624.00" y="0.00" width="4.80" height="240.00" opacity="0.333" />
       <rect x="633.60" y="0.00" width="9.60" height="240.00" opacity="0.333" />
-      <text x="321.60" y="276.96" text-anchor="middle"
+      <text x="321.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" opacity="0.333" >
          This Text
       </text>
diff -urN zint-2.12.0/docs/images/code128_green.svg zint/docs/images/code128_green.svg
--- zint-2.12.0/docs/images/code128_green.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_green.svg	2023-05-08 14:39:44.972320000 +0200
@@ -45,7 +45,7 @@
       <rect x="604.80" y="0.00" width="14.40" height="240.00" />
       <rect x="624.00" y="0.00" width="4.80" height="240.00" />
       <rect x="633.60" y="0.00" width="9.60" height="240.00" />
-      <text x="321.60" y="276.96" text-anchor="middle"
+      <text x="321.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          This Text
       </text>
diff -urN zint-2.12.0/docs/images/code128_rotate90.svg zint/docs/images/code128_rotate90.svg
--- zint-2.12.0/docs/images/code128_rotate90.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_rotate90.svg	2023-05-08 14:39:44.972320000 +0200
@@ -45,8 +45,8 @@
       <rect x="45.36" y="604.80" width="240.00" height="14.40" />
       <rect x="45.36" y="624.00" width="240.00" height="4.80" />
       <rect x="45.36" y="633.60" width="240.00" height="9.60" />
-      <text x="8.40" y="321.60" text-anchor="middle"
-         font-family="Helvetica, sans-serif" font-size="33.6" transform="rotate(90,8.40,321.60)" >
+      <text x="11.76" y="321.60" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="33.6" transform="rotate(90,11.76,321.60)" >
          This Text
       </text>
    </g>
diff -urN zint-2.12.0/docs/images/code128_small_bold.svg zint/docs/images/code128_small_bold.svg
--- zint-2.12.0/docs/images/code128_small_bold.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_small_bold.svg	2023-05-08 14:39:44.972320000 +0200
@@ -45,7 +45,7 @@
       <rect x="604.80" y="0.00" width="14.40" height="240.00" />
       <rect x="624.00" y="0.00" width="4.80" height="240.00" />
       <rect x="633.60" y="0.00" width="9.60" height="240.00" />
-      <text x="321.60" y="271.68" text-anchor="middle"
+      <text x="321.60" y="268.80" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="28.8" font-weight="bold" >
          This Text
       </text>
diff -urN zint-2.12.0/docs/images/code128_stacked.svg zint/docs/images/code128_stacked.svg
--- zint-2.12.0/docs/images/code128_stacked.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128_stacked.svg	2023-05-08 14:39:44.972320000 +0200
@@ -34,7 +34,7 @@
       <rect x="225.60" y="120.00" width="19.20" height="120.00" />
       <rect x="264.00" y="120.00" width="4.80" height="120.00" />
       <rect x="278.40" y="120.00" width="9.60" height="120.00" />
-      <text x="189.60" y="276.96" text-anchor="middle"
+      <text x="189.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          That
       </text>
diff -urN zint-2.12.0/docs/images/code128.svg zint/docs/images/code128.svg
--- zint-2.12.0/docs/images/code128.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code128.svg	2023-05-08 14:39:44.971319994 +0200
@@ -42,7 +42,7 @@
       <rect x="552.00" y="0.00" width="14.40" height="240.00" />
       <rect x="571.20" y="0.00" width="4.80" height="240.00" />
       <rect x="580.80" y="0.00" width="9.60" height="240.00" />
-      <text x="295.20" y="276.96" text-anchor="middle"
+      <text x="295.20" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          130170X178
       </text>
diff -urN zint-2.12.0/docs/images/code128_textgap.svg zint/docs/images/code128_textgap.svg
--- zint-2.12.0/docs/images/code128_textgap.svg	1970-01-01 01:00:00.000000000 +0100
+++ zint/docs/images/code128_textgap.svg	2023-05-08 14:39:44.972320000 +0200
@@ -0,0 +1,47 @@
+<?xml version="1.0" standalone="no"?>
+<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
+   "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
+<svg width="538" height="283" version="1.1"
+   xmlns="http://www.w3.org/2000/svg">
+   <desc>Zint Generated Symbol
+   </desc>
+
+   <g id="barcode" fill="#000000">
+      <rect x="0" y="0" width="538" height="283" fill="#FFFFFF" />
+      <rect x="0.00" y="0.00" width="9.60" height="240.00" />
+      <rect x="14.40" y="0.00" width="4.80" height="240.00" />
+      <rect x="28.80" y="0.00" width="4.80" height="240.00" />
+      <rect x="52.80" y="0.00" width="4.80" height="240.00" />
+      <rect x="62.40" y="0.00" width="19.20" height="240.00" />
+      <rect x="86.40" y="0.00" width="14.40" height="240.00" />
+      <rect x="105.60" y="0.00" width="4.80" height="240.00" />
+      <rect x="115.20" y="0.00" width="4.80" height="240.00" />
+      <rect x="134.40" y="0.00" width="9.60" height="240.00" />
+      <rect x="158.40" y="0.00" width="4.80" height="240.00" />
+      <rect x="182.40" y="0.00" width="4.80" height="240.00" />
+      <rect x="192.00" y="0.00" width="9.60" height="240.00" />
+      <rect x="211.20" y="0.00" width="4.80" height="240.00" />
+      <rect x="235.20" y="0.00" width="4.80" height="240.00" />
+      <rect x="244.80" y="0.00" width="9.60" height="240.00" />
+      <rect x="264.00" y="0.00" width="4.80" height="240.00" />
+      <rect x="273.60" y="0.00" width="9.60" height="240.00" />
+      <rect x="292.80" y="0.00" width="4.80" height="240.00" />
+      <rect x="316.80" y="0.00" width="9.60" height="240.00" />
+      <rect x="345.60" y="0.00" width="4.80" height="240.00" />
+      <rect x="355.20" y="0.00" width="4.80" height="240.00" />
+      <rect x="369.60" y="0.00" width="4.80" height="240.00" />
+      <rect x="384.00" y="0.00" width="19.20" height="240.00" />
+      <rect x="408.00" y="0.00" width="4.80" height="240.00" />
+      <rect x="422.40" y="0.00" width="4.80" height="240.00" />
+      <rect x="432.00" y="0.00" width="4.80" height="240.00" />
+      <rect x="446.40" y="0.00" width="19.20" height="240.00" />
+      <rect x="475.20" y="0.00" width="9.60" height="240.00" />
+      <rect x="499.20" y="0.00" width="14.40" height="240.00" />
+      <rect x="518.40" y="0.00" width="4.80" height="240.00" />
+      <rect x="528.00" y="0.00" width="9.60" height="240.00" />
+      <text x="268.80" y="270.72" text-anchor="middle"
+         font-family="Helvetica, sans-serif" font-size="33.6" >
+         Ãccent
+      </text>
+   </g>
+</svg>
diff -urN zint-2.12.0/docs/images/code32.svg zint/docs/images/code32.svg
--- zint-2.12.0/docs/images/code32.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code32.svg	2023-05-08 14:39:44.972320000 +0200
@@ -48,7 +48,7 @@
       <rect x="460.80" y="0.00" width="9.60" height="96.00" />
       <rect x="475.20" y="0.00" width="9.60" height="96.00" />
       <rect x="489.60" y="0.00" width="4.80" height="96.00" />
-      <text x="247.20" y="132.96" text-anchor="middle"
+      <text x="247.20" y="129.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          A143523126
       </text>
diff -urN zint-2.12.0/docs/images/code39.svg zint/docs/images/code39.svg
--- zint-2.12.0/docs/images/code39.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code39.svg	2023-05-08 14:39:44.972320000 +0200
@@ -33,7 +33,7 @@
       <rect x="273.60" y="0.00" width="9.60" height="240.00" />
       <rect x="288.00" y="0.00" width="9.60" height="240.00" />
       <rect x="302.40" y="0.00" width="4.80" height="240.00" />
-      <text x="153.60" y="276.96" text-anchor="middle"
+      <text x="153.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          *1AB*
       </text>
diff -urN zint-2.12.0/docs/images/code93.svg zint/docs/images/code93.svg
--- zint-2.12.0/docs/images/code93.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/code93.svg	2023-05-08 14:39:44.972320000 +0200
@@ -30,7 +30,7 @@
       <rect x="268.80" y="0.00" width="4.80" height="192.00" />
       <rect x="278.40" y="0.00" width="19.20" height="192.00" />
       <rect x="302.40" y="0.00" width="4.80" height="192.00" />
-      <text x="153.60" y="228.96" text-anchor="middle"
+      <text x="153.60" y="225.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          C93
       </text>
diff -urN zint-2.12.0/docs/images/dbar_exp.svg zint/docs/images/dbar_exp.svg
--- zint-2.12.0/docs/images/dbar_exp.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dbar_exp.svg	2023-05-08 14:39:44.973320006 +0200
@@ -52,7 +52,7 @@
       <rect x="921.60" y="0.00" width="4.80" height="163.20" />
       <rect x="945.60" y="0.00" width="4.80" height="163.20" />
       <rect x="955.20" y="0.00" width="4.80" height="163.20" />
-      <text x="480.00" y="200.16" text-anchor="middle"
+      <text x="480.00" y="196.80" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)98898765432106(3202)012345(15)991231
       </text>
diff -urN zint-2.12.0/docs/images/dbar_ltd.svg zint/docs/images/dbar_ltd.svg
--- zint-2.12.0/docs/images/dbar_ltd.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dbar_ltd.svg	2023-05-08 14:39:44.973320006 +0200
@@ -31,7 +31,7 @@
       <rect x="307.20" y="0.00" width="19.20" height="48.00" />
       <rect x="336.00" y="0.00" width="9.60" height="48.00" />
       <rect x="350.40" y="0.00" width="4.80" height="48.00" />
-      <text x="189.60" y="84.96" text-anchor="middle"
+      <text x="189.60" y="81.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)09501101530010
       </text>
diff -urN zint-2.12.0/docs/images/dbar_omn.svg zint/docs/images/dbar_omn.svg
--- zint-2.12.0/docs/images/dbar_omn.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dbar_omn.svg	2023-05-08 14:39:44.973320006 +0200
@@ -31,7 +31,7 @@
       <rect x="417.60" y="0.00" width="14.40" height="158.40" />
       <rect x="441.60" y="0.00" width="9.60" height="158.40" />
       <rect x="456.00" y="0.00" width="4.80" height="158.40" />
-      <text x="230.40" y="195.36" text-anchor="middle"
+      <text x="230.40" y="192.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)09501101530010
       </text>
diff -urN zint-2.12.0/docs/images/dbar_truncated.svg zint/docs/images/dbar_truncated.svg
--- zint-2.12.0/docs/images/dbar_truncated.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dbar_truncated.svg	2023-05-08 14:39:44.973320006 +0200
@@ -31,7 +31,7 @@
       <rect x="417.60" y="0.00" width="14.40" height="62.40" />
       <rect x="441.60" y="0.00" width="9.60" height="62.40" />
       <rect x="456.00" y="0.00" width="4.80" height="62.40" />
-      <text x="230.40" y="99.36" text-anchor="middle"
+      <text x="230.40" y="96.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)09501101530010
       </text>
diff -urN zint-2.12.0/docs/images/dpd.svg zint/docs/images/dpd.svg
--- zint-2.12.0/docs/images/dpd.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dpd.svg	2023-05-08 14:39:44.973320006 +0200
@@ -67,7 +67,7 @@
       <rect x="993.60" y="14.40" width="4.80" height="320.00" />
       <rect x="1003.20" y="14.40" width="9.60" height="320.00" />
       <rect x="0.00" y="0.00" width="1012.80" height="14.40" />
-      <text x="506.40" y="371.36" text-anchor="middle"
+      <text x="506.40" y="368.00" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          0003 932 0621 9912 3456 78 101 040 9
       </text>
diff -urN zint-2.12.0/docs/images/dpident.svg zint/docs/images/dpident.svg
--- zint-2.12.0/docs/images/dpident.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dpident.svg	2023-05-08 14:39:44.973320006 +0200
@@ -42,7 +42,7 @@
       <rect x="508.80" y="0.00" width="14.40" height="345.60" />
       <rect x="537.60" y="0.00" width="14.40" height="345.60" />
       <rect x="556.80" y="0.00" width="4.80" height="345.60" />
-      <text x="280.80" y="382.56" text-anchor="middle"
+      <text x="280.80" y="379.20" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          91.23 2.096.712 7
       </text>
diff -urN zint-2.12.0/docs/images/dpleit.svg zint/docs/images/dpleit.svg
--- zint-2.12.0/docs/images/dpleit.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/dpleit.svg	2023-05-08 14:39:44.973320006 +0200
@@ -47,7 +47,7 @@
       <rect x="614.40" y="0.00" width="4.80" height="345.60" />
       <rect x="624.00" y="0.00" width="14.40" height="345.60" />
       <rect x="643.20" y="0.00" width="4.80" height="345.60" />
-      <text x="324.00" y="382.56" text-anchor="middle"
+      <text x="324.00" y="379.20" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          92123.209.671.456
       </text>
diff -urN zint-2.12.0/docs/images/ean14.svg zint/docs/images/ean14.svg
--- zint-2.12.0/docs/images/ean14.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/ean14.svg	2023-05-08 14:39:44.973320006 +0200
@@ -45,7 +45,7 @@
       <rect x="604.80" y="0.00" width="14.40" height="307.88" />
       <rect x="624.00" y="0.00" width="4.80" height="307.88" />
       <rect x="633.60" y="0.00" width="9.60" height="307.88" />
-      <text x="321.60" y="344.84" text-anchor="middle"
+      <text x="321.60" y="341.48" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)98898765432106
       </text>
diff -urN zint-2.12.0/docs/images/eanx13.svg zint/docs/images/eanx13.svg
--- zint-2.12.0/docs/images/eanx13.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/eanx13.svg	2023-05-08 14:39:44.973320006 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="452" height="310" version="1.1"
+<svg width="452" height="311" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="452" height="310" fill="#FFFFFF" />
+      <rect x="0" y="0" width="452" height="311" fill="#FFFFFF" />
       <rect x="44.00" y="0.00" width="4.00" height="296.97" />
       <rect x="52.00" y="0.00" width="4.00" height="296.97" />
       <rect x="60.00" y="0.00" width="8.00" height="276.97" />
@@ -38,15 +38,15 @@
       <rect x="392.00" y="0.00" width="4.00" height="276.97" />
       <rect x="412.00" y="0.00" width="4.00" height="296.97" />
       <rect x="420.00" y="0.00" width="4.00" height="296.97" />
-      <text x="24.00" y="308.97" text-anchor="end"
+      <text x="24.40" y="309.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          4
       </text>
-      <text x="140.00" y="308.97" text-anchor="middle"
+      <text x="142.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          512345
       </text>
-      <text x="328.00" y="308.97" text-anchor="middle"
+      <text x="326.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          678906
       </text>
diff -urN zint-2.12.0/docs/images/eanx5.svg zint/docs/images/eanx5.svg
--- zint-2.12.0/docs/images/eanx5.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/eanx5.svg	2023-05-08 14:39:44.973320006 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="236" height="299" version="1.1"
+<svg width="236" height="300" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="236" height="299" fill="#FFFFFF" />
+      <rect x="0" y="0" width="236" height="300" fill="#FFFFFF" />
       <rect x="28.00" y="0.00" width="4.00" height="265.45" />
       <rect x="36.00" y="0.00" width="8.00" height="265.45" />
       <rect x="48.00" y="0.00" width="12.00" height="265.45" />
@@ -24,7 +24,7 @@
       <rect x="184.00" y="0.00" width="4.00" height="265.45" />
       <rect x="196.00" y="0.00" width="8.00" height="265.45" />
       <rect x="212.00" y="0.00" width="4.00" height="265.45" />
-      <text x="122.00" y="297.45" text-anchor="middle"
+      <text x="122.00" y="297.65" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          54321
       </text>
diff -urN zint-2.12.0/docs/images/eanx8_5.svg zint/docs/images/eanx8_5.svg
--- zint-2.12.0/docs/images/eanx8_5.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/eanx8_5.svg	2023-05-08 14:39:44.973320006 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="540" height="254" version="1.1"
+<svg width="540" height="255" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="540" height="254" fill="#FFFFFF" />
+      <rect x="0" y="0" width="540" height="255" fill="#FFFFFF" />
       <rect x="28.00" y="0.00" width="4.00" height="240.97" />
       <rect x="36.00" y="0.00" width="4.00" height="240.97" />
       <rect x="44.00" y="0.00" width="12.00" height="220.97" />
@@ -30,27 +30,27 @@
       <rect x="264.00" y="0.00" width="12.00" height="220.97" />
       <rect x="284.00" y="0.00" width="4.00" height="240.97" />
       <rect x="292.00" y="0.00" width="4.00" height="240.97" />
-      <rect x="324.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="332.00" y="38.00" width="8.00" height="202.97" />
-      <rect x="344.00" y="38.00" width="12.00" height="202.97" />
-      <rect x="364.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="372.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="380.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="396.00" y="38.00" width="8.00" height="202.97" />
-      <rect x="408.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="416.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="436.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="444.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="456.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="468.00" y="38.00" width="8.00" height="202.97" />
-      <rect x="480.00" y="38.00" width="4.00" height="202.97" />
-      <rect x="492.00" y="38.00" width="8.00" height="202.97" />
-      <rect x="508.00" y="38.00" width="4.00" height="202.97" />
-      <text x="96.00" y="252.97" text-anchor="middle"
+      <rect x="324.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="332.00" y="33.80" width="8.00" height="207.17" />
+      <rect x="344.00" y="33.80" width="12.00" height="207.17" />
+      <rect x="364.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="372.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="380.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="396.00" y="33.80" width="8.00" height="207.17" />
+      <rect x="408.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="416.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="436.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="444.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="456.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="468.00" y="33.80" width="8.00" height="207.17" />
+      <rect x="480.00" y="33.80" width="4.00" height="207.17" />
+      <rect x="492.00" y="33.80" width="8.00" height="207.17" />
+      <rect x="508.00" y="33.80" width="4.00" height="207.17" />
+      <text x="98.00" y="253.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          7432
       </text>
-      <text x="228.00" y="252.97" text-anchor="middle"
+      <text x="226.00" y="253.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          3654
       </text>
diff -urN zint-2.12.0/docs/images/eanx_cc_a.svg zint/docs/images/eanx_cc_a.svg
--- zint-2.12.0/docs/images/eanx_cc_a.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/eanx_cc_a.svg	2023-05-08 14:39:44.973320006 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="468" height="358" version="1.1"
+<svg width="468" height="359" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="468" height="358" fill="#FFFFFF" />
+      <rect x="0" y="0" width="468" height="359" fill="#FFFFFF" />
       <rect x="44.00" y="0.00" width="8.00" height="24.00" />
       <rect x="56.00" y="0.00" width="8.00" height="24.00" />
       <rect x="68.00" y="0.00" width="12.00" height="8.00" />
@@ -103,15 +103,15 @@
       <rect x="396.00" y="48.00" width="4.00" height="276.97" />
       <rect x="416.00" y="48.00" width="4.00" height="276.97" />
       <rect x="424.00" y="48.00" width="4.00" height="296.97" />
-      <text x="36.00" y="356.97" text-anchor="end"
+      <text x="36.40" y="357.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          3
       </text>
-      <text x="152.00" y="356.97" text-anchor="middle"
+      <text x="154.00" y="357.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          312345
       </text>
-      <text x="340.00" y="356.97" text-anchor="middle"
+      <text x="338.00" y="357.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          678903
       </text>
diff -urN zint-2.12.0/docs/images/eanx_cc_b.svg zint/docs/images/eanx_cc_b.svg
--- zint-2.12.0/docs/images/eanx_cc_b.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/eanx_cc_b.svg	2023-05-08 14:39:44.974320012 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="468" height="382" version="1.1"
+<svg width="468" height="383" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="468" height="382" fill="#FFFFFF" />
+      <rect x="0" y="0" width="468" height="383" fill="#FFFFFF" />
       <rect x="44.00" y="0.00" width="8.00" height="8.00" />
       <rect x="60.00" y="0.00" width="4.00" height="16.00" />
       <rect x="76.00" y="0.00" width="4.00" height="48.00" />
@@ -152,15 +152,15 @@
       <rect x="396.00" y="72.00" width="4.00" height="276.97" />
       <rect x="416.00" y="72.00" width="4.00" height="276.97" />
       <rect x="424.00" y="72.00" width="4.00" height="296.97" />
-      <text x="36.00" y="380.97" text-anchor="end"
+      <text x="36.40" y="381.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          3
       </text>
-      <text x="152.00" y="380.97" text-anchor="middle"
+      <text x="154.00" y="381.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          312345
       </text>
-      <text x="340.00" y="380.97" text-anchor="middle"
+      <text x="338.00" y="381.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          678903
       </text>
diff -urN zint-2.12.0/docs/images/excode39.svg zint/docs/images/excode39.svg
--- zint-2.12.0/docs/images/excode39.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/excode39.svg	2023-05-08 14:39:44.974320012 +0200
@@ -68,7 +68,7 @@
       <rect x="710.40" y="0.00" width="9.60" height="240.00" />
       <rect x="724.80" y="0.00" width="9.60" height="240.00" />
       <rect x="739.20" y="0.00" width="4.80" height="240.00" />
-      <text x="372.00" y="276.96" text-anchor="middle"
+      <text x="372.00" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          123.45fd
       </text>
diff -urN zint-2.12.0/docs/images/gs1_128_cc_c.svg zint/docs/images/gs1_128_cc_c.svg
--- zint-2.12.0/docs/images/gs1_128_cc_c.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/gs1_128_cc_c.svg	2023-05-08 14:39:44.974320012 +0200
@@ -199,7 +199,7 @@
       <rect x="576.00" y="52.00" width="12.00" height="256.57" />
       <rect x="592.00" y="52.00" width="4.00" height="256.57" />
       <rect x="600.00" y="52.00" width="8.00" height="256.57" />
-      <text x="308.00" y="339.37" text-anchor="middle"
+      <text x="308.00" y="336.57" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          (01)03312345678903
       </text>
diff -urN zint-2.12.0/docs/images/gs1_128.svg zint/docs/images/gs1_128.svg
--- zint-2.12.0/docs/images/gs1_128.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/gs1_128.svg	2023-05-08 14:39:44.974320012 +0200
@@ -72,7 +72,7 @@
       <rect x="1080.00" y="0.00" width="14.40" height="307.88" />
       <rect x="1099.20" y="0.00" width="4.80" height="307.88" />
       <rect x="1108.80" y="0.00" width="9.60" height="307.88" />
-      <text x="559.20" y="344.84" text-anchor="middle"
+      <text x="559.20" y="341.48" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (01)98898765432106(3202)012345(15)991231
       </text>
Binary files zint-2.12.0/docs/images/gui_appearance.png and zint/docs/images/gui_appearance.png differ
Binary files zint-2.12.0/docs/images/gui_aztec.png and zint/docs/images/gui_aztec.png differ
Binary files zint-2.12.0/docs/images/gui_composite.png and zint/docs/images/gui_composite.png differ
Binary files zint-2.12.0/docs/images/gui_main.png and zint/docs/images/gui_main.png differ
Binary files zint-2.12.0/docs/images/gui_segs.png and zint/docs/images/gui_segs.png differ
Binary files zint-2.12.0/docs/images/gui_set_printing_scale.png and zint/docs/images/gui_set_printing_scale.png differ
diff -urN zint-2.12.0/docs/images/hibc_128.svg zint/docs/images/hibc_128.svg
--- zint-2.12.0/docs/images/hibc_128.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/hibc_128.svg	2023-05-08 14:39:44.988320095 +0200
@@ -63,7 +63,7 @@
       <rect x="921.60" y="0.00" width="14.40" height="240.00" />
       <rect x="940.80" y="0.00" width="4.80" height="240.00" />
       <rect x="950.40" y="0.00" width="9.60" height="240.00" />
-      <text x="480.00" y="276.96" text-anchor="middle"
+      <text x="480.00" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          *+A123BJC5D6E71G*
       </text>
diff -urN zint-2.12.0/docs/images/hibc_39.svg zint/docs/images/hibc_39.svg
--- zint-2.12.0/docs/images/hibc_39.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/hibc_39.svg	2023-05-08 14:39:44.988320095 +0200
@@ -68,7 +68,7 @@
       <rect x="873.60" y="0.00" width="14.40" height="240.00" />
       <rect x="892.80" y="0.00" width="14.40" height="240.00" />
       <rect x="912.00" y="0.00" width="4.80" height="240.00" />
-      <text x="458.40" y="276.96" text-anchor="middle"
+      <text x="458.40" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          *+14352312J*
       </text>
diff -urN zint-2.12.0/docs/images/isbnx.svg zint/docs/images/isbnx.svg
--- zint-2.12.0/docs/images/isbnx.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/isbnx.svg	2023-05-08 14:39:44.988320095 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="452" height="310" version="1.1"
+<svg width="452" height="311" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="452" height="310" fill="#FFFFFF" />
+      <rect x="0" y="0" width="452" height="311" fill="#FFFFFF" />
       <rect x="44.00" y="0.00" width="4.00" height="296.97" />
       <rect x="52.00" y="0.00" width="4.00" height="296.97" />
       <rect x="60.00" y="0.00" width="12.00" height="276.97" />
@@ -38,15 +38,15 @@
       <rect x="392.00" y="0.00" width="12.00" height="276.97" />
       <rect x="412.00" y="0.00" width="4.00" height="296.97" />
       <rect x="420.00" y="0.00" width="4.00" height="296.97" />
-      <text x="24.00" y="308.97" text-anchor="end"
+      <text x="24.40" y="309.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          9
       </text>
-      <text x="140.00" y="308.97" text-anchor="middle"
+      <text x="142.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          789295
       </text>
-      <text x="328.00" y="308.97" text-anchor="middle"
+      <text x="326.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          055124
       </text>
diff -urN zint-2.12.0/docs/images/itf14_border0.svg zint/docs/images/itf14_border0.svg
--- zint-2.12.0/docs/images/itf14_border0.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/itf14_border0.svg	2023-05-08 14:39:44.988320095 +0200
@@ -47,7 +47,7 @@
       <rect x="662.40" y="0.00" width="4.80" height="307.88" />
       <rect x="672.00" y="0.00" width="14.40" height="307.88" />
       <rect x="691.20" y="0.00" width="4.80" height="307.88" />
-      <text x="372.00" y="344.84" text-anchor="middle"
+      <text x="372.00" y="341.48" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          92123209671459
       </text>
diff -urN zint-2.12.0/docs/images/itf14.svg zint/docs/images/itf14.svg
--- zint-2.12.0/docs/images/itf14.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/itf14.svg	2023-05-08 14:39:44.988320095 +0200
@@ -51,7 +51,7 @@
       <rect x="0.00" y="331.88" width="792.00" height="24.00" />
       <rect x="0.00" y="24.00" width="24.00" height="307.88" />
       <rect x="768.00" y="24.00" width="24.00" height="307.88" />
-      <text x="396.00" y="392.84" text-anchor="middle"
+      <text x="396.00" y="389.48" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          92123209671459
       </text>
diff -urN zint-2.12.0/docs/images/koreapost.svg zint/docs/images/koreapost.svg
--- zint-2.12.0/docs/images/koreapost.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/koreapost.svg	2023-05-08 14:39:44.988320095 +0200
@@ -36,7 +36,7 @@
       <rect x="710.40" y="0.00" width="4.80" height="240.00" />
       <rect x="729.60" y="0.00" width="4.80" height="240.00" />
       <rect x="787.20" y="0.00" width="4.80" height="240.00" />
-      <text x="403.20" y="276.96" text-anchor="middle"
+      <text x="403.20" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          9234570
       </text>
diff -urN zint-2.12.0/docs/images/logmars.svg zint/docs/images/logmars.svg
--- zint-2.12.0/docs/images/logmars.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/logmars.svg	2023-05-08 14:39:44.989320101 +0200
@@ -78,7 +78,7 @@
       <rect x="1027.20" y="0.00" width="14.40" height="218.18" />
       <rect x="1046.40" y="0.00" width="14.40" height="218.18" />
       <rect x="1065.60" y="0.00" width="4.80" height="218.18" />
-      <text x="535.20" y="255.14" text-anchor="middle"
+      <text x="535.20" y="251.78" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          12345/ABCDET
       </text>
diff -urN zint-2.12.0/docs/images/msi_plessey.svg zint/docs/images/msi_plessey.svg
--- zint-2.12.0/docs/images/msi_plessey.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/msi_plessey.svg	2023-05-08 14:39:44.989320101 +0200
@@ -35,7 +35,7 @@
       <rect x="345.60" y="0.00" width="9.60" height="240.00" />
       <rect x="360.00" y="0.00" width="4.80" height="240.00" />
       <rect x="374.40" y="0.00" width="4.80" height="240.00" />
-      <text x="189.60" y="276.96" text-anchor="middle"
+      <text x="189.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          650291
       </text>
diff -urN zint-2.12.0/docs/images/nve18.svg zint/docs/images/nve18.svg
--- zint-2.12.0/docs/images/nve18.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/nve18.svg	2023-05-08 14:39:44.989320101 +0200
@@ -51,7 +51,7 @@
       <rect x="710.40" y="0.00" width="14.40" height="307.88" />
       <rect x="729.60" y="0.00" width="4.80" height="307.88" />
       <rect x="739.20" y="0.00" width="9.60" height="307.88" />
-      <text x="374.40" y="344.84" text-anchor="middle"
+      <text x="374.40" y="341.48" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          (00)376123450000010039
       </text>
diff -urN zint-2.12.0/docs/images/plessey.svg zint/docs/images/plessey.svg
--- zint-2.12.0/docs/images/plessey.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/plessey.svg	2023-05-08 14:39:44.989320101 +0200
@@ -37,7 +37,7 @@
       <rect x="508.80" y="0.00" width="4.80" height="240.00" />
       <rect x="518.40" y="0.00" width="14.40" height="240.00" />
       <rect x="537.60" y="0.00" width="14.40" height="240.00" />
-      <text x="276.00" y="276.96" text-anchor="middle"
+      <text x="276.00" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          C64
       </text>
diff -urN zint-2.12.0/docs/images/pzn.svg zint/docs/images/pzn.svg
--- zint-2.12.0/docs/images/pzn.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/pzn.svg	2023-05-08 14:39:44.990320106 +0200
@@ -63,7 +63,7 @@
       <rect x="648.00" y="0.00" width="9.60" height="192.00" />
       <rect x="662.40" y="0.00" width="9.60" height="192.00" />
       <rect x="676.80" y="0.00" width="4.80" height="192.00" />
-      <text x="340.80" y="228.96" text-anchor="middle"
+      <text x="340.80" y="225.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          PZN - 27580899
       </text>
diff -urN zint-2.12.0/docs/images/telepen_num.svg zint/docs/images/telepen_num.svg
--- zint-2.12.0/docs/images/telepen_num.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/telepen_num.svg	2023-05-08 14:39:44.990320106 +0200
@@ -42,7 +42,7 @@
       <rect x="432.00" y="0.00" width="4.80" height="153.60" />
       <rect x="441.60" y="0.00" width="4.80" height="153.60" />
       <rect x="451.20" y="0.00" width="4.80" height="153.60" />
-      <text x="230.40" y="190.56" text-anchor="middle"
+      <text x="230.40" y="187.20" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          466X33
       </text>
diff -urN zint-2.12.0/docs/images/telepen.svg zint/docs/images/telepen.svg
--- zint-2.12.0/docs/images/telepen.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/telepen.svg	2023-05-08 14:39:44.990320106 +0200
@@ -40,7 +40,7 @@
       <rect x="432.00" y="0.00" width="4.80" height="153.60" />
       <rect x="441.60" y="0.00" width="4.80" height="153.60" />
       <rect x="451.20" y="0.00" width="4.80" height="153.60" />
-      <text x="230.40" y="190.56" text-anchor="middle"
+      <text x="230.40" y="187.20" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          Z80
       </text>
diff -urN zint-2.12.0/docs/images/upca_5.svg zint/docs/images/upca_5.svg
--- zint-2.12.0/docs/images/upca_5.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/upca_5.svg	2023-05-08 14:39:44.990320106 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="660" height="310" version="1.1"
+<svg width="660" height="311" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="660" height="310" fill="#FFFFFF" />
+      <rect x="0" y="0" width="660" height="311" fill="#FFFFFF" />
       <rect x="36.00" y="0.00" width="4.00" height="296.97" />
       <rect x="44.00" y="0.00" width="4.00" height="296.97" />
       <rect x="52.00" y="0.00" width="12.00" height="296.97" />
@@ -38,35 +38,35 @@
       <rect x="396.00" y="0.00" width="4.00" height="296.97" />
       <rect x="404.00" y="0.00" width="4.00" height="296.97" />
       <rect x="412.00" y="0.00" width="4.00" height="296.97" />
-      <rect x="452.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="460.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="472.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="488.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="500.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="512.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="524.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="536.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="544.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="564.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="572.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="580.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="596.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="608.00" y="38.00" width="4.00" height="238.97" />
-      <rect x="616.00" y="38.00" width="8.00" height="238.97" />
-      <rect x="636.00" y="38.00" width="4.00" height="238.97" />
-      <text x="16.00" y="308.97" text-anchor="end"
+      <rect x="452.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="460.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="472.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="488.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="500.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="512.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="524.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="536.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="544.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="564.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="572.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="580.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="596.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="608.00" y="33.80" width="4.00" height="243.17" />
+      <rect x="616.00" y="33.80" width="8.00" height="243.17" />
+      <rect x="636.00" y="33.80" width="4.00" height="243.17" />
+      <text x="17.40" y="309.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          7
       </text>
-      <text x="144.00" y="308.97" text-anchor="middle"
+      <text x="148.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          25272
       </text>
-      <text x="304.00" y="308.97" text-anchor="middle"
+      <text x="304.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          70270
       </text>
-      <text x="436.00" y="308.97" text-anchor="start"
+      <text x="434.60" y="309.17" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          3
       </text>
diff -urN zint-2.12.0/docs/images/upca.svg zint/docs/images/upca.svg
--- zint-2.12.0/docs/images/upca.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/upca.svg	2023-05-08 14:39:44.990320106 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="452" height="310" version="1.1"
+<svg width="452" height="311" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="452" height="310" fill="#FFFFFF" />
+      <rect x="0" y="0" width="452" height="311" fill="#FFFFFF" />
       <rect x="36.00" y="0.00" width="4.00" height="296.97" />
       <rect x="44.00" y="0.00" width="4.00" height="296.97" />
       <rect x="52.00" y="0.00" width="12.00" height="296.97" />
@@ -38,19 +38,19 @@
       <rect x="396.00" y="0.00" width="4.00" height="296.97" />
       <rect x="404.00" y="0.00" width="4.00" height="296.97" />
       <rect x="412.00" y="0.00" width="4.00" height="296.97" />
-      <text x="16.00" y="308.97" text-anchor="end"
+      <text x="17.40" y="309.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          7
       </text>
-      <text x="144.00" y="308.97" text-anchor="middle"
+      <text x="148.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          25272
       </text>
-      <text x="304.00" y="308.97" text-anchor="middle"
+      <text x="304.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          70270
       </text>
-      <text x="436.00" y="308.97" text-anchor="start"
+      <text x="434.60" y="309.17" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          3
       </text>
diff -urN zint-2.12.0/docs/images/upce.svg zint/docs/images/upce.svg
--- zint-2.12.0/docs/images/upce.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/upce.svg	2023-05-08 14:39:44.990320106 +0200
@@ -1,13 +1,13 @@
 <?xml version="1.0" standalone="no"?>
 <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
-<svg width="268" height="310" version="1.1"
+<svg width="268" height="311" version="1.1"
    xmlns="http://www.w3.org/2000/svg">
    <desc>Zint Generated Symbol
    </desc>
 
    <g id="barcode" fill="#000000">
-      <rect x="0" y="0" width="268" height="310" fill="#FFFFFF" />
+      <rect x="0" y="0" width="268" height="311" fill="#FFFFFF" />
       <rect x="36.00" y="0.00" width="4.00" height="296.97" />
       <rect x="44.00" y="0.00" width="4.00" height="296.97" />
       <rect x="56.00" y="0.00" width="8.00" height="276.97" />
@@ -25,15 +25,15 @@
       <rect x="220.00" y="0.00" width="4.00" height="296.97" />
       <rect x="228.00" y="0.00" width="4.00" height="296.97" />
       <rect x="236.00" y="0.00" width="4.00" height="296.97" />
-      <text x="16.00" y="308.97" text-anchor="end"
+      <text x="17.40" y="309.17" text-anchor="end"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          1
       </text>
-      <text x="132.00" y="308.97" text-anchor="middle"
+      <text x="134.00" y="309.17" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="40.0" >
          123456
       </text>
-      <text x="252.00" y="308.97" text-anchor="start"
+      <text x="250.60" y="309.17" text-anchor="start"
          font-family="Helvetica, sans-serif" font-size="28.0" >
          2
       </text>
diff -urN zint-2.12.0/docs/images/upu_s10.svg zint/docs/images/upu_s10.svg
--- zint-2.12.0/docs/images/upu_s10.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/upu_s10.svg	2023-05-08 14:39:44.990320106 +0200
@@ -51,7 +51,7 @@
       <rect x="710.40" y="0.00" width="14.40" height="240.00" />
       <rect x="729.60" y="0.00" width="4.80" height="240.00" />
       <rect x="739.20" y="0.00" width="9.60" height="240.00" />
-      <text x="374.40" y="276.96" text-anchor="middle"
+      <text x="374.40" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          EE 876 543 216 CA
       </text>
diff -urN zint-2.12.0/docs/images/vin.svg zint/docs/images/vin.svg
--- zint-2.12.0/docs/images/vin.svg	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/images/vin.svg	2023-05-08 14:39:44.991320112 +0200
@@ -108,7 +108,7 @@
       <rect x="1209.60" y="0.00" width="9.60" height="240.00" />
       <rect x="1224.00" y="0.00" width="9.60" height="240.00" />
       <rect x="1238.40" y="0.00" width="4.80" height="240.00" />
-      <text x="621.60" y="276.96" text-anchor="middle"
+      <text x="621.60" y="273.60" text-anchor="middle"
          font-family="Helvetica, sans-serif" font-size="33.6" >
          2FTPX28L0XCA15511
       </text>
diff -urN zint-2.12.0/docs/manual.pmd zint/docs/manual.pmd
--- zint-2.12.0/docs/manual.pmd	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/manual.pmd	2023-05-08 14:39:44.992320118 +0200
@@ -1,6 +1,6 @@
 % Zint Barcode Generator and Zint Barcode Studio User Manual
-% Version 2.12.0
-% December 2022
+% Version 2.12.0.9
+% February 2023
 
 # 1. Introduction
 
@@ -81,6 +81,8 @@
     'chunks' of data, each of which starts with an Application Identifier (AI).
     The AI identifies what type of information is being encoded.
 
+\clearpage
+
 Reader Initialisation (Programming)
 
 :   Some symbologies allow a special character to be included which can be
@@ -194,13 +196,15 @@
     https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
 ```
 
-Once Homebrew is installed use the following command to install the Zint.
+Once Homebrew is installed use the following command to install the CLI and
+library
 
 ```bash
 brew install zint
 ```
 
-To build from source see `"README.macos"` in the project root directory.
+To build from source (and install the GUI) see `"README.macos"` in the project
+root directory.
 
 [^1]: See the Homebrew website [https://brew.sh](https://brew.sh).
 
@@ -326,14 +330,16 @@
 ![Adjusting the Print Size](images/gui_set_printing_scale.png)
 
 The foreground and background colours can be set either using the text boxes
-which accept RRGGBBAA hexadecimal values or by clicking the foreground eye
-![eye](images/gui_black_eye.png) and background eye
-![eye](images/gui_white_eye.png) buttons which invoke a colour picker.
+which accept `"RRGGBBAA"` hexadecimal values and `"C,M,Y,K"` decimal percentage
+values, or by clicking the foreground eye ![eye](images/gui_black_eye.png) and
+background eye ![eye](images/gui_white_eye.png) buttons which invoke a colour
+picker.
 
 ![The colour picker tool](images/gui_colour.png)
 
 (Note that to change the colours visually, the luminence slider, the long narrow
-column on the right, must be adjusted.)
+column on the right, must be adjusted.) The color picker only deals in RGB(A),
+and will overwrite any CMYK values with RGB(A) values once `"OK"` is selected.
 
 Back in the Appearance tab, the colours can be reset to black-on-white using the
 `"Reset"` button, and exchanged one for the other using the swap
@@ -492,15 +498,20 @@
 
 `\\`        0x5C        `\`     Backslash
 
-`\dNNN`     NNN                 Any 8-bit character where NNN is decimal (0-255)
+`\dNNN`     NNN                 Any 8-bit character where NNN is decimal
+                                (000-255)
+
+`\oNNN`     0oNNN               Any 8-bit character where NNN is octal
+                                (000-377)
 
 `\xNN`      0xNN                Any 8-bit character where NN is hexadecimal
+                                (00-FF)
 
 `\uNNNN`                        Any 16-bit Unicode BMP[^2] character where
-                                NNNN is hexadecimal
+                                NNNN is hexadecimal (0000-FFFF)
 
 `\UNNNNNN`                      Any 21-bit Unicode character where NNNNNN
-                                is hexadecimal (maximum 0x10FFFF)
+                                is hexadecimal (000000-10FFFF)
 ---------------------------------------------------------------------------
 
 Table: {#tbl:escape_sequences tag=": Escape Sequences"}
@@ -509,6 +520,9 @@
 codeset from U+0000 to U+D7FF and U+E000 to U+FFFF (i.e. excluding surrogates).
 Not to be confused with the Windows Bitmap file format BMP!
 
+(Special escape sequences are available for Code 128 only to manually switch
+Code Sets - see [6.1.10.1 Standard Code 128 (ISO 15417)] for details.)
+
 Input data can be read directly from file using the `-i` or `--input` switch as
 shown below. The input file is assumed to be UTF-8 formatted unless an
 alternative mode is selected. This command replaces the use of the `-d` switch.
@@ -517,9 +531,11 @@
 zint -i somefile.txt
 ```
 
+To read from stdin specify a single hyphen `"-"` as the input file.
+
 Note that except when batch processing (see [4.11 Batch Processing] below), the
-file should not end with a newline (`LF` on Unix, `CR+LF` on Windows) unless you
-want the newline to be encoded in the symbol.
+file (or stdin) should not end with a newline (`LF` on Unix, `CR+LF` on Windows)
+unless you want the newline to be encoded in the symbol.
 
 ## 4.2 Directing Output
 
@@ -593,7 +609,7 @@
 
  18      `BARCODE_CODABAR`         Codabar
 
- 20      `BARCODE_CODE128`         Code 128 (automatic subset switching)
+ 20      `BARCODE_CODE128`         Code 128 (automatic Code Set switching)
 
  21      `BARCODE_DPLEIT`          Deutsche Post Leitcode
 
@@ -637,7 +653,7 @@
  52      `BARCODE_PZN`             PZN
 
  53      `BARCODE_PHARMA_TWO`      Pharmacode Two-Track
- 
+
  54      `BARCODE_CEPNET`          Brazilian CEPNet
 
  55      `BARCODE_PDF417`          PDF417
@@ -648,7 +664,7 @@
 
  58      `BARCODE_QRCODE`          QR Code
 
- 60      `BARCODE_CODE128AB`       Code 128 (Suppress subset C)
+ 60      `BARCODE_CODE128AB`       Code 128 (Suppress Code Set C)
 
  63      `BARCODE_AUSPOST`         Australia Post Standard Customer
 
@@ -912,8 +928,10 @@
 Code, Grid Matrix and QR Code symbology specifications.
 
 For more specific needs the foreground (ink) and background (paper) colours can
-be specified using the `--fg` and `--bg` options followed by a number in RRGGBB
-hexadecimal notation (the same system used in HTML). For example the command
+be specified using the `--fg` and `--bg` options followed by a number in
+`"RRGGBB"` hexadecimal notation (the same system used in HTML) or in `"C,M,Y,K"`
+decimal percentages format (the latter normally used with the `--cmyk` option -
+see below). For example the command
 
 ```bash
 zint --fg=00FF00 -d "This Text"
@@ -923,9 +941,10 @@
 
 ![`zint -d "This Text" --fg=00FF00`](images/code128_green.svg)
 
-Zint also supports RGBA colour information for some output file formats which
-support alpha channels (currently only PNG, SVG and TIF) in a RRGGBBAA format.
-For example:
+Zint also supports RGBA colour information for those output file formats which
+support alpha channels (currently only GIF, PCX, PNG, SVG and TIF, with GIF
+supporting either a background or foreground alpha but not both) in a
+`"RRGGBBAA"` format. For example:
 
 ```bash
 zint --fg=00ff0055 -d "This Text"
@@ -934,8 +953,9 @@
 ![`zint -d "This Text" --fg=00FF0055`](images/code128_green_alpha.svg)
 
 will produce a semi-transparent green foreground with standard (white)
-background. Note that transparency is handled differently for raster and
-vector files so that...
+background. Note that transparency is treated differently by raster and vector
+(SVG) output formats, as for vector output the background will "shine through"
+a transparent foreground. For instance
 
 ```bash
 zint --bg=ff0000 --fg=ffffff00 ...
@@ -943,8 +963,18 @@
 
 will give different results for PNG and SVG. Experimentation is advised!
 
-In addition the `--nobackground` option will simply remove the background from
-EMF, EPS, GIF, PNG, SVG and TIF files.
+In addition the `--nobackground` option will remove the background from all
+output formats except BMP.[^4]
+
+The `--cmyk` option is specific to output in Encapsulated PostScript (EPS) and
+TIF, and selects the CMYK colour space. Custom colours should then usually be
+given in the comma-separated `"C,M,Y,K"` format, where `C`, `M`, `Y` and `K` are
+expressed as decimal percentage values from 0 to 100. RGB values may still be
+used, in which case they will be converted formulaically to CMYK approximations.
+
+[^4]: The background is omitted for vector outputs EMF, EPS and SVG when
+`--nobackground` is given. For raster outputs GIF, PCX, PNG and TIF, the
+background's alpha channel is set to zero (fully transparent).
 
 ## 4.8 Rotating the Symbol
 
@@ -1079,7 +1109,7 @@
 Han Xin        Latin-1                   GB 18030 (includes ASCII)
 MaxiCode       Latin-1                   None
 MicroPDF417    Latin-1                   None
-Micro QR Code  Latin-1                   Shift JIS (includes ASCII[^4])
+Micro QR Code  Latin-1                   Shift JIS (includes ASCII[^5])
 PDF417         Latin-1                   None
 QR Code        Latin-1                   Shift JIS (see above)
 rMQR           Latin-1                   Shift JIS (see above)
@@ -1089,7 +1119,7 @@
 
 Table: {#tbl:default_character_sets tag=": Default Character Sets"}
 
-[^4]: Shift JIS (JIS X 0201 Roman) re-maps two ASCII characters: backslash (`\`)
+[^5]: Shift JIS (JIS X 0201 Roman) re-maps two ASCII characters: backslash (`\`)
 to the yen sign (Â¥), and tilde (`~`) to overline (U+203E).
 
 If Zint encounters characters which can not be encoded using the default
@@ -1184,12 +1214,12 @@
 33        UTF-16LE (Low order byte first)
 34        UTF-32BE (High order bytes first)
 35        UTF-32LE (Low order bytes first)
-170       ISO/IEC 646 Invariant[^5]
+170       ISO/IEC 646 Invariant[^6]
 899       8-bit binary data
 
 Table: {#tbl:eci_codes tag=": ECI Codes"}
 
-[^5]: ISO/IEC 646 Invariant is a subset of ASCII with 12 characters undefined:
+[^6]: ISO/IEC 646 Invariant is a subset of ASCII with 12 characters undefined:
 `#`, `$`, `@`, `[`, `\`, `]`, `^`, `` ` ``, `{`, `|`, `}`, `~`.
 
 An ECI value of 0 does not encode any ECI information in the code symbol (unless
@@ -1343,7 +1373,7 @@
 supported output file formats are shown in the following table.
 
 Abbreviation   File format
-------------   ---------------------------
+------------   ------------------------------------
 BMP            Windows Bitmap
 EMF            Enhanced Metafile Format
 EPS            Encapsulated PostScript
@@ -1352,7 +1382,7 @@
 PNG            Portable Network Graphic
 SVG            Scalable Vector Graphic
 TIF            Tagged Image File Format
-TXT            Text file (see [4.18 Other Output Options])
+TXT            Text file (see [4.19 Other Options])
 
 Table: {#tbl:output_file_formats tag=": Output File Formats"}
 
@@ -1441,7 +1471,24 @@
 and goes from 1 to count. Count must be 2 or more. See the individual
 symbologies for further details.
 
-## 4.17 Help Options
+## 4.17 Human Readable Text (HRT) Options
+
+For linear barcodes the text present in the output image can be removed by
+using the `--notext` option.
+
+Text can be set to bold using the `--bold` option, or a smaller font can be
+substituted using the `--small` option. The `--bold` and `--small` options can
+be used together if required, but only for vector output.
+
+![`zint --bold -d "This Text" --small`](images/code128_small_bold.svg)
+
+The gap between the barcode and the text can be adjusted using the `--textgap`
+option, where the gap is given as a multiple of the X-dimension (maximum 5X). A
+zero value uses the default gap.
+
+![`zint -d "Ãccent" --textgap=0.1`](images/code128_textgap.svg)
+
+## 4.18 Help Options
 
 There are three help options which give information about how to use the
 command line. The `-h` or `--help` option will display a list of all of the
@@ -1453,25 +1500,12 @@
 
 The `-e` or `--ecinos` option gives a list of the ECI codes.
 
-## 4.18 Other Output Options
-
-For linear barcodes the text present in the output image can be removed by
-using the `--notext` option.
-
-The text can be set to bold using the `--bold` option, or a smaller font
-can be substituted using the `--small` option. The `--bold` and `--small`
-options can be used together if required, but only for vector output.
-
-![`zint --bold -d "This Text" --small`](images/code128_small_bold.svg)
+## 4.19 Other Options
 
 Zint can output a representation of the symbol data as a set of hexadecimal
 values if asked to output to a text file (`"*.txt"`) or if given the option
 `--filetype=txt`. This can be used for test and diagnostic purposes.
 
-The `--cmyk` option is specific to output in Encapsulated PostScript and TIF,
-and converts the RGB colours used to the CMYK colour space. Setting custom
-colours at the command line will still need to be done in RRGGBB format.
-
 Additional options are available which are specific to certain symbologies.
 These may, for example, control the amount of error correction data or the
 size of the symbol. These options are discussed in section [6. Types of
@@ -1494,9 +1528,9 @@
 ## 5.1 Creating and Deleting Symbols
 
 The symbols manipulated by Zint are held in a `zint_symbol` structure defined in
-`"zint.h"`. These symbols are created with the `ZBarcode_Create()` function and
-deleted using the `ZBarcode_Delete()` function. For example the following code
-creates and then deletes a symbol:
+`"zint.h"`. These symbol structures are created with the `ZBarcode_Create()`
+function and deleted using the `ZBarcode_Delete()` function. For example the
+following code creates and then deletes a symbol:
 
 ```c
 #include <zint.h>
@@ -1591,7 +1625,8 @@
 
 The `ZBarcode_Encode_File()` and `ZBarcode_Encode_File_and_Print()` functions
 can be used to encode data read directly from a text file where the filename is
-given in the `NUL`-terminated `filename` string.
+given in the `NUL`-terminated `filename` string. The special filename `"-"`
+(single hyphen) can be used to read from stdin.
 
 If printing more than one barcode, the `zint_symbol` structure may be re-used by
 calling the `ZBarcode_Clear()` function after each barcode to free any output
@@ -1688,7 +1723,7 @@
 struct zint_vector_circle *circle;
 
 prepare_canvas(my_symbol->vector->width, my_symbol->vector->height,
-               my_symbol->scale, my_symbol->fgcolour, my_symbol->bgcolor,
+               my_symbol->scale, my_symbol->fgcolour, my_symbol->bgcolour,
                rotate_angle);
 
 for (rect = my_symbol->vector->rectangles; rect; rect = rect->next) {
@@ -1725,35 +1760,41 @@
 `symbology`           integer     Symbol to use (see [5.8      `BARCODE_CODE128`
                                   Specifying a Symbology]).
 
-`height`              float       Symbol height, excluding      Symbol dependent
+`height`              float       Symbol height in              Symbol dependent
+                                  X-dimensions, excluding
                                   fixed width-to-height
-                                  symbols.[^6]
+                                  symbols.[^7]
 
 `scale`               float       Scale factor for adjusting    1.0
-                                  size of image.
+                                  size of image (sets
+                                  X-dimension).
 
-`whitespace_width`    integer     Horizontal whitespace width.  0
+`whitespace_width`    integer     Horizontal whitespace width   0
+                                  in X-dimensions.
 
-`whitespace_height`   integer     Vertical whitespace height.   0
+`whitespace_height`   integer     Vertical whitespace height    0
+                                  in X-dimensions.
 
-`border_width`        integer     Border width.                 0
+`border_width`        integer     Border width in               0
+                                  X-dimensions.
 
-`output_options`      integer     Set various output file       0 (none)
+`output_options`      integer     Set various output            0 (none)
                                   parameters (see [5.9
-                                  Adjusting Other Output
-                                  Options]).
+                                  Adjusting Output Options]).
 
 `fgcolour`            character   Foreground (ink)              `"000000"`
                       string      colour as RGB/RGBA
-                                  hexadecimal string. Must be
-                                  6 or 8 characters followed
-                                  by a terminating `NUL`.
+                                  hexadecimal string or
+                                  `"C,M,Y,K"` decimal
+                                  percentages string, with a
+                                  terminating `NUL`.
 
 `bgcolour`            character   Background (paper)            `"ffffff"`
                       string      colour as RGB/RGBA
-                                  hexadecimal string. Must be
-                                  6 or 8 characters followed
-                                  by a terminating `NUL`.
+                                  hexadecimal string or
+                                  `"C,M,Y,K"` decimal
+                                  percentages string, with a
+                                  terminating `NUL`.
 
 `fgcolor`             pointer     Points to fgcolour allowing
                                   alternate spelling.
@@ -1780,7 +1821,8 @@
 
 `option_3`            integer     Symbol specific options.      0
 
-`show_hrt`            integer     Set to 0 to hide text.        1
+`show_hrt`            integer     Set to 0 to hide Human        1
+                                  Readable Text (HRT).
 
 `input_mode`          integer     Set encoding of input         `DATA_MODE`
                                   data (see [5.10 Setting the
@@ -1794,10 +1836,15 @@
                                   only).
 
 `dot_size`            float       Diameter of dots used in      0.8
-                                  dotty mode.
+                                  dotty mode (in
+                                  X-dimensions).
+
+`text_gap`            float       Gap between barcode and       0 (font-specific
+                                  text (HRT) in X-dimensions.   default)
 
 `guard_descent`       float       Height of guard bar           5.0
-                                  descent (EAN/UPC only).
+                                  descent (EAN/UPC only) in
+                                  X-dimensions.
 
 `structapp`           Structured  Mark a symbol as part of a    count 0
                       Append      sequence of symbols.          (disabled)
@@ -1826,7 +1873,7 @@
                       arrays
 
 `row_height`          array of    Representation of the         (output only)
-                      floats      height of a row.
+                      floats      height of rows.
 
 `errtxt`              character   Error message in the event    (output only)
                       string      that an error occurred,
@@ -1857,7 +1904,7 @@
 
 Table: API Structure `zint_symbol` {#tbl:api_structure_zint_symbol tag="$ $"}
 
-[^6]: The `height` value is ignored for Aztec (including HIBC and Aztec Rune),
+[^7]: The `height` value is ignored for Aztec (including HIBC and Aztec Rune),
 Code One, Data Matrix (including HIBC), DotCode, Grid Matrix, Han Xin, MaxiCode,
 QR Code (including HIBC, Micro QR, rMQR and UPNQR), and Ultracode - all of which
 have a fixed width-to-height ratio (or, in the case of Code One, a fixed
@@ -1882,12 +1929,11 @@
 }
 ```
 
-Background removal for EMF, EPS, GIF, PNG, SVG and TIF files can be achieved by
-setting the background alpha to `"00"` where the values for R, G and B will be
-ignored:
+Background removal for all outputs except BMP can be achieved by setting the
+background alpha to `"00"` where the values for R, G and B will be ignored:
 
 ```c
-strcpy(my_symbol->bgcolour, "55555500");
+    strcpy(my_symbol->bgcolour, "55555500");
 ```
 
 ## 5.7 Handling Errors
@@ -1986,7 +2032,7 @@
 This code will exit with the appropriate message:
 
 ```
-Error 653: Malformed foreground colour 'NONSENSE' (hexadecimal only)
+Error 691: Malformed foreground RGB colour 'nonsense' (hexadecimal only)
 ```
 
 To treat all warnings as errors, set `symbol->warn_level` to `WARN_FAIL_ALL`.
@@ -2006,7 +2052,7 @@
 symbol->symbology = 50;
 ```
 
-## 5.9 Adjusting Other Output Options
+## 5.9 Adjusting Output Options
 
 The `output_options` variable can be used to adjust various aspects of the
 output file. To select more than one option from the table below simply `OR`
@@ -2021,10 +2067,10 @@
 -------------------------  -----------------------------------------------------
  0                         No options selected.
 
-`BARCODE_BIND_TOP`         Boundary bar above the symbol only.[^7]
+`BARCODE_BIND_TOP`         Boundary bar above the symbol only.[^8]
 
 `BARCODE_BIND`             Boundary bars above and below the symbol and between
-                           rows if stacking multiple symbols.[^8]
+                           rows if stacking multiple symbols.[^9]
 
 `BARCODE_BOX`              Add a box surrounding the symbol and whitespace.
 
@@ -2049,7 +2095,7 @@
                            separate colour channels (`OUT_BUFFER` only).
 
 `BARCODE_QUIET_ZONES`      Add compliant quiet zones (additional to any
-                           specified whitespace).[^9]
+                           specified whitespace).[^10]
 
 `BARCODE_NO_QUIET_ZONES`   Disable quiet zones, notably those with defaults.
 
@@ -2059,13 +2105,13 @@
 
 Table: API `output_options` Values {#tbl:api_output_options tag="$ $"}
 
-[^7]: The `BARCODE_BIND_TOP` flag is set by default for DPD - see [6.1.10.7 DPD
+[^8]: The `BARCODE_BIND_TOP` flag is set by default for DPD - see [6.1.10.7 DPD
 Code].
 
-[^8]: The `BARCODE_BIND` flag is always set for Codablock-F, Code 16K and Code
+[^9]: The `BARCODE_BIND` flag is always set for Codablock-F, Code 16K and Code
 49. Special considerations apply to ITF-14 - see [6.1.2.6 ITF-14].
 
-[^9]: Codablock-F, Code 16K, Code 49, EAN-2 to EAN-13, ISBN, ITF-14, UPC-A and
+[^10]: Codablock-F, Code 16K, Code 49, EAN-2 to EAN-13, ISBN, ITF-14, UPC-A and
 UPC-E have compliant quiet zones added by default.
 
 \clearpage
@@ -2103,6 +2149,10 @@
 `FAST_MODE`         Use faster if less optimal encodation or other shortcuts if
                     available (affects `DATAMATRIX`, `MICROPDF417`, `PDF417`,
                     `QRCODE` and `UPNQR` only).
+
+`EXTRA_ESCAPE_MODE` Process special symbology-specific escape sequences
+                    (`CODE128` only).
+
 --------------------------------------------------------------------------------
 
 Table: API `input_mode` Values {#tbl:api_input_mode tag="$ $"}
@@ -2111,8 +2161,8 @@
 the CLI and GUI, which is `UNICODE_MODE`.)
 
 `DATA_MODE`, `UNICODE_MODE` and `GS1_MODE` are mutually exclusive, whereas
-`ESCAPE_MODE`, `GS1PARENS_MODE`, `GS1NOCHECK_MODE`, `HEIGHTPERROW_MODE` and
-`FAST_MODE` are optional. So, for example, you can set
+`ESCAPE_MODE`, `GS1PARENS_MODE`, `GS1NOCHECK_MODE`, `HEIGHTPERROW_MODE`,
+`FAST_MODE` and `EXTRA_ESCAPE_MODE` are optional. So, for example, you can set
 
 ```c
 my_symbol->input_mode = UNICODE_MODE | ESCAPE_MODE;
@@ -2132,8 +2182,10 @@
 
 is not valid.
 
-Permissible escape sequences are listed in Table {@tbl:escape_sequences}. An
-example of `GS1PARENS_MODE` usage is given in section [6.1.10.3 GS1-128].
+Permissible escape sequences (`ESCAPE_MODE`) are listed in Table
+{@tbl:escape_sequences}, and the special Code 128-only `EXTRA_ESCAPE_MODE`
+escape sequences are given in [6.1.10.1 Standard Code 128 (ISO 15417)].
+An example of `GS1PARENS_MODE` usage is given in section [6.1.10.3 GS1-128].
 
 `GS1NOCHECK_MODE` is for use with legacy systems that have data that does not
 conform to the current GS1 standard. Printable ASCII input is still checked for,
@@ -2144,6 +2196,10 @@
 The `height` variable should be set to the desired per-row value on input (it
 will be set to the overall height on output).
 
+`FAST_MODE` causes a less optimal encodation scheme to be used for Data Matrix,
+MicroPDF417 and PDF417. For QR Code and UPNQR, it affects Zint's automatic mask
+selection - see [6.6.3 QR Code (ISO 18004)] for details.
+
 ## 5.11 Multiple Segments
 
 For input data requiring multiple ECIs, the following functions may be used:
@@ -2236,7 +2292,7 @@
 my_symbol->scale = ZBarcode_Scale_From_XdimDp(
                         my_symbol->symbology,
                         ZBarcode_Default_Xdim(my_symbol->symbology),
-                        my_symbol->dpmm, "PNG"); /* 7.5 */
+                        my_symbol->dpmm, "PNG"); /* Returns 7.5 */
 ```
 
 The third function `ZBarcode_XdimDP_From_Scale()` is the "reverse" of
@@ -2481,7 +2537,6 @@
 identification purposes. Identcode requires an 11-digit numerical input to which
 Zint adds a check digit.
 
-
 \clearpage
 
 ### 6.1.3 UPC (Universal Product Code) (ISO 15420)
@@ -2776,22 +2831,47 @@
 
 One of the most ubiquitous one-dimensional barcode symbologies, Code 128 was
 developed in 1981 by Computer Identics. This symbology supports full ASCII text
-and uses a three-mode system to compress the data into a smaller symbol. Zint
-automatically switches between modes and adds a modulo-103 check digit. Code
-128 is the default barcode symbology used by Zint. In addition Zint supports
-the encoding of ISO/IEC 8859-1 (non-English) characters in Code 128 symbols. The
-ISO/IEC 8859-1 character set is shown in Appendix [A.2 Latin Alphabet No. 1
-(ISO/IEC 8859-1)].
+and uses a three-Code Set system to compress the data into a smaller symbol.
+Zint automatically switches between Code Sets A, B and C (but see the special
+escapes below) and adds a modulo-103 check digit.
+
+Manual switching of Code Sets is possible using the `--extraesc` option (API
+`input_mode |= EXTRA_ESCAPE_MODE`) and the Code 128-specific escapes `\^A`,
+`\^B`, `\^C`. For instance the following will force switching to Code Set B for
+the data `"5678"` (normally Code Set C would be used throughout):
+
+```bash
+zint -b CODE128 -d "1234\^B5678" --extraesc
+```
+
+The manually selected Code Set will apply until the next Code Set escape
+sequence, with the exception that data that cannot be represented in that Code
+Set will be switched as appropriate. If the data contains a special code
+sequence, it can be escaped by doubling the caret (`^`). For instance
+
+```bash
+zint -b CODE128 -d "\^AABC\^^BDEF" --extraesc
+```
+
+will encode the data `"ABC\^BDEF"` in Code Set A.
 
-#### 6.1.10.2 Code 128 Suppress Subset C (Subsets A and B only)
+Code 128 is the default barcode symbology used by Zint. In addition Zint
+supports the encoding of ISO/IEC 8859-1 (non-English) characters in Code 128
+symbols. The ISO/IEC 8859-1 character set is shown in Appendix [A.2 Latin
+Alphabet No. 1 (ISO/IEC 8859-1)].
+
+#### 6.1.10.2 Code 128 Suppress Code Set C (Code Sets A and B only)
 
 ![`zint -b CODE128AB -d "130170X178"`](images/code128ab.svg)
 
-It is sometimes advantageous to stop Code 128 from using subset mode C which
-compresses numerical data. The `BARCODE_CODE128AB`[^10] variant (symbology 60)
-suppresses mode C in favour of modes A and B.
+It is sometimes advantageous to stop Code 128 from using Code Set C which
+compresses numerical data. The `BARCODE_CODE128AB`[^11] variant (symbology 60)
+suppresses Code Set C in favour of Code Sets A and B.
+
+Note that the special escapes to manually switch Code Sets mentioned above are
+not available for this variant (nor for any other).
 
-[^10]: `BARCODE_CODE128AB` previously used the name `BARCODE_CODE128B`, which is
+[^11]: `BARCODE_CODE128AB` previously used the name `BARCODE_CODE128B`, which is
 still recognised.
 
 #### 6.1.10.3 GS1-128
@@ -2886,6 +2966,8 @@
 `option_2 = 1`), which omits the identification tag and prints the barcode at
 half height. In this case, an input of 27 alphanumeric characters is required.
 
+\clearpage
+
 #### 6.1.10.8 UPU S10
 
 ![`zint -b UPU_S10 --compliantheight -d "EE876543216CA"`](images/upu_s10.svg)
@@ -2997,7 +3079,6 @@
 characters in length. A single check character is added by Zint, appearing in
 the 2nd character position. Lowercase input is automatically made uppercase.
 
-
 \clearpage
 
 ## 6.2 Stacked Symbologies
@@ -4258,7 +4339,7 @@
 
 ## 7.1 License
 
-Zint, libzint and Zint Barcode Studio are Copyright Â© 2022 Robin Stuart. All
+Zint, libzint and Zint Barcode Studio are Copyright Â© 2023 Robin Stuart. All
 historical versions are distributed under the GNU General Public License
 version 3 or later. Versions 2.5 and later are released under a dual license:
 the encoding library is released under the BSD (3 clause) license whereas the
diff -urN zint-2.12.0/docs/manual.txt zint/docs/manual.txt
--- zint-2.12.0/docs/manual.txt	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/manual.txt	2023-05-08 14:39:44.994320130 +0200
@@ -1,6 +1,6 @@
 Zint Barcode Generator and Zint Barcode Studio User Manual
-Version 2.12.0
-December 2022
+Version 2.12.0.9
+February 2023
 
 *******************************************************************************
 * For reference the following is a text-only version of the Zint manual,      *
@@ -51,8 +51,9 @@
     -   4.14 Working with Dots
     -   4.15 Multiple Segments
     -   4.16 Structured Append
-    -   4.17 Help Options
-    -   4.18 Other Output Options
+    -   4.17 Human Readable Text (HRT) Options
+    -   4.18 Help Options
+    -   4.19 Other Options
 -   5. Using the API
     -   5.1 Creating and Deleting Symbols
     -   5.2 Encoding and Saving to File
@@ -62,7 +63,7 @@
     -   5.6 Setting Options
     -   5.7 Handling Errors
     -   5.8 Specifying a Symbology
-    -   5.9 Adjusting Other Output Options
+    -   5.9 Adjusting Output Options
     -   5.10 Setting the Input Mode
     -   5.11 Multiple Segments
     -   5.12 Scaling Helpers
@@ -106,7 +107,7 @@
         -   6.1.9 Pharmacode
         -   6.1.10 Code 128
             -   6.1.10.1 Standard Code 128 (ISO 15417)
-            -   6.1.10.2 Code 128 Suppress Subset C (Subsets A and B only)
+            -   6.1.10.2 Code 128 Suppress Code Set C (Code Sets A and B only)
             -   6.1.10.3 GS1-128
             -   6.1.10.4 EAN-14
             -   6.1.10.5 NVE-18 (SSCC-18)
@@ -372,11 +373,13 @@
     /bin/bash -c "$(curl -fsSL \
         https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
 
-Once Homebrew is installed use the following command to install the Zint.
+Once Homebrew is installed use the following command to install the CLI and
+library
 
     brew install zint
 
-To build from source see "README.macos" in the project root directory.
+To build from source (and install the GUI) see "README.macos" in the project
+root directory.
 
 2.4 Zint Tcl Backend
 
@@ -491,13 +494,15 @@
 [Adjusting the Print Size]
 
 The foreground and background colours can be set either using the text boxes
-which accept RRGGBBAA hexadecimal values or by clicking the foreground eye [eye]
-and background eye [eye] buttons which invoke a colour picker.
+which accept "RRGGBBAA" hexadecimal values and "C,M,Y,K" decimal percentage
+values, or by clicking the foreground eye [eye] and background eye [eye] buttons
+which invoke a colour picker.
 
 [The colour picker tool]
 
 (Note that to change the colours visually, the luminence slider, the long narrow
-column on the right, must be adjusted.)
+column on the right, must be adjusted.) The color picker only deals in RGB(A),
+and will overwrite any CMYK values with RGB(A) values once "OK" is selected.
 
 Back in the Appearance tab, the colours can be reset to black-on-white using the
 "Reset" button, and exchanged one for the other using the swap [swap] button
@@ -646,28 +651,37 @@
   \\          0x5C         \       Backslash
 
   \dNNN       NNN                  Any 8-bit character where NNN is decimal
-                                   (0-255)
+                                   (000-255)
+
+  \oNNN       0oNNN                Any 8-bit character where NNN is octal
+                                   (000-377)
 
   \xNN        0xNN                 Any 8-bit character where NN is hexadecimal
+                                   (00-FF)
 
   \uNNNN                           Any 16-bit Unicode BMP[2] character where
-                                   NNNN is hexadecimal
+                                   NNNN is hexadecimal (0000-FFFF)
 
   \UNNNNNN                         Any 21-bit Unicode character where NNNNNN
-                                   is hexadecimal (maximum 0x10FFFF)
+                                   is hexadecimal (000000-10FFFF)
   ----------------------------------------------------------------------------
 
   : TableÂ : Escape Sequences:
 
+(Special escape sequences are available for Code 128 only to manually switch
+Code Sets - see 6.1.10.1 Standard Code 128 (ISO 15417) for details.)
+
 Input data can be read directly from file using the -i or --input switch as
 shown below. The input file is assumed to be UTF-8 formatted unless an
 alternative mode is selected. This command replaces the use of the -d switch.
 
     zint -i somefile.txt
 
+To read from stdin specify a single hyphen "-" as the input file.
+
 Note that except when batch processing (see 4.11 Batch Processing below), the
-file should not end with a newline (LF on Unix, CR+LF on Windows) unless you
-want the newline to be encoded in the symbol.
+file (or stdin) should not end with a newline (LF on Unix, CR+LF on Windows)
+unless you want the newline to be encoded in the symbol.
 
 4.2 Directing Output
 
@@ -731,7 +745,7 @@
 
   18        BARCODE_CODABAR           Codabar
 
-  20        BARCODE_CODE128           Code 128 (automatic subset switching)
+  20        BARCODE_CODE128           Code 128 (automatic Code Set switching)
 
   21        BARCODE_DPLEIT            Deutsche Post Leitcode
 
@@ -786,7 +800,7 @@
 
   58        BARCODE_QRCODE            QR Code
 
-  60        BARCODE_CODE128AB         Code 128 (Suppress subset C)
+  60        BARCODE_CODE128AB         Code 128 (Suppress Code Set C)
 
   63        BARCODE_AUSPOST           Australia Post Standard Customer
 
@@ -1023,8 +1037,10 @@
 Code, Grid Matrix and QR Code symbology specifications.
 
 For more specific needs the foreground (ink) and background (paper) colours can
-be specified using the --fg and --bg options followed by a number in RRGGBB
-hexadecimal notation (the same system used in HTML). For example the command
+be specified using the --fg and --bg options followed by a number in "RRGGBB"
+hexadecimal notation (the same system used in HTML) or in "C,M,Y,K" decimal
+percentages format (the latter normally used with the --cmyk option - see
+below). For example the command
 
     zint --fg=00FF00 -d "This Text"
 
@@ -1032,24 +1048,32 @@
 
 [zint -d "This Text" --fg=00FF00]
 
-Zint also supports RGBA colour information for some output file formats which
-support alpha channels (currently only PNG, SVG and TIF) in a RRGGBBAA format.
-For example:
+Zint also supports RGBA colour information for those output file formats which
+support alpha channels (currently only GIF, PCX, PNG, SVG and TIF, with GIF
+supporting either a background or foreground alpha but not both) in a "RRGGBBAA"
+format. For example:
 
     zint --fg=00ff0055 -d "This Text"
 
 [zint -d "This Text" --fg=00FF0055]
 
 will produce a semi-transparent green foreground with standard (white)
-background. Note that transparency is handled differently for raster and vector
-files so thatâ¦
+background. Note that transparency is treated differently by raster and vector
+(SVG) output formats, as for vector output the background will âshine throughâ a
+transparent foreground. For instance
 
     zint --bg=ff0000 --fg=ffffff00 ...
 
 will give different results for PNG and SVG. Experimentation is advised!
 
-In addition the --nobackground option will simply remove the background from
-EMF, EPS, GIF, PNG, SVG and TIF files.
+In addition the --nobackground option will remove the background from all output
+formats except BMP.[4]
+
+The --cmyk option is specific to output in Encapsulated PostScript (EPS) and
+TIF, and selects the CMYK colour space. Custom colours should then usually be
+given in the comma-separated "C,M,Y,K" format, where C, M, Y and K are expressed
+as decimal percentage values from 0 to 100. RGB values may still be used, in
+which case they will be converted formulaically to CMYK approximations.
 
 4.8 Rotating the Symbol
 
@@ -1169,7 +1193,7 @@
   Han Xin         Latin-1                    GB 18030 (includes ASCII)
   MaxiCode        Latin-1                    None
   MicroPDF417     Latin-1                    None
-  Micro QR Code   Latin-1                    Shift JIS (includes ASCII[4])
+  Micro QR Code   Latin-1                    Shift JIS (includes ASCII[5])
   PDF417          Latin-1                    None
   QR Code         Latin-1                    Shift JIS (see above)
   rMQR            Latin-1                    Shift JIS (see above)
@@ -1271,7 +1295,7 @@
   33         UTF-16LE (Low order byte first)
   34         UTF-32BE (High order bytes first)
   35         UTF-32LE (Low order bytes first)
-  170        ISO/IEC 646 Invariant[5]
+  170        ISO/IEC 646 Invariant[6]
   899        8-bit binary data
 
   : TableÂ : ECI Codes:
@@ -1409,7 +1433,7 @@
 supported output file formats are shown in the following table.
 
   Abbreviation   File format
-  -------------- -------------------------------------------
+  -------------- ------------------------------------
   BMP            Windows Bitmap
   EMF            Enhanced Metafile Format
   EPS            Encapsulated PostScript
@@ -1418,7 +1442,7 @@
   PNG            Portable Network Graphic
   SVG            Scalable Vector Graphic
   TIF            Tagged Image File Format
-  TXT            Text file (see 4.18 Other Output Options)
+  TXT            Text file (see 4.19 Other Options)
 
   : TableÂ : Output File Formats:
 
@@ -1501,7 +1525,24 @@
 from 1 to count. Count must be 2 or more. See the individual symbologies for
 further details.
 
-4.17 Help Options
+4.17 Human Readable Text (HRT) Options
+
+For linear barcodes the text present in the output image can be removed by using
+the --notext option.
+
+Text can be set to bold using the --bold option, or a smaller font can be
+substituted using the --small option. The --bold and --small options can be used
+together if required, but only for vector output.
+
+[zint --bold -d "This Text" --small]
+
+The gap between the barcode and the text can be adjusted using the --textgap
+option, where the gap is given as a multiple of the X-dimension (maximum 5X). A
+zero value uses the default gap.
+
+[zint -d "Ãccent" --textgap=0.1]
+
+4.18 Help Options
 
 There are three help options which give information about how to use the command
 line. The -h or --help option will display a list of all of the valid options
@@ -1513,25 +1554,12 @@
 
 The -e or --ecinos option gives a list of the ECI codes.
 
-4.18 Other Output Options
-
-For linear barcodes the text present in the output image can be removed by using
-the --notext option.
-
-The text can be set to bold using the --bold option, or a smaller font can be
-substituted using the --small option. The --bold and --small options can be used
-together if required, but only for vector output.
-
-[zint --bold -d "This Text" --small]
+4.19 Other Options
 
 Zint can output a representation of the symbol data as a set of hexadecimal
 values if asked to output to a text file ("*.txt") or if given the option
 --filetype=txt. This can be used for test and diagnostic purposes.
 
-The --cmyk option is specific to output in Encapsulated PostScript and TIF, and
-converts the RGB colours used to the CMYK colour space. Setting custom colours
-at the command line will still need to be done in RRGGBB format.
-
 Additional options are available which are specific to certain symbologies.
 These may, for example, control the amount of error correction data or the size
 of the symbol. These options are discussed in section 6. Types of Symbology of
@@ -1553,9 +1581,9 @@
 5.1 Creating and Deleting Symbols
 
 The symbols manipulated by Zint are held in a zint_symbol structure defined in
-"zint.h". These symbols are created with the ZBarcode_Create() function and
-deleted using the ZBarcode_Delete() function. For example the following code
-creates and then deletes a symbol:
+"zint.h". These symbol structures are created with the ZBarcode_Create()
+function and deleted using the ZBarcode_Delete() function. For example the
+following code creates and then deletes a symbol:
 
     #include <zint.h>
     #include <stdio.h>
@@ -1639,7 +1667,8 @@
 
 The ZBarcode_Encode_File() and ZBarcode_Encode_File_and_Print() functions can be
 used to encode data read directly from a text file where the filename is given
-in the NUL-terminated filename string.
+in the NUL-terminated filename string. The special filename "-" (single hyphen)
+can be used to read from stdin.
 
 If printing more than one barcode, the zint_symbol structure may be re-used by
 calling the ZBarcode_Clear() function after each barcode to free any output
@@ -1726,7 +1755,7 @@
     struct zint_vector_circle *circle;
 
     prepare_canvas(my_symbol->vector->width, my_symbol->vector->height,
-                   my_symbol->scale, my_symbol->fgcolour, my_symbol->bgcolor,
+                   my_symbol->scale, my_symbol->fgcolour, my_symbol->bgcolour,
                    rotate_angle);
 
     for (rect = my_symbol->vector->rectangles; rect; rect = rect->next) {
@@ -1761,35 +1790,39 @@
   symbology             integer      Symbol to use (see 5.8       BARCODE_CODE128
                                      Specifying a Symbology).
 
-  height                float        Symbol height, excluding     Symbol dependent
+  height                float        Symbol height in             Symbol dependent
+                                     X-dimensions, excluding
                                      fixed width-to-height
-                                     symbols.[6]
+                                     symbols.[7]
 
   scale                 float        Scale factor for adjusting   1.0
-                                     size of image.
+                                     size of image (sets
+                                     X-dimension).
 
-  whitespace_width      integer      Horizontal whitespace width. 0
+  whitespace_width      integer      Horizontal whitespace width  0
+                                     in X-dimensions.
 
-  whitespace_height     integer      Vertical whitespace height.  0
+  whitespace_height     integer      Vertical whitespace height   0
+                                     in X-dimensions.
 
-  border_width          integer      Border width.                0
+  border_width          integer      Border width in              0
+                                     X-dimensions.
 
-  output_options        integer      Set various output file      0 (none)
+  output_options        integer      Set various output           0 (none)
                                      parameters (see 5.9
-                                     Adjusting Other Output
-                                     Options).
+                                     Adjusting Output Options).
 
   fgcolour              character    Foreground (ink) colour as   "000000"
-                        string       RGB/RGBA hexadecimal string.
-                                     Must be 6 or 8 characters
-                                     followed by a terminating
-                                     NUL.
+                        string       RGB/RGBA hexadecimal string
+                                     or "C,M,Y,K" decimal
+                                     percentages string, with a
+                                     terminating NUL.
 
   bgcolour              character    Background (paper) colour as "ffffff"
-                        string       RGB/RGBA hexadecimal string.
-                                     Must be 6 or 8 characters
-                                     followed by a terminating
-                                     NUL.
+                        string       RGB/RGBA hexadecimal string
+                                     or "C,M,Y,K" decimal
+                                     percentages string, with a
+                                     terminating NUL.
 
   fgcolor               pointer      Points to fgcolour allowing
                                      alternate spelling.
@@ -1815,7 +1848,8 @@
 
   option_3              integer      Symbol specific options.     0
 
-  show_hrt              integer      Set to 0 to hide text.       1
+  show_hrt              integer      Set to 0 to hide Human       1
+                                     Readable Text (HRT).
 
   input_mode            integer      Set encoding of input data   DATA_MODE
                                      (see 5.10 Setting the Input
@@ -1829,10 +1863,15 @@
                                      only).
 
   dot_size              float        Diameter of dots used in     0.8
-                                     dotty mode.
+                                     dotty mode (in
+                                     X-dimensions).
+
+  text_gap              float        Gap between barcode and text 0 (font-specific
+                                     (HRT) in X-dimensions.       default)
 
   guard_descent         float        Height of guard bar descent  5.0
-                                     (EAN/UPC only).
+                                     (EAN/UPC only) in
+                                     X-dimensions.
 
   structapp             Structured   Mark a symbol as part of a   count 0
                         Append       sequence of symbols.         (disabled)
@@ -1861,7 +1900,7 @@
                         arrays
 
   row_height            array of     Representation of the height (output only)
-                        floats       of a row.
+                        floats       of rows.
 
   errtxt                character    Error message in the event   (output only)
                         string       that an error occurred, with
@@ -1909,11 +1948,10 @@
         return 0;
     }
 
-Background removal for EMF, EPS, GIF, PNG, SVG and TIF files can be achieved by
-setting the background alpha to "00" where the values for R, G and B will be
-ignored:
+Background removal for all outputs except BMP can be achieved by setting the
+background alpha to "00" where the values for R, G and B will be ignored:
 
-    strcpy(my_symbol->bgcolour, "55555500");
+        strcpy(my_symbol->bgcolour, "55555500");
 
 5.7 Handling Errors
 
@@ -2011,7 +2049,7 @@
 
 This code will exit with the appropriate message:
 
-    Error 653: Malformed foreground colour 'NONSENSE' (hexadecimal only)
+    Error 691: Malformed foreground RGB colour 'nonsense' (hexadecimal only)
 
 To treat all warnings as errors, set symbol->warn_level to WARN_FAIL_ALL.
 
@@ -2026,7 +2064,7 @@
 
     symbol->symbology = 50;
 
-5.9 Adjusting Other Output Options
+5.9 Adjusting Output Options
 
 The output_options variable can be used to adjust various aspects of the output
 file. To select more than one option from the table below simply OR them
@@ -2039,10 +2077,10 @@
   -------------------------- ----------------------------------------------------
   0                          No options selected.
 
-  BARCODE_BIND_TOP           Boundary bar above the symbol only.[7]
+  BARCODE_BIND_TOP           Boundary bar above the symbol only.[8]
 
   BARCODE_BIND               Boundary bars above and below the symbol and between
-                             rows if stacking multiple symbols.[8]
+                             rows if stacking multiple symbols.[9]
 
   BARCODE_BOX                Add a box surrounding the symbol and whitespace.
 
@@ -2067,7 +2105,7 @@
                              separate colour channels (OUT_BUFFER only).
 
   BARCODE_QUIET_ZONES        Add compliant quiet zones (additional to any
-                             specified whitespace).[9]
+                             specified whitespace).[10]
 
   BARCODE_NO_QUIET_ZONES     Disable quiet zones, notably those with defaults.
 
@@ -2110,6 +2148,9 @@
   FAST_MODE           Use faster if less optimal encodation or other shortcuts if
                       available (affects DATAMATRIX, MICROPDF417, PDF417, QRCODE
                       and UPNQR only).
+
+  EXTRA_ESCAPE_MODE   Process special symbology-specific escape sequences
+                      (CODE128 only).
   -------------------------------------------------------------------------------
 
   : TableÂ Â : API input_mode Values
@@ -2118,8 +2159,8 @@
 CLI and GUI, which is UNICODE_MODE.)
 
 DATA_MODE, UNICODE_MODE and GS1_MODE are mutually exclusive, whereas
-ESCAPE_MODE, GS1PARENS_MODE, GS1NOCHECK_MODE, HEIGHTPERROW_MODE and FAST_MODE
-are optional. So, for example, you can set
+ESCAPE_MODE, GS1PARENS_MODE, GS1NOCHECK_MODE, HEIGHTPERROW_MODE, FAST_MODE and
+EXTRA_ESCAPE_MODE are optional. So, for example, you can set
 
     my_symbol->input_mode = UNICODE_MODE | ESCAPE_MODE;
 
@@ -2133,8 +2174,10 @@
 
 is not valid.
 
-Permissible escape sequences are listed in Table : Escape Sequences. An example
-of GS1PARENS_MODE usage is given in section 6.1.10.3 GS1-128.
+Permissible escape sequences (ESCAPE_MODE) are listed in Table
+: Escape Sequences, and the special Code 128-only EXTRA_ESCAPE_MODE escape
+sequences are given in 6.1.10.1 Standard Code 128 (ISO 15417). An example of
+GS1PARENS_MODE usage is given in section 6.1.10.3 GS1-128.
 
 GS1NOCHECK_MODE is for use with legacy systems that have data that does not
 conform to the current GS1 standard. Printable ASCII input is still checked for,
@@ -2145,6 +2188,10 @@
 height variable should be set to the desired per-row value on input (it will be
 set to the overall height on output).
 
+FAST_MODE causes a less optimal encodation scheme to be used for Data Matrix,
+MicroPDF417 and PDF417. For QR Code and UPNQR, it affects Zintâs automatic mask
+selection - see 6.6.3 QR Code (ISO 18004) for details.
+
 5.11 Multiple Segments
 
 For input data requiring multiple ECIs, the following functions may be used:
@@ -2228,7 +2275,7 @@
     my_symbol->scale = ZBarcode_Scale_From_XdimDp(
                             my_symbol->symbology,
                             ZBarcode_Default_Xdim(my_symbol->symbology),
-                            my_symbol->dpmm, "PNG"); /* 7.5 */
+                            my_symbol->dpmm, "PNG"); /* Returns 7.5 */
 
 The third function ZBarcode_XdimDP_From_Scale() is the âreverseâ of
 ZBarcode_Scale_From_XdimDp(), returning the X-dimension (in mm) or the dot
@@ -2729,20 +2776,41 @@
 
 One of the most ubiquitous one-dimensional barcode symbologies, Code 128 was
 developed in 1981 by Computer Identics. This symbology supports full ASCII text
-and uses a three-mode system to compress the data into a smaller symbol. Zint
-automatically switches between modes and adds a modulo-103 check digit. Code 128
-is the default barcode symbology used by Zint. In addition Zint supports the
-encoding of ISO/IEC 8859-1 (non-English) characters in Code 128 symbols. The
-ISO/IEC 8859-1 character set is shown in Appendix A.2 Latin Alphabet No.Â 1
-(ISO/IEC 8859-1).
+and uses a three-Code Set system to compress the data into a smaller symbol.
+Zint automatically switches between Code Sets A, B and C (but see the special
+escapes below) and adds a modulo-103 check digit.
+
+Manual switching of Code Sets is possible using the --extraesc option (API
+input_mode |= EXTRA_ESCAPE_MODE) and the Code 128-specific escapes \^A, \^B,
+\^C. For instance the following will force switching to Code Set B for the data
+"5678" (normally Code Set C would be used throughout):
+
+    zint -b CODE128 -d "1234\^B5678" --extraesc
+
+The manually selected Code Set will apply until the next Code Set escape
+sequence, with the exception that data that cannot be represented in that Code
+Set will be switched as appropriate. If the data contains a special code
+sequence, it can be escaped by doubling the caret (^). For instance
 
-6.1.10.2 Code 128 Suppress Subset C (Subsets A and B only)
+    zint -b CODE128 -d "\^AABC\^^BDEF" --extraesc
+
+will encode the data "ABC\^BDEF" in Code Set A.
+
+Code 128 is the default barcode symbology used by Zint. In addition Zint
+supports the encoding of ISO/IEC 8859-1 (non-English) characters in Code 128
+symbols. The ISO/IEC 8859-1 character set is shown in Appendix A.2 Latin
+Alphabet No.Â 1 (ISO/IEC 8859-1).
+
+6.1.10.2 Code 128 Suppress Code Set C (Code Sets A and B only)
 
 [zint -b CODE128AB -d "130170X178"]
 
-It is sometimes advantageous to stop Code 128 from using subset mode C which
-compresses numerical data. The BARCODE_CODE128AB[10] variant (symbology 60)
-suppresses mode C in favour of modes A and B.
+It is sometimes advantageous to stop Code 128 from using Code Set C which
+compresses numerical data. The BARCODE_CODE128AB[11] variant (symbology 60)
+suppresses Code Set C in favour of Code Sets A and B.
+
+Note that the special escapes to manually switch Code Sets mentioned above are
+not available for this variant (nor for any other).
 
 6.1.10.3 GS1-128
 
@@ -4130,7 +4198,7 @@
 
 7.1 License
 
-Zint, libzint and Zint Barcode Studio are Copyright Â© 2022 Robin Stuart. All
+Zint, libzint and Zint Barcode Studio are Copyright Â© 2023 Robin Stuart. All
 historical versions are distributed under the GNU General Public License version
 3 or later. Versions 2.5 and later are released under a dual license: the
 encoding library is released under the BSD (3 clause) license whereas the GUI,
@@ -4338,7 +4406,7 @@
 
 Annex B. Man Page ZINT(1)
 
-% ZINT(1) Version 2.12.0 % % December 2022
+% ZINT(1) Version 2.12.0.9 % % February 2023
 
 NAME
 
@@ -4389,8 +4457,8 @@
     â00002.pngâ etc., which can be changed by using the -o | --output option.
 
 --bg=COLOUR
-    Specify a background (paper) colour where COLOUR is in hex RRGGBB or
-    RRGGBBAA format.
+    Specify a background (paper) colour where COLOUR is in hexadecimal RRGGBB or
+    RRGGBBAA format or in decimal C,M,Y,K percentages format.
 
 --binary
     Treat input data as raw 8-bit binary data instead of the default UTF-8.
@@ -4497,13 +4565,21 @@
         \\       (0x5C)    \    Backslash
         \dNNN    (NNN)          Any 8-bit character where NNN is
                                 decimal (000-255)
+        \oNNN    (0oNNN)        Any 8-bit character where NNN is
+                                octal (000-377)
         \xNN     (0xNN)         Any 8-bit character where NN is
-                                hexadecimal
+                                hexadecimal (00-FF)
         \uNNNN   (U+NNNN)       Any 16-bit Unicode BMP character
                                 where NNNN is hexadecimal
         \UNNNNNN (U+NNNNNN)     Any 21-bit Unicode character
                                 where NNNNNN is hexadecimal
 
+--extraesc
+
+    Process the special escape sequences \^A, \^B and \^C that allow manual
+    switching of Code Sets (Code 128 only). The sequence \^^ can be used to
+    encode data that contains special escape sequences.
+
 --fast
 
     Use faster if less optimal encodation or other shortcuts (affects Data
@@ -4511,8 +4587,8 @@
 
 --fg=COLOUR
 
-    Specify a foreground (ink) colour where COLOUR is in hex RRGGBB or RRGGBBAA
-    format.
+    Specify a foreground (ink) colour where COLOUR is in hexadecimal RRGGBB or
+    RRGGBBAA format or in decimal C,M,Y,K percentages format.
 
 --filetype=TYPE
 
@@ -4561,7 +4637,8 @@
 
 -i, --input=FILE
 
-    Read the input data from FILE.
+    Read the input data from FILE. Specify a single hyphen (-) for FILE to read
+    from stdin.
 
 --init
 
@@ -4724,6 +4801,12 @@
     Display the table of barcode types (symbologies). The numbers or names can
     be used with -b | --barcode.
 
+--textgap=NUMBER
+
+    Adjust the gap between the barcode and the Human Readable Text (HRT). NUMBER
+    is in multiples of the X-dimension, and may be floating-point. Maximum is 5;
+    zero results in the default being used.
+
 --vers=INTEGER
 
     Set the symbol version (size, check digits, other options) to INTEGER. The
@@ -4749,8 +4832,10 @@
         C25LOGIC        ditto
         C25STANDARD     ditto
         Codabar         1 or 2 (add hidden or visible check digit)
-        Code 11         0 or 1 (no or 1 visible check digit only)
-                               (default is 2 visible check digits)
+        Code 11         0 to 2 (2 visible check digits to none)
+                        0      (default 2 visible check digits)
+                        1      (1 visible check digit)
+                        2      (no check digits)
         Code 39         1      (add visible check digit)
         Code 93         1      (hide the default check characters)
         EXCODE39        1      (add visible check digit)
@@ -4880,7 +4965,7 @@
 
 COPYRIGHT
 
-Copyright Â© 2022 Robin Stuart. Released under GNU GPL 3.0 or later.
+Copyright Â© 2023 Robin Stuart. Released under GNU GPL 3.0 or later.
 
 AUTHOR
 
@@ -4898,25 +4983,29 @@
 now deprecated but are still recognised by Zint and will continue to be
 supported in future versions.
 
-[4] Shift JIS (JIS X 0201 Roman) re-maps two ASCII characters: backslash (\) to
+[4] The background is omitted for vector outputs EMF, EPS and SVG when
+--nobackground is given. For raster outputs GIF, PCX, PNG and TIF, the
+backgroundâs alpha channel is set to zero (fully transparent).
+
+[5] Shift JIS (JIS X 0201 Roman) re-maps two ASCII characters: backslash (\) to
 the yen sign (Â¥), and tilde (~) to overline (U+203E).
 
-[5] ISO/IEC 646 Invariant is a subset of ASCII with 12 characters undefined: #,
+[6] ISO/IEC 646 Invariant is a subset of ASCII with 12 characters undefined: #,
 $, @, [, \, ], ^, `, {, |, }, ~.
 
-[6] The height value is ignored for Aztec (including HIBC and Aztec Rune), Code
+[7] The height value is ignored for Aztec (including HIBC and Aztec Rune), Code
 One, Data Matrix (including HIBC), DotCode, Grid Matrix, Han Xin, MaxiCode, QR
 Code (including HIBC, Micro QR, rMQR and UPNQR), and Ultracode - all of which
 have a fixed width-to-height ratio (or, in the case of Code One, a fixed
 height).
 
-[7] The BARCODE_BIND_TOP flag is set by default for DPD - see 6.1.10.7 DPD Code.
+[8] The BARCODE_BIND_TOP flag is set by default for DPD - see 6.1.10.7 DPD Code.
 
-[8] The BARCODE_BIND flag is always set for Codablock-F, Code 16K and Code 49.
+[9] The BARCODE_BIND flag is always set for Codablock-F, Code 16K and Code 49.
 Special considerations apply to ITF-14 - see 6.1.2.6 ITF-14.
 
-[9] Codablock-F, Code 16K, Code 49, EAN-2 to EAN-13, ISBN, ITF-14, UPC-A and
+[10] Codablock-F, Code 16K, Code 49, EAN-2 to EAN-13, ISBN, ITF-14, UPC-A and
 UPC-E have compliant quiet zones added by default.
 
-[10] BARCODE_CODE128AB previously used the name BARCODE_CODE128B, which is still
+[11] BARCODE_CODE128AB previously used the name BARCODE_CODE128B, which is still
 recognised.
diff -urN zint-2.12.0/docs/zint.1 zint/docs/zint.1
--- zint-2.12.0/docs/zint.1	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/zint.1	2023-05-08 14:39:44.994320130 +0200
@@ -1,4 +1,4 @@
-.\" Automatically generated by Pandoc 2.19.2
+.\" Automatically generated by Pandoc 3.0.1
 .\"
 .\" Define V font for inline verbatim, using C font in formats
 .\" that render this, and otherwise B font.
@@ -14,7 +14,7 @@
 . ftr VB CB
 . ftr VBI CBI
 .\}
-.TH "ZINT" "1" "December 2022" "Version 2.12.0" ""
+.TH "ZINT" "1" "February 2023" "Version 2.12.0.9" ""
 .hy
 .SH NAME
 .PP
@@ -72,8 +72,9 @@
 be changed by using the \f[V]-o\f[R] | \f[V]--output\f[R] option.
 .TP
 \f[V]--bg=COLOUR\f[R]
-Specify a background (paper) colour where \f[I]COLOUR\f[R] is in hex
-\f[V]RRGGBB\f[R] or \f[V]RRGGBBAA\f[R] format.
+Specify a background (paper) colour where \f[I]COLOUR\f[R] is in
+hexadecimal \f[V]RRGGBB\f[R] or \f[V]RRGGBBAA\f[R] format or in decimal
+\f[V]C,M,Y,K\f[R] percentages format.
 .TP
 \f[V]--binary\f[R]
 Treat input data as raw 8-bit binary data instead of the default UTF-8.
@@ -187,8 +188,10 @@
 \[rs]\[rs]       (0x5C)    \[rs]    Backslash
 \[rs]dNNN    (NNN)          Any 8-bit character where NNN is
                         decimal (000-255)
+\[rs]oNNN    (0oNNN)        Any 8-bit character where NNN is
+                        octal (000-377)
 \[rs]xNN     (0xNN)         Any 8-bit character where NN is
-                        hexadecimal
+                        hexadecimal (00-FF)
 \[rs]uNNNN   (U+NNNN)       Any 16-bit Unicode BMP character
                         where NNNN is hexadecimal
 \[rs]UNNNNNN (U+NNNNNN)     Any 21-bit Unicode character
@@ -197,13 +200,21 @@
 .fi
 .RE
 .TP
+\f[V]--extraesc\f[R]
+Process the special escape sequences \f[V]\[rs]\[ha]A\f[R],
+\f[V]\[rs]\[ha]B\f[R] and \f[V]\[rs]\[ha]C\f[R] that allow manual
+switching of Code Sets (Code 128 only).
+The sequence \f[V]\[rs]\[ha]\[ha]\f[R] can be used to encode data that
+contains special escape sequences.
+.TP
 \f[V]--fast\f[R]
 Use faster if less optimal encodation or other shortcuts (affects Data
 Matrix, MicroPDF417, PDF417, QRCODE & UPNQR only).
 .TP
 \f[V]--fg=COLOUR\f[R]
-Specify a foreground (ink) colour where \f[I]COLOUR\f[R] is in hex
-\f[V]RRGGBB\f[R] or \f[V]RRGGBBAA\f[R] format.
+Specify a foreground (ink) colour where \f[I]COLOUR\f[R] is in
+hexadecimal \f[V]RRGGBB\f[R] or \f[V]RRGGBBAA\f[R] format or in decimal
+\f[V]C,M,Y,K\f[R] percentages format.
 .TP
 \f[V]--filetype=TYPE\f[R]
 Set the output file type to \f[I]TYPE\f[R], which is one of
@@ -248,6 +259,8 @@
 .TP
 \f[V]-i\f[R], \f[V]--input=FILE\f[R]
 Read the input data from \f[I]FILE\f[R].
+Specify a single hyphen (\f[V]-\f[R]) for \f[I]FILE\f[R] to read from
+stdin.
 .TP
 \f[V]--init\f[R]
 Create a Reader Initialisation (Programming) symbol.
@@ -433,6 +446,12 @@
 The numbers or names can be used with \f[V]-b\f[R] |
 \f[V]--barcode\f[R].
 .TP
+\f[V]--textgap=NUMBER\f[R]
+Adjust the gap between the barcode and the Human Readable Text (HRT).
+\f[I]NUMBER\f[R] is in multiples of the X-dimension, and may be
+floating-point.
+Maximum is 5; zero results in the default being used.
+.TP
 \f[V]--vers=INTEGER\f[R]
 Set the symbol version (size, check digits, other options) to
 \f[I]INTEGER\f[R].
@@ -466,8 +485,10 @@
 C25LOGIC        ditto
 C25STANDARD     ditto
 Codabar         1 or 2 (add hidden or visible check digit)
-Code 11         0 or 1 (no or 1 visible check digit only)
-                       (default is 2 visible check digits)
+Code 11         0 to 2 (2 visible check digits to none)
+                0      (default 2 visible check digits)
+                1      (1 visible check digit)
+                2      (no check digits)
 Code 39         1      (add visible check digit)
 Code 93         1      (hide the default check characters)
 EXCODE39        1      (add visible check digit)
@@ -623,7 +644,7 @@
 (2022)
 .SH COPYRIGHT
 .PP
-Copyright \[co] 2022 Robin Stuart.
+Copyright Â© 2023 Robin Stuart.
 Released under GNU GPL 3.0 or later.
 .SH AUTHOR
 .PP
diff -urN zint-2.12.0/docs/zint.1.pmd zint/docs/zint.1.pmd
--- zint-2.12.0/docs/zint.1.pmd	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/zint.1.pmd	2023-05-08 14:39:44.994320130 +0200
@@ -1,6 +1,6 @@
-% ZINT(1) Version 2.12.0
+% ZINT(1) Version 2.12.0.9
 %
-% December 2022
+% February 2023
 
 # NAME
 
@@ -44,7 +44,8 @@
     "00002.png" etc., which can be changed by using the `-o` | `--output` option.
 
 `--bg=COLOUR`
-:   Specify a background (paper) colour where *COLOUR* is in hex `RRGGBB` or `RRGGBBAA` format.
+:   Specify a background (paper) colour where *COLOUR* is in hexadecimal `RRGGBB` or `RRGGBBAA` format or in decimal
+    `C,M,Y,K` percentages format.
 
 `--binary`
 :   Treat input data as raw 8-bit binary data instead of the default UTF-8. Automatic code page translation to an ECI
@@ -139,13 +140,20 @@
         \\       (0x5C)    \    Backslash
         \dNNN    (NNN)          Any 8-bit character where NNN is
                                 decimal (000-255)
+        \oNNN    (0oNNN)        Any 8-bit character where NNN is
+                                octal (000-377)
         \xNN     (0xNN)         Any 8-bit character where NN is
-                                hexadecimal
+                                hexadecimal (00-FF)
         \uNNNN   (U+NNNN)       Any 16-bit Unicode BMP character
                                 where NNNN is hexadecimal
         \UNNNNNN (U+NNNNNN)     Any 21-bit Unicode character
                                 where NNNNNN is hexadecimal
 
+`--extraesc`
+
+:   Process the special escape sequences `\^A`, `\^B` and `\^C` that allow manual switching of Code Sets (Code 128
+    only). The sequence `\^^` can be used to encode data that contains special escape sequences.
+
 `--fast`
 
 :   Use faster if less optimal encodation or other shortcuts (affects Data Matrix, MicroPDF417, PDF417, QRCODE & UPNQR
@@ -153,7 +161,8 @@
 
 `--fg=COLOUR`
 
-:   Specify a foreground (ink) colour where *COLOUR* is in hex `RRGGBB` or `RRGGBBAA` format.
+:   Specify a foreground (ink) colour where *COLOUR* is in hexadecimal `RRGGBB` or `RRGGBBAA` format or in decimal
+    `C,M,Y,K` percentages format.
 
 `--filetype=TYPE`
 
@@ -197,7 +206,7 @@
 
 `-i`, `--input=FILE`
 
-:   Read the input data from *FILE*.
+:   Read the input data from *FILE*. Specify a single hyphen (`-`) for *FILE* to read from stdin.
 
 `--init`
 
@@ -344,6 +353,11 @@
 
 :   Display the table of barcode types (symbologies). The numbers or names can be used with `-b` | `--barcode`.
 
+`--textgap=NUMBER`
+
+:   Adjust the gap between the barcode and the Human Readable Text (HRT). *NUMBER* is in multiples of the X-dimension,
+    and may be floating-point. Maximum is 5; zero results in the default being used.
+
 `--vers=INTEGER`
 
 :   Set the symbol version (size, check digits, other options) to *INTEGER*. The meaning is symbol-specific.
@@ -368,8 +382,10 @@
         C25LOGIC        ditto
         C25STANDARD     ditto
         Codabar         1 or 2 (add hidden or visible check digit)
-        Code 11         0 or 1 (no or 1 visible check digit only)
-                               (default is 2 visible check digits)
+        Code 11         0 to 2 (2 visible check digits to none)
+                        0      (default 2 visible check digits)
+                        1      (1 visible check digit)
+                        2      (no check digits)
         Code 39         1      (add visible check digit)
         Code 93         1      (hide the default check characters)
         EXCODE39        1      (add visible check digit)
@@ -502,7 +518,7 @@
 
 # COPYRIGHT
 
-Copyright Â© 2022 Robin Stuart. Released under GNU GPL 3.0 or later.
+Copyright Â© 2023 Robin Stuart. Released under GNU GPL 3.0 or later.
 
 # AUTHOR
 
diff -urN zint-2.12.0/docs/zint_images.sh zint/docs/zint_images.sh
--- zint-2.12.0/docs/zint_images.sh	2022-12-12 22:06:08.000000000 +0100
+++ zint/docs/zint_images.sh	2023-05-08 14:39:44.994320130 +0200
@@ -34,6 +34,7 @@
 zint -b AZTEC --eci=9 -d "ÎÎµÎ¯Î¼ÎµÎ½Î¿" --seg1=7,"Ð¢ÐµÐºÑÑ" --seg2=20,"æç« " --scale=$SCALE_2D -o images/aztec_segs.svg
 zint -b DATAMATRIX -d "2nd of 3" --structapp="2,3,5006" --scale=$SCALE_2D -o images/datamatrix_structapp.svg
 zint --bold -d "This Text" --small --scale=$SCALE_LINEAR -o images/code128_small_bold.svg
+zint -d "Ãccent" --textgap=0.1 --scale=$SCALE_LINEAR -o images/code128_textgap.svg
 zint -b CODE11 -d "9212320967" --scale=$SCALE_LINEAR -o images/code11.svg
 zint -b C25STANDARD -d "9212320967" --scale=$SCALE_LINEAR -o images/c25standard.svg
 zint -b C25IATA -d "9212320967" --scale=$SCALE_LINEAR -o images/c25iata.svg
diff -urN zint-2.12.0/frontend/main.c zint/frontend/main.c
--- zint-2.12.0/frontend/main.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend/main.c	2023-05-08 14:39:44.996320142 +0200
@@ -1,7 +1,7 @@
 /* main.c - Command line handling routines for Zint */
 /*
     libzint - the open source barcode library
-    Copyright (C) 2008-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2008-2023 Robin Stuart <rstuart114@gmail.com>
 
     This program is free software; you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
@@ -115,7 +115,7 @@
 }
 
 /* Output version information */
-static void version(int no_png) {
+static void version(const int no_png) {
     const char *no_png_lib = no_png ? " (no libpng)" : "";
     const int zint_version = ZBarcode_Version();
     const int version_major = zint_version / 10000;
@@ -136,7 +136,7 @@
 }
 
 /* Output usage information */
-static void usage(int no_png) {
+static void usage(const int no_png) {
     const char *no_png_type = no_png ? "" : "/PNG";
     const char *no_png_ext = no_png ? "gif" : "png";
 
@@ -146,7 +146,7 @@
     fputs( "  -b, --barcode=TYPE    Number or name of barcode type. Default is 20 (CODE128)\n"
            "  --addongap=NUMBER     Set add-on gap in multiples of X-dimension for EAN/UPC\n"
            "  --batch               Treat each line of input file as a separate data set\n"
-           "  --bg=COLOUR           Specify a background colour (in hex RGB/RGBA)\n"
+           "  --bg=COLOUR           Specify a background colour (as RGB(A) or \"C,M,Y,K\")\n"
            "  --binary              Treat input as raw binary data\n", stdout);
     fputs( "  --bind                Add boundary bars\n"
            "  --bindtop             Add top boundary bar only\n"
@@ -164,9 +164,10 @@
            "  --dump                Dump hexadecimal representation to stdout\n"
            "  -e, --ecinos          Display ECI (Extended Channel Interpretation) table\n", stdout);
     fputs( "  --eci=NUMBER          Set the ECI code for the data (segment 0)\n"
-           "  --esc                 Process escape characters in input data\n"
+           "  --esc                 Process escape sequences in input data\n"
+           "  --extraesc            Process symbology-specific escape sequences (Code 128)\n"
            "  --fast                Use faster encodation or other shortcuts if available\n"
-           "  --fg=COLOUR           Specify a foreground colour (in hex RGB/RGBA)\n", stdout);
+           "  --fg=COLOUR           Specify a foreground colour (as RGB(A) or \"C,M,Y,K\")\n", stdout);
     printf("  --filetype=TYPE       Set output file type BMP/EMF/EPS/GIF/PCX%s/SVG/TIF/TXT\n", no_png_type);
     fputs( "  --fullmultibyte       Use multibyte for binary/Latin (QR/Han Xin/Grid Matrix)\n"
            "  --gs1                 Treat input as GS1 compatible data\n"
@@ -201,11 +202,12 @@
            "  --square              Force Data Matrix symbols to be square\n"
            "  --structapp=I,C[,ID]  Set Structured Append info (I index, C count)\n"
            "  -t, --types           Display table of barcode types\n", stdout);
-    fputs( "  --vers=NUMBER         Set symbol version (size, check digits, other options)\n"
+    fputs( "  --textgap=NUMBER      Adjust gap between barcode and HRT in multiples of X-dim\n"
+           "  --vers=NUMBER         Set symbol version (size, check digits, other options)\n"
            "  -v, --version         Display Zint version\n"
            "  --vwhitesp=NUMBER     Set height of vertical whitespace in multiples of X-dim\n"
-           "  -w, --whitesp=NUMBER  Set width of horizontal whitespace in multiples of X-dim\n"
-           "  --werror              Convert all warnings into errors\n", stdout);
+           "  -w, --whitesp=NUMBER  Set width of horizontal whitespace in multiples of X-dim\n", stdout);
+    fputs( "  --werror              Convert all warnings into errors\n", stdout);
 }
 
 /* Display supported ECI codes */
@@ -862,7 +864,7 @@
                 if (mirror_start_o > 221) { /* Insist on leaving at least ~30 chars for filename */
                     fprintf(stderr, "Warning 188: directory for mirrored batch output too long (> 220), ignored\n");
                     fflush(stderr);
-                    warn_number = ZINT_WARN_INVALID_OPTION; /* TODO: maybe new warning e.g. ZINT_WARN_INVALID_INPUT? */
+                    warn_number = ZINT_WARN_INVALID_OPTION; /* TODO: maybe new warning ZINT_WARN_INVALID_INPUT? */
                     mirror_start_o = 0;
                 } else {
                     memcpy(output_file, symbol->outfile, mirror_start_o);
@@ -879,7 +881,7 @@
         }
     }
 
-    if (!strcmp(filename, "-")) {
+    if (strcmp(filename, "-") == 0) {
         file = stdin;
     } else {
         file = fopen(filename, "rb");
@@ -1056,6 +1058,104 @@
     return error_number;
 }
 
+enum options {
+    OPT_ADDONGAP = 128, OPT_BATCH, OPT_BINARY, OPT_BG, OPT_BIND, OPT_BIND_TOP, OPT_BOLD, OPT_BORDER, OPT_BOX,
+    OPT_CMYK, OPT_COLS, OPT_COMPLIANTHEIGHT, OPT_DIRECT, OPT_DMRE, OPT_DOTSIZE, OPT_DOTTY, OPT_DUMP,
+    OPT_ECI, OPT_ESC, OPT_EXTRAESC, OPT_FAST, OPT_FG, OPT_FILETYPE, OPT_FONTSIZE, OPT_FULLMULTIBYTE,
+    OPT_GS1, OPT_GS1NOCHECK, OPT_GS1PARENS, OPT_GSSEP, OPT_GUARDDESCENT,
+    OPT_HEIGHT, OPT_HEIGHTPERROW, OPT_INIT, OPT_MIRROR, OPT_MASK, OPT_MODE,
+    OPT_NOBACKGROUND, OPT_NOQUIETZONES, OPT_NOTEXT, OPT_PRIMARY, OPT_QUIETZONES,
+    OPT_ROTATE, OPT_ROWS, OPT_SCALE, OPT_SCALEXDIM, OPT_SCMVV, OPT_SECURE,
+    OPT_SEG1, OPT_SEG2, OPT_SEG3, OPT_SEG4, OPT_SEG5, OPT_SEG6, OPT_SEG7, OPT_SEG8, OPT_SEG9,
+    OPT_SEPARATOR, OPT_SMALL, OPT_SQUARE, OPT_STRUCTAPP, OPT_TEXTGAP,
+    OPT_VERBOSE, OPT_VERS, OPT_VWHITESP, OPT_WERROR
+};
+
+static const struct option longopts[] = {
+    {"addongap", 1, NULL, OPT_ADDONGAP},
+    {"barcode", 1, NULL, 'b'},
+    {"batch", 0, NULL, OPT_BATCH},
+    {"binary", 0, NULL, OPT_BINARY},
+    {"bg", 1, 0, OPT_BG},
+    {"bgcolor", 1, 0, OPT_BG}, /* Synonym */
+    {"bgcolour", 1, 0, OPT_BG}, /* Synonym */
+    {"bind", 0, NULL, OPT_BIND},
+    {"bindtop", 0, NULL, OPT_BIND_TOP},
+    {"bold", 0, NULL, OPT_BOLD},
+    {"border", 1, NULL, OPT_BORDER},
+    {"box", 0, NULL, OPT_BOX},
+    {"cmyk", 0, NULL, OPT_CMYK},
+    {"cols", 1, NULL, OPT_COLS},
+    {"compliantheight", 0, NULL, OPT_COMPLIANTHEIGHT},
+    {"data", 1, NULL, 'd'},
+    {"direct", 0, NULL, OPT_DIRECT},
+    {"dmre", 0, NULL, OPT_DMRE},
+    {"dotsize", 1, NULL, OPT_DOTSIZE},
+    {"dotty", 0, NULL, OPT_DOTTY},
+    {"dump", 0, NULL, OPT_DUMP},
+    {"eci", 1, NULL, OPT_ECI},
+    {"ecinos", 0, NULL, 'e'},
+    {"esc", 0, NULL, OPT_ESC},
+    {"extraesc", 0, NULL, OPT_EXTRAESC},
+    {"fast", 0, NULL, OPT_FAST},
+    {"fg", 1, 0, OPT_FG},
+    {"fgcolor", 1, 0, OPT_FG}, /* Synonym */
+    {"fgcolour", 1, 0, OPT_FG}, /* Synonym */
+    {"filetype", 1, NULL, OPT_FILETYPE},
+    {"fontsize", 1, NULL, OPT_FONTSIZE},
+    {"fullmultibyte", 0, NULL, OPT_FULLMULTIBYTE},
+    {"gs1", 0, 0, OPT_GS1},
+    {"gs1nocheck", 0, NULL, OPT_GS1NOCHECK},
+    {"gs1parens", 0, NULL, OPT_GS1PARENS},
+    {"gssep", 0, NULL, OPT_GSSEP},
+    {"guarddescent", 1, NULL, OPT_GUARDDESCENT},
+    {"height", 1, NULL, OPT_HEIGHT},
+    {"heightperrow", 0, NULL, OPT_HEIGHTPERROW},
+    {"help", 0, NULL, 'h'},
+    {"init", 0, NULL, OPT_INIT},
+    {"input", 1, NULL, 'i'},
+    {"mirror", 0, NULL, OPT_MIRROR},
+    {"mask", 1, NULL, OPT_MASK},
+    {"mode", 1, NULL, OPT_MODE},
+    {"nobackground", 0, NULL, OPT_NOBACKGROUND},
+    {"noquietzones", 0, NULL, OPT_NOQUIETZONES},
+    {"notext", 0, NULL, OPT_NOTEXT},
+    {"output", 1, NULL, 'o'},
+    {"primary", 1, NULL, OPT_PRIMARY},
+    {"quietzones", 0, NULL, OPT_QUIETZONES},
+    {"reverse", 0, NULL, 'r'},
+    {"rotate", 1, NULL, OPT_ROTATE},
+    {"rows", 1, NULL, OPT_ROWS},
+    {"scale", 1, NULL, OPT_SCALE},
+    {"scalexdimdp", 1, NULL, OPT_SCALEXDIM},
+    {"scmvv", 1, NULL, OPT_SCMVV},
+    {"secure", 1, NULL, OPT_SECURE},
+    {"seg1", 1, NULL, OPT_SEG1},
+    {"seg2", 1, NULL, OPT_SEG2},
+    {"seg3", 1, NULL, OPT_SEG3},
+    {"seg4", 1, NULL, OPT_SEG4},
+    {"seg5", 1, NULL, OPT_SEG5},
+    {"seg6", 1, NULL, OPT_SEG6},
+    {"seg7", 1, NULL, OPT_SEG7},
+    {"seg8", 1, NULL, OPT_SEG8},
+    {"seg9", 1, NULL, OPT_SEG9},
+    {"separator", 1, NULL, OPT_SEPARATOR},
+    {"small", 0, NULL, OPT_SMALL},
+    {"square", 0, NULL, OPT_SQUARE},
+    {"structapp", 1, NULL, OPT_STRUCTAPP},
+    {"textgap", 1, NULL, OPT_TEXTGAP},
+    {"types", 0, NULL, 't'},
+    {"verbose", 0, NULL, OPT_VERBOSE}, /* Currently undocumented, output some debug info */
+    {"vers", 1, NULL, OPT_VERS},
+    {"version", 0, NULL, 'v'},
+    {"vwhitesp", 1, NULL, OPT_VWHITESP},
+    {"werror", 0, NULL, OPT_WERROR},
+    {"whitesp", 1, NULL, 'w'},
+    {NULL, 0, NULL, 0}
+};
+
+static const char optstring[] = "b:d:ehi:o:rtvw:";
+
 /* Stuff to convert args on Windows command line to UTF-8 */
 #ifdef _WIN32
 #include <windows.h>
@@ -1086,11 +1186,36 @@
 }
 
 /* For Windows replace args with UTF-8 versions */
-static void win_args(int *p_argc, char ***p_argv) {
+/* TODO: using `CommandLineToArgvW()` causes shell32.dll to be loaded - replace with own version, see
+   https://news.ycombinator.com/item?id=18596841 */
+static void win_args(const int argc, char ***p_argv) {
     int i;
-    LPWSTR *szArgList = CommandLineToArgvW(GetCommandLineW(), &win_argc);
+    int no_getopt_error = 1;
+    LPWSTR *szArgList;
+    char *utf8_args = (char *) z_alloca(argc);
+
+    /* Only convert data options to UTF-8 - avoids code page issues with filename args, ticket #288, props Marcel */
+    memset(utf8_args, 0, argc);
+    while (no_getopt_error) {
+        const int c = getopt_long_only(argc, *p_argv, optstring, longopts, NULL /*longindex*/);
+        if (c == -1) break;
+        switch (c) {
+            case 'd':
+            case OPT_SEG1: case OPT_SEG2: case OPT_SEG3: case OPT_SEG4: case OPT_SEG5:
+            case OPT_SEG6: case OPT_SEG7: case OPT_SEG8: case OPT_SEG9:
+                utf8_args[optind - 1] = 1;
+                break;
+            case '?':
+                no_getopt_error = 0;
+                break;
+            default:
+                break;
+        }
+    }
+
+    szArgList = CommandLineToArgvW(GetCommandLineW(), &win_argc);
     if (szArgList) {
-        if (!(win_argv = (char **) calloc(win_argc + 1, sizeof(char *)))) {
+        if (win_argc != argc || !(win_argv = (char **) calloc(win_argc + 1, sizeof(char *)))) {
             LocalFree(szArgList);
         } else {
             for (i = 0; i < win_argc; i++) {
@@ -1109,9 +1234,10 @@
                 }
             }
             for (i = 0; i < win_argc; i++) {
-                (*p_argv)[i] = win_argv[i];
+                if (utf8_args[i]) {
+                    (*p_argv)[i] = win_argv[i];
+                }
             }
-            *p_argc = win_argc;
             LocalFree(szArgList);
         }
     }
@@ -1147,7 +1273,6 @@
     int rows = 0;
     char filetype[4] = {0};
     int output_given = 0;
-    int no_png;
     int png_refused;
     int val;
     int i;
@@ -1159,118 +1284,30 @@
     float float_opt;
     char errbuf[64]; /* For `validate_float()` */
     arg_opt *arg_opts = (arg_opt *) z_alloca(sizeof(arg_opt) * argc);
-    int no_getopt_error = 1;
 
-    my_symbol = ZBarcode_Create();
-    if (!my_symbol) {
-        fprintf(stderr, "Error 151: Memory failure\n");
-        exit(ZINT_ERROR_MEMORY);
-    }
-    no_png = ZBarcode_NoPng();
+    const int no_png = ZBarcode_NoPng();
 
     if (argc == 1) {
-        ZBarcode_Delete(my_symbol);
         usage(no_png);
         exit(ZINT_ERROR_INVALID_DATA);
     }
+
+    my_symbol = ZBarcode_Create();
+    if (!my_symbol) {
+        fprintf(stderr, "Error 151: Memory failure\n");
+        exit(ZINT_ERROR_MEMORY);
+    }
     my_symbol->input_mode = UNICODE_MODE;
 
+    opterr = 0; /* Disable `getopt_long_only()` printing errors */
+
 #ifdef _WIN32
-    win_args(&argc, &argv);
+    win_args(argc, &argv);
+    optind = 1; /* Reset after scanning in `win_args()` */
 #endif
 
-    opterr = 0; /* Disable `getopt_long_only()` printing errors */
-    while (no_getopt_error) {
-        enum options {
-            OPT_ADDONGAP = 128, OPT_BATCH, OPT_BINARY, OPT_BG, OPT_BIND, OPT_BIND_TOP, OPT_BOLD, OPT_BORDER, OPT_BOX,
-            OPT_CMYK, OPT_COLS, OPT_COMPLIANTHEIGHT, OPT_DIRECT, OPT_DMRE, OPT_DOTSIZE, OPT_DOTTY, OPT_DUMP,
-            OPT_ECI, OPT_ESC, OPT_FAST, OPT_FG, OPT_FILETYPE, OPT_FONTSIZE, OPT_FULLMULTIBYTE,
-            OPT_GS1, OPT_GS1NOCHECK, OPT_GS1PARENS, OPT_GSSEP, OPT_GUARDDESCENT,
-            OPT_HEIGHT, OPT_HEIGHTPERROW, OPT_INIT, OPT_MIRROR, OPT_MASK, OPT_MODE,
-            OPT_NOBACKGROUND, OPT_NOQUIETZONES, OPT_NOTEXT, OPT_PRIMARY, OPT_QUIETZONES,
-            OPT_ROTATE, OPT_ROWS, OPT_SCALE, OPT_SCALEXDIM, OPT_SCMVV, OPT_SECURE,
-            OPT_SEG1, OPT_SEG2, OPT_SEG3, OPT_SEG4, OPT_SEG5, OPT_SEG6, OPT_SEG7, OPT_SEG8, OPT_SEG9,
-            OPT_SEPARATOR, OPT_SMALL, OPT_SQUARE, OPT_STRUCTAPP,
-            OPT_VERBOSE, OPT_VERS, OPT_VWHITESP, OPT_WERROR
-        };
-        int option_index = 0;
-        static const struct option long_options[] = {
-            {"addongap", 1, NULL, OPT_ADDONGAP},
-            {"barcode", 1, NULL, 'b'},
-            {"batch", 0, NULL, OPT_BATCH},
-            {"binary", 0, NULL, OPT_BINARY},
-            {"bg", 1, 0, OPT_BG},
-            {"bind", 0, NULL, OPT_BIND},
-            {"bindtop", 0, NULL, OPT_BIND_TOP},
-            {"bold", 0, NULL, OPT_BOLD},
-            {"border", 1, NULL, OPT_BORDER},
-            {"box", 0, NULL, OPT_BOX},
-            {"cmyk", 0, NULL, OPT_CMYK},
-            {"cols", 1, NULL, OPT_COLS},
-            {"compliantheight", 0, NULL, OPT_COMPLIANTHEIGHT},
-            {"data", 1, NULL, 'd'},
-            {"direct", 0, NULL, OPT_DIRECT},
-            {"dmre", 0, NULL, OPT_DMRE},
-            {"dotsize", 1, NULL, OPT_DOTSIZE},
-            {"dotty", 0, NULL, OPT_DOTTY},
-            {"dump", 0, NULL, OPT_DUMP},
-            {"eci", 1, NULL, OPT_ECI},
-            {"ecinos", 0, NULL, 'e'},
-            {"esc", 0, NULL, OPT_ESC},
-            {"fast", 0, NULL, OPT_FAST},
-            {"fg", 1, 0, OPT_FG},
-            {"filetype", 1, NULL, OPT_FILETYPE},
-            {"fontsize", 1, NULL, OPT_FONTSIZE},
-            {"fullmultibyte", 0, NULL, OPT_FULLMULTIBYTE},
-            {"gs1", 0, 0, OPT_GS1},
-            {"gs1nocheck", 0, NULL, OPT_GS1NOCHECK},
-            {"gs1parens", 0, NULL, OPT_GS1PARENS},
-            {"gssep", 0, NULL, OPT_GSSEP},
-            {"guarddescent", 1, NULL, OPT_GUARDDESCENT},
-            {"height", 1, NULL, OPT_HEIGHT},
-            {"heightperrow", 0, NULL, OPT_HEIGHTPERROW},
-            {"help", 0, NULL, 'h'},
-            {"init", 0, NULL, OPT_INIT},
-            {"input", 1, NULL, 'i'},
-            {"mirror", 0, NULL, OPT_MIRROR},
-            {"mask", 1, NULL, OPT_MASK},
-            {"mode", 1, NULL, OPT_MODE},
-            {"nobackground", 0, NULL, OPT_NOBACKGROUND},
-            {"noquietzones", 0, NULL, OPT_NOQUIETZONES},
-            {"notext", 0, NULL, OPT_NOTEXT},
-            {"output", 1, NULL, 'o'},
-            {"primary", 1, NULL, OPT_PRIMARY},
-            {"quietzones", 0, NULL, OPT_QUIETZONES},
-            {"reverse", 0, NULL, 'r'},
-            {"rotate", 1, NULL, OPT_ROTATE},
-            {"rows", 1, NULL, OPT_ROWS},
-            {"scale", 1, NULL, OPT_SCALE},
-            {"scalexdimdp", 1, NULL, OPT_SCALEXDIM},
-            {"scmvv", 1, NULL, OPT_SCMVV},
-            {"secure", 1, NULL, OPT_SECURE},
-            {"seg1", 1, NULL, OPT_SEG1},
-            {"seg2", 1, NULL, OPT_SEG2},
-            {"seg3", 1, NULL, OPT_SEG3},
-            {"seg4", 1, NULL, OPT_SEG4},
-            {"seg5", 1, NULL, OPT_SEG5},
-            {"seg6", 1, NULL, OPT_SEG6},
-            {"seg7", 1, NULL, OPT_SEG7},
-            {"seg8", 1, NULL, OPT_SEG8},
-            {"seg9", 1, NULL, OPT_SEG9},
-            {"separator", 1, NULL, OPT_SEPARATOR},
-            {"small", 0, NULL, OPT_SMALL},
-            {"square", 0, NULL, OPT_SQUARE},
-            {"structapp", 1, NULL, OPT_STRUCTAPP},
-            {"types", 0, NULL, 't'},
-            {"verbose", 0, NULL, OPT_VERBOSE}, /* Currently undocumented, output some debug info */
-            {"vers", 1, NULL, OPT_VERS},
-            {"version", 0, NULL, 'v'},
-            {"vwhitesp", 1, NULL, OPT_VWHITESP},
-            {"werror", 0, NULL, OPT_WERROR},
-            {"whitesp", 1, NULL, 'w'},
-            {NULL, 0, NULL, 0}
-        };
-        const int c = getopt_long_only(argc, argv, "b:d:ehi:o:rtvw:", long_options, &option_index);
+    while (1) {
+        const int c = getopt_long_only(argc, argv, optstring, longopts, NULL /*longindex*/);
         if (c == -1) break;
 
         switch (c) {
@@ -1298,7 +1335,7 @@
                 }
                 break;
             case OPT_BG:
-                strncpy(my_symbol->bgcolour, optarg, 9);
+                strncpy(my_symbol->bgcolour, optarg, 15); /* Allow for "CCC,MMM,YYY,KKK" */
                 break;
             case OPT_BINARY:
                 my_symbol->input_mode = (my_symbol->input_mode & ~0x07) | DATA_MODE;
@@ -1392,11 +1429,14 @@
             case OPT_ESC:
                 my_symbol->input_mode |= ESCAPE_MODE;
                 break;
+            case OPT_EXTRAESC:
+                my_symbol->input_mode |= EXTRA_ESCAPE_MODE;
+                break;
             case OPT_FAST:
                 my_symbol->input_mode |= FAST_MODE;
                 break;
             case OPT_FG:
-                strncpy(my_symbol->fgcolour, optarg, 9);
+                strncpy(my_symbol->fgcolour, optarg, 15); /* Allow for "CCC,MMM,YYY,KKK" */
                 break;
             case OPT_FILETYPE:
                 /* Select the type of output file */
@@ -1673,6 +1713,19 @@
                     return do_exit(ZINT_ERROR_INVALID_OPTION);
                 }
                 break;
+            case OPT_TEXTGAP:
+                if (!validate_float(optarg, &float_opt, errbuf)) {
+                    fprintf(stderr, "Error 194: Invalid text gap floating point (%s)\n", errbuf);
+                    return do_exit(ZINT_ERROR_INVALID_OPTION);
+                }
+                if (float_opt >= 0.0f && float_opt <= 5.0f) {
+                    my_symbol->text_gap = float_opt;
+                } else {
+                    fprintf(stderr, "Warning 195: Text gap '%g' out of range (0 to 5), ignoring\n", float_opt);
+                    fflush(stderr);
+                    warn_number = ZINT_WARN_INVALID_OPTION;
+                }
+                break;
             case OPT_VERBOSE:
                 my_symbol->debug = 1;
                 break;
@@ -1833,6 +1886,12 @@
             }
         }
 
+        if (output_given && (my_symbol->output_options & BARCODE_STDOUT)) {
+            my_symbol->output_options &= ~BARCODE_STDOUT;
+            fprintf(stderr, "Warning 193: Output file given, ignoring '--direct' option\n");
+            fflush(stderr);
+            warn_number = ZINT_WARN_INVALID_OPTION;
+        }
         if (batch_mode) {
             /* Take each line of text as a separate data set */
             if (data_arg_num > 1) {
diff -urN zint-2.12.0/frontend/Makefile.mingw zint/frontend/Makefile.mingw
--- zint-2.12.0/frontend/Makefile.mingw	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend/Makefile.mingw	2023-05-08 14:39:44.995320136 +0200
@@ -6,7 +6,7 @@
 # make clean		cleans up a previous compilation and any object or editor files
 #
 
-ZINT_VERSION:=-DZINT_VERSION=\"2.12.0\"
+ZINT_VERSION:=-DZINT_VERSION=\"2.12.0.9\"
 
 CC := gcc
 CFLAGS := -D_WIN32 -O2 -fms-extensions -mms-bitfields -fno-exceptions -fomit-frame-pointer -Wall -I../backend
diff -urN zint-2.12.0/frontend/tests/CMakeLists.txt zint/frontend/tests/CMakeLists.txt
--- zint-2.12.0/frontend/tests/CMakeLists.txt	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend/tests/CMakeLists.txt	2023-05-08 14:39:44.996320142 +0200
@@ -1,4 +1,4 @@
-# Copyright (C) 2020 Robin Stuart <rstuart114@gmail.com>
+# Copyright (C) 2020-23 Robin Stuart <rstuart114@gmail.com>
 # Adapted from qrencode/tests/CMakeLists.txt
 # Copyright (C) 2006-2017 Kentaro Fukuchi <kentaro@fukuchi.org>
 # vim: set ts=4 sw=4 et :
@@ -10,4 +10,7 @@
 
 include(${zint-package_SOURCE_DIR}/cmake/zint_add_test.cmake)
 
+if(ZINT_SHARED)
+    set(ZINT_STATIC "")
+endif()
 zint_add_test(args test_args)
diff -urN zint-2.12.0/frontend/tests/test_args.c zint/frontend/tests/test_args.c
--- zint-2.12.0/frontend/tests/test_args.c	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend/tests/test_args.c	2023-05-08 14:39:44.996320142 +0200
@@ -1,6 +1,6 @@
 /*
     libzint - the open source barcode library
-    Copyright (C) 2020-2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2020-2023 Robin Stuart <rstuart114@gmail.com>
 
     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
@@ -214,6 +214,9 @@
         if (input_mode & ESCAPE_MODE) {
             sprintf(cmd + (int) strlen(cmd), "%s--esc", strlen(cmd) ? " " : "");
         }
+        if (input_mode & EXTRA_ESCAPE_MODE) {
+            sprintf(cmd + (int) strlen(cmd), "%s--extraesc", strlen(cmd) ? " " : "");
+        }
         if (input_mode & FAST_MODE) {
             sprintf(cmd + (int) strlen(cmd), "%s--fast", strlen(cmd) ? " " : "");
         }
@@ -310,40 +313,42 @@
         /*  5*/ { BARCODE_CODE128, NULL, NULL, "123\n45\n", "7\n",-1, -1, 1, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "Warning 144: Processing first input file 'test_dump_args1.txt' only\nD2 13 9B 39 65 C8 C9 8E B\nD3 97 62 3B 63 AC" },
         /*  6*/ { BARCODE_CODE128, "\t", NULL, NULL, NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 90 D2 1A 63 AC" },
         /*  7*/ { BARCODE_CODE128, "\\t", NULL, NULL, NULL, ESCAPE_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 90 D2 1A 63 AC" },
-        /*  8*/ { BARCODE_CODE128, "123", NULL, NULL, NULL, -1, BARCODE_BIND | BARCODE_BOX | BARCODE_BIND_TOP | SMALL_TEXT | BOLD_TEXT | CMYK_COLOUR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D2 13 9B 39 65 C8 C9 8E B" },
-        /*  9*/ { BARCODE_CODE128, "123", NULL, NULL, NULL, -1, BARCODE_DOTTY_MODE, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "Error 224: Selected symbology cannot be rendered as dots" },
-        /* 10*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 97 BA 86 51 88 B1 11 AC 46 D8 C7 58\nD0 97 BB 12 46 88 C5 1A 3C 55 CC C7 58" },
-        /* 11*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, 10, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 97 BA 86 51 88 B1 11 AC 44 68 BC 98 EB\nD0 97 BB 12 46 2B BD 7B A3 47 8A 8D 18 EB" },
-        /* 12*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL,  3, -1, 0, -1, "D0 97 BA 58 51 88 B1 11 AC 46 36 C7 58\nD0 97 BB 12 46 88 C5 77 AF 74 62 C7 58\nD0 97 BA CE 5D EB DD 1A 3C 56 88 C7 58" },
-        /* 13*/ { BARCODE_CODE11, NULL, NULL, "123", NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "B2 D6 96 CA B5 6D 64" },
-        /* 14*/ { BARCODE_CODE11, NULL, NULL, "123", NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  1, "B2 D6 96 CA B5 64" },
-        /* 15*/ { BARCODE_CODE11, "123", NULL, "456", NULL,       -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  2, "B2 D6 96 CA B2\nB2 B6 DA 9A B2" },
-        /* 16*/ { BARCODE_CODE11, "123", "456", "789", "012",     -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  2, "B2 D6 96 CA B2\nB2 B6 DA 9A B2\nB2 A6 D2 D5 64\nB2 AD AD 2D 64" },
-        /* 17*/ { BARCODE_PDF417, "123", NULL, NULL, NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  0, 0, -1, "FF 54 7A BC 3A 9C 1D 5C 0F E8 A4\nFF 54 7E AE 3C 11 5F AB 8F E8 A4\nFF 54 6A F8 29 9F 1D 5F 8F E8 A4\nFF 54 57 9E 37 BA 1A F7 CF E8 A4\nFF 54 75 CC 36 F0 5D 73 0F E8 A4" },
-        /* 18*/ { BARCODE_DATAMATRIX, "ABC", NULL, NULL, NULL, -1,          -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA 8\nB3 4\n8F 0\nB2 C\nA6 0\nBA C\nD6 0\nEB 4\nE2 8\nFF C" },
-        /* 19*/ { BARCODE_DATAMATRIX, "ABC", NULL, NULL, NULL, -1, READER_INIT, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A\nAC 7\n8A 4\nA0 3\nC2 2\nB5 1\n82 2\nBA 7\n8C C\nA0 5\n86 A\nFF F" },
-        /* 20*/ { BARCODE_DATAMATRIX, "ABCDEFGH", NULL, NULL, NULL, FAST_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nA6 8C\nB2 F0\n98 B4\nB9 A8\nB8 CC\nF0 78\nA0 3C\n99 70\n85 1C\nDA B0\nE5 94\nA7 50\nFF FC" },
-        /* 21*/ { BARCODE_DATAMATRIX, "ABCDEFGH", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\n80 04\n82 60\nC5 24\n98 A8\nA3 9C\nCB B8\nAF DC\n86 58\nF6 44\nAC 18\n90 54\nCF 30\nFF FC" },
-        /* 22*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJK", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA AA AA\n80 09 F9 BD\n82 4A E2 58\nC5 CD C9 A5\nD8 5C A5 FC\nE0 35 88 69\nCC FC B3 E6\nFF FF FF FF" },
-        /* 23*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJK", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 1, -1, "AA AA\n80 25\n82 24\nC5 5D\n98 90\nA4 C7\nC8 A6\nB9 E9\n8E 02\nDE 91\nCD 6C\nA0 BB\n85 80\n98 2D\nE4 CA\nFF FF" },
-        /* 24*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA A8\nBA 5A 44\n8B 4D 28\nBF 77 64\n97 85 50\nBA D8 AC\nCD ED B8\nD4 B5 2C\nD1 A8 00\n81 FB 2C\nE4 75 78\n96 E8 2C\nF3 75 78\nEE 1D 04\nCA BA 98\nB1 8F B4\nA0 4F 00\nE4 A7 74\nF1 D3 90\nEF E1 BC\n91 10 38\nFF FF FC" },
-        /* 25*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 1, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA AA AA AA AA AA AA\nBA 03 BA 7D E5 31 B0 0D\n8B 6A 93 B6 E0 0A B8 3C\nBF 1D EA A7 EB ED A1 FB\n96 66 86 B6 C9 AE 92 40\nBF 65 E7 95 BC B7 FA E3\nCC 7C 90 CC D1 24 AB 5A\nFF FF FF FF FF FF FF FF" },
-        /* 26*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 1, -1, 0, -1, -1, NULL, -1, -1, 1, -1, "AA AA A8\nBA 5A 44\n8B 4D 28\nBF 77 64\n97 85 50\nBA D8 AC\nCD ED B8\nD4 B5 2C\nD1 A8 00\n81 FB 2C\nE4 75 78\n96 E8 2C\nF3 75 78\nEE 1D 04\nCA BA 98\nB1 8F B4\nA0 4F 00\nE4 A7 74\nF1 D3 90\nEF E1 BC\n91 10 38\nFF FF FC" },
-        /* 27*/ { BARCODE_DATAMATRIX, "[91]12[92]34", NULL, NULL, NULL, GS1_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nFA 9C\nBC 00\nD7 84\nED E0\nA4 E4\nA7 40\n9D 3C\nBF 50\nFA 24\nB1 68\nE5 04\n92 70\nFF FC" },
-        /* 28*/ { BARCODE_DATAMATRIX, "[91]12[92]34", NULL, NULL, NULL, GS1_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
-        /* 29*/ { BARCODE_DATAMATRIX, "[9\\x31]12[92]34", NULL, NULL, NULL, GS1_MODE | ESCAPE_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
-        /* 30*/ { BARCODE_DATAMATRIX, "(9\\x31)12(92)34", NULL, NULL, NULL, GS1_MODE | ESCAPE_MODE | GS1PARENS_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
-        /* 31*/ { BARCODE_EANX_CC, "[91]12", NULL, NULL, NULL,    -1, -1, 0, -1, 0, -1, 0, -1, -1, "12345678+12", -1, -1, 0, -1, "DB BC D3 9C 44 E9 D2 2C 19 E7 A2 D8 A0 00 00 00\nDB 31 1C 9C C7 29 92 47 D9 E9 40 C8 A0 00 00 00\nDA 3B EB 10 AF 09 9A 18 9D 7D 82 E8 A0 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n20 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n14 68 D1 A6 49 BD 55 C9 D4 22 48 B9 40 59 94 98" },
-        /* 32*/ { BARCODE_EANX_CC, "[91]12", NULL, NULL, NULL,    -1, -1, 0, -1, 0, -1, 0, -1,  2, "12345678+12", -1, -1, 0, -1, "D3 A3 E9 DB F5 C9 DB 43 D9 CB 98 D2 20 00 00 00\nD3 25 0F 11 E4 49 D3 51 F1 AC FC D6 20 00 00 00\nD1 33 48 19 39 E9 93 18 49 D8 98 D7 20 00 00 00\nD1 A6 FC DA 1C 49 9B C5 05 E2 84 D7 A0 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n20 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n14 68 D1 A6 49 BD 55 C9 D4 22 48 B9 40 59 94 98" },
-        /* 33*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  1, 0, -1, "Warning 760: Converted to Shift JIS but no ECI specified\nFE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
-        /* 34*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, 26, 0, -1, -1, NULL, -1,  1, 0, -1, "FE 5B F8\n82 72 08\nBA DA E8\nBA 52 E8\nBA 2A E8\n82 0A 08\nFE AB F8\n00 D8 00\nEF F6 20\nB5 C2 28\n36 28 88\nFD 42 10\n62 2A C8\n00 95 70\nFE B7 38\n82 FD D8\nBA 97 00\nBA 43 60\nBA C8 C8\n82 C3 68\nFE EA F8" },
-        /* 35*/ { BARCODE_QRCODE, "\223\137", NULL, NULL, NULL, DATA_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 0A 08\nBA A2 E8\nBA 0A E8\nBA 5A E8\n82 72 08\nFE AB F8\n00 A0 00\nEF AE 20\n75 B5 20\n82 F7 58\nF4 9D C8\n5E 17 28\n00 C2 20\nFE 88 80\n82 82 38\nBA EA A8\nBA 55 50\nBA D7 68\n82 BD D0\nFE B7 78" },
-        /* 36*/ { BARCODE_QRCODE, "\223\137", NULL, NULL, NULL, DATA_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
-        /* 37*/ { BARCODE_QRCODE, "\\x93\\x5F", NULL, NULL, NULL, DATA_MODE | ESCAPE_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
-        /* 38*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, -1, 0, 2, -1, NULL, -1,  1, 0, -1, "Warning 760: Converted to Shift JIS but no ECI specified\nFE 4B F8\n82 92 08\nBA 42 E8\nBA 92 E8\nBA 3A E8\n82 EA 08\nFE AB F8\n00 38 00\nFB CD 50\nA5 89 18\n0B 74 B8\nFC 81 A0\n92 34 B8\n00 DE 48\nFE AB 10\n82 5E 50\nBA C9 20\nBA C9 20\nBA F4 E0\n82 81 A0\nFE B4 E8" },
-        /* 39*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1, -1, 0, -1, "FE 8A FE\n80 28 02\nBE E8 FA\nA0 94 0A\nAE 3E EA\nAE D2 EA\nAE 74 EA\n00 AA 00\n15 B4 80\n0B 48 74\nA2 4A A4\nB5 56 2C\nA8 5A A8\n9F 18 50\n02 07 50\n00 A6 00\nFE 20 EA\n02 C2 EA\nFA C4 EA\n0A 42 0A\nEA 52 FA\nEA 24 02\nEA AA FE" },
-        /* 40*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, 3, -1, NULL, -1, -1, 0, -1, "FE 16 FE\n80 E2 02\nBE C2 FA\nA0 A0 0A\nAE F6 EA\nAE 98 EA\nAE BA EA\n00 E0 00\n15 83 80\n44 7E AE\n92 9C 78\n25 BF 08\n47 4B 8C\n0D F9 74\n03 E7 50\n00 3A 00\nFE C2 EA\n02 22 EA\nFA DA EA\n0A 22 0A\nEA B2 FA\nEA 9A 02\nEA E8 FE" },
-        /* 41*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, 4, -1, NULL, -1, -1, 0, -1, "FE 8A FE\n80 28 02\nBE E8 FA\nA0 94 0A\nAE 3E EA\nAE D2 EA\nAE 74 EA\n00 AA 00\n15 B4 80\n0B 48 74\nA2 4A A4\nB5 56 2C\nA8 5A A8\n9F 18 50\n02 07 50\n00 A6 00\nFE 20 EA\n02 C2 EA\nFA C4 EA\n0A 42 0A\nEA 52 FA\nEA 24 02\nEA AA FE" },
+        /*  8*/ { BARCODE_CODE128, "\\^Ab\011", NULL, NULL, NULL, EXTRA_ESCAPE_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D2 12 1B AF 43 4C A1 8E B" },
+        /*  9*/ { BARCODE_CODE128, "\\^Ab\\t", NULL, NULL, NULL, ESCAPE_MODE | EXTRA_ESCAPE_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D2 12 1B AF 43 4C A1 8E B" },
+        /* 10*/ { BARCODE_CODE128, "123", NULL, NULL, NULL, -1, BARCODE_BIND | BARCODE_BOX | BARCODE_BIND_TOP | SMALL_TEXT | BOLD_TEXT | CMYK_COLOUR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D2 13 9B 39 65 C8 C9 8E B" },
+        /* 11*/ { BARCODE_CODE128, "123", NULL, NULL, NULL, -1, BARCODE_DOTTY_MODE, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "Error 224: Selected symbology cannot be rendered as dots" },
+        /* 12*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 97 BA 86 51 88 B1 11 AC 46 D8 C7 58\nD0 97 BB 12 46 88 C5 1A 3C 55 CC C7 58" },
+        /* 13*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, 10, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "D0 97 BA 86 51 88 B1 11 AC 44 68 BC 98 EB\nD0 97 BB 12 46 2B BD 7B A3 47 8A 8D 18 EB" },
+        /* 14*/ { BARCODE_CODABLOCKF, "ABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL,  3, -1, 0, -1, "D0 97 BA 58 51 88 B1 11 AC 46 36 C7 58\nD0 97 BB 12 46 88 C5 77 AF 74 62 C7 58\nD0 97 BA CE 5D EB DD 1A 3C 56 88 C7 58" },
+        /* 15*/ { BARCODE_CODE11, NULL, NULL, "123", NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "B2 D6 96 CA B5 6D 64" },
+        /* 16*/ { BARCODE_CODE11, NULL, NULL, "123", NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  1, "B2 D6 96 CA B5 64" },
+        /* 17*/ { BARCODE_CODE11, "123", NULL, "456", NULL,       -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  2, "B2 D6 96 CA B2\nB2 B6 DA 9A B2" },
+        /* 18*/ { BARCODE_CODE11, "123", "456", "789", "012",     -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0,  2, "B2 D6 96 CA B2\nB2 B6 DA 9A B2\nB2 A6 D2 D5 64\nB2 AD AD 2D 64" },
+        /* 19*/ { BARCODE_PDF417, "123", NULL, NULL, NULL,        -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  0, 0, -1, "FF 54 7A BC 3A 9C 1D 5C 0F E8 A4\nFF 54 7E AE 3C 11 5F AB 8F E8 A4\nFF 54 6A F8 29 9F 1D 5F 8F E8 A4\nFF 54 57 9E 37 BA 1A F7 CF E8 A4\nFF 54 75 CC 36 F0 5D 73 0F E8 A4" },
+        /* 20*/ { BARCODE_DATAMATRIX, "ABC", NULL, NULL, NULL, -1,          -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA 8\nB3 4\n8F 0\nB2 C\nA6 0\nBA C\nD6 0\nEB 4\nE2 8\nFF C" },
+        /* 21*/ { BARCODE_DATAMATRIX, "ABC", NULL, NULL, NULL, -1, READER_INIT, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A\nAC 7\n8A 4\nA0 3\nC2 2\nB5 1\n82 2\nBA 7\n8C C\nA0 5\n86 A\nFF F" },
+        /* 22*/ { BARCODE_DATAMATRIX, "ABCDEFGH", NULL, NULL, NULL, FAST_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nA6 8C\nB2 F0\n98 B4\nB9 A8\nB8 CC\nF0 78\nA0 3C\n99 70\n85 1C\nDA B0\nE5 94\nA7 50\nFF FC" },
+        /* 23*/ { BARCODE_DATAMATRIX, "ABCDEFGH", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\n80 04\n82 60\nC5 24\n98 A8\nA3 9C\nCB B8\nAF DC\n86 58\nF6 44\nAC 18\n90 54\nCF 30\nFF FC" },
+        /* 24*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJK", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA AA AA\n80 09 F9 BD\n82 4A E2 58\nC5 CD C9 A5\nD8 5C A5 FC\nE0 35 88 69\nCC FC B3 E6\nFF FF FF FF" },
+        /* 25*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJK", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 1, -1, "AA AA\n80 25\n82 24\nC5 5D\n98 90\nA4 C7\nC8 A6\nB9 E9\n8E 02\nDE 91\nCD 6C\nA0 BB\n85 80\n98 2D\nE4 CA\nFF FF" },
+        /* 26*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA A8\nBA 5A 44\n8B 4D 28\nBF 77 64\n97 85 50\nBA D8 AC\nCD ED B8\nD4 B5 2C\nD1 A8 00\n81 FB 2C\nE4 75 78\n96 E8 2C\nF3 75 78\nEE 1D 04\nCA BA 98\nB1 8F B4\nA0 4F 00\nE4 A7 74\nF1 D3 90\nEF E1 BC\n91 10 38\nFF FF FC" },
+        /* 27*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 1, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA AA AA AA AA AA AA AA\nBA 03 BA 7D E5 31 B0 0D\n8B 6A 93 B6 E0 0A B8 3C\nBF 1D EA A7 EB ED A1 FB\n96 66 86 B6 C9 AE 92 40\nBF 65 E7 95 BC B7 FA E3\nCC 7C 90 CC D1 24 AB 5A\nFF FF FF FF FF FF FF FF" },
+        /* 28*/ { BARCODE_DATAMATRIX, "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEF", NULL, NULL, NULL, -1, -1, 0, -1, 1, -1, 0, -1, -1, NULL, -1, -1, 1, -1, "AA AA A8\nBA 5A 44\n8B 4D 28\nBF 77 64\n97 85 50\nBA D8 AC\nCD ED B8\nD4 B5 2C\nD1 A8 00\n81 FB 2C\nE4 75 78\n96 E8 2C\nF3 75 78\nEE 1D 04\nCA BA 98\nB1 8F B4\nA0 4F 00\nE4 A7 74\nF1 D3 90\nEF E1 BC\n91 10 38\nFF FF FC" },
+        /* 29*/ { BARCODE_DATAMATRIX, "[91]12[92]34", NULL, NULL, NULL, GS1_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nFA 9C\nBC 00\nD7 84\nED E0\nA4 E4\nA7 40\n9D 3C\nBF 50\nFA 24\nB1 68\nE5 04\n92 70\nFF FC" },
+        /* 30*/ { BARCODE_DATAMATRIX, "[91]12[92]34", NULL, NULL, NULL, GS1_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
+        /* 31*/ { BARCODE_DATAMATRIX, "[9\\x31]12[92]34", NULL, NULL, NULL, GS1_MODE | ESCAPE_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
+        /* 32*/ { BARCODE_DATAMATRIX, "(9\\x31)12(92)34", NULL, NULL, NULL, GS1_MODE | ESCAPE_MODE | GS1PARENS_MODE, GS1_GS_SEPARATOR, 0, -1, 0, -1, 0, -1, -1, NULL, -1, -1, 0, -1, "AA A8\nF9 DC\nBF 20\nD6 C4\nED 10\nA0 0C\nA7 C0\n96 5C\nBA 70\nBB A4\nE2 18\nDD 14\n9C 40\nFF FC" },
+        /* 33*/ { BARCODE_EANX_CC, "[91]12", NULL, NULL, NULL,    -1, -1, 0, -1, 0, -1, 0, -1, -1, "12345678+12", -1, -1, 0, -1, "DB BC D3 9C 44 E9 D2 2C 19 E7 A2 D8 A0 00 00 00\nDB 31 1C 9C C7 29 92 47 D9 E9 40 C8 A0 00 00 00\nDA 3B EB 10 AF 09 9A 18 9D 7D 82 E8 A0 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n20 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n14 68 D1 A6 49 BD 55 C9 D4 22 48 B9 40 59 94 98" },
+        /* 34*/ { BARCODE_EANX_CC, "[91]12", NULL, NULL, NULL,    -1, -1, 0, -1, 0, -1, 0, -1,  2, "12345678+12", -1, -1, 0, -1, "D3 A3 E9 DB F5 C9 DB 43 D9 CB 98 D2 20 00 00 00\nD3 25 0F 11 E4 49 D3 51 F1 AC FC D6 20 00 00 00\nD1 33 48 19 39 E9 93 18 49 D8 98 D7 20 00 00 00\nD1 A6 FC DA 1C 49 9B C5 05 E2 84 D7 A0 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n20 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00\n10 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00\n14 68 D1 A6 49 BD 55 C9 D4 22 48 B9 40 59 94 98" },
+        /* 35*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  1, 0, -1, "Warning 760: Converted to Shift JIS but no ECI specified\nFE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
+        /* 36*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, 26, 0, -1, -1, NULL, -1,  1, 0, -1, "FE 5B F8\n82 72 08\nBA DA E8\nBA 52 E8\nBA 2A E8\n82 0A 08\nFE AB F8\n00 D8 00\nEF F6 20\nB5 C2 28\n36 28 88\nFD 42 10\n62 2A C8\n00 95 70\nFE B7 38\n82 FD D8\nBA 97 00\nBA 43 60\nBA C8 C8\n82 C3 68\nFE EA F8" },
+        /* 37*/ { BARCODE_QRCODE, "\223\137", NULL, NULL, NULL, DATA_MODE, -1, 0, -1, 0, -1, 0, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 0A 08\nBA A2 E8\nBA 0A E8\nBA 5A E8\n82 72 08\nFE AB F8\n00 A0 00\nEF AE 20\n75 B5 20\n82 F7 58\nF4 9D C8\n5E 17 28\n00 C2 20\nFE 88 80\n82 82 38\nBA EA A8\nBA 55 50\nBA D7 68\n82 BD D0\nFE B7 78" },
+        /* 38*/ { BARCODE_QRCODE, "\223\137", NULL, NULL, NULL, DATA_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
+        /* 39*/ { BARCODE_QRCODE, "\\x93\\x5F", NULL, NULL, NULL, DATA_MODE | ESCAPE_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1,  1, 0, -1, "FE 2B F8\n82 AA 08\nBA B2 E8\nBA 0A E8\nBA FA E8\n82 E2 08\nFE AB F8\n00 80 00\nD3 3B B0\n60 95 68\n7A B3 A0\n1D 0F 98\nAA D7 30\n00 E6 A8\nFE DA D0\n82 42 20\nBA 0E 38\nBA C7 18\nBA 17 68\n82 B9 40\nFE C5 28" },
+        /* 40*/ { BARCODE_QRCODE, "ç¹", NULL, NULL, NULL,         -1, -1, 0, -1, 0, -1, 0, 2, -1, NULL, -1,  1, 0, -1, "Warning 760: Converted to Shift JIS but no ECI specified\nFE 4B F8\n82 92 08\nBA 42 E8\nBA 92 E8\nBA 3A E8\n82 EA 08\nFE AB F8\n00 38 00\nFB CD 50\nA5 89 18\n0B 74 B8\nFC 81 A0\n92 34 B8\n00 DE 48\nFE AB 10\n82 5E 50\nBA C9 20\nBA C9 20\nBA F4 E0\n82 81 A0\nFE B4 E8" },
+        /* 41*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, -1, -1, NULL, -1, -1, 0, -1, "FE 8A FE\n80 28 02\nBE E8 FA\nA0 94 0A\nAE 3E EA\nAE D2 EA\nAE 74 EA\n00 AA 00\n15 B4 80\n0B 48 74\nA2 4A A4\nB5 56 2C\nA8 5A A8\n9F 18 50\n02 07 50\n00 A6 00\nFE 20 EA\n02 C2 EA\nFA C4 EA\n0A 42 0A\nEA 52 FA\nEA 24 02\nEA AA FE" },
+        /* 42*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, 3, -1, NULL, -1, -1, 0, -1, "FE 16 FE\n80 E2 02\nBE C2 FA\nA0 A0 0A\nAE F6 EA\nAE 98 EA\nAE BA EA\n00 E0 00\n15 83 80\n44 7E AE\n92 9C 78\n25 BF 08\n47 4B 8C\n0D F9 74\n03 E7 50\n00 3A 00\nFE C2 EA\n02 22 EA\nFA DA EA\n0A 22 0A\nEA B2 FA\nEA 9A 02\nEA E8 FE" },
+        /* 43*/ { BARCODE_HANXIN, "Ã©", NULL, NULL, NULL,  DATA_MODE, -1, 0, -1, 0, -1, 1, 4, -1, NULL, -1, -1, 0, -1, "FE 8A FE\n80 28 02\nBE E8 FA\nA0 94 0A\nAE 3E EA\nAE D2 EA\nAE 74 EA\n00 AA 00\n15 B4 80\n0B 48 74\nA2 4A A4\nB5 56 2C\nA8 5A A8\n9F 18 50\n02 07 50\n00 A6 00\nFE 20 EA\n02 C2 EA\nFA C4 EA\n0A 42 0A\nEA 52 FA\nEA 24 02\nEA AA FE" },
     };
     int data_size = ARRAY_SIZE(data);
     int i;
@@ -769,6 +774,7 @@
         int border;
         int cols;
         double dotsize;
+        double textgap;
         int eci;
         char *filetype;
         double height;
@@ -789,44 +795,46 @@
     };
     /* s/\/\*[ 0-9]*\*\//\=printf("\/\*%3d*\/", line(".") - line("'<")): */
     struct item data[] = {
-        /*  0*/ { -2, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 139: Invalid add-on gap value (digits only)" },
-        /*  1*/ {  6, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 140: Add-on gap out of range (7 to 12), ignoring" },
-        /*  2*/ { 13, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 140: Add-on gap out of range (7 to 12), ignoring" },
-        /*  3*/ { -1, -2,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 107: Invalid border width value (digits only)" },
-        /*  4*/ { -1, 1001, -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 108: Border width out of range (0 to 1000), ignoring" },
-        /*  5*/ { -1, -1,   -1, 12345678, -1,   NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 181: Invalid dot radius floating point (integer part must be 7 digits maximum)" },
-        /*  6*/ { -1, -1,   -1, 0.009, -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 106: Invalid dot radius value (less than 0.01), ignoring" },
-        /*  7*/ { -1, -1,   -2, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 131: Invalid columns value (digits only)" },
-        /*  8*/ { -1, -1,  201, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 111: Number of columns out of range (1 to 200), ignoring" },
-        /*  9*/ { -1, -1,   -1, -1,    -2,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 138: Invalid ECI value (digits only)" },
-        /* 10*/ { -1, -1,   -1, -1,    1000000, NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 118: ECI code out of range (0 to 999999), ignoring" },
-        /* 11*/ { -1, -1,   -1, -1,    -1,      "jpg", -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 142: File type 'jpg' not supported, ignoring" },
-        /* 12*/ { -1, -1,   -1, -1,    -1,      NULL,  -2,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 183: Invalid symbol height floating point (integer part must be digits only)" },
-        /* 13*/ { -1, -1,   -1, -1,    -1,      NULL,   0,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 110: Symbol height '0' out of range (0.5 to 2000), ignoring" },
-        /* 14*/ { -1, -1,   -1, -1,    -1,      NULL, 2001,  -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 110: Symbol height '2001' out of range (0.5 to 2000), ignoring" },
-        /* 15*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -2, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 182: Invalid guard bar descent floating point (integer part must be digits only)" },
-        /* 16*/ { -1, -1,   -1, -1,    -1,      NULL,  -1, 50.1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 135: Guard bar descent '50.1' out of range (0 to 50), ignoring" },
-        /* 17*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -2, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 148: Invalid mask value (digits only)" },
-        /* 18*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1,  8, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 147: Mask value out of range (0 to 7), ignoring" },
-        /* 19*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1,  7, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 116: Mode value out of range (0 to 6), ignoring" },
-        /* 20*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -2, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 117: Invalid rotation value (digits only)" },
-        /* 21*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, 45, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 137: Invalid rotation parameter (0, 90, 180 or 270 only), ignoring" },
-        /* 22*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -2, -1,   -1, -1, -1, -1,   -1,   -1, "Error 132: Invalid rows value (digits only)" },
-        /* 23*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, 91, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 112: Number of rows out of range (1 to 90), ignoring" },
-        /* 24*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -2,   -1, -1, -1, -1,   -1,   -1, "Error 184: Invalid scale floating point (integer part must be digits only)" },
-        /* 25*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, 0.49, -1, -1, -1, -1,   -1,   -1, "Warning 146: Scaling less than 0.5 will be set to 0.5 for 'gif' output" },
-        /* 26*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -2, -1, -1, -1,   -1,   -1, "Error 149: Invalid Structured Carrier Message version value (digits only)" },
-        /* 27*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,  100, -1, -1, -1,   -1,   -1, "Warning 150: Structured Carrier Message version out of range (0 to 99), ignoring" },
-        /* 28*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -2, -1, -1,   -1,   -1, "Error 134: Invalid ECC value (digits only)" },
-        /* 29*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1,  9, -1, -1,   -1,   -1, "Warning 114: ECC level out of range (0 to 8), ignoring" },
-        /* 30*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -2, -1,   -1,   -1, "Error 128: Invalid separator value (digits only)" },
-        /* 31*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1,  5, -1,   -1,   -1, "Warning 127: Separator value out of range (0 to 4), ignoring" },
-        /* 32*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -2,   -1,   -1, "Error 133: Invalid version value (digits only)" },
-        /* 33*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, 1000, -1,   -1, "Warning 113: Version value out of range (1 to 999), ignoring" },
-        /* 34*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -2,   -1, "Error 153: Invalid vertical whitespace value '-2' (digits only)" },
-        /* 35*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, 1001,   -1, "Warning 154: Vertical whitespace value out of range (0 to 1000), ignoring" },
-        /* 36*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -2, "Error 120: Invalid horizontal whitespace value '-2' (digits only)" },
-        /* 37*/ { -1, -1,   -1, -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1, 1001, "Warning 121: Horizontal whitespace value out of range (0 to 1000), ignoring" },
+        /*  0*/ { -2, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 139: Invalid add-on gap value (digits only)" },
+        /*  1*/ {  6, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 140: Add-on gap out of range (7 to 12), ignoring" },
+        /*  2*/ { 13, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 140: Add-on gap out of range (7 to 12), ignoring" },
+        /*  3*/ { -1, -2,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 107: Invalid border width value (digits only)" },
+        /*  4*/ { -1, 1001, -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 108: Border width out of range (0 to 1000), ignoring" },
+        /*  5*/ { -1, -1,   -1, -1, -0.5,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 194: Invalid text gap floating point (integer part must be digits only)" },
+        /*  6*/ { -1, -1,   -1, -1, 5.01,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 195: Text gap '5.01' out of range (0 to 5), ignoring" },
+        /*  7*/ { -1, -1,   -1, 12345678,  -1, -1,    NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 181: Invalid dot radius floating point (integer part must be 7 digits maximum)" },
+        /*  8*/ { -1, -1,   -1, 0.009, -1,   -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 106: Invalid dot radius value (less than 0.01), ignoring" },
+        /*  9*/ { -1, -1,   -2, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 131: Invalid columns value (digits only)" },
+        /* 10*/ { -1, -1,  201, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 111: Number of columns out of range (1 to 200), ignoring" },
+        /* 11*/ { -1, -1,   -1, -1,   -1,    -2,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 138: Invalid ECI value (digits only)" },
+        /* 12*/ { -1, -1,   -1, -1,   -1,    1000000, NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 118: ECI code out of range (0 to 999999), ignoring" },
+        /* 13*/ { -1, -1,   -1, -1,   -1,    -1,      "jpg", -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 142: File type 'jpg' not supported, ignoring" },
+        /* 14*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -2,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 183: Invalid symbol height floating point (integer part must be digits only)" },
+        /* 15*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,   0,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 110: Symbol height '0' out of range (0.5 to 2000), ignoring" },
+        /* 16*/ { -1, -1,   -1, -1,   -1,    -1,      NULL, 2001,  -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 110: Symbol height '2001' out of range (0.5 to 2000), ignoring" },
+        /* 17*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -2, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 182: Invalid guard bar descent floating point (integer part must be digits only)" },
+        /* 18*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1, 50.1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 135: Guard bar descent '50.1' out of range (0 to 50), ignoring" },
+        /* 19*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -2, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 148: Invalid mask value (digits only)" },
+        /* 20*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1,  8, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 147: Mask value out of range (0 to 7), ignoring" },
+        /* 21*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1,  7, -1, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 116: Mode value out of range (0 to 6), ignoring" },
+        /* 22*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -2, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Error 117: Invalid rotation value (digits only)" },
+        /* 23*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, 45, -1, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 137: Invalid rotation parameter (0, 90, 180 or 270 only), ignoring" },
+        /* 24*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -2, -1,   -1, -1, -1, -1,   -1,   -1, "Error 132: Invalid rows value (digits only)" },
+        /* 25*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, 91, -1,   -1, -1, -1, -1,   -1,   -1, "Warning 112: Number of rows out of range (1 to 90), ignoring" },
+        /* 26*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -2,   -1, -1, -1, -1,   -1,   -1, "Error 184: Invalid scale floating point (integer part must be digits only)" },
+        /* 27*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, 0.49, -1, -1, -1, -1,   -1,   -1, "Warning 146: Scaling less than 0.5 will be set to 0.5 for 'gif' output" },
+        /* 28*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -2, -1, -1, -1,   -1,   -1, "Error 149: Invalid Structured Carrier Message version value (digits only)" },
+        /* 29*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,  100, -1, -1, -1,   -1,   -1, "Warning 150: Structured Carrier Message version out of range (0 to 99), ignoring" },
+        /* 30*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -2, -1, -1,   -1,   -1, "Error 134: Invalid ECC value (digits only)" },
+        /* 31*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1,  9, -1, -1,   -1,   -1, "Warning 114: ECC level out of range (0 to 8), ignoring" },
+        /* 32*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -2, -1,   -1,   -1, "Error 128: Invalid separator value (digits only)" },
+        /* 33*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1,  5, -1,   -1,   -1, "Warning 127: Separator value out of range (0 to 4), ignoring" },
+        /* 34*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -2,   -1,   -1, "Error 133: Invalid version value (digits only)" },
+        /* 35*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, 1000, -1,   -1, "Warning 113: Version value out of range (1 to 999), ignoring" },
+        /* 36*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -2,   -1, "Error 153: Invalid vertical whitespace value '-2' (digits only)" },
+        /* 37*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, 1001,   -1, "Warning 154: Vertical whitespace value out of range (0 to 1000), ignoring" },
+        /* 38*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1,   -2, "Error 120: Invalid horizontal whitespace value '-2' (digits only)" },
+        /* 39*/ { -1, -1,   -1, -1,   -1,    -1,      NULL,  -1,   -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1,   -1, 1001, "Warning 121: Horizontal whitespace value out of range (0 to 1000), ignoring" },
     };
     int data_size = ARRAY_SIZE(data);
     int i;
@@ -850,6 +858,7 @@
         arg_int(cmd, "--border=", data[i].border);
         arg_int(cmd, "--cols=", data[i].cols);
         arg_double(cmd, "--dotsize=", data[i].dotsize);
+        arg_double(cmd, "--textgap=", data[i].textgap);
         arg_int(cmd, "--eci=", data[i].eci);
         arg_data(cmd, "--filetype=", data[i].filetype);
         arg_double(cmd, "--height=", data[i].height);
@@ -1145,62 +1154,67 @@
         /*  0*/ { BARCODE_CODE128, "1", -1, " --bg=", "EF9900", "", 0 },
         /*  1*/ { BARCODE_CODE128, "1", -1, " -bg=", "EF9900", "", 0 },
         /*  2*/ { BARCODE_CODE128, "1", -1, " --bg=", "EF9900AA", "", 0 },
-        /*  3*/ { BARCODE_CODE128, "1", -1, " --bg=", "GF9900", "Error 654: Malformed background colour 'GF9900' (hexadecimal only)", 0 },
-        /*  4*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000", "", 0 },
-        /*  5*/ { BARCODE_CODE128, "1", -1, " --fg=", "00000000", "", 0 },
-        /*  6*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000F", "Error 651: Malformed foreground colour (6 or 8 characters only)", 0 },
-        /*  7*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000FG", "Error 653: Malformed foreground colour '000000FG' (hexadecimal only)", 0 },
-        /*  8*/ { BARCODE_CODE128, "1", -1, " --compliantheight", "", "", 0 },
-        /*  9*/ { BARCODE_CODE128, "1", -1, " --fontsize=", "10", "", 0 },
-        /* 10*/ { BARCODE_CODE128, "1", -1, " --fontsize=", "101", "Warning 126: Font size out of range (0 to 100), ignoring", 0 },
-        /* 11*/ { BARCODE_CODE128, "1", -1, " --nobackground", "", "", 0 },
-        /* 12*/ { BARCODE_CODE128, "1", -1, " --noquietzones", "", "", 0 },
-        /* 13*/ { BARCODE_CODE128, "1", -1, " --notext", "", "", 0 },
-        /* 14*/ { BARCODE_CODE128, "1", -1, " --quietzones", "", "", 0 },
-        /* 15*/ { BARCODE_CODE128, "1", -1, " --reverse", "", "", 0 },
-        /* 16*/ { BARCODE_CODE128, "1", -1, " --werror", NULL, "", 0 },
-        /* 17*/ { 19, "1", -1, " --werror", NULL, "Error 207: Codabar 18 not supported", 0 },
-        /* 18*/ { BARCODE_GS1_128, "[01]12345678901231", -1, "", NULL, "", 0 },
-        /* 19*/ { BARCODE_GS1_128, "0112345678901231", -1, "", NULL, "Error 252: Data does not start with an AI", 0 },
-        /* 20*/ { BARCODE_GS1_128, "0112345678901231", -1, " --gs1nocheck", NULL, "Error 252: Data does not start with an AI", 0 },
-        /* 21*/ { BARCODE_GS1_128, "[00]376104250021234569", -1, "", NULL, "", 0 },
-        /* 22*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, "", NULL, "Warning 261: AI (00) position 18: Bad checksum '8', expected '9'", 0 },
-        /* 23*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, " --gs1nocheck", NULL, "", 0 },
-        /* 24*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, " --werror", NULL, "Error 261: AI (00) position 18: Bad checksum '8', expected '9'", 0 },
-        /* 25*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "1", "Error 155: Invalid Structured Append argument, expect \"index,count[,ID]\"", 0 },
-        /* 26*/ { BARCODE_AZTEC, "1", -1, " --structapp=", ",", "Error 156: Structured Append index too short", 0 },
-        /* 27*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "1234567890,", "Error 156: Structured Append index too long", 0 },
-        /* 28*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,", "Error 159: Structured Append count too short", 0 },
-        /* 29*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,1234567890", "Error 159: Structured Append count too long", 0 },
-        /* 30*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,", "Error 158: Structured Append ID too short", 0 },
-        /* 31*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,1234567890,", "Error 157: Structured Append count too long", 0 },
-        /* 32*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,123456789012345678901234567890123", "Error 158: Structured Append ID too long", 0 },
-        /* 33*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,12345678901234567890123456789012", "Error 701: Structured Append count out of range (2-26)", 0 },
-        /* 34*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,26,12345678901234567890123456789012", "", 0 },
-        /* 35*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "A,26,12345678901234567890123456789012", "Error 160: Invalid Structured Append index (digits only)", 0 },
-        /* 36*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,A,12345678901234567890123456789012", "Error 161: Invalid Structured Append count (digits only)", 0 },
-        /* 37*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,1,12345678901234567890123456789012", "Error 162: Invalid Structured Append count, must be >= 2", 0 },
-        /* 38*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "0,2,12345678901234567890123456789012", "Error 163: Structured Append index out of range (1-2)", 0 },
-        /* 39*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "3,2,12345678901234567890123456789012", "Error 163: Structured Append index out of range (1-2)", 0 },
-        /* 40*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "2,3,12345678901234567890123456789012", "", 0 },
-        /* 41*/ { BARCODE_PDF417, "1", -1, " --heightperrow", "", "", 0 },
-        /* 42*/ { -1, NULL, -1, " -v", NULL, "Zint version ", 1 },
-        /* 43*/ { -1, NULL, -1, " --version", NULL, "Zint version ", 1 },
-        /* 44*/ { -1, NULL, -1, " -h", NULL, "Encode input data in a barcode ", 1 },
-        /* 45*/ { -1, NULL, -1, " -e", NULL, "3: ISO/IEC 8859-1 ", 1 },
-        /* 46*/ { -1, NULL, -1, " -t", NULL, "1 CODE11 ", 1 },
-        /* 47*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12345678", "Error 178: scalexdimdp X-dim invalid floating point (integer part must be 7 digits maximum)", 0 },
-        /* 48*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1234567890123", "Error 176: scalexdimdp X-dim too long", 0 },
-        /* 49*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "123456.12", "Error 178: scalexdimdp X-dim invalid floating point (7 significant digits maximum)", 0 },
-        /* 50*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", ",12.34", "Error 174: scalexdimdp X-dim too short", 0 },
-        /* 51*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12.34,", "Error 175: scalexdimdp resolution too short", 0 },
-        /* 52*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12mm1", "Error 177: scalexdimdp X-dim units must occur at end", 0 },
-        /* 53*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1inc", "Error 177: scalexdimdp X-dim units must occur at end", 0 },
-        /* 54*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1234x", "Error 178: scalexdimdp X-dim invalid floating point (integer part must be digits only)", 0 },
-        /* 55*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12.34in,123x", "Error 180: scalexdimdp resolution invalid floating point (integer part must be digits only)", 0 },
-        /* 56*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12,123.45678", "Error 180: scalexdimdp resolution invalid floating point (7 significant digits maximum)", 0 },
-        /* 57*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "10.1,1000", "Warning 185: scalexdimdp X-dim (10.1) out of range (> 10), ignoring", 0 },
-        /* 58*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "10,1000.1", "Warning 186: scalexdimdp resolution (1000.1) out of range (> 1000), ignoring", 0 },
+        /*  3*/ { BARCODE_CODE128, "1", -1, " --bg=", "GF9900", "Error 881: Malformed background RGB colour 'GF9900' (hexadecimal only)", 0 },
+        /*  4*/ { BARCODE_CODE128, "1", -1, " --bgcolor=", "EF9900", "", 0 },
+        /*  5*/ { BARCODE_CODE128, "1", -1, " --bgcolour=", "EF9900", "", 0 },
+        /*  6*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000", "", 0 },
+        /*  7*/ { BARCODE_CODE128, "1", -1, " --fg=", "00000000", "", 0 },
+        /*  8*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000F", "Error 880: Malformed foreground RGB colour (6 or 8 characters only)", 0 },
+        /*  9*/ { BARCODE_CODE128, "1", -1, " --fg=", "000000FG", "Error 881: Malformed foreground RGB colour '000000FG' (hexadecimal only)", 0 },
+        /* 10*/ { BARCODE_CODE128, "1", -1, " --fg=", "0,0,0,100", "", 0 },
+        /* 11*/ { BARCODE_CODE128, "1", -1, " --fgcolor=", "111111", "", 0 },
+        /* 12*/ { BARCODE_CODE128, "1", -1, " --fgcolour=", "111111", "", 0 },
+        /* 13*/ { BARCODE_CODE128, "1", -1, " --compliantheight", "", "", 0 },
+        /* 14*/ { BARCODE_CODE128, "1", -1, " --fontsize=", "10", "", 0 },
+        /* 15*/ { BARCODE_CODE128, "1", -1, " --fontsize=", "101", "Warning 126: Font size out of range (0 to 100), ignoring", 0 },
+        /* 16*/ { BARCODE_CODE128, "1", -1, " --nobackground", "", "", 0 },
+        /* 17*/ { BARCODE_CODE128, "1", -1, " --noquietzones", "", "", 0 },
+        /* 18*/ { BARCODE_CODE128, "1", -1, " --notext", "", "", 0 },
+        /* 19*/ { BARCODE_CODE128, "1", -1, " --quietzones", "", "", 0 },
+        /* 20*/ { BARCODE_CODE128, "1", -1, " --reverse", "", "", 0 },
+        /* 21*/ { BARCODE_CODE128, "1", -1, " --werror", NULL, "", 0 },
+        /* 22*/ { 19, "1", -1, " --werror", NULL, "Error 207: Codabar 18 not supported", 0 },
+        /* 23*/ { BARCODE_GS1_128, "[01]12345678901231", -1, "", NULL, "", 0 },
+        /* 24*/ { BARCODE_GS1_128, "0112345678901231", -1, "", NULL, "Error 252: Data does not start with an AI", 0 },
+        /* 25*/ { BARCODE_GS1_128, "0112345678901231", -1, " --gs1nocheck", NULL, "Error 252: Data does not start with an AI", 0 },
+        /* 26*/ { BARCODE_GS1_128, "[00]376104250021234569", -1, "", NULL, "", 0 },
+        /* 27*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, "", NULL, "Warning 261: AI (00) position 18: Bad checksum '8', expected '9'", 0 },
+        /* 28*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, " --gs1nocheck", NULL, "", 0 },
+        /* 29*/ { BARCODE_GS1_128, "[00]376104250021234568", -1, " --werror", NULL, "Error 261: AI (00) position 18: Bad checksum '8', expected '9'", 0 },
+        /* 30*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "1", "Error 155: Invalid Structured Append argument, expect \"index,count[,ID]\"", 0 },
+        /* 31*/ { BARCODE_AZTEC, "1", -1, " --structapp=", ",", "Error 156: Structured Append index too short", 0 },
+        /* 32*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "1234567890,", "Error 156: Structured Append index too long", 0 },
+        /* 33*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,", "Error 159: Structured Append count too short", 0 },
+        /* 34*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,1234567890", "Error 159: Structured Append count too long", 0 },
+        /* 35*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,", "Error 158: Structured Append ID too short", 0 },
+        /* 36*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,1234567890,", "Error 157: Structured Append count too long", 0 },
+        /* 37*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,123456789012345678901234567890123", "Error 158: Structured Append ID too long", 0 },
+        /* 38*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "123456789,123456789,12345678901234567890123456789012", "Error 701: Structured Append count out of range (2-26)", 0 },
+        /* 39*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,26,12345678901234567890123456789012", "", 0 },
+        /* 40*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "A,26,12345678901234567890123456789012", "Error 160: Invalid Structured Append index (digits only)", 0 },
+        /* 41*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,A,12345678901234567890123456789012", "Error 161: Invalid Structured Append count (digits only)", 0 },
+        /* 42*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "26,1,12345678901234567890123456789012", "Error 162: Invalid Structured Append count, must be >= 2", 0 },
+        /* 43*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "0,2,12345678901234567890123456789012", "Error 163: Structured Append index out of range (1-2)", 0 },
+        /* 44*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "3,2,12345678901234567890123456789012", "Error 163: Structured Append index out of range (1-2)", 0 },
+        /* 45*/ { BARCODE_AZTEC, "1", -1, " --structapp=", "2,3,12345678901234567890123456789012", "", 0 },
+        /* 46*/ { BARCODE_PDF417, "1", -1, " --heightperrow", "", "", 0 },
+        /* 47*/ { -1, NULL, -1, " -v", NULL, "Zint version ", 1 },
+        /* 48*/ { -1, NULL, -1, " --version", NULL, "Zint version ", 1 },
+        /* 49*/ { -1, NULL, -1, " -h", NULL, "Encode input data in a barcode ", 1 },
+        /* 50*/ { -1, NULL, -1, " -e", NULL, "3: ISO/IEC 8859-1 ", 1 },
+        /* 51*/ { -1, NULL, -1, " -t", NULL, "1 CODE11 ", 1 },
+        /* 52*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12345678", "Error 178: scalexdimdp X-dim invalid floating point (integer part must be 7 digits maximum)", 0 },
+        /* 53*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1234567890123", "Error 176: scalexdimdp X-dim too long", 0 },
+        /* 54*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "123456.12", "Error 178: scalexdimdp X-dim invalid floating point (7 significant digits maximum)", 0 },
+        /* 55*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", ",12.34", "Error 174: scalexdimdp X-dim too short", 0 },
+        /* 56*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12.34,", "Error 175: scalexdimdp resolution too short", 0 },
+        /* 57*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12mm1", "Error 177: scalexdimdp X-dim units must occur at end", 0 },
+        /* 58*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1inc", "Error 177: scalexdimdp X-dim units must occur at end", 0 },
+        /* 59*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "1234x", "Error 178: scalexdimdp X-dim invalid floating point (integer part must be digits only)", 0 },
+        /* 60*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12.34in,123x", "Error 180: scalexdimdp resolution invalid floating point (integer part must be digits only)", 0 },
+        /* 61*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "12,123.45678", "Error 180: scalexdimdp resolution invalid floating point (7 significant digits maximum)", 0 },
+        /* 62*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "10.1,1000", "Warning 185: scalexdimdp X-dim (10.1) out of range (> 10), ignoring", 0 },
+        /* 63*/ { BARCODE_EANX, "501234567890", -1, " --scalexdimdp=", "10,1000.1", "Warning 186: scalexdimdp resolution (1000.1) out of range (> 1000), ignoring", 0 },
     };
     int data_size = ARRAY_SIZE(data);
     int i;
diff -urN zint-2.12.0/frontend/zint.rc zint/frontend/zint.rc
--- zint-2.12.0/frontend/zint.rc	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend/zint.rc	2023-05-08 14:39:44.996320142 +0200
@@ -2,8 +2,8 @@
 #include <windows.h>
 #include <winver.h>
 
-#define VER_FILEVERSION        2,12,0,0
-#define VER_FILEVERSION_STR    "2.12.0.0\0"
+#define VER_FILEVERSION        2,12,0,9
+#define VER_FILEVERSION_STR    "2.12.0.9\0"
 
 #ifdef GCC_WINDRES
 VS_VERSION_INFO		VERSIONINFO
diff -urN zint-2.12.0/frontend_qt/extScale.ui zint/frontend_qt/extScale.ui
--- zint-2.12.0/frontend_qt/extScale.ui	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/extScale.ui	2023-05-08 14:39:44.998320154 +0200
@@ -303,6 +303,20 @@
    <item>
     <layout class="QHBoxLayout" name="horzLayoutScaleBtns">
      <item>
+      <widget class="QPushButton" name="btnScaleUnset">
+       <property name="autoDefault">
+        <bool>false</bool>
+       </property>
+       <property name="text">
+        <string> &amp;Unset</string>
+       </property>
+       <property name="toolTip">
+        <string>Reset the scale to the original value and
+mark the settings as unset</string>
+       </property>
+      </widget>
+     </item>
+     <item>
       <spacer name="horzSpacerScaleBtns">
        <property name="orientation">
         <enum>Qt::Horizontal</enum>
diff -urN zint-2.12.0/frontend_qt/grpC128.ui zint/frontend_qt/grpC128.ui
--- zint-2.12.0/frontend_qt/grpC128.ui	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/grpC128.ui	2023-05-08 14:39:44.999320159 +0200
@@ -37,15 +37,26 @@
       <item row="0" column="1">
        <widget class="QRadioButton" name="radC128CSup">
         <property name="text">
-         <string>Subset &amp;C Suppression</string>
+         <string>Code Set &amp;C Suppression</string>
         </property>
         <property name="toolTip">
-         <string>Do not use Subset C mode
+         <string>Do not use Code Set C
 (numeric compression)</string>
         </property>
        </widget>
       </item>
-      <item row="1" column="0">
+      <item row="1" column="0" colspan="2">
+       <widget class="QRadioButton" name="radC128ExtraEsc">
+        <property name="text">
+         <string>&amp;Manual Code Sets (Extra Escape Mode)</string>
+        </property>
+        <property name="toolTip">
+         <string>Process special escape sequences &quot;\^A&quot;, &quot;\^B&quot; and
+&quot;\^C&quot; allowing manual Code Set selection</string>
+        </property>
+       </widget>
+      </item>
+      <item row="2" column="0">
        <widget class="QRadioButton" name="radC128EAN">
         <property name="text">
          <string>GS&amp;1-128</string>
@@ -56,7 +67,7 @@
         </property>
        </widget>
       </item>
-      <item row="1" column="1">
+      <item row="2" column="1">
        <widget class="QRadioButton" name="radC128HIBC">
         <property name="text">
          <string>H&amp;IBC</string>
diff -urN zint-2.12.0/frontend_qt/main.cpp zint/frontend_qt/main.cpp
--- zint-2.12.0/frontend_qt/main.cpp	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/main.cpp	2023-05-08 14:39:45.002320177 +0200
@@ -28,7 +28,7 @@
     /* Suppresses "Qt WebEngine seems to be initialized from a plugin" warning */
     QApplication::setAttribute(Qt::AA_ShareOpenGLContexts);
 #endif
-#if defined(_WIN32) && QT_VERSION >= 0x50A01
+#if defined(_WIN32) && QT_VERSION >= 0x50A01 && QT_VERSION < 0x60000
     /* Suppresses help question mark in dialogs */
     QApplication::setAttribute(Qt::AA_DisableWindowContextHelpButton);
 #endif
diff -urN zint-2.12.0/frontend_qt/mainwindow.cpp zint/frontend_qt/mainwindow.cpp
--- zint-2.12.0/frontend_qt/mainwindow.cpp	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/mainwindow.cpp	2023-05-08 14:39:45.003320183 +0200
@@ -1,6 +1,6 @@
 /***************************************************************************
  *   Copyright (C) 2008 by BogDan Vatra <bogdan@licentia.eu>               *
- *   Copyright (C) 2009-2022 by Robin Stuart <rstuart114@gmail.com>        *
+ *   Copyright (C) 2009-2023 by Robin Stuart <rstuart114@gmail.com>        *
  *                                                                         *
  *   This program is free software: you can redistribute it and/or modify  *
  *   it under the terms of the GNU General Public License as published by  *
@@ -57,7 +57,48 @@
 
 static const QKeySequence factoryResetSeq(Qt::SHIFT | Qt::CTRL | Qt::Key_R);
 
-static const QRegularExpression colorRE(QSL("^[0-9A-Fa-f]{6}([0-9A-Fa-f]{2})?$"));
+// RGB hexadecimal 6 or 8 in length or CMYK comma-separated decimal percentages "C,M,Y,K"
+static const QRegularExpression colorRE(
+                                QSL("^([0-9A-Fa-f]{6}([0-9A-Fa-f]{2})?)|(((100|[0-9]{0,2}),){3}(100|[0-9]{0,2}))$"));
+
+static const QString fgDefault(QSL("000000"));
+static const QString bgDefault(QSL("FFFFFF"));
+static const QString fgDefaultAlpha(QSL("000000FF"));
+static const QString bgDefaultAlpha(QSL("FFFFFFFF"));
+
+static QString qcolor_to_str(const QColor &color)
+{
+    if (color.alpha() == 0xFF) {
+        return QString::asprintf("%02X%02X%02X", color.red(), color.green(), color.blue());
+    }
+    return QString::asprintf("%02X%02X%02X%02X", color.red(), color.green(), color.blue(), color.alpha());
+}
+
+static QColor str_to_qcolor(const QString &str)
+{
+    QColor color;
+    int r, g, b, a;
+    if (str.contains(',')) {
+        int comma1 = str.indexOf(',');
+        int comma2 = str.indexOf(',', comma1 + 1);
+        int comma3 = str.indexOf(',', comma2 + 1);
+        int black = 100 - str.mid(comma3 + 1).toInt();
+        int val = 100 - str.mid(0, comma1).toInt();
+        r = (int) roundf((0xFF * val * black) / 10000.0f);
+        val = 100 - str.mid(comma1 + 1, comma2 - comma1 - 1).toInt();
+        g = (int) roundf((0xFF * val * black) / 10000.0f);
+        val = 100 - str.mid(comma2 + 1, comma3 - comma2 - 1).toInt();
+        b = (int) roundf((0xFF * val * black) / 10000.0f);
+        a = 0xFF;
+    } else {
+        r = str.mid(0, 2).toInt(nullptr, 16);
+        g = str.mid(2, 2).toInt(nullptr, 16);
+        b = str.mid(4, 2).toInt(nullptr, 16);
+        a = str.length() == 8 ? str.mid(6, 2).toInt(nullptr, 16) : 0xFF;
+    }
+    color.setRgb(r, g, b, a);
+    return color;
+}
 
 struct bstyle_item {
     const QString text;
@@ -275,6 +316,7 @@
     btnClearDataSeg2->setIcon(clearIcon);
     btnClearDataSeg3->setIcon(clearIcon);
     btnClearComposite->setIcon(clearIcon);
+    btnClearTextGap->setIcon(clearIcon);
     btnZap->setIcon(QIcon(QSL(":res/zap.svg")));
 
     change_options();
@@ -288,6 +330,9 @@
     connect(bwidth,  SIGNAL(valueChanged( int )), SLOT(update_preview()));
     connect(btype, SIGNAL(currentIndexChanged( int )), SLOT(update_preview()));
     connect(cmbFontSetting, SIGNAL(currentIndexChanged( int )), SLOT(update_preview()));
+    connect(spnTextGap, SIGNAL(valueChanged( double )), SLOT(text_gap_zero()));
+    connect(spnTextGap, SIGNAL(valueChanged( double )), SLOT(update_preview()));
+    connect(btnClearTextGap, SIGNAL(clicked( bool )), SLOT(clear_text_gap()));
     connect(txtData, SIGNAL(textChanged( const QString& )), SLOT(data_ui_set()));
     connect(txtData, SIGNAL(textChanged( const QString& )), SLOT(update_preview()));
     connect(txtDataSeg1, SIGNAL(textChanged( const QString& )), SLOT(data_ui_set()));
@@ -399,14 +444,8 @@
     settings.setValue(QSL("studio/bgcolor_geometry"), m_bgcolor_geometry);
     settings.setValue(QSL("studio/tab_index"), tabMain->currentIndex());
     settings.setValue(QSL("studio/symbology"), bstyle->currentIndex());
-    settings.setValue(QSL("studio/ink/red"), m_fgcolor.red());
-    settings.setValue(QSL("studio/ink/green"), m_fgcolor.green());
-    settings.setValue(QSL("studio/ink/blue"), m_fgcolor.blue());
-    settings.setValue(QSL("studio/ink/alpha"), m_fgcolor.alpha());
-    settings.setValue(QSL("studio/paper/red"), m_bgcolor.red());
-    settings.setValue(QSL("studio/paper/green"), m_bgcolor.green());
-    settings.setValue(QSL("studio/paper/blue"), m_bgcolor.blue());
-    settings.setValue(QSL("studio/paper/alpha"), m_bgcolor.alpha());
+    settings.setValue(QSL("studio/ink/text"), m_fgstr);
+    settings.setValue(QSL("studio/paper/text"), m_bgstr);
     settings.setValue(QSL("studio/data"), txtData->text());
     /* Seg data not saved so don't restore */
     settings.setValue(QSL("studio/composite_text"), txtComposite->toPlainText());
@@ -428,6 +467,7 @@
     settings.setValue(QSL("studio/appearance/scale"), spnScale->value());
     settings.setValue(QSL("studio/appearance/border_type"), btype->currentIndex());
     settings.setValue(QSL("studio/appearance/font_setting"), cmbFontSetting->currentIndex());
+    settings.setValue(QSL("studio/appearance/text_gap"), spnTextGap->value());
     settings.setValue(QSL("studio/appearance/chk_hrt_show"), chkHRTShow->isChecked() ? 1 : 0);
     settings.setValue(QSL("studio/appearance/chk_cmyk"), chkCMYK->isChecked() ? 1 : 0);
     settings.setValue(QSL("studio/appearance/chk_quiet_zones"), chkQuietZones->isChecked() ? 1 : 0);
@@ -448,14 +488,28 @@
     bool initial_load = m_symbology == 0;
     QString initialData(initial_load ? tr("Your Data Here!") : "");
 
-    m_fgcolor.setRgb(settings.value(QSL("studio/ink/red"), 0).toInt(),
+    m_fgstr = settings.value(QSL("studio/ink/text"), QSL("")).toString();
+    if (m_fgstr.isEmpty()) {
+        QColor color(settings.value(QSL("studio/ink/red"), 0).toInt(),
                     settings.value(QSL("studio/ink/green"), 0).toInt(),
                     settings.value(QSL("studio/ink/blue"), 0).toInt(),
                     settings.value(QSL("studio/ink/alpha"), 0xff).toInt());
-    m_bgcolor.setRgb(settings.value(QSL("studio/paper/red"), 0xff).toInt(),
-                    settings.value(QSL("studio/paper/green"), 0xff).toInt(),
-                    settings.value(QSL("studio/paper/blue"), 0xff).toInt(),
+        m_fgstr = qcolor_to_str(color);
+    }
+    if (m_fgstr.indexOf(colorRE) != 0) {
+        m_fgstr = fgDefault;
+    }
+    m_bgstr = settings.value(QSL("studio/paper/text"), QSL("")).toString();
+    if (m_bgstr.isEmpty()) {
+        QColor color(settings.value(QSL("studio/paper/red"), 0).toInt(),
+                    settings.value(QSL("studio/paper/green"), 0).toInt(),
+                    settings.value(QSL("studio/paper/blue"), 0).toInt(),
                     settings.value(QSL("studio/paper/alpha"), 0xff).toInt());
+        m_bgstr = qcolor_to_str(color);
+    }
+    if (m_bgstr.indexOf(colorRE) != 0) {
+        m_bgstr = bgDefault;
+    }
 
     txtData->setText(settings.value(QSL("studio/data"), initialData).toString());
     /* Don't save seg data */
@@ -479,6 +533,7 @@
     spnScale->setValue(settings.value(QSL("studio/appearance/scale"), 1.0).toFloat());
     btype->setCurrentIndex(settings.value(QSL("studio/appearance/border_type"), 0).toInt());
     cmbFontSetting->setCurrentIndex(settings.value(QSL("studio/appearance/font_setting"), 0).toInt());
+    spnTextGap->setValue(settings.value(QSL("studio/appearance/text_gap"), 0.0).toFloat());
     chkHRTShow->setChecked(settings.value(QSL("studio/appearance/chk_hrt_show"), 1).toInt() ? true : false);
     chkCMYK->setChecked(settings.value(QSL("studio/appearance/chk_cmyk"), 0).toInt() ? true : false);
     chkQuietZones->setChecked(settings.value(QSL("studio/appearance/chk_quiet_zones"), 0).toInt() ? true : false);
@@ -549,10 +604,14 @@
     }
 
     if ((watched == txt_fgcolor || watched == txt_bgcolor) && event->type() == QEvent::FocusOut) {
-        if (watched == txt_fgcolor) {
-            setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-        } else {
-            setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+        // Exclude right-click context menu pop-up (Undo/Redo/Cut/Copy/Paste etc.)
+        QFocusEvent *focusEvent = static_cast<QFocusEvent *>(event);
+        if (focusEvent->reason() != Qt::PopupFocusReason) {
+            if (watched == txt_fgcolor) {
+                setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+            } else {
+                setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
+            }
         }
     }
 
@@ -561,38 +620,30 @@
 
 void MainWindow::reset_colours()
 {
-    m_fgcolor.setRgb(0, 0, 0, 0xff);
-    m_bgcolor.setRgb(0xff, 0xff, 0xff, 0xff);
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+    m_fgstr = fgDefault;
+    m_bgstr = bgDefault;
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
     update_preview();
 }
 
 void MainWindow::reverse_colours()
 {
-    QColor temp = m_fgcolor;
-    m_fgcolor = m_bgcolor;
-    m_bgcolor = temp;
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+    QString temp = m_fgstr;
+    m_fgstr = m_bgstr;
+    m_bgstr = temp;
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
     update_preview();
 }
 
-QString MainWindow::getColorStr(const QColor color, bool alpha_always) {
-    QString ret;
-    if (color.alpha() != 0xFF || alpha_always) {
-        ret = QString::asprintf("%02X%02X%02X%02X", color.red(), color.green(), color.blue(), color.alpha());
-    } else {
-        ret = QString::asprintf("%02X%02X%02X", color.red(), color.green(), color.blue());
+void MainWindow::setColorTxtBtn(const QString &colorStr, QLineEdit *txt, QPushButton* btn) {
+    if (colorStr != txt->text()) {
+        int cursorPos = txt->cursorPosition();
+        txt->setText(colorStr);
+        txt->setCursorPosition(cursorPos);
     }
-    return ret;
-}
-
-void MainWindow::setColorTxtBtn(const QColor color, QLineEdit *txt, QPushButton* btn) {
-    int cursorPos = txt->cursorPosition();
-    txt->setText(getColorStr(color));
-    txt->setCursorPosition(cursorPos);
-    btn->setStyleSheet(QSL("QPushButton {background-color:") + color.name() + QSL(";}"));
+    btn->setStyleSheet(QSL("QPushButton {background-color:") + str_to_qcolor(colorStr).name() + QSL(";}"));
 }
 
 bool MainWindow::save()
@@ -708,13 +759,14 @@
     int symbology = bstyle_items[bstyle->currentIndex()].symbology;
 
     load_settings(settings);
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
 
     load_sub_settings(settings, symbology);
 
     settings.sync();
 
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
+
     txtData->setFocus(Qt::OtherFocusReason);
     update_preview();
 }
@@ -733,7 +785,7 @@
             "<p>A free barcode generator</p>"
             "<p>Instruction manual is available at the project homepage:<br>"
             "<a href=\"http://www.zint.org.uk\">http://www.zint.org.uk</a>.</p>"
-            "<p>Copyright &copy; 2006-2022 Robin Stuart and others.<br>"
+            "<p>Copyright &copy; 2006-2023 Robin Stuart and others.<br>"
             "Qt backend by BogDan Vatra.<br>"
             "Released under GNU GPL 3.0 or later.</p>"
             "<p>Qt version %2</p>"
@@ -927,15 +979,15 @@
 
     load_settings(settings);
 
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
-
     m_xdimdpVars.x_dim = 0.0f;
     m_xdimdpVars.x_dim_units = 0;
     m_xdimdpVars.set = 0;
 
     load_sub_settings(settings, symbology);
 
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
+
     txtData->setFocus(Qt::OtherFocusReason);
     update_preview();
 }
@@ -972,7 +1024,7 @@
 {
     double originalScale = spnScale->value();
     QString originalSizeMsg = lblSizeMsg->text();
-    ScaleWindow dlg(&m_bc, &m_xdimdpVars);
+    ScaleWindow dlg(&m_bc, &m_xdimdpVars, originalScale);
     m_scaleWindow = &dlg;
     connect(&dlg, SIGNAL(scaleChanged(double)), this, SLOT(on_scaleChanged(double)));
     (void) dlg.exec();
@@ -989,45 +1041,45 @@
 
 void MainWindow::on_fgcolor_clicked()
 {
-    color_clicked(m_fgcolor, txt_fgcolor, fgcolor, tr("Set foreground colour"), m_fgcolor_geometry,
+    color_clicked(m_fgstr, txt_fgcolor, fgcolor, tr("Set foreground colour"), m_fgcolor_geometry,
                     SLOT(fgcolor_changed(const QColor&)));
 }
 
 void MainWindow::on_bgcolor_clicked()
 {
-    color_clicked(m_bgcolor, txt_bgcolor, bgcolor, tr("Set background colour"), m_bgcolor_geometry,
+    color_clicked(m_bgstr, txt_bgcolor, bgcolor, tr("Set background colour"), m_bgcolor_geometry,
                     SLOT(bgcolor_changed(const QColor&)));
 }
 
-void MainWindow::color_clicked(QColor &color, QLineEdit *txt, QPushButton *btn, const QString& title,
+void MainWindow::color_clicked(QString &colorStr, QLineEdit *txt, QPushButton *btn, const QString& title,
                                 QByteArray& geometry, const char *color_changed)
 {
-    QColor original = color;
+    QString original = colorStr;
 
     QColorDialog color_dialog(nullptr /*parent*/);
     color_dialog.setWindowTitle(title);
     color_dialog.setOptions(QColorDialog::DontUseNativeDialog | QColorDialog::ShowAlphaChannel);
-    color_dialog.setCurrentColor(color);
+    color_dialog.setCurrentColor(str_to_qcolor(colorStr));
     color_dialog.restoreGeometry(geometry);
     connect(&color_dialog, SIGNAL(currentColorChanged(const QColor &)), this, color_changed);
 
     if (color_dialog.exec() && color_dialog.selectedColor().isValid()) {
-        color = color_dialog.selectedColor();
+        colorStr = qcolor_to_str(color_dialog.selectedColor());
     } else {
-        color = original;
+        colorStr = original;
     }
     geometry = color_dialog.saveGeometry();
     disconnect(&color_dialog, SIGNAL(currentColorChanged(const QColor &)), this, color_changed);
 
-    setColorTxtBtn(color, txt, btn);
+    setColorTxtBtn(colorStr, txt, btn);
     update_preview();
 }
 
 void MainWindow::fgcolor_changed(const QColor& color)
 {
     if (color.isValid()) {
-        m_fgcolor = color;
-        setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
+        m_fgstr = qcolor_to_str(color);
+        setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
         update_preview();
     }
 }
@@ -1035,39 +1087,30 @@
 void MainWindow::bgcolor_changed(const QColor& color)
 {
     if (color.isValid()) {
-        m_bgcolor = color;
-        setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+        m_bgstr = qcolor_to_str(color);
+        setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
         update_preview();
     }
 }
 
 void MainWindow::fgcolor_edited()
 {
-    color_edited(m_fgcolor, txt_fgcolor, fgcolor);
+    color_edited(m_fgstr, txt_fgcolor, fgcolor);
 }
 
 void MainWindow::bgcolor_edited()
 {
-    color_edited(m_bgcolor, txt_bgcolor, bgcolor);
+    color_edited(m_bgstr, txt_bgcolor, bgcolor);
 }
 
-void MainWindow::color_edited(QColor &color, QLineEdit *txt, QPushButton *btn)
+void MainWindow::color_edited(QString &colorStr, QLineEdit *txt, QPushButton *btn)
 {
-    QColor new_color;
-    QString new_text = txt->text().trimmed();
-    if (new_text.indexOf(colorRE) != 0) {
-        return;
-    }
-    int r = new_text.mid(0, 2).toInt(nullptr, 16);
-    int g = new_text.mid(2, 2).toInt(nullptr, 16);
-    int b = new_text.mid(4, 2).toInt(nullptr, 16);
-    int a = new_text.length() == 8 ? new_text.mid(6, 2).toInt(nullptr, 16) : 0xFF;
-    new_color.setRgb(r, g, b, a);
-    if (!new_color.isValid()) {
+    QString new_str = txt->text().trimmed();
+    if (new_str.indexOf(colorRE) != 0) {
         return;
     }
-    color = new_color;
-    setColorTxtBtn(color, txt, btn);
+    colorStr = new_str;
+    setColorTxtBtn(colorStr, txt, btn);
     update_preview();
 }
 
@@ -1104,6 +1147,15 @@
     bool enabled = chkHRTShow->isEnabled() && chkHRTShow->isChecked();
     lblFontSetting->setEnabled(enabled);
     cmbFontSetting->setEnabled(enabled);
+    lblTextGap->setEnabled(enabled);
+    spnTextGap->setEnabled(enabled);
+    text_gap_ui_set();
+}
+
+void MainWindow::text_gap_ui_set()
+{
+    bool hrtEnabled = chkHRTShow->isEnabled() && chkHRTShow->isChecked();
+    btnClearTextGap->setEnabled(hrtEnabled && spnTextGap->value() != 0.0);
 }
 
 void MainWindow::dotty_ui_set()
@@ -1207,6 +1259,23 @@
     }
 }
 
+void MainWindow::text_gap_zero()
+{
+    // Make sure special text "Default" triggered as QDoubleSpinBox can return values almost but not quite zero
+    double val = spnTextGap->value();
+    if (val != 0.0 && val < 0.0001) {
+        spnTextGap->setValue(0.0);
+    }
+    text_gap_ui_set();
+}
+
+void MainWindow::clear_text_gap()
+{
+    spnTextGap->setValue(0.0);
+    spnTextGap->setFocus();
+    update_preview();
+}
+
 void MainWindow::on_encoded()
 {
     // Protect against encode in Sequence Export popup dialog
@@ -1535,8 +1604,8 @@
     m_btnHeightPerRowDisable = nullptr;
     m_btnHeightPerRowDefault = nullptr;
 
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
 
     m_xdimdpVars.x_dim = 0.0f;
     m_xdimdpVars.x_dim_units = 0;
@@ -1558,6 +1627,7 @@
         connect(get_widget(QSL("radC128EAN")), SIGNAL(toggled( bool )), SLOT(composite_ean_check()));
         connect(get_widget(QSL("radC128EAN")), SIGNAL(toggled( bool )), SLOT(update_preview()));
         connect(get_widget(QSL("radC128HIBC")), SIGNAL(toggled( bool )), SLOT(update_preview()));
+        connect(get_widget(QSL("radC128ExtraEsc")), SIGNAL(toggled( bool )), SLOT(update_preview()));
 
     } else if (symbology == BARCODE_PDF417) {
         QFile file(QSL(":/grpPDF417.ui"));
@@ -2092,9 +2162,10 @@
         file.close();
         load_sub_settings(settings, symbology);
         tabMain->insertTab(1, m_optionWidget, tr("UPC-&A"));
-        combobox_item_enabled(cmbFontSetting, 1, false);
-        if (cmbFontSetting->currentIndex() == 1) {
-            cmbFontSetting->setCurrentIndex(0);
+        combobox_item_enabled(cmbFontSetting, 1, false); // Disable bold options
+        combobox_item_enabled(cmbFontSetting, 3, false);
+        if (cmbFontSetting->currentIndex() == 1 || cmbFontSetting->currentIndex() == 3) {
+            cmbFontSetting->setCurrentIndex(cmbFontSetting->currentIndex() - 1);
         }
         connect(get_widget(QSL("cmbUPCAAddonGap")), SIGNAL(currentIndexChanged( int )), SLOT(update_preview()));
         connect(get_widget(QSL("spnUPCAGuardDescent")), SIGNAL(valueChanged( double )), SLOT(update_preview()));
@@ -2117,9 +2188,10 @@
         } else {
             tabMain->insertTab(1, m_optionWidget, tr("&EAN"));
         }
-        combobox_item_enabled(cmbFontSetting, 1, false);
-        if (cmbFontSetting->currentIndex() == 1) {
-            cmbFontSetting->setCurrentIndex(0);
+        combobox_item_enabled(cmbFontSetting, 1, false); // Disable bold options
+        combobox_item_enabled(cmbFontSetting, 3, false);
+        if (cmbFontSetting->currentIndex() == 1 || cmbFontSetting->currentIndex() == 3) {
+            cmbFontSetting->setCurrentIndex(cmbFontSetting->currentIndex() - 1);
         }
         connect(get_widget(QSL("cmbUPCEANAddonGap")), SIGNAL(currentIndexChanged( int )), SLOT(update_preview()));
         connect(get_widget(QSL("spnUPCEANGuardDescent")), SIGNAL(valueChanged( double )), SLOT(update_preview()));
@@ -2188,8 +2260,8 @@
     chkQuietZones->setEnabled(!m_bc.bc.hasDefaultQuietZones(symbology));
     chkDotty->setEnabled(m_bc.bc.isDotty(symbology));
 
-    setColorTxtBtn(m_fgcolor, txt_fgcolor, fgcolor);
-    setColorTxtBtn(m_bgcolor, txt_bgcolor, bgcolor);
+    setColorTxtBtn(m_fgstr, txt_fgcolor, fgcolor);
+    setColorTxtBtn(m_bgstr, txt_bgcolor, bgcolor);
 
     data_ui_set();
     composite_ui_set();
@@ -2502,6 +2574,8 @@
             m_bc.bc.setText(txtData->text());
         }
     }
+    btnReset->setEnabled((m_fgstr != fgDefault && m_fgstr != fgDefaultAlpha)
+                        || (m_bgstr != bgDefault && m_bgstr != bgDefaultAlpha));
     m_bc.bc.setOption1(-1);
     m_bc.bc.setOption2(0);
     m_bc.bc.setOption3(0);
@@ -2524,14 +2598,18 @@
     switch (symbology) {
 
         case BARCODE_CODE128:
-            if (get_rad_val(QSL("radC128CSup")))
+            if (get_rad_val(QSL("radC128CSup"))) {
                 m_bc.bc.setSymbol(BARCODE_CODE128AB);
-            else if (get_rad_val(QSL("radC128EAN")))
+            } else if (get_rad_val(QSL("radC128EAN"))) {
                 m_bc.bc.setSymbol(chkComposite->isChecked() ? BARCODE_GS1_128_CC : BARCODE_GS1_128);
-            else if (get_rad_val(QSL("radC128HIBC")))
+            } else if (get_rad_val(QSL("radC128HIBC"))) {
                 m_bc.bc.setSymbol(BARCODE_HIBC_128);
-            else
+            } else if (get_rad_val(QSL("radC128ExtraEsc"))) {
                 m_bc.bc.setSymbol(BARCODE_CODE128);
+                m_bc.bc.setInputMode(m_bc.bc.inputMode() | EXTRA_ESCAPE_MODE);
+            } else {
+                m_bc.bc.setSymbol(BARCODE_CODE128);
+            }
             break;
 
         case BARCODE_EANX:
@@ -3122,13 +3200,14 @@
     m_bc.bc.setVWhitespace(spnVWhitespace->value());
     m_bc.bc.setQuietZones(chkQuietZones->isEnabled() && chkQuietZones->isChecked());
     m_bc.bc.setFontSetting(cmbFontSetting->currentIndex());
+    m_bc.bc.setTextGap(spnTextGap->value());
     m_bc.bc.setRotateAngle(cmbRotate->currentIndex());
     m_bc.bc.setDotty(chkDotty->isEnabled() && chkDotty->isChecked());
     if (m_symbology == BARCODE_DOTCODE || (chkDotty->isEnabled() && chkDotty->isChecked())) {
         m_bc.bc.setDotSize(spnDotSize->value());
     }
-    m_bc.bc.setFgColor(m_fgcolor);
-    m_bc.bc.setBgColor(m_bgcolor);
+    m_bc.bc.setFgStr(m_fgstr);
+    m_bc.bc.setBgStr(m_bgstr);
     m_bc.bc.setScale((float) spnScale->value());
     change_cmyk();
     m_bc.setSize(width - 10, height - 10);
@@ -3153,7 +3232,7 @@
     btnMenu->setIcon(menuIcon);
     btnCopyBMP->setIcon(copyIcon);
     btnCopySVG->setIcon(copyIcon);
-    //btnSave->setIcon(saveIcon); // Makes it too big
+    btnSave->setIcon(saveIcon); // Makes it (too) big but live with it for a while after "Save As..." -> "Save..."
     btnExit->setIcon(quitIcon);
 
     m_copyBMPAct = new QAction(copyIcon, tr("Copy as &BMP"), this);
@@ -3220,7 +3299,7 @@
     m_helpAct->setShortcut(QKeySequence::HelpContents);
     connect(m_helpAct, SIGNAL(triggered()), this, SLOT(help()));
 
-    m_aboutAct = new QAction(aboutIcon, tr("&About"), this);
+    m_aboutAct = new QAction(aboutIcon, tr("&About..."), this);
     m_aboutAct->setStatusTip(tr("About Zint Barcode Studio"));
     connect(m_aboutAct, SIGNAL(triggered()), this, SLOT(about()));
 
@@ -3896,6 +3975,7 @@
         settings.setValue(QSL("studio/bc/%1/appearance/border_type").arg(name), btype->currentIndex());
         if (chkHRTShow->isEnabled()) {
             settings.setValue(QSL("studio/bc/%1/appearance/font_setting").arg(name), cmbFontSetting->currentIndex());
+            settings.setValue(QSL("studio/bc/%1/appearance/text_gap").arg(name), spnTextGap->value());
             settings.setValue(QSL("studio/bc/%1/appearance/chk_hrt_show").arg(name), chkHRTShow->isChecked() ? 1 : 0);
         }
         settings.setValue(QSL("studio/bc/%1/appearance/chk_cmyk").arg(name), chkCMYK->isChecked() ? 1 : 0);
@@ -3906,14 +3986,8 @@
             settings.setValue(QSL("studio/bc/%1/appearance/chk_dotty").arg(name), chkDotty->isChecked() ? 1 : 0);
             settings.setValue(QSL("studio/bc/%1/appearance/dot_size").arg(name), spnDotSize->value());
         }
-        settings.setValue(QSL("studio/bc/%1/ink/red").arg(name), m_fgcolor.red());
-        settings.setValue(QSL("studio/bc/%1/ink/green").arg(name), m_fgcolor.green());
-        settings.setValue(QSL("studio/bc/%1/ink/blue").arg(name), m_fgcolor.blue());
-        settings.setValue(QSL("studio/bc/%1/ink/alpha").arg(name), m_fgcolor.alpha());
-        settings.setValue(QSL("studio/bc/%1/paper/red").arg(name), m_bgcolor.red());
-        settings.setValue(QSL("studio/bc/%1/paper/green").arg(name), m_bgcolor.green());
-        settings.setValue(QSL("studio/bc/%1/paper/blue").arg(name), m_bgcolor.blue());
-        settings.setValue(QSL("studio/bc/%1/paper/alpha").arg(name), m_bgcolor.alpha());
+        settings.setValue(QSL("studio/bc/%1/ink/text").arg(name), m_fgstr);
+        settings.setValue(QSL("studio/bc/%1/paper/text").arg(name), m_bgstr);
         settings.setValue(QSL("studio/bc/%1/xdimdpvars/x_dim").arg(name), m_xdimdpVars.x_dim);
         settings.setValue(QSL("studio/bc/%1/xdimdpvars/x_dim_units").arg(name), m_xdimdpVars.x_dim_units);
         settings.setValue(QSL("studio/bc/%1/xdimdpvars/set").arg(name), m_xdimdpVars.set);
@@ -3927,7 +4001,7 @@
         case BARCODE_HIBC_128:
             settings.setValue(QSL("studio/bc/code128/encoding_mode"), get_rad_grp_index(
                 QStringList() << QSL("radC128Stand") << QSL("radC128EAN") << QSL("radC128CSup")
-                                << QSL("radC128HIBC")));
+                                << QSL("radC128HIBC") << QSL("radC128ExtraEsc")));
             break;
 
         case BARCODE_PDF417:
@@ -4079,7 +4153,8 @@
 
         case BARCODE_MAILMARK_2D:
             settings.setValue(QSL("studio/bc/mailmark2d/size"), get_cmb_index(QSL("cmbMailmark2DSize")));
-            settings.setValue(QSL("studio/bc/mailmark2d/chk_suppress_rect"), get_chk_val(QSL("chkMailmark2DRectangle")));
+            settings.setValue(
+                        QSL("studio/bc/mailmark2d/chk_suppress_rect"), get_chk_val(QSL("chkMailmark2DRectangle")));
             break;
 
         case BARCODE_ITF14:
@@ -4295,10 +4370,12 @@
         if (chkHRTShow->isEnabled()) {
             cmbFontSetting->setCurrentIndex(settings.value(
                 QSL("studio/bc/%1/appearance/font_setting").arg(name), 0).toInt());
+            spnTextGap->setValue(settings.value(QSL("studio/bc/%1/appearance/text_gap").arg(name), 0.0).toFloat());
             chkHRTShow->setChecked(settings.value(
                 QSL("studio/bc/%1/appearance/chk_hrt_show").arg(name), 1).toInt() ? true : false);
         }
-        chkCMYK->setChecked(settings.value(QSL("studio/bc/%1/appearance/cmyk").arg(name), 0).toInt() ? true : false);
+        chkCMYK->setChecked(settings.value(
+            QSL("studio/bc/%1/appearance/chk_cmyk").arg(name), 0).toInt() ? true : false);
         chkQuietZones->setChecked(settings.value(
             QSL("studio/bc/%1/appearance/chk_quietzones").arg(name), 0).toInt() ? true : false);
         cmbRotate->setCurrentIndex(settings.value(QSL("studio/bc/%1/appearance/rotate").arg(name), 0).toInt());
@@ -4308,15 +4385,28 @@
             spnDotSize->setValue(settings.value(
                 QSL("studio/bc/%1/appearance/dot_size").arg(name), 0.4f / 0.5f).toFloat());
         }
-        m_fgcolor.setRgb(settings.value(QSL("studio/bc/%1/ink/red").arg(name), 0).toInt(),
+        m_fgstr = settings.value(QSL("studio/bc/%1/ink/text").arg(name), QSL("")).toString();
+        if (m_fgstr.isEmpty()) {
+            QColor color(settings.value(QSL("studio/bc/%1/ink/red").arg(name), 0).toInt(),
                         settings.value(QSL("studio/bc/%1/ink/green").arg(name), 0).toInt(),
                         settings.value(QSL("studio/bc/%1/ink/blue").arg(name), 0).toInt(),
                         settings.value(QSL("studio/bc/%1/ink/alpha").arg(name), 0xff).toInt());
-        m_bgcolor.setRgb(settings.value(QSL("studio/bc/%1/paper/red").arg(name), 0xff).toInt(),
+            m_fgstr = qcolor_to_str(color);
+        }
+        if (m_fgstr.indexOf(colorRE) != 0) {
+            m_fgstr = fgDefault;
+        }
+        m_bgstr = settings.value(QSL("studio/bc/%1/paper/text").arg(name), QSL("")).toString();
+        if (m_bgstr.isEmpty()) {
+            QColor color(settings.value(QSL("studio/bc/%1/paper/red").arg(name), 0xff).toInt(),
                         settings.value(QSL("studio/bc/%1/paper/green").arg(name), 0xff).toInt(),
                         settings.value(QSL("studio/bc/%1/paper/blue").arg(name), 0xff).toInt(),
                         settings.value(QSL("studio/bc/%1/paper/alpha").arg(name), 0xff).toInt());
-
+            m_bgstr = qcolor_to_str(color);
+        }
+        if (m_bgstr.indexOf(colorRE) != 0) {
+            m_bgstr = bgDefault;
+        }
         m_xdimdpVars.x_dim = settings.value(QSL("studio/bc/%1/xdimdpvars/x_dim").arg(name), 0.0).toFloat();
         m_xdimdpVars.x_dim_units = settings.value(QSL("studio/bc/%1/xdimdpvars/x_dim_units").arg(name), 0).toInt();
         m_xdimdpVars.set = settings.value(QSL("studio/bc/%1/xdimdpvars/set").arg(name), 0).toInt();
@@ -4334,7 +4424,7 @@
         case BARCODE_HIBC_128:
             set_rad_from_setting(settings, QSL("studio/bc/code128/encoding_mode"),
                 QStringList() << QSL("radC128Stand") << QSL("radC128EAN") << QSL("radC128CSup")
-                                << QSL("radC128HIBC"));
+                                << QSL("radC128HIBC") << QSL("radC128ExtraEsc"));
             break;
 
         case BARCODE_PDF417:
@@ -4491,7 +4581,8 @@
 
         case BARCODE_MAILMARK_2D:
             set_cmb_from_setting(settings, QSL("studio/bc/mailmark2d/size"), QSL("cmbMailmark2DSize"));
-            set_chk_from_setting(settings, QSL("studio/bc/mailmark2d/chk_suppress_rect"), QSL("chkMailmark2DRectangle"));
+            set_chk_from_setting(settings, QSL("studio/bc/mailmark2d/chk_suppress_rect"),
+                                            QSL("chkMailmark2DRectangle"));
             break;
 
         case BARCODE_ITF14:
diff -urN zint-2.12.0/frontend_qt/mainwindow.h zint/frontend_qt/mainwindow.h
--- zint-2.12.0/frontend_qt/mainwindow.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/mainwindow.h	2023-05-08 14:39:45.004320189 +0200
@@ -1,6 +1,6 @@
 /***************************************************************************
  *   Copyright (C) 2008 by BogDan Vatra <bogdan@licentia.eu>               *
- *   Copyright (C) 2009-2022 by Robin Stuart <rstuart114@gmail.com>        *
+ *   Copyright (C) 2009-2023 by Robin Stuart <rstuart114@gmail.com>        *
  *                                                                         *
  *   This program is free software: you can redistribute it and/or modify  *
  *   it under the terms of the GNU General Public License as published by  *
@@ -69,9 +69,12 @@
     void change_cmyk();
     void autoheight_ui_set();
     void HRTShow_ui_set();
+    void text_gap_ui_set();
     void dotty_ui_set();
     void codeone_ui_set();
     void structapp_ui_set();
+    void text_gap_zero();
+    void clear_text_gap();
     void on_encoded();
     void on_errored();
     void on_dataChanged(const QString& text, bool escaped, int seg_no);
@@ -129,11 +132,10 @@
 
     bool clear_data_eci_seg(int seg_no);
 
-    void color_clicked(QColor &color, QLineEdit *txt, QPushButton *btn, const QString& title, QByteArray& geometry,
-            const char *color_changed);
-    void color_edited(QColor &color, QLineEdit *txt, QPushButton *btn);
-    QString getColorStr(const QColor color, bool alpha_always = false);
-    void setColorTxtBtn(const QColor color, QLineEdit *txt, QPushButton* btn);
+    void color_clicked(QString &colorStr, QLineEdit *txt, QPushButton *btn, const QString& title,
+            QByteArray& geometry, const char *color_changed);
+    void color_edited(QString &colorStr, QLineEdit *txt, QPushButton *btn);
+    void setColorTxtBtn(const QString &colorStr, QLineEdit *txt, QPushButton* btn);
 
     virtual void resizeEvent(QResizeEvent *event) override;
     virtual bool event(QEvent *event) override;
@@ -201,7 +203,7 @@
     const char *getFileType(const struct Zint::QZintXdimDpVars *vars, bool msg = false) const;
 
 private:
-    QColor m_fgcolor, m_bgcolor;
+    QString m_fgstr, m_bgstr;
     QByteArray m_fgcolor_geometry, m_bgcolor_geometry;
     BarcodeItem m_bc;
     QWidget *m_optionWidget;
diff -urN zint-2.12.0/frontend_qt/mainWindow.ui zint/frontend_qt/mainWindow.ui
--- zint-2.12.0/frontend_qt/mainWindow.ui	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/mainWindow.ui	2023-05-08 14:39:45.002320177 +0200
@@ -178,7 +178,7 @@
                   <property name="minimumSize">
                    <size>
                     <width>0</width>
-                    <height>24</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -195,7 +195,7 @@
                   <property name="maximumSize">
                    <size>
                     <width>22</width>
-                    <height>16777215</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -468,7 +468,7 @@
                   <property name="maximumSize">
                    <size>
                     <width>22</width>
-                    <height>16777215</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -626,7 +626,7 @@
                     <property name="maximumSize">
                      <size>
                       <width>22</width>
-                      <height>16777215</height>
+                      <height>26</height>
                      </size>
                     </property>
                     <property name="toolTip">
@@ -929,7 +929,7 @@
                   <property name="minimumSize">
                    <size>
                     <width>0</width>
-                    <height>24</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -946,7 +946,7 @@
                   <property name="maximumSize">
                    <size>
                     <width>22</width>
-                    <height>16777215</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -1190,7 +1190,7 @@
                   <property name="minimumSize">
                    <size>
                     <width>0</width>
-                    <height>24</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -1207,7 +1207,7 @@
                   <property name="maximumSize">
                    <size>
                     <width>22</width>
-                    <height>16777215</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -1451,7 +1451,7 @@
                   <property name="minimumSize">
                    <size>
                     <width>0</width>
-                    <height>24</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -1468,7 +1468,7 @@
                   <property name="maximumSize">
                    <size>
                     <width>22</width>
-                    <height>16777215</height>
+                    <height>26</height>
                    </size>
                   </property>
                   <property name="toolTip">
@@ -1530,6 +1530,7 @@
 &lt;tr&gt;&lt;td&gt;\R&amp;nbsp;&lt;/td&gt;&lt;td&gt;Record Separator (0x1E)&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;\\&amp;nbsp;&lt;/td&gt;&lt;td&gt;Backslash (0x5C)&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;\dNNN&amp;nbsp;&lt;/td&gt;&lt;td&gt;8-bit character (N decimal)&lt;/td&gt;&lt;/tr&gt;
+&lt;tr&gt;&lt;td&gt;\oNNN&amp;nbsp;&lt;/td&gt;&lt;td&gt;8-bit character (N octal)&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;\xNN&amp;nbsp;&lt;/td&gt;&lt;td&gt;8-bit character (N hex)&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;\uNNNN&amp;nbsp;&lt;/td&gt;&lt;td&gt;16-bit Unicode BMP (N hex)&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;\UNNNNNN&amp;nbsp;&lt;/td&gt;&lt;td&gt;21-bit Unicode (N hex)&lt;/td&gt;&lt;/tr&gt;
@@ -1692,41 +1693,6 @@
               </widget>
              </item>
              <item row="2" column="0">
-              <widget class="QLabel" name="lblBorderWidth">
-               <property name="toolTip">
-                <string>Width of boundary bars or border in X-dimensions</string>
-               </property>
-               <property name="text">
-                <string>B&amp;order Width:</string>
-               </property>
-               <property name="alignment">
-                <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
-               </property>
-               <property name="buddy">
-                <cstring>bwidth</cstring>
-               </property>
-              </widget>
-             </item>
-             <item row="2" column="1" colspan="2">
-              <widget class="QSpinBox" name="bwidth">
-               <property name="toolTip">
-                <string>Width of boundary bars or border in X-dimensions</string>
-               </property>
-               <property name="suffix">
-                <string> X</string>
-               </property>
-               <property name="minimum">
-                <number>0</number>
-               </property>
-               <property name="maximum">
-                <number>16</number>
-               </property>
-               <property name="value">
-                <number>0</number>
-               </property>
-              </widget>
-             </item>
-             <item row="3" column="0">
               <widget class="QLabel" name="lblBorderType">
                <property name="toolTip">
                 <string>Add border or box</string>
@@ -1742,7 +1708,7 @@
                </property>
               </widget>
              </item>
-             <item row="3" column="1" colspan="2">
+             <item row="2" column="1" colspan="2">
               <widget class="QComboBox" name="btype">
                <property name="toolTip">
                 <string>Add border or box</string>
@@ -1772,6 +1738,41 @@
                </item>
               </widget>
              </item>
+             <item row="3" column="0">
+              <widget class="QLabel" name="lblBorderWidth">
+               <property name="toolTip">
+                <string>Width of boundary bars or border in X-dimensions</string>
+               </property>
+               <property name="text">
+                <string>B&amp;order Width:</string>
+               </property>
+               <property name="alignment">
+                <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
+               </property>
+               <property name="buddy">
+                <cstring>bwidth</cstring>
+               </property>
+              </widget>
+             </item>
+             <item row="3" column="1" colspan="2">
+              <widget class="QSpinBox" name="bwidth">
+               <property name="toolTip">
+                <string>Width of boundary bars or border in X-dimensions</string>
+               </property>
+               <property name="suffix">
+                <string> X</string>
+               </property>
+               <property name="minimum">
+                <number>0</number>
+               </property>
+               <property name="maximum">
+                <number>16</number>
+               </property>
+               <property name="value">
+                <number>0</number>
+               </property>
+              </widget>
+             </item>
              <item row="4" column="0">
               <widget class="QLabel" name="lblWhitespace">
                <property name="toolTip">
@@ -1793,8 +1794,8 @@
                <item row="0" column="0">
                 <widget class="QSpinBox" name="spnWhitespace">
                  <property name="toolTip">
-                  <string>Width of horizontal whitespace on either side of barcode
-in X-dimensions</string>
+                  <string>Width of horizontal whitespace on either side
+of barcode in X-dimensions</string>
                  </property>
                  <property name="suffix">
                   <string> X</string>
@@ -1807,8 +1808,8 @@
                <item row="0" column="1">
                 <widget class="QSpinBox" name="spnVWhitespace">
                  <property name="toolTip">
-                  <string>Height of vertical whitespace above and below the barcode
-in X-dimensions</string>
+                  <string>Height of vertical whitespace above and below
+the barcode in X-dimensions</string>
                  </property>
                  <property name="suffix">
                   <string> X</string>
@@ -1820,7 +1821,129 @@
                </item>
               </layout>
              </item>
-             <item row="5" column="0">
+             <item row="5" column="0" colspan="2">
+              <widget class="QCheckBox" name="chkHRTShow">
+               <property name="toolTip">
+                <string>Show Human Readable Text in image
+(ignored if disabled)</string>
+               </property>
+               <property name="text">
+                <string>Show Te&amp;xt</string>
+               </property>
+               <property name="checked">
+                <bool>true</bool>
+               </property>
+              </widget>
+             </item>
+             <item row="6" column="0">
+              <widget class="QLabel" name="lblFontSetting">
+               <property name="toolTip">
+                <string>Set font characteristics
+(ignored if disabled)</string>
+               </property>
+               <property name="text">
+                <string>Fo&amp;nt Setting:</string>
+               </property>
+               <property name="alignment">
+                <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
+               </property>
+               <property name="buddy">
+                <cstring>cmbFontSetting</cstring>
+               </property>
+              </widget>
+             </item>
+             <item row="6" column="1" colspan="2">
+              <widget class="QComboBox" name="cmbFontSetting">
+               <property name="toolTip">
+                <string>Set font characteristics
+(ignored if disabled)</string>
+               </property>
+               <item>
+                <property name="text">
+                 <string>Normal</string>
+                </property>
+               </item>
+               <item>
+                <property name="text">
+                 <string>Bold</string>
+                </property>
+               </item>
+               <item>
+                <property name="text">
+                 <string>Small</string>
+                </property>
+               </item>
+               <item>
+                <property name="text">
+                 <string>Small Bold (vector only)</string>
+                </property>
+               </item>
+              </widget>
+             </item>
+             <item row="7" column="0">
+              <widget class="QLabel" name="lblTextGap">
+               <property name="toolTip">
+                <string>Gap between barcode and text
+(ignored if disabled)</string>
+               </property>
+               <property name="text">
+                <string>Text Gap:</string>
+               </property>
+               <property name="alignment">
+                <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
+               </property>
+               <property name="buddy">
+                <cstring>spnTextGap</cstring>
+               </property>
+              </widget>
+             </item>
+             <item row="7" column="1">
+              <widget class="QDoubleSpinBox" name="spnTextGap">
+               <property name="toolTip">
+                <string>Gap between barcode and text
+(ignored if disabled)</string>
+               </property>
+               <property name="suffix">
+                <string> X</string>
+                <string/>
+               </property>
+               <property name="decimals">
+                <number>2</number>
+               </property>
+               <property name="minimum">
+                <double>0.000000000000000</double>
+               </property>
+               <property name="maximum">
+                <double>5.000000000000000</double>
+               </property>
+               <property name="singleStep">
+                <double>0.100000000000000</double>
+               </property>
+               <property name="value">
+                <double>0.000000000000000</double>
+               </property>
+               <property name="specialValueText">
+                <string>Default</string>
+               </property>
+              </widget>
+             </item>
+             <item row="7" column="2">
+              <widget class="QPushButton" name="btnClearTextGap">
+               <property name="maximumSize">
+                <size>
+                 <width>22</width>
+                 <height>26</height>
+                </size>
+               </property>
+               <property name="toolTip">
+                <string>Set text gap to zero (default)</string>
+               </property>
+               <property name="text">
+                <string/>
+               </property>
+              </widget>
+             </item>
+             <item row="8" column="0">
               <widget class="QLabel" name="lblScale">
                <property name="toolTip">
                 <string>Image scale when output to file
@@ -1837,7 +1960,7 @@
                </property>
               </widget>
              </item>
-             <item row="5" column="1">
+             <item row="8" column="1">
               <widget class="QDoubleSpinBox" name="spnScale">
                <property name="toolTip">
                 <string>Image scale when output to file
@@ -1863,12 +1986,12 @@
                </property>
               </widget>
              </item>
-             <item row="5" column="2">
+             <item row="8" column="2">
               <widget class="QPushButton" name="btnScale">
                <property name="maximumSize">
                 <size>
                  <width>22</width>
-                 <height>16777215</height>
+                 <height>26</height>
                 </size>
                </property>
                <property name="toolTip">
@@ -1879,10 +2002,11 @@
                </property>
               </widget>
              </item>
-             <item row="6" column="0">
+             <item row="9" column="0">
               <widget class="QLabel" name="lblSize">
                <property name="toolTip">
-                <string>Image size (width x height) of barcode at given dot density</string>
+                <string>Image size (width x height) of barcode
+at given dot density</string>
                </property>
                <property name="text">
                 <string>Print Size:</string>
@@ -1892,75 +2016,17 @@
                </property>
               </widget>
              </item>
-             <item row="6" column="1" colspan="5">
+             <item row="9" column="1" colspan="5">
               <widget class="QLabel" name="lblSizeMsg">
                <property name="toolTip">
-                <string>Image size (width x height) of barcode at given dot density</string>
+                <string>Image size (width x height) of barcode
+at given dot density</string>
                </property>
                <property name="text">
                 <string/>
                </property>
               </widget>
              </item>
-             <item row="7" column="0">
-              <widget class="QLabel" name="lblFontSetting">
-               <property name="toolTip">
-                <string>Set font characteristics
-(ignored if disabled)</string>
-               </property>
-               <property name="text">
-                <string>Fo&amp;nt Setting:</string>
-               </property>
-               <property name="alignment">
-                <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>
-               </property>
-               <property name="buddy">
-                <cstring>cmbFontSetting</cstring>
-               </property>
-              </widget>
-             </item>
-             <item row="7" column="1" colspan="2">
-              <widget class="QComboBox" name="cmbFontSetting">
-               <property name="toolTip">
-                <string>Set font characteristics
-(ignored if disabled)</string>
-               </property>
-               <item>
-                <property name="text">
-                 <string>Normal</string>
-                </property>
-               </item>
-               <item>
-                <property name="text">
-                 <string>Bold</string>
-                </property>
-               </item>
-               <item>
-                <property name="text">
-                 <string>Small</string>
-                </property>
-               </item>
-               <item>
-                <property name="text">
-                 <string>Small Bold (vector only)</string>
-                </property>
-               </item>
-              </widget>
-             </item>
-             <item row="8" column="0" colspan="2">
-              <widget class="QCheckBox" name="chkHRTShow">
-               <property name="toolTip">
-                <string>Show Human Readable Text in image
-(ignored if disabled)</string>
-               </property>
-               <property name="text">
-                <string>Show Te&amp;xt</string>
-               </property>
-               <property name="checked">
-                <bool>true</bool>
-               </property>
-              </widget>
-             </item>
              <item row="0" column="3">
               <widget class="QLabel" name="label_fgcolor">
                <property name="enabled">
@@ -1989,12 +2055,12 @@
                 </size>
                </property>
                <property name="toolTip">
-                <string>Change ink colour, format
-is hexadecimal &quot;RRGGBB&quot;
-or &quot;RRGGBBAA&quot; (alpha)</string>
+                <string>Change ink colour, format is
+hexadecimal &quot;RRGGBB&quot; or &quot;RRGGBBAA&quot; (alpha)
+or decimal &quot;C,M,Y,K&quot; percentages (0-100)</string>
                </property>
                <property name="maxLength">
-                <number>8</number>
+                <number>15</number>
                </property>
               </widget>
              </item>
@@ -2003,7 +2069,7 @@
                <property name="maximumSize">
                 <size>
                  <width>22</width>
-                 <height>16777215</height>
+                 <height>26</height>
                 </size>
                </property>
                <property name="toolTip">
@@ -2042,12 +2108,14 @@
                 </size>
                </property>
                <property name="toolTip">
-                <string>Change paper colour, format
-is hexadecimal &quot;RRGGBB&quot;
-or &quot;RRGGBBAA&quot; (alpha)</string>
+                <string>Change paper colour, format is
+hexadecimal &quot;RRGGBB&quot; or &quot;RRGGBBAA&quot; (alpha)
+or decimal &quot;C,M,Y,K&quot; percentages (0-100).
+For no background, set alpha channel to zero,
+e.g. &quot;FFFFFF00&quot;</string>
                </property>
                <property name="maxLength">
-                <number>8</number>
+                <number>15</number>
                </property>
               </widget>
              </item>
@@ -2056,7 +2124,7 @@
                <property name="maximumSize">
                 <size>
                  <width>22</width>
-                 <height>16777215</height>
+                 <height>26</height>
                 </size>
                </property>
                <property name="toolTip">
@@ -2107,7 +2175,7 @@
                <property name="maximumSize">
                 <size>
                  <width>22</width>
-                 <height>16777215</height>
+                 <height>26</height>
                 </size>
                </property>
                <property name="toolTip">
@@ -2189,7 +2257,7 @@
                </item>
               </widget>
              </item>
-             <item row="7" column="4" colspan="2">
+             <item row="6" column="4" colspan="2">
               <widget class="QCheckBox" name="chkDotty">
                <property name="toolTip">
                 <string>Use dots instead of squares for matrix symbols
@@ -2203,7 +2271,7 @@
                </property>
               </widget>
              </item>
-             <item row="8" column="3">
+             <item row="7" column="3">
               <widget class="QLabel" name="lblDotSize">
                <property name="enabled">
                 <bool>false</bool>
@@ -2223,7 +2291,7 @@
                </property>
               </widget>
              </item>
-             <item row="8" column="4" colspan="2">
+             <item row="7" column="4" colspan="2">
               <widget class="QDoubleSpinBox" name="spnDotSize">
                <property name="enabled">
                 <bool>false</bool>
@@ -2283,7 +2351,7 @@
         <string>Show menu</string>
        </property>
        <property name="text">
-        <string>Men&amp;u</string>
+        <string> Men&amp;u</string>
        </property>
       </widget>
      </item>
@@ -2326,7 +2394,7 @@
         <string>Output image to file (BMP/EMF/EPS/GIF/PCX/PNG/SVG/TIF)</string>
        </property>
        <property name="text">
-        <string>&amp;Save Asâ¦</string>
+        <string> &amp;Save...</string>
        </property>
       </widget>
      </item>
@@ -2336,7 +2404,7 @@
         <string>Exit Zint Barcode Studio</string>
        </property>
        <property name="text">
-        <string>&amp;Quit</string>
+        <string> &amp;Quit</string>
        </property>
       </widget>
      </item>
diff -urN zint-2.12.0/frontend_qt/res/qtZint.rc zint/frontend_qt/res/qtZint.rc
--- zint-2.12.0/frontend_qt/res/qtZint.rc	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/res/qtZint.rc	2023-05-08 14:39:45.004320189 +0200
@@ -5,8 +5,8 @@
 #include <winver.h>
 
 
-#define VER_FILEVERSION        2,12,0,0
-#define VER_FILEVERSION_STR    "2.12.0.0\0"
+#define VER_FILEVERSION        2,12,0,9
+#define VER_FILEVERSION_STR    "2.12.0.9\0"
 
 #ifdef GCC_WINDRES
 
diff -urN zint-2.12.0/frontend_qt/scalewindow.cpp zint/frontend_qt/scalewindow.cpp
--- zint-2.12.0/frontend_qt/scalewindow.cpp	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/scalewindow.cpp	2023-05-08 14:39:45.004320189 +0200
@@ -1,6 +1,6 @@
 /*
     Zint Barcode Generator - the open source barcode generator
-    Copyright (C) 2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2022-2023 Robin Stuart <rstuart114@gmail.com>
 
     This program is free software; you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
@@ -44,8 +44,8 @@
     return 0;
 }
 
-ScaleWindow::ScaleWindow(BarcodeItem *bc, Zint::QZintXdimDpVars *vars)
-        : m_bc(bc), Valid(false), m_vars(*vars)
+ScaleWindow::ScaleWindow(BarcodeItem *bc, Zint::QZintXdimDpVars *vars, double originalScale)
+        : m_bc(bc), Valid(false), m_vars(*vars), m_originalScale(originalScale), m_unset(false)
 {
     setupUi(this);
 
@@ -90,11 +90,15 @@
     size_msg_ui_set();
 
     QIcon closeIcon(QIcon::fromTheme(QSL("window-close"), QIcon(QSL(":res/x.svg"))));
+    QIcon unsetIcon(QSL(":res/delete.svg"));
     QIcon okIcon(QIcon(QSL(":res/check.svg")));
     btnCancel->setIcon(closeIcon);
+    btnScaleUnset->setIcon(unsetIcon);
+    btnScaleUnset->setEnabled(m_vars.set);
     btnOK->setIcon(okIcon);
 
     connect(btnCancel, SIGNAL(clicked( bool )), SLOT(close()));
+    connect(btnScaleUnset, SIGNAL( clicked( bool )), SLOT(unset_scale()));
     connect(btnOK, SIGNAL(clicked( bool )), SLOT(okay()));
     connect(spnXdim, SIGNAL(valueChanged( double )), SLOT(update_scale()));
     connect(cmbXdimUnits, SIGNAL(currentIndexChanged( int )), SLOT(x_dim_units_change()));
@@ -143,11 +147,25 @@
     }
 }
 
+void ScaleWindow::unset_scale()
+{
+    m_vars.x_dim = m_bc->bc.getXdimDpFromScale(m_originalScale, get_dpmm(), getFileType());
+    m_vars.set = 0;
+
+    if (cmbXdimUnits->currentIndex() == 1) { // Inches
+        spnXdim->setValue(m_vars.x_dim / 25.4);
+    } else {
+        spnXdim->setValue(m_vars.x_dim);
+    }
+    m_unset = true;
+    btnScaleUnset->setEnabled(false);
+}
+
 void ScaleWindow::okay()
 {
     if (update_vars()) {
         Valid = true;
-        m_vars.set = 1;
+        m_vars.set = m_unset ? 0 : 1;
     }
     close();
 }
@@ -159,6 +177,8 @@
         // Need up-to-date `vectorWidth()` and `vectorHeight()` to estimate size including borders, whitespace & text,
         // so tell main window to encode and it will update UI here via `size_msg_ui_set()`
         emit scaleChanged(scale);
+        m_unset = false;
+        btnScaleUnset->setEnabled(true);
     }
 }
 
diff -urN zint-2.12.0/frontend_qt/scalewindow.h zint/frontend_qt/scalewindow.h
--- zint-2.12.0/frontend_qt/scalewindow.h	2022-12-12 22:06:08.000000000 +0100
+++ zint/frontend_qt/scalewindow.h	2023-05-08 14:39:45.005320195 +0200
@@ -1,6 +1,6 @@
 /*
     Zint Barcode Generator - the open source barcode generator
-    Copyright (C) 2022 Robin Stuart <rstuart114@gmail.com>
+    Copyright (C) 2022-2023 Robin Stuart <rstuart114@gmail.com>
 
     This program is free software; you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
@@ -32,7 +32,7 @@
     BarcodeItem *m_bc;
 
 public:
-    ScaleWindow(BarcodeItem *bc, struct Zint::QZintXdimDpVars *vars);
+    ScaleWindow(BarcodeItem *bc, struct Zint::QZintXdimDpVars *vars, double originalScale);
     ~ScaleWindow();
 
     bool Valid;
@@ -45,6 +45,7 @@
 public slots:
     void size_msg_ui_set();
 private slots:
+    void unset_scale();
     void okay();
     void update_scale();
     void x_dim_units_change();
@@ -57,6 +58,8 @@
     float get_dpmm() const;
     const char *getFileType() const;
     double update_vars();
+    double m_originalScale;
+    bool m_unset;
 };
 
 /* vim: set ts=4 sw=4 et : */
diff -urN zint-2.12.0/win32/libzint.vcxproj zint/win32/libzint.vcxproj
--- zint-2.12.0/win32/libzint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/libzint.vcxproj	2023-05-08 14:39:45.006320201 +0200
@@ -57,7 +57,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\zlib\;..\..\lpng\;..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -91,7 +91,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\zlib\;..\..\lpng\;..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>
diff -urN zint-2.12.0/win32/vs2008/libzint.vcproj zint/win32/vs2008/libzint.vcproj
--- zint-2.12.0/win32/vs2008/libzint.vcproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2008/libzint.vcproj	2023-05-08 14:39:45.006320201 +0200
@@ -42,7 +42,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="..\..\..\lpng;..\..\..\zlib"
-				PreprocessorDefinitions="WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG"
+				PreprocessorDefinitions="WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG"
 				MinimalRebuild="true"
 				ExceptionHandling="0"
 				BasicRuntimeChecks="3"
@@ -127,7 +127,7 @@
 				Optimization="2"
 				EnableIntrinsicFunctions="false"
 				AdditionalIncludeDirectories="..\..\..\lpng;..\..\..\zlib"
-				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL"
+				PreprocessorDefinitions="WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL"
 				StringPooling="true"
 				ExceptionHandling="0"
 				RuntimeLibrary="2"
@@ -212,7 +212,7 @@
 				Optimization="2"
 				EnableIntrinsicFunctions="false"
 				AdditionalIncludeDirectories="d:\opt\include"
-				PreprocessorDefinitions="WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;"
+				PreprocessorDefinitions="WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;"
 				StringPooling="true"
 				ExceptionHandling="0"
 				RuntimeLibrary="2"
diff -urN zint-2.12.0/win32/vs2008/zint.vcproj zint/win32/vs2008/zint.vcproj
--- zint-2.12.0/win32/vs2008/zint.vcproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2008/zint.vcproj	2023-05-08 14:39:45.006320201 +0200
@@ -42,7 +42,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="..\backend"
-				PreprocessorDefinitions="WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;;ZINT_DLL"
+				PreprocessorDefinitions="WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;;ZINT_DLL"
 				MinimalRebuild="true"
 				ExceptionHandling="0"
 				BasicRuntimeChecks="3"
@@ -115,7 +115,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="2"
 				AdditionalIncludeDirectories="..\backend"
-				PreprocessorDefinitions="WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;;ZINT_DLL"
+				PreprocessorDefinitions="WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;;ZINT_DLL"
 				StringPooling="true"
 				ExceptionHandling="0"
 				RuntimeLibrary="0"
@@ -187,7 +187,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="2"
 				AdditionalIncludeDirectories="..\backend"
-				PreprocessorDefinitions="WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0\&quot;&quot;"
+				PreprocessorDefinitions="WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION=&quot;\&quot;2.12.0.9\&quot;&quot;"
 				StringPooling="true"
 				ExceptionHandling="0"
 				RuntimeLibrary="2"
diff -urN zint-2.12.0/win32/vs2015/libzint.vcxproj zint/win32/vs2015/libzint.vcxproj
--- zint-2.12.0/win32/vs2015/libzint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2015/libzint.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -117,7 +117,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_NO_PNG;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_NO_PNG;BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -149,7 +149,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>ZINT_NO_PNG;WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>ZINT_NO_PNG;WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <ExceptionHandling>
       </ExceptionHandling>
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -182,7 +182,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;ZINT_NO_PNG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;ZLIB_DLL;PNG_DLL;ZINT_NO_PNG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>
@@ -215,7 +215,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;ZINT_NO_PNG;ZLIB_DLL;PNG_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;ZINT_NO_PNG;ZLIB_DLL;PNG_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling>
       </ExceptionHandling>
@@ -250,7 +250,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>
@@ -273,7 +273,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling>
       </ExceptionHandling>
diff -urN zint-2.12.0/win32/vs2015/vsx/libzintMD.vcxproj zint/win32/vs2015/vsx/libzintMD.vcxproj
--- zint-2.12.0/win32/vs2015/vsx/libzintMD.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2015/vsx/libzintMD.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -39,7 +39,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>true</IntrinsicFunctions>
       <AdditionalIncludeDirectories>d:\opt1\include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_NO_PNG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_LIB;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_NO_PNG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling>
       </ExceptionHandling>
diff -urN zint-2.12.0/win32/vs2015/zint.vcxproj zint/win32/vs2015/zint.vcxproj
--- zint-2.12.0/win32/vs2015/zint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2015/zint.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -108,7 +108,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -127,7 +127,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <ExceptionHandling>
       </ExceptionHandling>
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -147,7 +147,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
@@ -165,7 +165,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling>
       </ExceptionHandling>
@@ -186,7 +186,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>
@@ -205,7 +205,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling>
       </ExceptionHandling>
diff -urN zint-2.12.0/win32/vs2019/libzint.vcxproj zint/win32/vs2019/libzint.vcxproj
--- zint-2.12.0/win32/vs2019/libzint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2019/libzint.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -57,7 +57,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -91,7 +91,7 @@
       <Optimization>MaxSpeed</Optimization>
       <IntrinsicFunctions>false</IntrinsicFunctions>
       <AdditionalIncludeDirectories>..\..\..\zlib\;..\..\..\lpng\;..\..\..\lpng\build;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";BUILD_ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";BUILD_ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>
diff -urN zint-2.12.0/win32/vs2019/zint.vcxproj zint/win32/vs2019/zint.vcxproj
--- zint-2.12.0/win32/vs2019/zint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/vs2019/zint.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -53,7 +53,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -72,7 +72,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
diff -urN zint-2.12.0/win32/zint_cmdline_vc6/zint_cmdline_vc6.dsp zint/win32/zint_cmdline_vc6/zint_cmdline_vc6.dsp
--- zint-2.12.0/win32/zint_cmdline_vc6/zint_cmdline_vc6.dsp	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/zint_cmdline_vc6/zint_cmdline_vc6.dsp	2023-05-08 14:39:45.008320212 +0200
@@ -42,7 +42,7 @@
 # PROP Ignore_Export_Lib 0
 # PROP Target_Dir ""
 # ADD BASE CPP /nologo /W3 /GX /O2 /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /c
-# ADD CPP /nologo /MD /W3 /GX /O2 /I "..\..\backend" /I "..\..\..\zlib" /I "..\..\..\lpng" /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /D ZINT_VERSION="\"2.12.0\"" /c
+# ADD CPP /nologo /MD /W3 /GX /O2 /I "..\..\backend" /I "..\..\..\zlib" /I "..\..\..\lpng" /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /D ZINT_VERSION="\"2.12.0.9\"" /c
 # ADD BASE RSC /l 0x407 /d "NDEBUG"
 # ADD RSC /l 0x407 /d "NDEBUG"
 BSC32=bscmake.exe
@@ -66,7 +66,7 @@
 # PROP Ignore_Export_Lib 0
 # PROP Target_Dir ""
 # ADD BASE CPP /nologo /W3 /Gm /GX /ZI /Od /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /GZ /c
-# ADD CPP /nologo /MTd /W3 /Gm /GX /ZI /Od /I "..\..\backend" /I "..\..\..\lpng" /I "..\..\..\zlib" /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_MBCS" /D "ZINT_NO_PNG" /D "DEBUG" /YX /FD /GZ /D ZINT_VERSION="\"2.12.0\"" /c
+# ADD CPP /nologo /MTd /W3 /Gm /GX /ZI /Od /I "..\..\backend" /I "..\..\..\lpng" /I "..\..\..\zlib" /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_MBCS" /D "ZINT_NO_PNG" /D "DEBUG" /YX /FD /GZ /D ZINT_VERSION="\"2.12.0.9\"" /c
 # ADD BASE RSC /l 0x407 /d "_DEBUG"
 # ADD RSC /l 0x407 /d "_DEBUG"
 BSC32=bscmake.exe
diff -urN zint-2.12.0/win32/zint_cmdline_vc6/zint.rc zint/win32/zint_cmdline_vc6/zint.rc
--- zint-2.12.0/win32/zint_cmdline_vc6/zint.rc	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/zint_cmdline_vc6/zint.rc	2023-05-08 14:39:45.007320207 +0200
@@ -30,8 +30,8 @@
 // Version
 //
 
-#define VER_FILEVERSION        2,12,0,0
-#define VER_FILEVERSION_STR    "2.12.0.0\0"
+#define VER_FILEVERSION        2,12,0,9
+#define VER_FILEVERSION_STR    "2.12.0.9\0"
 
 VS_VERSION_INFO VERSIONINFO
  FILEVERSION VER_FILEVERSION
diff -urN zint-2.12.0/win32/zint.vcxproj zint/win32/zint.vcxproj
--- zint-2.12.0/win32/zint.vcxproj	2022-12-12 22:06:08.000000000 +0100
+++ zint/win32/zint.vcxproj	2023-05-08 14:39:45.007320207 +0200
@@ -53,7 +53,7 @@
     <ClCompile>
       <Optimization>Disabled</Optimization>
       <AdditionalIncludeDirectories>..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;_DEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <MinimalRebuild>true</MinimalRebuild>
       <ExceptionHandling />
       <BasicRuntimeChecks>EnableFastChecks</BasicRuntimeChecks>
@@ -72,7 +72,7 @@
     <ClCompile>
       <Optimization>MaxSpeed</Optimization>
       <AdditionalIncludeDirectories>..\backend;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
-      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
+      <PreprocessorDefinitions>WIN32;_WIN32;NDEBUG;_CRT_SECURE_NO_WARNINGS;_CRT_NONSTDC_NO_WARNINGS;ZINT_VERSION="2.12.0.9";ZINT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
       <StringPooling>true</StringPooling>
       <ExceptionHandling />
       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
diff -urN zint-2.12.0/zint.nsi zint/zint.nsi
--- zint-2.12.0/zint.nsi	2022-12-12 22:06:08.000000000 +0100
+++ zint/zint.nsi	2023-05-08 14:39:45.008320212 +0200
@@ -10,7 +10,7 @@
 ;******************************************************************************
 !define PRODUCT_NAME "Zint"
 !define PRODUCT_EXE "qtZint.exe"
-!define PRODUCT_VERSION "2.12.0"
+!define PRODUCT_VERSION "2.12.0.9"
 !define PRODUCT_WEB_SITE "http://www.zint.org.uk"
 !define PRODUCT_PUBLISHER "Robin Stuart & BogDan Vatra"
 !define PRODUCT_DIR_REGKEY "Software\Microsoft\Windows\CurrentVersion\App Paths\${PRODUCT_EXE}"
